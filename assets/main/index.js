window.__require=function t(e,o,n){function r(a,s){if(!o[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var u=o[a]={exports:{}};e[a][0].call(u.exports,function(t){return r(e[a][1][t]||t)},u,u.exports,t,e,o,n)}return o[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<n.length;a++)r(n[a]);return r}({AStar:[function(t,e,o){"use strict";var n,r;cc._RF.push(e,"d9a1fiDlddLWLt2OQ7p2Fwe","AStar"),Object.defineProperty(o,"__esModule",{value:!0}),o.AStarNode=void 0;var i={new:function(){n=[],r=[]},search:function(t,e){var o;this.new(),this._addConnectionsToOpenList(t);for(var n=0,r=this._popOpenList(e);r;){if(n++,0==r.distant(e)){o=r;break}if(this._addToCloseList(r),this._addConnectionsToOpenList(r),r=this._popOpenList(e),n>=1e4){console.warn("[AStarSearch] possible loop path, after steps: ",n);break}}return o},findPath:function(t,e){var o=[],n=this.search(t,e);return n&&(o=n.getPath()),o},_addConnectionsToOpenList:function(t){for(var e=t.getConnectedNodes(),o=0;o<e.length;o++)this._isInCloseList(e[o])||n.push(e[o])},_popOpenList:function(t){for(var e,o=0,r=-1,i=0;i<n.length;i++){var a=n[i];0==i?(e=a,r=i,o=a.distant(t)):a.distant(t)<o&&(e=a,r=i,o=a.distant(t))}return cc.js.array.removeAt(n,r),e},_isInCloseList:function(t){for(var e=!1,o=0;o<r.length;o++)if(t.equalTo(r[o])){e=!0;break}return e},_addToCloseList:function(t){r.push(t)}};o.default=i;var a=function(){function t(t){this.setParent(t)}return t.prototype.setParent=function(t){this._parent=t},t.prototype.getParent=function(){return this._parent},t.prototype.getPath=function(){var t=[],e=void 0;for(t.push(this),e=this.getParent();e;)t.push(e),e=e.getParent();return t.reverse()},t}();o.AStarNode=a,cc._RF.pop()},{}],AccountProxy:[function(t,e,o){"use strict";cc._RF.push(e,"f336dIY9uhG1Jo12TCXgnCs","AccountProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.DATA_KEYS=o.CONTEXT=o.ACCOUNT=void 0;var s=t("../Framework/Model/Proxy"),c=t("../Framework/Utils/Utils"),l={LOCAL:"Local.Proxy",FACEBOOK:"Facebook.Proxy",WECHAT:"Wechat.Proxy"};(function(t){t[t.LOCAL=0]="LOCAL",t[t.FACEBOOK=1]="FACEBOOK",t[t.WECHAT=2]="WECHAT"})(o.ACCOUNT||(o.ACCOUNT={})),o.CONTEXT={DEFAULT:"SOLO",SOLO:"SOLO",POST:"POST",THREAD:"THREAD",GROUP:"GROUP"};var u={LOGIN:"login",FIRSTLOGIN:"firstlogin",SHORTCUT:"Shortcut"};o.DATA_KEYS=u;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._newDay=!1,e._isFirstLogin=!1,e._shortcutTriedCount=0,e}return r(e,t),e.prototype.getType=function(){return this._accountType},e.prototype.getPlayer=function(){return this._player},e.prototype.getContext=function(){return this._context},e.prototype.isThreadContext=function(){return!1},e.prototype.isSoloContext=function(){return!0},e.prototype.init=function(){return i(this,void 0,void 0,function(){return a(this,function(){return this._player={id:"",name:"",photoUrl:""},this._context={id:"",type:""},[2]})})},e.prototype.setLogin=function(t){this._loginTime=t},e.prototype.setFirstLogin=function(t){this._firstLoginTime=t},e.prototype.loadLoginInfoAsync=function(){return i(this,void 0,void 0,function(){var t,e,o,n,r,i;return a(this,function(a){switch(a.label){case 0:return(t=[]).push(u.LOGIN),t.push(u.FIRSTLOGIN),t.push(u.SHORTCUT),[4,this.loadDataAsync(t)];case 1:return e=a.sent(),0,n=new Date,o=c.default.isNotUndefinedOrNull(e[u.SHORTCUT])?e[u.SHORTCUT]:0,this._shortcutTriedCount=o,c.default.isNotUndefinedOrNull(e[u.FIRSTLOGIN])?(this.setFirstLogin(new Date(e[u.FIRSTLOGIN])),this._isFirstLogin=!1):(this.setFirstLogin(n),this._isFirstLogin=!0),c.default.isNotUndefinedOrNull(e[u.LOGIN])?(r=new Date(e[u.LOGIN]),i=!c.default.isSameDayToday(r),this.setNewDay(i),i?this.setLogin(n):this.setLogin(r)):(this.setLogin(n),this.setNewDay(!0)),[2]}})})},e.prototype.saveShortcutCounter=function(){return i(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return(t={})[u.SHORTCUT]=this._shortcutTriedCount,[4,this.saveDataAsync(t)];case 1:return e.sent(),[2]}})})},e.prototype.saveLoginInfoAsync=function(t){return i(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return t||(t={}),t[u.LOGIN]=this._loginTime,t[u.FIRSTLOGIN]=this._firstLoginTime,[4,this.saveDataAsync(t)];case 1:return e.sent(),[2]}})})},e.prototype.firstLoginTime=function(){return this._firstLoginTime},e.prototype.isFirstLogin=function(){return this._isFirstLogin},e.prototype.loginTime=function(){return this._loginTime},e.prototype.isNewDay=function(){return this._newDay},e.prototype.setNewDay=function(t){this._newDay=t,t&&(this._shortcutTriedCount=0)},e.prototype.tryCreateShortcut=function(){return i(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return(t={})[u.SHORTCUT]=this._shortcutTriedCount,[4,this.saveDataAsync(t)];case 1:return e.sent(),[2]}})})},e.prototype.shortcutTriedCount=function(){return this._shortcutTriedCount},e.prototype.addShortcutTriedCount=function(t){this._shortcutTriedCount+=t},e.prototype.logEvent=function(){},e.prototype.canSwitchGame=function(){return!1},e.prototype.switchGameAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.PROXIES=l,e}(s.default);o.default=p,cc._RF.pop()},{"../Framework/Model/Proxy":"Proxy","../Framework/Utils/Utils":"Utils"}],ActionJob:[function(t,e,o){"use strict";cc._RF.push(e,"d2555dGvihB96VrhpvBaouu","ActionJob");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.createActionJob=function(t,o){var n=new e(t);return n.setFinishHander(o),n},e.createJob=function(t,o){var n=new e(t);return o&&(n.setJobBeginHandler(o.onBeginHandler),n.setJobUpdateHandler(o.onUpdateHandler),n.setFinishHander(o.onFinishHandler),n.setCancelHandler(o.tryCancelHandler)),n},e.prototype._generateJob=function(e){t.prototype._generateJob.call(this,e),this._actions=[],e&&(this._node=e.node,e.actions&&(this._actions=this._actions.concat(e.actions)))},e.prototype.appendAction=function(t){this.isNew()?this._actions.push(t):console.warn("[ActionJob] can't add action to a running job")},e.prototype._onBegin=function(){t.prototype._onBegin.call(this),!this._node||this._actions.length<=0?console.error("[ActionJob] missing action node or actions"):(this._actions.length>1?this._action=cc.sequence(this._actions):this._action=this._actions[0],this._node.runAction(this._action))},e.prototype._tryCancel=function(){var e=t.prototype._tryCancel.call(this);return this._action.isDone()||this._node.stopAction(this._action),e},e.prototype._onUpdate=function(e){return t.prototype._onUpdate.call(this,e),!!this._action.isDone()},e}(t("./Job").default);o.default=i,cc._RF.pop()},{"./Job":"Job"}],AdmobHelper:[function(t,e,o){"use strict";cc._RF.push(e,"b94412JXldLp4lHOScqZvc1","AdmobHelper");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){}return t.init=function(){cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD?jsb.reflection.callStaticMethod("TpclHelper","initAdmob"):cc.sys.platform==cc.sys.ANDROID&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/tpcl/admobHelper","init","()V")},t.initBanner=function(){cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD?jsb.reflection.callStaticMethod("TpclHelper","initBanner"):cc.sys.platform==cc.sys.ANDROID&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/tpcl/admobHelper","initBanner","()V")},t.showBanner=function(){cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD?jsb.reflection.callStaticMethod("TpclHelper","showBanner"):cc.sys.platform==cc.sys.ANDROID&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/tpcl/admobHelper","showBanner","()V")},t.hideBanner=function(){cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD?jsb.reflection.callStaticMethod("TpclHelper","hideBanner"):cc.sys.platform==cc.sys.ANDROID&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/tpcl/admobHelper","hideBanner","()V")},t.initInterstitial=function(){cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD?jsb.reflection.callStaticMethod("TpclHelper","initInterstitial"):cc.sys.platform==cc.sys.ANDROID&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/tpcl/admobHelper","initInterstitial","()V")},t.loadInterstitial=function(){cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD?jsb.reflection.callStaticMethod("TpclHelper","loadInterstitial"):cc.sys.platform==cc.sys.ANDROID&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/tpcl/admobHelper","loadInterstitial","()V")},t.isInterstitialLoaded=function(){return cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD?jsb.reflection.callStaticMethod("TpclHelper","isInterstitialLoaded"):cc.sys.platform==cc.sys.ANDROID&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/tpcl/admobHelper","isInterstitialLoaded","()Z")},t.showInterstitial=function(){cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD?jsb.reflection.callStaticMethod("TpclHelper","showInterstitial"):cc.sys.platform==cc.sys.ANDROID&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/tpcl/admobHelper","showInterstitial","()V")},t.initVideo=function(){cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD?jsb.reflection.callStaticMethod("TpclHelper","initVideo"):cc.sys.platform==cc.sys.ANDROID&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/tpcl/admobHelper","initVideo","()V")},t.isVideoLoaded=function(){return cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD?jsb.reflection.callStaticMethod("TpclHelper","isVideoLoaded"):cc.sys.platform==cc.sys.ANDROID&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/tpcl/admobHelper","isVideoLoaded","()Z")},t.loadVideo=function(){cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD?jsb.reflection.callStaticMethod("TpclHelper","loadVideo"):cc.sys.platform==cc.sys.ANDROID&&jsb.reflection.callStaticMethod("org/cocos2dx/javascript/tpcl/admobHelper","loadVideo","()V")},t.showVideo=function(){return n(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return cc.sys.platform!=cc.sys.IPHONE&&cc.sys.platform!=cc.sys.IPAD?[3,2]:[4,a()];case 1:return[2,t.sent()];case 2:if(cc.sys.platform==cc.sys.ANDROID)return[2,jsb.reflection.callStaticMethod("org/cocos2dx/javascript/tpcl/admobHelper","showVideo","()V")];t.label=3;case 3:return[2]}})})},t}();function a(){return n(this,void 0,void 0,function(){var t;return r(this,function(){return jsb.reflection.callStaticMethod("TpclHelper","showVideo"),(t=s())>0?(c(),[2,1==t]):[2,new Promise(function(e){var o=setInterval(function(){if((t=s())>0){console.info("Video State: "+t),clearInterval(o);var n=1==t;c(),e(n)}},100)})]})})}function s(){return jsb.reflection.callStaticMethod("TpclHelper","checkVideoPlayState")}function c(){return jsb.reflection.callStaticMethod("TpclHelper","resetVideoPlayState")}o.default=i,cc._RF.pop()},{}],AdmobProvider:[function(t,e,o){"use strict";cc._RF.push(e,"fa3d5aCG4hPRotJmJ1V44C5","AdmobProvider");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../AdmobHelper"),a=function(){function t(){this._ads={bannerAd:void 0,isBannerLoaded:!1,rewardedVideoAd:void 0,isVideoLoaded:!1},this._bannerInited=!1,this._initTime=0,this._failCounter=0}return t.isValid=function(){return cc.sys.isNative&&cc.sys.isMobile},t.prototype.init=function(){this._initBanner(),this.loadVideo()},t.prototype._initBanner=function(){return i.default.initBanner(),!0},t.prototype._isBannerInited=function(){return!0},t.prototype.isBannerReady=function(){return!!this._isBannerInited()},t.prototype.showBanner=function(){return n(this,void 0,void 0,function(){return r(this,function(){return this._isBannerInited()?(i.default.showBanner(),[2]):[2,!1]})})},t.prototype.hideBanner=function(){if(!this._isBannerInited())return!1;i.default.hideBanner()},t.prototype.isInterstitialReady=function(){return i.default.isInterstitialLoaded()},t.prototype.loadInterstitial=function(){i.default.loadInterstitial()},t.prototype.showInterstitial=function(){i.default.showInterstitial()},t.prototype.isVideoReady=function(){return i.default.isVideoLoaded()},t.prototype.loadVideo=function(){return n(this,void 0,void 0,function(){return r(this,function(){return[2,i.default.loadVideo()]})})},t.prototype.showVideo=function(t){return n(this,void 0,void 0,function(){var e;return r(this,function(o){switch(o.label){case 0:return[4,i.default.showVideo()];case 1:return e=o.sent(),t&&t(e),console.info("[Admob] video play succes: ",e),[2,e]}})})},t}();o.default=a,cc._RF.pop()},{"../AdmobHelper":"AdmobHelper"}],AdsInterface:[function(t,e,o){"use strict";cc._RF.push(e,"72f3cbQ/e1Adp/inaAt1FM6","AdsInterface"),Object.defineProperty(o,"__esModule",{value:!0}),o.ADS_PROVIDER=void 0,function(t){t[t.NONE=0]="NONE",t[t.BAIDU=1]="BAIDU",t[t.ADMOB=2]="ADMOB",t[t.FACEBOOK=3]="FACEBOOK",t[t.MINIGAME=4]="MINIGAME"}(o.ADS_PROVIDER||(o.ADS_PROVIDER={})),cc._RF.pop()},{}],AdsManager:[function(t,e,o){"use strict";cc._RF.push(e,"2e83beXa2hH8oa5au/amBvL","AdsManager");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./AdsInterface"),a=t("../../Tpcl/Baidu/BaiduAds"),s=t("../Utils/Utils"),c=t("./TempAds"),l=t("../../Tpcl/Admob/AdmobProvider"),u=t("../../Tpcl/Facebook/Facebook"),p=t("../../Tpcl/Facebook/FacebookAds"),d=function(){function t(){this._videoCounter=0,this._popupCounter=0,this._lastAdsDate=0}return t.getInstance=function(){return s.default.isUndefinedOrNull(t._inst)&&(t._inst=new t),t._inst},t.prototype.init=function(t){switch(t){case i.ADS_PROVIDER.BAIDU:a.default.isValid()?(this._adsProvider=new a.default,console.info("## using Baidu Ads")):console.warn("[BaiduAds] not valid");break;case i.ADS_PROVIDER.ADMOB:l.default.isValid()?(this._adsProvider=new l.default,console.info("## using Admob Ads")):console.warn("[Admob] not valid on this platform: ",cc.sys.platform);break;case i.ADS_PROVIDER.FACEBOOK:u.default.isValid()?(this._adsProvider=new p.default,console.info("## using Facebook Ads")):console.warn("[Facebook] not valid")}this._adsProvider||(this._adsProvider=new c.default),this._adsProvider.init(),i.ADS_PROVIDER.ADMOB,this._videoCounter=0,this._popupCounter=0},t.prototype.load=function(){return n(this,void 0,void 0,function(){return r(this,function(){return this._updateCounter(),[2]})})},t.prototype.save=function(){return n(this,void 0,void 0,function(){return r(this,function(){return[2]})})},t.prototype._updateCounter=function(){s.default.isSameDayToday(new Date(this._lastAdsDate))||(this._videoCounter=0)},t.prototype.getVideoAdsCounter=function(){return this._videoCounter},t.prototype.addCounter=function(){this._videoCounter++,this._lastAdsDate=Date.now(),this.save()},t.prototype.getPopupAdsCounter=function(){return this._popupCounter},t.prototype.showBannerAds=function(t){t?this._adsProvider.showBanner():this._adsProvider.hideBanner()},t.prototype.isPopupAdsReady=function(){},t.prototype.showPopupAds=function(){return n(this,void 0,void 0,function(){return r(this,function(){return[2]})})},t.prototype.isRewardsAdsReady=function(t){var e=this._adsProvider.isVideoReady(),o=Date.now()-this._lastAdsDate>s.default.msMinutes(.25),n=!0;return t>0&&(n=this._videoCounter<t),e&&o&&n},t.prototype.showRewardsAds=function(t){return n(this,void 0,void 0,function(){return r(this,function(){return[2,MiniGameAds.showRewardedVideo().then(function(){return t(!0),Promise.resolve(!0)}).catch(function(e){return t(!1),console.error("showRewardedVideo error: "+e),Promise.resolve(!1)})]})})},t}();o.default=d,cc._RF.pop()},{"../../Tpcl/Admob/AdmobProvider":"AdmobProvider","../../Tpcl/Baidu/BaiduAds":"BaiduAds","../../Tpcl/Facebook/Facebook":"Facebook","../../Tpcl/Facebook/FacebookAds":"FacebookAds","../Utils/Utils":"Utils","./AdsInterface":"AdsInterface","./TempAds":"TempAds"}],AdsProxy:[function(t,e,o){"use strict";cc._RF.push(e,"0aa83b2pdxG8o0cX3yKGTKg","AdsProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/Model/Proxy"),l=t("../Settings/ProxyTypes"),u=t("../Settings/AdsSettings"),p=cc._decorator,d=p.ccclass,f=(p.property,-1),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return r(e,t),o=e,e.create=function(t){var e=new o;return e.name=t,e.init(),e},e.prototype.init=function(){this._accountProxy=this.getFacade().retrieveProxy(l.default.ACCOUNT),this._adsData={freeGoldValue:0,freeGoldAdsCounter:0,extraGoldValue:0,extraGoldAdsCounter:0,randomAdsCounter:0,freeMatchCounter:0,shareCounter:0},this.data=this._adsData},e.prototype.resetDailyData=function(){this._adsData.freeGoldValue=0,this._adsData.freeGoldAdsCounter=0,this._adsData.extraGoldValue=0,this._adsData.extraGoldAdsCounter=0,this._adsData.randomAdsCounter=0,this._adsData.freeMatchCounter=0,this._adsData.shareCounter=0},e.prototype.initAds=function(){var t=this._accountProxy;t.isAdsReady(u.ADS_KEY.RANDOM_RV)||t.prepareAds(u.ADS_KEY.RANDOM_RV,0),t.isAdsReady(u.ADS_KEY.RANDOM_INT)||t.prepareAds(u.ADS_KEY.RANDOM_INT,1)},e.prototype.getData=function(){return this._adsData},e.prototype.loadExtraGoldAds=function(){this._accountProxy.isAdsReady(u.ADS_KEY.EXTRA_GOLD)||this._accountProxy.prepareAds(u.ADS_KEY.EXTRA_GOLD,0)},e.prototype.loadFreeGoldAds=function(){this._accountProxy.isAdsReady(u.ADS_KEY.FREE_GOLD)||this._accountProxy.prepareAds(u.ADS_KEY.FREE_GOLD,0)},e.prototype.loadRandomAds=function(){this._accountProxy.isAdsReady(u.ADS_KEY.RANDOM_RV)||this._accountProxy.prepareAds(u.ADS_KEY.RANDOM_RV,0),this._accountProxy.isAdsReady(u.ADS_KEY.RANDOM_INT)||this._accountProxy.prepareAds(u.ADS_KEY.RANDOM_INT,1)},e.prototype.loadReviveAds=function(){this._accountProxy.isAdsReady(u.ADS_KEY.REVIVE)||this._accountProxy.prepareAds(u.ADS_KEY.REVIVE,0)},e.prototype.isExtraGoldAdsReady=function(){return this._accountProxy.isAdsReady(u.ADS_KEY.EXTRA_GOLD)},e.prototype.calculateExtraGold=function(t){return t<=0?(this._adsData.extraGoldValue=0,0):(e=1e3+t%1e3,this._adsData.extraGoldValue=e,e);var e},e.prototype.playExtraGoldAds=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return[4,this._accountProxy.playAds(u.ADS_KEY.EXTRA_GOLD)];case 1:return(t=n.sent())?((e=this.getFacade().retrieveProxy(l.default.INVENTORY)).addMoney(this._adsData.extraGoldValue),e.save(),this.sendNotification(o.EVENTS.ADS_PLAY_DONE,{adsKey:u.ADS_KEY.EXTRA_GOLD,success:!0,value:this._adsData.extraGoldValue}),this._adsData.extraGoldAdsCounter++,this._adsData.extraGoldValue=0,this._adsData.freeMatchCounter=0):this.sendNotification(o.EVENTS.ADS_PLAY_DONE,{adsKey:u.ADS_KEY.EXTRA_GOLD,success:!1,value:this._adsData.extraGoldValue}),this.loadExtraGoldAds(),[2,t]}})})},e.prototype.isFreeGoldAdsReady=function(){return!(f>0&&this._adsData.freeGoldAdsCounter>=f)&&this._accountProxy.isAdsReady(u.ADS_KEY.FREE_GOLD)},e.prototype.calculateFreeGold=function(){if(!(this._adsData.freeGoldValue>0))return this._adsData.freeGoldValue=1e3,this._adsData.freeGoldValue},e.prototype.playFreeGoldAds=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return[4,this._accountProxy.playAds(u.ADS_KEY.FREE_GOLD)];case 1:return(t=n.sent())?((e=this.getFacade().retrieveProxy(l.default.INVENTORY)).addMoney(this._adsData.freeGoldValue),e.save(),this.sendNotification(o.EVENTS.ADS_PLAY_DONE,{adsKey:u.ADS_KEY.FREE_GOLD,success:!0,value:this._adsData.freeGoldValue}),this._adsData.freeGoldAdsCounter++,this._adsData.freeGoldValue=0,this._adsData.freeMatchCounter=0):this.sendNotification(o.EVENTS.ADS_PLAY_DONE,{adsKey:u.ADS_KEY.FREE_GOLD,success:!1,value:this._adsData.freeGoldValue}),this.loadFreeGoldAds(),[2,t]}})})},e.prototype.isRandomAdsReady=function(){return!(this._adsData.freeMatchCounter<5)&&(this._accountProxy.isAdsReady(u.ADS_KEY.RANDOM_RV)||this._accountProxy.isAdsReady(u.ADS_KEY.RANDOM_INT))},e.prototype.isReviveAdsReady=function(){return this._accountProxy.isAdsReady(u.ADS_KEY.REVIVE)},e.prototype.playRandomAds=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return t=u.ADS_KEY.RANDOM_RV,e=!1,this._accountProxy.isAdsReady(u.ADS_KEY.RANDOM_RV)?[4,this._accountProxy.playAds(u.ADS_KEY.RANDOM_RV)]:[3,2];case 1:return e=n.sent(),[3,5];case 2:return this._accountProxy.isAdsReady(u.ADS_KEY.RANDOM_INT)?(t=u.ADS_KEY.RANDOM_INT,[4,this._accountProxy.playAds(u.ADS_KEY.RANDOM_INT)]):[3,4];case 3:return e=n.sent(),[3,5];case 4:return[2,!1];case 5:return this._adsData.randomAdsCounter++,this._adsData.freeMatchCounter=0,this.sendNotification(o.EVENTS.ADS_PLAY_DONE,{adsKey:t,success:!0,value:0}),this.loadRandomAds(),[2,e]}})})},e.prototype.playReviveAds=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,this._accountProxy.playAds(u.ADS_KEY.REVIVE)];case 1:return(t=e.sent())?this.sendNotification(o.EVENTS.ADS_PLAY_DONE,{adsKey:u.ADS_KEY.REVIVE,success:!0,value:0}):this.sendNotification(o.EVENTS.ADS_PLAY_DONE,{adsKey:u.ADS_KEY.REVIVE,success:!1,value:0}),this.loadReviveAds(),[2,t]}})})},e.prototype.increaseFreeMatch=function(){this._adsData.freeMatchCounter++},e.prototype.hasShareRewards=function(){return!(this._adsData.shareCounter>=1)},e.prototype.getShareRewards=function(){return 2e3},e.prototype.playAds=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(o){switch(o.label){case 0:switch(e=!1,t){case u.ADS_KEY.FREE_GOLD:return[3,1];case u.ADS_KEY.EXTRA_GOLD:return[3,3];case u.ADS_KEY.RANDOM_INT:case u.ADS_KEY.RANDOM_RV:return[3,5];case u.ADS_KEY.REVIVE:return[3,7]}return[3,9];case 1:return[4,this.playFreeGoldAds()];case 2:return e=o.sent(),[3,9];case 3:return[4,this.playExtraGoldAds()];case 4:return e=o.sent(),[3,9];case 5:return[4,this.playRandomAds()];case 6:return e=o.sent(),[3,9];case 7:return[4,this.playReviveAds()];case 8:return e=o.sent(),[3,9];case 9:return[2,e]}})})},e.EVENTS={ADS_PLAY_DONE:"Ads.Play.Done",ADS_PLAY_FAIL:"Ads.Play.Fail"},o=i([d],e)}(c.default);o.default=h,cc._RF.pop()},{"../Framework/Model/Proxy":"Proxy","../Settings/AdsSettings":"AdsSettings","../Settings/ProxyTypes":"ProxyTypes"}],AdsSettings:[function(t,e,o){"use strict";cc._RF.push(e,"50da3qkS9NPMZuZE/baYC1i","AdsSettings"),Object.defineProperty(o,"__esModule",{value:!0}),o.Ads=o.ADS_KEY=void 0;var n,r={EXTRA_GOLD:"",REVIVE:"",FREE_GOLD:"",RANDOM_INT:"272188327036051_274461726808711",RANDOM_RV:"272188327036051_274461436808740"};(function(t){t[t.EXTRA_GOLD=0]="EXTRA_GOLD",t[t.REVIVE=1]="REVIVE",t[t.FREE_GOLD=2]="FREE_GOLD",t[t.RANDOM_INT=3]="RANDOM_INT",t[t.RANDOM_RV=4]="RANDOM_RV"})(n||(n={})),o.ADS_KEY=n,r.EXTRA_GOLD=r.RANDOM_RV,r.REVIVE=r.RANDOM_RV,r.FREE_GOLD=r.RANDOM_RV;var i={getAdsId:function(t){var e=r.RANDOM_RV;switch(t){case n.EXTRA_GOLD:e=r.EXTRA_GOLD;break;case n.FREE_GOLD:e=r.FREE_GOLD;break;case n.REVIVE:e=r.REVIVE;break;case n.RANDOM_INT:e=r.RANDOM_INT;break;case n.RANDOM_RV:e=r.RANDOM_RV}return e}};o.Ads=i,cc._RF.pop()},{}],AdsUIMediator:[function(t,e,o){"use strict";cc._RF.push(e,"0d82cViGntM4YwIIp+NiBY6","AdsUIMediator");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/View/UIMediator"),l=t("../Framework/Utils/Utils"),u=t("../Settings/ProxyTypes"),p=cc._decorator,d=p.ccclass,f=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._proxy=null,e}return r(e,t),e.prototype._initViewComponent=function(){this.ui.initOnce()},e.prototype._initProxy=function(){l.default.isUndefinedOrNull(this._proxy)&&(this._proxy=this.getFacade().retrieveProxy(u.default.ADS))},e.prototype._updateData=function(){},e.prototype.showAds=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return this._adsKey=t,this._config=e,e.callback=this.onUesrInput.bind(this),this.ui.setData(e),this.ui.beforeShow(),[4,this.ui.show(!0)];case 1:return o.sent(),[4,this.ui.afterShow()];case 2:return o.sent(),[2]}})})},e.prototype.onUesrInput=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return t?[4,this._proxy.playAds(this._adsKey)]:[3,3];case 1:return e.sent(),[4,this.hide(!0)];case 2:return e.sent(),[3,5];case 3:return[4,this.hide(!0)];case 4:e.sent(),e.label=5;case 5:return[2]}})})},i([d],e)}(c.default));o.default=f,cc._RF.pop()},{"../Framework/Utils/Utils":"Utils","../Framework/View/UIMediator":"UIMediator","../Settings/ProxyTypes":"ProxyTypes"}],AdsUI:[function(t,e,o){"use strict";cc._RF.push(e,"7887fVu385G85fSzE1W+/Wq","AdsUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/View/BaseUI"),l=t("../Framework/Utils/Utils"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.title1=null,e.title2=null,e.rewardsIcon=null,e.txtValue=null,e.btnOK=null,e.btnNo=null,e}return r(e,t),e.prototype.initOnce=function(){this.btnOK.node.on("click",this.onOK,this),this.btnNo.node.on("click",this.onCancel,this)},e.prototype.setData=function(t){this._config=t},e.prototype.beforeShow=function(){l.default.isNotUndefinedOrNull(this._config)&&(l.default.isNotUndefinedOrNull(this._config.title1)&&(this.title1.string=this._config.title1),l.default.isNotUndefinedOrNull(this._config.title2)&&(this.title2.string=this._config.title2),l.default.isNotUndefinedOrNull(this._config.value)&&(this.txtValue.string="+"+this._config.value))},e.prototype.afterShow=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.onOK=function(){l.default.isNotUndefinedOrNull(this._config.callback)?this._config.callback(!0):this.hide(!1)},e.prototype.onCancel=function(){l.default.isNotUndefinedOrNull(this._config.callback)?this._config.callback(!1):this.hide(!1)},i([d(cc.Label)],e.prototype,"title1",void 0),i([d(cc.Label)],e.prototype,"title2",void 0),i([d(cc.Sprite)],e.prototype,"rewardsIcon",void 0),i([d(cc.Label)],e.prototype,"txtValue",void 0),i([d(cc.Button)],e.prototype,"btnOK",void 0),i([d(cc.Button)],e.prototype,"btnNo",void 0),i([p],e)}(c.default);o.default=f,cc._RF.pop()},{"../Framework/Utils/Utils":"Utils","../Framework/View/BaseUI":"BaseUI"}],AnimationJob:[function(t,e,o){"use strict";cc._RF.push(e,"d4c34YaSYRB64RV42X7MU7+","AnimationJob");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Job"),a=t("../Utils/Utils"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createAnimationJob=function(t,o){var n=new e(t);return n.setFinishHander(o),n},e.createJob=function(t,o){var n=new e(t);return o&&(n.setJobBeginHandler(o.onBeginHandler),n.setJobUpdateHandler(o.onUpdateHandler),n.setFinishHander(o.onFinishHandler),n.setCancelHandler(o.tryCancelHandler)),n},e.prototype._generateJob=function(e){if(t.prototype._generateJob.call(this,e),e)if(this._animation=e.animation,a.default.isUndefinedOrNull(e.nameOrIdx)&&e.animation.defaultClip)this._clipName=e.animation.defaultClip.name;else if("string"==typeof e.nameOrIdx)this._clipName=e.nameOrIdx;else{var o=e.nameOrIdx,n=e.animation.getClips()[o];n?this._clipName=n.name:console.warn("[AnimationClip] missing clip name or index: ",e)}},e.prototype._onBegin=function(){t.prototype._onBegin.call(this),this._animation.play(this._clipName)},e.prototype._onUpdate=function(e){var o=t.prototype._onUpdate.call(this,e),n=this._animation.currentClip;if(n){var r=n.name;o=!this._animation.getAnimationState(r).isPlaying}return o},e.prototype._tryCancel=function(){var e=t.prototype._tryCancel.call(this);return this._animation.stop(),e},e.prototype.pause=function(){this._animation.pause(),t.prototype.pause.call(this)},e.prototype.resume=function(){this._animation.resume(),t.prototype.resume.call(this)},e}(i.default);o.default=s,cc._RF.pop()},{"../Utils/Utils":"Utils","./Job":"Job"}],AppCommands:[function(t,e,o){"use strict";cc._RF.push(e,"28bd04mlelOJoasi8+wq80r","AppCommands");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.SkipAdsForReviveCommand=o.AdsForReviveCommand=o.ReviveCommand=o.HideReviveUICommand=void 0;var s=t("../Framework/Controller/SimpleCommand"),c=t("../App/AppFacade"),l=t("../Framework/Utils/Utils"),u=t("../Framework/Controller/MacroCommand"),p=t("../Framework/Scene/SceneControl"),d=t("../Settings/SceneTypes"),f=t("../Settings/ProxyTypes"),h=t("../Settings/MediatorType"),y=t("../Settings/EventTypes"),_=t("../Settings/CommandTypes"),v=t("../Account/InventoryProxy"),g=t("../Account/BasePlayerProxy"),b=t("../Shop/ShopDB"),m=t("../Settings/AdsSettings"),w=t("../Settings/Settings"),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.execute=function(){return i(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,c.default.getAppInstance().registerGlobalProxies()];case 1:return t.sent(),[4,c.default.getAppInstance().registerGlobalMediators()];case 2:return t.sent(),[4,c.default.getAppInstance().initGlobalProxies()];case 3:return t.sent(),[2]}})})},e}(s.default),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){var t,e,o,n,r,i,s;return a(this,function(a){switch(a.label){case 0:return[4,(t=c.default.getInstance().retrieveProxy(f.default.ACCOUNT)).startAsync()];case 1:return a.sent(),[4,t.loadLoginInfoAsync()];case 2:return a.sent(),console.info("===> first login time: ",t.firstLoginTime().toString(),", [new account: ",t.isFirstLogin(),"]"),console.info("===> last login time: ",t.loginTime().toString(),", [new day: ",t.isNewDay(),"]"),e=c.default.getInstance().retrieveProxy(f.default.INVENTORY),o=c.default.getInstance().retrieveProxy(f.default.PLAYER),n=[v.default.KEY,g.default.KEY],[4,t.loadDataAsync(n)];case 3:return r=a.sent(),t.isFirstLogin()||l.default.isUndefinedOrNull(r)?(i={},[4,t.onFirstStartAsync()]):[3,6];case 4:return a.sent(),e.onFirstStart(),o.onFirstStart(),o.addDaysPlayed(1),o.setReturnDays(t.firstLoginTime()),i[v.default.KEY]=e.data,i[g.default.KEY]=o.data,[4,t.saveLoginInfoAsync(i)];case 5:return a.sent(),[3,9];case 6:return l.default.isNotUndefinedOrNull(r)?(s=r[v.default.KEY],l.default.isNotUndefinedOrNull(s)?e.updateFromData(s):console.warn("===> missing inventory data"),s=r[g.default.KEY],l.default.isNotUndefinedOrNull(s)?o.updateFromData(s):console.warn("===> missing player data"),new Date,t.isNewDay()&&(o.addDaysPlayed(1),o.setReturnDays(t.loginTime())),[4,t.saveLoginInfoAsync({})]):[3,8];case 7:return a.sent(),[3,9];case 8:console.warn("===> missing data"),a.label=9;case 9:return[2]}})})},e}(s.default),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){var t,e,o;return a(this,function(n){switch(n.label){case 0:return[4,this.getFacade().retrieveProxy(f.default.ADS).initAds()];case 1:return n.sent(),(t=this.getFacade().retrieveProxy(f.default.LEADERBOARD))?[4,t.loadPlayerEntryAsync()]:[3,4];case 2:return n.sent(),[4,t.getEntrisAsync(w.default.RANK_INIT_COUNT,0)];case 3:n.sent(),n.label=4;case 4:return(e=this.retrieveProxy(f.default.ACCOUNT))&&e.isThreadContext()&&(o=this.retrieveProxy(f.default.CONTEXT_RANK))?[4,o.changeContextId(e.getContext().id)]:[3,7];case 5:return n.sent(),[4,o.reloadEntriesAsync(w.default.RANK_INIT_COUNT,0)];case 6:n.sent(),n.label=7;case 7:return[2]}})})},e}(s.default),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){return a(this,function(){return c.default.getAppInstance().initGlobalMediators(),[2]})})},e}(s.default),A=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){var t,e,o;return a(this,function(n){switch(n.label){case 0:return(t=this.getFacade().retrieveMediator(h.default.GAME_UI))&&t.show(!1),(e=this.getFacade().retrieveMediator(h.default.HUD))&&e.show(!1),(o=this.getFacade().retrieveMediator(h.default.SHOP_UI))?(o.show(!1),[4,o.close()]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})}}(s.default),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.addSubCommand(P,"init account"),this.addSubCommand(O,"init proxies"),this.addSubCommand(E," init mediators"),this.addSubCommand(U,"play new match")},e}(u.default)),T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return t=d.default.GAME,[4,p.default.loadSceneAsync(t,!1)];case 1:return e.sent(),[2]}})})},e}(s.default),R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(e){return i(this,void 0,void 0,function(){var o;return a(this,function(n){switch(n.label){case 0:return o=c.default.getAppInstance().getMainUI(),l.default.isNotUndefinedOrNull(o)?[4,o.hide(!0)]:[3,2];case 1:n.sent(),c.default.getAppInstance().setMainUI(void 0),n.label=2;case 2:return t.prototype.execute.call(this,e),[2]}})})},e}(s.default),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(e){return i(this,void 0,void 0,function(){var o;return a(this,function(n){switch(n.label){case 0:return[4,(o=c.default.getInstance().retrieveMediator(h.default.HOME_UI)).show(!0)];case 1:return n.sent(),c.default.getAppInstance().setMainUI(o),t.prototype.execute.call(this,e),[2]}})})},e}(s.default),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(e){return i(this,void 0,void 0,function(){var o;return a(this,function(n){switch(n.label){case 0:return(o=c.default.getInstance().retrieveMediator(h.default.GAME_UI))?[4,o.show(!0)]:(console.warn("[ShowGameUICommand] no game ui mediator"),[2]);case 1:return n.sent(),c.default.getAppInstance().setMainUI(o),t.prototype.execute.call(this,e),[2]}})})},e}(s.default),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(e){return i(this,void 0,void 0,function(){var o;return a(this,function(n){switch(n.label){case 0:return[4,(o=c.default.getInstance().retrieveMediator(h.default.RESULT_UI)).show(!0)];case 1:return n.sent(),c.default.getAppInstance().setMainUI(o),t.prototype.execute.call(this,e),[2]}})})},e}(s.default),k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(o){switch(o.label){case 0:return(e=c.default.getInstance().retrieveProxy(f.default.MATCH))?[4,e.newMatch(t.getUserData())]:(console.warn("[NewMatchCommand] no match proxy"),[2]);case 1:return o.sent(),[2]}})})},e}(s.default),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(e){return i(this,void 0,void 0,function(){var o,n;return a(this,function(){return(o=c.default.getInstance().retrieveMediator(h.default.GAME_CONTROL))?(o.startMatch(),(n=c.default.getInstance().retrieveMediator(h.default.GAME_UI))?(n.startMatch(),t.prototype.execute.call(this,e),[2]):(console.warn("[StartMatchCommand] no game ui mediator"),[2])):(console.warn("[StartMatchCommand] no match control mediator"),[2])})})},e}(s.default),D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e}(s.default),K=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})}}(s.default),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(e){return i(this,void 0,void 0,function(){var o,n,r,i,s,u,p;return a(this,function(a){switch(a.label){case 0:return c.default.getInstance().retrieveMediator(h.default.GAME_CONTROL).endMatch(),c.default.getInstance().retrieveMediator(h.default.GAME_UI).endMatch(),(o=c.default.getInstance().retrieveProxy(f.default.MATCH)).endMatch(),(n=c.default.getInstance().retrieveProxy(f.default.PLAYER)).addGamesPlayed(1),o.data.isNewRecord&&(n.checkHistoryScore(o.getScore()),(r=c.default.getAppInstance().retrieveMediator(h.default.HUD))&&r.onHistoryUpdate()),n.save(),(i=c.default.getInstance().retrieveProxy(f.default.INVENTORY)).addMoney(o.getFinalMoney()),i.save(),this.runCommand(_.default.UPDATE_LEADERBOARD,o),s=c.default.getInstance().retrieveProxy(f.default.ACCOUNT),u=new Date,l.default.isSameDay(u,s.loginTime())?[3,2]:(s.setLogin(u),s.setNewDay(!0),n.addDaysPlayed(1),n.save(),[4,s.saveLoginInfoAsync({})]);case 1:a.sent(),a.label=2;case 2:return c.default.getInstance().retrieveProxy(f.default.ADS).calculateExtraGold(o.getFinalMoney()),(p=c.default.getInstance().retrieveMediator(h.default.RESULT_UI)).updateMatchScore(),[4,p.show(!0)];case 3:return a.sent(),t.prototype.execute.call(this,e),[2]}})})},e}(s.default)),F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(t){return i(this,void 0,void 0,function(){var e,o,n,r;return a(this,function(){return e=t.getUserData(),o=c.default.getInstance().retrieveProxy(f.default.LEADERBOARD),n=e.getScore(),n=Math.ceil(100*n),r={},o.setScoreAsync(n,JSON.stringify(r)),[2]})})},e}(s.default),U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.addSubCommand(k,"new match"),this.addSubCommand(T,"go game scene")},e}(u.default),L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.addSubCommand(K,"end match")},e}(u.default),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(e){return i(this,void 0,void 0,function(){var o;return a(this,function(){return o=c.default.getInstance().retrieveProxy(f.default.APP),l.default.isNotUndefinedOrNull(o)&&o.setPaused(!0),t.prototype.execute.call(this,e),[2]})})},e}(s.default),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(e){return i(this,void 0,void 0,function(){var o;return a(this,function(){return o=c.default.getInstance().retrieveProxy(f.default.APP),l.default.isNotUndefinedOrNull(o)&&o.setPaused(!1),t.prototype.execute.call(this,e),[2]})})},e}(s.default),B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.addSubCommand(R),this.addSubCommand(I)},e}(u.default),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(t){return i(this,void 0,void 0,function(){var e,o,n,r,i,s,u,p,d;return a(this,function(a){switch(a.label){case 0:return e=t.getUserData(),o=e.item,b.default.idToCategory(o),n=f.default.SHOP,r=c.default.getInstance().retrieveProxy(n),(i=r.getItemById(o)).owned?(console.warn("===> item already owned: ",i),[2]):(s=b.default.getInstance().getConfigById(o),console.assert(l.default.isNotUndefinedOrNull(s)),(u=c.default.getInstance().retrieveProxy(f.default.INVENTORY)).getMoney()<s.price?(c.default.getInstance().sendNotification(y.default.SHOP.NOT_ENOUGH_MONEY_FOR_ITEM,{item:o,price:s.price}),[2]):[4,u.buyItem(o,s.price)]);case 1:return a.sent(),p=this.getFacade().retrieveProxy(f.default.ACCOUNT),(d={})[v.default.KEY]=u.data,[4,p.saveDataAsync(d)];case 2:return a.sent(),[2]}})})},e}(s.default),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return t=this.getFacade().retrieveMediator(h.default.REVIVE_UI),l.default.isNotUndefinedOrNull(t)?[4,t.hide(!0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e}(s.default);o.HideReviveUICommand=H;var V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return t=this.getFacade().retrieveMediator(h.default.REVIVE_UI),l.default.isNotUndefinedOrNull(t)?[4,t.show(!0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e}(s.default),Y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){return a(this,function(){return c.default.getInstance().retrieveMediator(h.default.GAME_CONTROL).revive(),this.retrieveMediator(h.default.GAME_UI).continueMatch(),[2]})})},e}(s.default);o.ReviveCommand=Y;var W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(o){switch(o.label){case 0:return(e=this.getFacade().retrieveProxy(f.default.ADS)).isReviveAdsReady()?[4,e.playReviveAds()]:[3,7];case 1:return o.sent()?[4,this.runCommand(H,t)]:[3,4];case 2:return o.sent(),[4,this.runCommand(Y,t)];case 3:return o.sent(),[3,6];case 4:return[4,this.getFacade().executeCommand(_.default.SKIP_ADS_FOR_REVIVE)];case 5:o.sent(),o.label=6;case 6:return[3,9];case 7:return[4,this.getFacade().executeCommand(_.default.SKIP_ADS_FOR_REVIVE)];case 8:o.sent(),o.label=9;case 9:return[2]}})})},e}(s.default);o.AdsForReviveCommand=W;var J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.addSubCommand(H),this.addSubCommand(L)},e}(u.default);o.SkipAdsForReviveCommand=J;var q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){var t,e;return a(this,function(){return t=this.getFacade().retrieveProxy(f.default.ADS),e=t.getData().freeGoldValue,this.getFacade().retrieveMediator(h.default.ADS).showAds(m.ADS_KEY.FREE_GOLD,{title2:"FREE GOLD",value:e}),[2]})})},e}(s.default),z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){var t,e;return a(this,function(){return t=this.getFacade().retrieveProxy(f.default.ADS),e=t.getData().extraGoldValue,this.getFacade().retrieveMediator(h.default.ADS).showAds(m.ADS_KEY.EXTRA_GOLD,{title2:"EXTRA GOLD",value:e}),[2]})})},e}(u.default),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(){return t.getUserData(),(e=this.getFacade().retrieveMediator(h.default.RANK_UI))&&e.show(!0),[2]})})},e}(s.default),Q={COMMANDS:_.default,registerToFacade:function(t){t.registerCommand(_.default.APP_INIT,S),t.registerCommand(_.default.APP_START,A),t.registerCommand(_.default.HIDE_MAIN_UI,R),t.registerCommand(_.default.SHOW_HOME_UI,I),t.registerCommand(_.default.SHOW_GAME_UI,C),t.registerCommand(_.default.SHOW_RESULT_UI,N),t.registerCommand(_.default.SHOW_REVIVE_UI,V),t.registerCommand(_.default.NEW_MATCH,k),t.registerCommand(_.default.START_MATCH,x),t.registerCommand(_.default.STOP_MATCH,D),t.registerCommand(_.default.END_MATCH,K),t.registerCommand(_.default.PLAY_NEW_MATCH,U),t.registerCommand(_.default.END_GAME,L),t.registerCommand(_.default.UPDATE_LEADERBOARD,F),t.registerCommand(_.default.GO_HOME_SCENE,B),t.registerCommand(_.default.PAUSE_GAME,M),t.registerCommand(_.default.RESUME_GAME,G),t.registerCommand(_.default.BUY_PROP,j),t.registerCommand(_.default.ADS_FOR_REVIVE,W),t.registerCommand(_.default.SKIP_ADS_FOR_REVIVE,J),t.registerCommand(_.default.SHOW_ADS_FOR_EXTRA_GOLD,z),t.registerCommand(_.default.SHOW_ADS_FOR_FREE_GOLD,q),t.registerCommand(_.default.SHOW_RANK,X)}};o.default=Q,cc._RF.pop()},{"../Account/BasePlayerProxy":"BasePlayerProxy","../Account/InventoryProxy":"InventoryProxy","../App/AppFacade":"AppFacade","../Framework/Controller/MacroCommand":"MacroCommand","../Framework/Controller/SimpleCommand":"SimpleCommand","../Framework/Scene/SceneControl":"SceneControl","../Framework/Utils/Utils":"Utils","../Settings/AdsSettings":"AdsSettings","../Settings/CommandTypes":"CommandTypes","../Settings/EventTypes":"EventTypes","../Settings/MediatorType":"MediatorType","../Settings/ProxyTypes":"ProxyTypes","../Settings/SceneTypes":"SceneTypes","../Settings/Settings":"Settings","../Shop/ShopDB":"ShopDB"}],AppFacade:[function(t,e,o){"use strict";cc._RF.push(e,"f50543xskhL5YpCwt+zgEyz","AppFacade");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,u=c.property,p=t("../Framework/Utils/Utils"),d=t("../Framework/Facade"),f=t("../Commands/AppCommands"),h=t("../Framework/View/MediatorComp"),y=t(".//AppProxy"),_=t("../Account/Facebook/FacebookProxy"),v=t("../Account/LocalAccount/LocalProxy"),g=t("../Settings/ProxyTypes"),b=t("../Account/BasePlayerProxy"),m=t("../Account/InventoryProxy"),w=t("../Ads/AdsProxy"),S=t("../Rank/RankProxy"),P=t("./DownloadCache"),O=t("../GamePlay/BaseMatchProxy"),E=t("../Settings/RankTypes"),A=t("../Rank/ContextRankProxy"),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uiMediators=[],e}var o;return r(e,t),o=e,e.getAppInstance=function(){return o._appInstance},e.prototype.onLoad=function(){p.Utils.isUndefinedOrNull(d.default._instance)&&(cc.game.addPersistRootNode(this.node),d.default._instance=this,o._appInstance=this,d.default._instance.init(),f.default.registerToFacade(this),this._onLoaded())},e.prototype._onLoaded=function(){},e.prototype.start=function(){},e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.registerGlobalProxies=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i,a,c;return s(this,function(s){switch(s.label){case 0:return t=y.default.create(),this.registerProxy(t),e=this.createProxy(g.default.DOWNLOAD_CACHE),this.registerProxy(e),(o=this.createAccountProxy()).name=g.default.ACCOUNT,this.registerProxy(o),[4,o.init()];case 1:return s.sent(),n=this.createProxy(g.default.PLAYER),this.registerProxy(n),r=this.createProxy(g.default.INVENTORY),this.registerProxy(r),i=this.createProxy(g.default.MATCH),this.registerProxy(i),a=this.createProxy(g.default.ADS),this.registerProxy(a),c=this.createProxy(g.default.LEADERBOARD,{board:E.default.HIGHSCORE,friendsOnly:!1}),this.registerProxy(c),[2]}})})},e.prototype.createProxy=function(t,e){var o;switch(t){case g.default.ACCOUNT:o=this.createAccountProxy();break;case g.default.PLAYER:o=b.default.create(g.default.PLAYER);break;case g.default.INVENTORY:o=m.default.create(g.default.INVENTORY);break;case g.default.MATCH:o=O.default.create(g.default.MATCH);break;case g.default.ADS:o=w.default.create(g.default.ADS);break;case g.default.LEADERBOARD:o=S.default.create(g.default.LEADERBOARD,e);break;case g.default.CONTEXT_RANK:o=A.default.create(g.default.CONTEXT_RANK,e);break;case g.default.DOWNLOAD_CACHE:o=P.default.create(g.default.DOWNLOAD_CACHE);break;default:console.warn("[AppFacade] unknown proxy: ",t)}return o},e.prototype.createAccountProxy=function(){var t;return p.Utils.isNotUndefinedOrNull(window._facebook)?(console.info("============= GAME RUNNING IN FACEBOOK ============="),t=new _.default):(console.info("============= GAME RUNNING FROM LOCAL ============="),t=new v.default),t},e.prototype.registerGlobalMediators=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return this.uiMediators.forEach(function(e){t.registerMediator(e)}),[2]})})},e.prototype.initGlobalProxies=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.initGlobalMediators=function(){this.uiMediators.forEach(function(t){t.initOnce()})},e.prototype.setMainUI=function(t){this._mainUI=t},e.prototype.getMainUI=function(){return this._mainUI},i([u(h.default)],e.prototype,"uiMediators",void 0),o=i([l],e)}(d.default);o.default=T,cc._RF.pop()},{"../Account/BasePlayerProxy":"BasePlayerProxy","../Account/Facebook/FacebookProxy":"FacebookProxy","../Account/InventoryProxy":"InventoryProxy","../Account/LocalAccount/LocalProxy":"LocalProxy","../Ads/AdsProxy":"AdsProxy","../Commands/AppCommands":"AppCommands","../Framework/Facade":"Facade","../Framework/Utils/Utils":"Utils","../Framework/View/MediatorComp":"MediatorComp","../GamePlay/BaseMatchProxy":"BaseMatchProxy","../Rank/ContextRankProxy":"ContextRankProxy","../Rank/RankProxy":"RankProxy","../Settings/ProxyTypes":"ProxyTypes","../Settings/RankTypes":"RankTypes",".//AppProxy":"AppProxy","./DownloadCache":"DownloadCache"}],AppProxy:[function(t,e,o){"use strict";cc._RF.push(e,"6b34eCdnP9D74xV5+D91/7D","AppProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,t("../Framework/Model/Proxy")),l=t("../Settings/ProxyTypes"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return r(e,t),o=e,e.create=function(){var t=new o;return t.name=l.default.APP,t.init(),t},e.prototype.init=function(){this.data={sound:!0}},e.prototype.isPaused=function(){return cc.director.isPaused()},e.prototype.setPaused=function(t){t?cc.director.pause():cc.director.resume(),this.sendNotification(o.EVENTS.PAUSE_TOGGLE,this.isPaused())},e.prototype.togglePaused=function(){this.setPaused(!this.isPaused())},e.prototype.isSoundOn=function(){return this.data.sound},e.prototype.setSoundOn=function(t){this.data.sound=t,this.sendNotification(o.EVENTS.SOUND_TOGGLE,this.isSoundOn())},e.prototype.toggleSound=function(){this.data.sound=!this.data.sound},e.EVENTS={PAUSE_TOGGLE:"Pause.Toggle.Event",SOUND_TOGGLE:"Sound.Toggle.Event"},o=i([s],e)}(c.default);o.default=u,cc._RF.pop()},{"../Framework/Model/Proxy":"Proxy","../Settings/ProxyTypes":"ProxyTypes"}],AudioConfig:[function(t,e,o){"use strict";cc._RF.push(e,"e014e8SGClCpp83DEzWXaCp","AudioConfig");var n=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,i=r.ccclass,a=r.property,s=function(){function t(){this.name="",this.clip=null}return n([a(cc.String)],t.prototype,"name",void 0),n([a({type:cc.AudioClip})],t.prototype,"clip",void 0),n([i("AudioConfig")],t)}();o.default=s,cc._RF.pop()},{}],AudioControl:[function(t,e,o){"use strict";cc._RF.push(e,"0f0eeCxK1BEnZQ6u4wMxbdA","AudioControl");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Utils/Utils"),s=t("../Model/LocalCache"),c=t("../Facade"),l=t("./AudioConfig"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgms=[],e.effectPoolSize=5,e.sounds=[],e.soundConfigs=[],e._bgmSource=null,e._effectPool=[],e._mute=!1,e._bgmPlaying=!1,e._bgmAudioId=-1,e._bgmLoopCounter=0,e._bgmLoopTarger=0,e._bgmLoopDuration=0,e._bgmClipIds=[],e._bgmClipId=-1,e}var o;return r(e,t),o=e,e.getInstance=function(){return this._inst},e.prototype.onLoad=function(){a.default.isUndefinedOrNull(o._inst)?(cc.game.addPersistRootNode(this.node),o._inst=this):this.destroy()},e.prototype.init=function(){var t;t="true"==s.default.get("Mute"),this.mute(t);var e=new cc.Node("bgm");e.parent=this.node;var o=e.addComponent(cc.AudioSource);this._bgmSource=o,this._bgmSource.loop=!0;for(var n=0;n<this.effectPoolSize;n++){var r=new cc.Node;r.parent=this.node;var i=r.addComponent(cc.AudioSource);i.loop=!1,this._effectPool.push(i)}},e.prototype.isMute=function(){return this._mute},e.prototype.swithMuteState=function(){this.mute(!this.isMute())},e.prototype.mute=function(t){if(this._mute=t,this._bgmSource&&this._bgmSource.clip)if(t){this._bgmSource.isPlaying&&this._bgmSource.stop();for(var e=0;e<this._effectPool.length;e++)this._effectPool[e].isPlaying&&this._effectPool[e].stop()}else this._bgmSource.play();t?(this._bgmAudioId=-1,cc.audioEngine.stopAll()):this._bgmClipIds.length>0&&this.playBgmGroup2(this._bgmClipIds,this._bgmLoopTarger,-1),s.default.put("Mute",t?"true":"false"),c.default.getInstance()&&c.default.getInstance().sendNotification(o.EVENTS.MUTE_STATE_CHANGE,t)},e.prototype.isBgmPlaying=function(){return this._bgmPlaying},e.prototype.playBgm=function(t,e){if(!(this.bgms.length<=0)){t||(t=0),(t<0||t>=this.bgms.length)&&(t=a.default.randomInt(0,this.bgms.length));var o=this.bgms[t];try{this._bgmSource,this._bgmSource.isPlaying&&this._bgmSource.stop(),this._bgmSource.clip=o,e>=0&&(this._bgmSource.volume=e),this._mute||(this._bgmSource.play(),this._bgmSource.loop=!0,this._bgmPlaying=!0)}catch(n){}}},e.prototype.stopBgm=function(){try{this._bgmPlaying=!1,this._bgmSource.isPlaying&&this._bgmSource.stop()}catch(t){}},e.prototype.playSoundById=function(t,e){if(!this._mute&&!(this.sounds.length<=0||t<0||t>=this.sounds.length))try{var o=this._getFreeAudioSource();a.default.isNotUndefinedOrNull(o)&&(o.clip=this.sounds[t],e>=0&&(o.volume=e),o.play())}catch(n){}},e.prototype.playSoundByName=function(t,e){if(void 0===e&&(e=.5),!(this._mute||this.soundConfigs.length<=0)){for(var o,n=0;n<this.soundConfigs.length;n++)this.soundConfigs[n].name.toLowerCase()==t.toLowerCase()&&(o=this.soundConfigs[n].clip);if(!a.default.isUndefinedOrNull(o))try{var r=this._getFreeAudioSource();a.default.isNotUndefinedOrNull(r)&&(r.clip=o,e>=0&&(r.volume=e),r.play())}catch(i){}}},e.prototype._getFreeAudioSource=function(){for(var t=null,e=0;e<this._effectPool.length;e++)if(!this._effectPool[e].isPlaying){t=this._effectPool[e];break}return t},e.prototype.playClick=function(){this.playSoundByName("click")},e.prototype.playCoin=function(){this.playSoundByName("coin")},e.prototype.playDie=function(){this.playSoundByName("die")},e.prototype.stopBgm2=function(){this._bgmAudioId>=0&&(cc.audioEngine.stop(this._bgmAudioId),this._bgmAudioId=-1)},e.prototype.update=function(t){this.isMute()||this._bgmAudioId>=0&&this._bgmLoopDuration>0&&(this._bgmLoopCounter+=t,this._bgmLoopCounter>=this._bgmLoopDuration&&(cc.audioEngine.stop(this._bgmAudioId),this._bgmAudioId=-1,this.playBgmGroup2(this._bgmClipIds,this._bgmLoopTarger,this._bgmClipId)))},e.prototype._playBgm2=function(t,e){this._bgmAudioId>=0&&(cc.audioEngine.stop(this._bgmAudioId),this._bgmAudioId=-1),this._bgmClipId=t;var o=this.bgms[t],n=cc.audioEngine.play(o,e,1);return this._bgmAudioId=n,n},e.prototype.playBgmGroup=function(t,e,o){if(void 0===o&&(o=-1),this._bgmAudioId>=0&&(cc.audioEngine.stop(this._bgmAudioId),this._bgmAudioId=-1),this._bgmClipIds=t,this._bgmLoopTarger=e,this._bgmLoopCounter=0,!this._mute){var n=0;if(t.length>1&&(n=a.default.randomItemInArray(t).value,o>=0))for(;n==o;)n=a.default.randomItemInArray(t).value;var r=e<=0;return this._bgmLoopCounter=0,this._playBgm2(n,r)}},e.prototype.playBgmGroup2=function(t,e,o){if(void 0===o&&(o=-1),this._bgmAudioId>=0&&(cc.audioEngine.stop(this._bgmAudioId),this._bgmAudioId=-1),this._bgmClipIds=t,this._bgmLoopTarger=e,this._bgmLoopCounter=0,!this._mute){var n=0;if(t.length>1&&(n=a.default.randomItemInArray(t).value,o>=0))for(;n==o;)n=a.default.randomItemInArray(t).value;this._bgmLoopCounter=0;var r=this._playBgm2(n,!0),i=cc.audioEngine.getDuration(r);return this._bgmLoopDuration=e>0?i*e:0,r}},e.prototype.playSound2=function(t,e){void 0===e&&(e=!1);var o=this.sounds[t];return o?cc.audioEngine.playEffect(o,e):0},e.EVENTS={MUTE_STATE_CHANGE:"Audio.Mute.Change"},i([d({type:cc.AudioClip})],e.prototype,"bgms",void 0),i([d],e.prototype,"effectPoolSize",void 0),i([d({type:cc.AudioClip})],e.prototype,"sounds",void 0),i([d(l.default)],e.prototype,"soundConfigs",void 0),o=i([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../Facade":"Facade","../Model/LocalCache":"LocalCache","../Utils/Utils":"Utils","./AudioConfig":"AudioConfig"}],AudioTypes:[function(t,e,o){"use strict";var n;cc._RF.push(e,"a2344vCGwlPa5T/g/m4QdlL","AudioTypes"),Object.defineProperty(o,"__esModule",{value:!0}),function(t){t[t.CLICK=0]="CLICK",t[t.COIN=1]="COIN",t[t.DIE=2]="DIE"}(n||(n={})),o.default=n,cc._RF.pop()},{}],BaiduAds:[function(t,e,o){"use strict";cc._RF.push(e,"1aa2c0/WbRPwq2bjCz0DXlM","BaiduAds");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Baidu"),a=i.default.sdk,s=function(){function t(){this._ads={bannerAd:void 0,isBannerLoaded:!1,rewardedVideoAd:void 0,isVideoLoaded:!1},this._bannerInited=!1,this._initTime=0,this._failCounter=0}return t.isValid=function(){return i.default.isValid()},t.prototype.init=function(){var t=this;if(!i.default.isValid())return console.warn("[BaiduAds] not valid"),!1;this._initTime=Date.now();var e=a.createRewardedVideoAd({adUnitId:"6543176",appSid:"eae4163d"});e.onLoad(function(){console.info("[VideoAds] loaded"),t._ads.isVideoLoaded=!0,t._failCounter=0}),e.onError(function(e){console.info("[VideoAds] error: ",e),t._failCounter++,t._failCounter<5&&"3010002"==e.errCode&&(console.info("[VideoAds] 5 \u79d2\u540e\u5c1d\u8bd5\u91cd\u65b0\u52a0\u8f7d"),setTimeout(function(){t.loadVideo()},5e3))}),e.onClose(function(t){console.info("[VideoAds] closed: ",t)}),this._ads.rewardedVideoAd=e,setTimeout(function(){t._initBanner()},1e4)},t.prototype._initBanner=function(){var t=this;if(this._bannerInited)return!1;if(Date.now()-this._initTime<5e3)return console.info("[Baidu.Ads] banner not ready to init"),!1;console.info("[Baidu.Ads] banner initing ===> "),this._bannerInited=!0;var e={adUnitId:"6543174",appSid:"eae4163d",style:{top:i.default.getScreenSize().height-200,left:0,width:i.default.getScreenSize().width}},o=a.createBannerAd(e);return o.onResize(function(t){console.log(" [BannerAds] onResize:",t,o.style)}),o.onLoad(function(){console.info("[BannerAds] \u52a0\u8f7d\u5b8c\u6210: ",o.style),o.style.top=i.default.getScreenSize().height-o.style.height}),o.onLoad(function(){console.info("[BannerAds] loaded"),t._ads.isBannerLoaded=!0}),o.onError(function(t){console.info("[BannerAds] error: ",t)}),this._ads.bannerAd=o,!0},t.prototype._isBannerInited=function(){return this._bannerInited},t.prototype.isBannerReady=function(){return!!this._isBannerInited()&&this._ads.isBannerLoaded},t.prototype.showBanner=function(){return n(this,void 0,void 0,function(){return r(this,function(){return this._isBannerInited()?this._ads.isBannerLoaded?[2,this._ads.bannerAd.show()]:(this._ads.rewardedVideoAd.load(),[2]):[2,!1]})})},t.prototype.hideBanner=function(){if(!this._isBannerInited())return!1;this._ads.bannerAd.hide()},t.prototype.isInterstitialReady=function(){return!1},t.prototype.loadInterstitial=function(){},t.prototype.showInterstitial=function(){},t.prototype.isVideoReady=function(){return this._ads.isVideoLoaded},t.prototype.loadVideo=function(){return n(this,void 0,void 0,function(){return r(this,function(){return[2,this._ads.rewardedVideoAd.load()]})})},t.prototype.showVideo=function(t){return n(this,void 0,void 0,function(){var e=this;return r(this,function(){return[2,new Promise(function(o){if(e._ads.isVideoLoaded){var n=function(r){console.info("[VideoAds] closed: ",r),t&&t(r.isEnded),o(r.isEnded),console.info("[VideoAds] closed done"),e._ads.rewardedVideoAd.offClose(n)};e._ads.isVideoLoaded=!1,e._ads.rewardedVideoAd.onClose(n),e._ads.rewardedVideoAd.show()}else console.info("[VideoAds] not loaded"),o(!1)})]})})},t}();o.default=s,cc._RF.pop()},{"./Baidu":"Baidu"}],Baidu:[function(t,e,o){"use strict";cc._RF.push(e,"9278fQ6ostNdL3gzDDZr7yo","Baidu");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=window.swan,a={isValid:function(){return!!i},sdk:i,systemInfo:void 0,swanId:void 0,init:function(){return n(this,void 0,void 0,function(){return r(this,function(){return console.info("[Baidu] init, checking for update"),a.isValid()?[2,new Promise(function(t){a.sdk.getSystemInfo({success:function(e){console.info("getSystemInfo success",e),a.systemInfo=e,t(!0)},fail:function(e){console.warn("getSystemInfo fail",e),t(!1)}}),a._checkForUpdate()})]:(console.warn("[Baidu] not running in Baidu environment"),[2])})})},getSwanId:function(){return n(this,void 0,void 0,function(){return r(this,function(){return a.swanId?[2,a.swanId]:[2,new Promise(function(t){a.sdk.getSwanId({success:function(e){console.log("[Baidu] swanId:",e.data),a.swanId=e.data.swanid,t(a.swanId)},fail:function(e){console.log("[Baidu] swanId fail:",e),t(void 0)}})})]})})},getScreenSize:function(){return a.systemInfo?cc.size(a.systemInfo.windowWidth,a.systemInfo.windowHeight):cc.size(0,0)},setItem:function(t,e){return n(this,void 0,void 0,function(){return r(this,function(o){switch(o.label){case 0:return[4,a.setStorageAsync(t,e)];case 1:return[2,o.sent()]}})})},getItem:function(t){return n(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,a.getStorageSync(t)];case 1:return[2,e.sent()]}})})},getStorageSync:function(t){return n(this,void 0,void 0,function(){var e,o;return r(this,function(){if(!a.isValid())return[2];e=a.sdk;try{o=e.getStorageSync(t)}catch(n){console.warn("[getStorage] error: ",n)}return[2,o]})})},setStorageAsync:function(t,e){return n(this,void 0,void 0,function(){var o;return r(this,function(){return a.isValid()?(o=a.sdk,[2,new Promise(function(n,r){o.setStorage({key:t,data:e,success:function(){n()},fail:function(e){console.error("[setStorage] error: ",e,", key=",t),r(e)},complete:function(){}})})]):[2]})})},removeStorageSync:function(t){if(a.isValid()){var e=a.sdk;try{e.removeStorageSync(t)}catch(o){console.error("[removeStorage] key",t,", error: ",o)}}},clearStorageSync:function(){if(a.isValid()){var t=a.sdk;try{t.clearStorageSync()}catch(e){console.error("[clearStorage] error: ",e)}}},shareMessage:function(t){return n(this,void 0,void 0,function(){return r(this,function(){return a.isValid()?[2,new Promise(function(e){t.success=function(){console.info("[Baidu.Share] success"),e(!0)},t.fail=function(t){console.warn("[Baidu.Share] fail: ",t),e(!1)};var o=a.sdk;try{o.shareAppMessage(t)}catch(n){console.warn("[Baidu.Share] error: ",n),e(!1)}})]:[2,!1]})})},_newVersion:!1,_checkForUpdate:function(){if(a.isValid()){var t=a.sdk.getUpdateManager();t.onCheckForUpdate(function(t){return console.log("[Baidu] has new version: ",t)}),t.onUpdateReady(function(){a._newVersion=!0,console.info("[Baidu] new version ready")}),t.onUpdateFailed(function(){return console.log("onUpdateFailed")})}},isNewVersionReady:function(){return a._newVersion},tryApplyNewVersion:function(){return n(this,void 0,void 0,function(){return r(this,function(){return a.isValid()&&a.isNewVersionReady()?[2,new Promise(function(t){var e=a.sdk,o=e.getUpdateManager();a._newVersion&&e.showModal({title:"\u6709\u65b0\u7248\u672c",content:"\u65b0\u7248\u672c\u4e0b\u8f7d\u5b8c\u6bd5\uff0c\u51c6\u5907\u66f4\u65b0",showCancel:!1,success:function(){o.applyUpdate(),a._newVersion=!1,t()}})})]:[2,!1]})})},vibrateShort:function(){return!!a.isValid()&&(a.sdk.vibrateShort(),!0)},vibrateLong:function(){return!!a.isValid()&&(a.sdk.vibrateLong(),!0)},login:function(){return n(this,void 0,void 0,function(){var t;return r(this,function(){return a.isValid()?((t=a.sdk).checkSession({success:function(t){console.log("[Baidu] \u767b\u5f55\u6001\u6709\u6548: ",t)},fail:function(){console.log("[Baidu] \u767b\u5f55\u6001\u65e0\u6548\uff0c\u5c1d\u8bd5login"),function e(){t.login({success:function(){},fail:function(){t.showModal({title:"\u767b\u5f55\u5931\u8d25",content:"\u662f\u5426\u91cd\u65b0\u767b\u5f55\uff1f",cancelText:"\u9000\u51fa\u6e38\u620f",success:function(o){o.confirm?(console.log("\u70b9\u51fb\u4e86\u786e\u5b9a"),e()):o.cancel&&(console.log("\u70b9\u51fb\u4e86\u53d6\u6d88"),t.exit())}})}})}()}}),t.getSwanId({success:function(t){console.log("[Baidu] swanId:",t.data)},fail:function(t){console.log("[Baidu] swanId fail:",t)}}),[2]):[2,!1]})})},loadPackage:function(t){return n(this,void 0,void 0,function(){return r(this,function(){return[2,new Promise(function(e){a.sdk.loadSubpackage({name:t,success:function(o){console.log("\u5206\u5305["+t+"]\u4e0b\u8f7d\u6210\u529f :",o),e(!0)},fail:function(o){console.log("\u5206\u5305["+t+"]\u4e0b\u8f7d\u5931\u8d25 :",o),e(!1)}}).onProgressUpdate(function(t){console.log("\u5206\u5305\u4e0b\u8f7d\u8fdb\u5ea6\u767e\u5206\u6bd4",t.progress),console.log("\u5df2\u7ecf\u4e0b\u8f7d\u7684\u6570\u636e\u957f\u5ea6",t.totalBytesWritten),console.log("\u6570\u636e\u603b\u957f\u5ea6",t.totalBytesExpectedToWrite)})})]})})}};o.default=a,cc._RF.pop()},{}],BaseGameScene:[function(t,e,o){"use strict";cc._RF.push(e,"7d107FA1pBEoIxHW4ikoEE5","BaseGameScene");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/Scene/SceneControl"),l=t("../App/AppFacade"),u=t("../Settings/MediatorType"),p=t("../Settings/CommandTypes"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startMatchOnLoad=!1,e}return r(e,t),e.prototype._onStart=function(){return a(this,void 0,void 0,function(){var e,o;return s(this,function(n){switch(n.label){case 0:return t.prototype._onStart.call(this),(e=l.default.getInstance().retrieveMediator(u.default.GAME_UI))&&e.newMatch(),(o=l.default.getInstance().retrieveMediator(u.default.GAME_CONTROL))?[4,o.newMatch()]:[3,2];case 1:n.sent(),n.label=2;case 2:return e&&e.show(!0),this.startMatchOnLoad?[4,l.default.getInstance().executeCommand(p.default.START_MATCH)]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}})})},i([h],e.prototype,"startMatchOnLoad",void 0),i([f],e)}(c.default);o.default=y,cc._RF.pop()},{"../App/AppFacade":"AppFacade","../Framework/Scene/SceneControl":"SceneControl","../Settings/CommandTypes":"CommandTypes","../Settings/MediatorType":"MediatorType"}],BaseGameUIMediator:[function(t,e,o){"use strict";cc._RF.push(e,"bc485ztAd9C5oUlmOq+S2Ry","BaseGameUIMediator");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Framework/View/UIMediator"),s=t("./BaseMatchProxy"),c=t("../Framework/Utils/Utils"),l=t("../App/AppProxy"),u=t("../Settings/ProxyTypes"),p=t("../GamePlay/BasePlayground"),d=t("../Framework/Audio/AudioControl"),f=cc._decorator,h=f.ccclass,y=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._timer=0,e._matchBegin=!1,e._proxy=null,e._gameUI=null,e}return r(e,t),e.prototype._initProxy=function(){t.prototype._initProxy.call(this),c.default.isUndefinedOrNull(this._proxy)&&(this._proxy=this.getFacade().retrieveProxy(u.default.MATCH))},e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),this._gameUI=this.ui},e.prototype.update=function(){this._matchBegin},e.prototype.newMatch=function(){this._matchBegin=!1,this._timer=0,this.onLevelUpdate(this._proxy.getLevel()),this._gameUI.setScore(0),this._gameUI.setGold(0),this._gameUI.showGuide(!1,!1),this._gameUI.hideLevelUpAnimation(),this._gameUI.hideNewRecordAnimation()},e.prototype.waitForMatchStart=function(){this._showGuide(!0)},e.prototype.startMatch=function(){this._matchBegin=!0},e.prototype.endMatch=function(){this._matchBegin=!1},e.prototype.stopMatch=function(){this._matchBegin=!1},e.prototype.continueMatch=function(){this._matchBegin=!0},e.prototype._showGuide=function(t){this._gameUI.showGuide(t,void 0)},e.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.addEvent(p.default.EVENTS.GAME_DID_START),this.addEvent(s.default.EVENTS.LEVEL_UPDATE),this.addEvent(s.default.EVENTS.NEW_RECORD),this.addEvent(s.default.EVENTS.SCORE_UPDATE),this.addEvent(s.default.EVENTS.GOLD_UPDATE),this.addEvent(l.default.EVENTS.PAUSE_TOGGLE),this.addEvent(d.default.EVENTS.MUTE_STATE_CHANGE,this.onMuteChange,this)},e.prototype.handleNotification=function(e){var o=e.getUserData();switch(e.type){case p.default.EVENTS.GAME_DID_START:this.onGameDidStart();break;case s.default.EVENTS.LEVEL_UPDATE:this.onLevelUpdate(o);break;case s.default.EVENTS.SCORE_UPDATE:this.onScoreUpdate(o);break;case s.default.EVENTS.NEW_RECORD:this.onNewRecord(o);break;case s.default.EVENTS.GOLD_UPDATE:this.onGoldUpdate(o);break;case l.default.EVENTS.PAUSE_TOGGLE:this.onPauseStateUpdate(o);break;default:t.prototype.handleNotification.call(this,e)}},e.prototype.onMuteChange=function(t){this.ui.onMuteChange(t)},e.prototype.onGameDidStart=function(){this._showGuide(!1),this._matchBegin=!0},e.prototype.onDollDie=function(){this.endMatch()},e.prototype.onDollRevive=function(){this.onGameDidStart()},e.prototype.onLevelUpdate=function(){this._gameUI.playLevelUpAnimation()},e.prototype.onNewRecord=function(t){this._gameUI.playNewRecordAnimation(t)},e.prototype.onPauseStateUpdate=function(t){this._gameUI.setPauseState(t)},e.prototype.onGoldUpdate=function(t){this._gameUI.setGold(t)},e.prototype.onScoreUpdate=function(t){this._gameUI.setScore(t)},i([h],e)}(a.default));o.default=y,cc._RF.pop()},{"../App/AppProxy":"AppProxy","../Framework/Audio/AudioControl":"AudioControl","../Framework/Utils/Utils":"Utils","../Framework/View/UIMediator":"UIMediator","../GamePlay/BasePlayground":"BasePlayground","../Settings/ProxyTypes":"ProxyTypes","./BaseMatchProxy":"BaseMatchProxy"}],BaseGameUI:[function(t,e,o){"use strict";cc._RF.push(e,"e598cpryM5NU6gngTgbuNDn","BaseGameUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Framework/View/BaseUI"),s=t("../App/AppFacade"),c=t("../Settings/ProxyTypes"),l=t("../Framework/Utils/Utils"),u=t("../Framework/Extension/ToggleButton"),p=t("../Framework/Audio/AudioControl"),d=t("../Framework/Utils/UIHelper"),f=cc._decorator,h=f.ccclass,y=f.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scoreLabel=null,e.goldLabel=null,e.guideNode=null,e.shortGuide=null,e.btnPause=null,e.btnSound=null,e.levelupAnimation=null,e.newRecordAnimation=null,e.newRecordParticles=null,e.newRecordSprites=[],e}return r(e,t),e.prototype.initOnce=function(){var t=this,e=s.default.getInstance().retrieveProxy(c.default.APP);l.default.isNotUndefinedOrNull(this.btnPause)&&(this.btnPause.setOn(e.isPaused()),this.btnPause.startWithOn=e.isPaused(),this.btnPause.node.on("click",this.onPause,this)),l.default.isNotUndefinedOrNull(this.levelupAnimation)&&(this.levelupAnimation.on(cc.Animation.EventType.FINISHED,function(){t.levelupAnimation.node.active=!1}),this.levelupAnimation.node.active=!1),this.newRecordParticles&&(this.newRecordParticles.stopSystem(),this.newRecordParticles.node.active=!1),d.default.bindClickEvent(this.btnSound,this.onSound.bind(this)),this.btnSound&&(this.btnSound.startWithOn=!p.default.getInstance().isMute())},e.prototype.onSound=function(){var t=p.default.getInstance().isMute();p.default.getInstance().mute(!t)},e.prototype.onMuteChange=function(t){this.btnSound.setOn(!t)},e.prototype.onPause=function(){var t=s.default.getInstance().retrieveProxy(c.default.APP);l.default.isNotUndefinedOrNull(t)&&(t.togglePaused(),this.btnPause.setOn(t.isPaused()))},e.prototype.setScore=function(t){this.scoreLabel&&(this.scoreLabel.string=t)},e.prototype.setGold=function(t){this.goldLabel&&(this.goldLabel.string=t)},e.prototype.showGuide=function(t,e){this.guideNode&&(this.guideNode.active=t),this.shortGuide&&(this.shortGuide.active=e)},e.prototype.setPauseState=function(t){this.btnPause&&this.btnPause.setOn(t)},e.prototype.updatePauseState=function(){var t=s.default.getInstance().retrieveProxy(c.default.APP);this.btnPause&&this.btnPause.setOn(t.isPaused())},e.prototype.hideLevelUpAnimation=function(){this.levelupAnimation&&(this.levelupAnimation.node.active=!1)},e.prototype.playLevelUpAnimation=function(){this.levelupAnimation&&(this.levelupAnimation.stop(),this.levelupAnimation.node.active=!0,this.levelupAnimation.play())},e.prototype.hideNewRecordAnimation=function(){this.newRecordAnimation&&(this.newRecordAnimation.node.active=!1),this.newRecordParticles&&this.newRecordParticles.stopSystem()},e.prototype.playNewRecordAnimation=function(t){this.newRecordAnimation&&(this.newRecordAnimation.node.active=!0,this.newRecordAnimation.getComponent(cc.Sprite).spriteFrame=this.newRecordSprites[t-1],this.newRecordAnimation.play()),this.newRecordParticles&&(this.newRecordParticles.node.active=!0,this.newRecordParticles.resetSystem())},i([y(cc.Label)],e.prototype,"scoreLabel",void 0),i([y(cc.Label)],e.prototype,"goldLabel",void 0),i([y(cc.Node)],e.prototype,"guideNode",void 0),i([y(cc.Node)],e.prototype,"shortGuide",void 0),i([y(u.default)],e.prototype,"btnPause",void 0),i([y(u.default)],e.prototype,"btnSound",void 0),i([y(cc.Animation)],e.prototype,"levelupAnimation",void 0),i([y(cc.Animation)],e.prototype,"newRecordAnimation",void 0),i([y(cc.ParticleSystem)],e.prototype,"newRecordParticles",void 0),i([y(cc.SpriteFrame)],e.prototype,"newRecordSprites",void 0),i([h],e)}(a.default);o.default=_,cc._RF.pop()},{"../App/AppFacade":"AppFacade","../Framework/Audio/AudioControl":"AudioControl","../Framework/Extension/ToggleButton":"ToggleButton","../Framework/Utils/UIHelper":"UIHelper","../Framework/Utils/Utils":"Utils","../Framework/View/BaseUI":"BaseUI","../Settings/ProxyTypes":"ProxyTypes"}],BaseHUD:[function(t,e,o){"use strict";cc._RF.push(e,"26a7axFQLNEYJzdnG3MQs1a","BaseHUD");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Framework/View/BaseUI"),s=t("../Framework/Extension/ToggleButton"),c=t("../Settings/ProxyTypes"),l=t("../Commands/AppCommands"),u=t("../Framework/Audio/AudioControl"),p=t("../App/AppFacade"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtMoney=null,e.adNode=null,e.btnSound=null,e.historyScore=null,e}return r(e,t),e.prototype.initOnce=function(){this.adNode.on("click",this.onAdsClick,this),this.btnSound.node.on("click",this.onSound,this)},e.prototype.showAds=function(t){this.adNode.active=t},e.prototype.updateMoney=function(t){this.txtMoney.string=t.toString()},e.prototype.updateHistory=function(t){this.historyScore.string=t.toFixed(2).toString()},e.prototype.onAdsClick=function(){p.default.getInstance().retrieveProxy(c.default.ADS).isFreeGoldAdsReady()&&p.default.getInstance().executeCommand(l.default.COMMANDS.SHOW_ADS_FOR_FREE_GOLD)},e.prototype.onSound=function(){var t=u.default.getInstance().isMute();u.default.getInstance().mute(!t)},e.prototype.onMuteChange=function(t){this.btnSound.setOn(!t)},i([h(cc.Label)],e.prototype,"txtMoney",void 0),i([h(cc.Node)],e.prototype,"adNode",void 0),i([h(s.default)],e.prototype,"btnSound",void 0),i([h(cc.Label)],e.prototype,"historyScore",void 0),i([f],e)}(a.default);o.default=y,cc._RF.pop()},{"../App/AppFacade":"AppFacade","../Commands/AppCommands":"AppCommands","../Framework/Audio/AudioControl":"AudioControl","../Framework/Extension/ToggleButton":"ToggleButton","../Framework/View/BaseUI":"BaseUI","../Settings/ProxyTypes":"ProxyTypes"}],BaseHomeUI:[function(t,e,o){"use strict";cc._RF.push(e,"88f4adi6ZxIDZcIPRu6nKhI","BaseHomeUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Framework/View/BaseUI"),s=t("../Settings/CommandTypes"),c=t("../App/AppFacade"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playButton=null,e.versionLabel=null,e}return r(e,t),e.prototype.start=function(){this.playButton.node.on("click",function(){c.default.getInstance().executeCommand(s.default.PLAY_NEW_MATCH)},this)},i([p(cc.Button)],e.prototype,"playButton",void 0),i([p(cc.Label)],e.prototype,"versionLabel",void 0),i([u],e)}(a.default);o.default=d,cc._RF.pop()},{"../App/AppFacade":"AppFacade","../Framework/View/BaseUI":"BaseUI","../Settings/CommandTypes":"CommandTypes"}],BaseHudMediator:[function(t,e,o){"use strict";cc._RF.push(e,"52563hssHBCBLVQVI2D8+pF","BaseHudMediator");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Framework/View/UIMediator"),s=t("../Account/InventoryProxy"),c=t("../Ads/AdsProxy"),l=t("../Framework/Audio/AudioControl"),u=t("../Settings/ProxyTypes"),p=t("../Settings/MediatorType"),d=t("../Settings/EventTypes"),f=t("../GamePlay/BasePlayground"),h=t("../Settings/AdsSettings"),y=cc._decorator,_=y.ccclass,v=(y.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.initOnce=function(){t.prototype.initOnce.call(this),this.showAdsNode(!1)},e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),l.default.getInstance()&&this.onMuteChange(l.default.getInstance().isMute())},e.prototype.initEvents=function(){this.addEvent(f.default.EVENTS.GAME_DID_START),this.addEvent(d.default.SHOP.NOT_ENOUGH_MONEY_FOR_ITEM),this.addEvent(s.default.EVENTS.MONEY_UPDATE),this.addEvent(c.default.EVENTS.ADS_PLAY_DONE),this.addEvent(l.default.EVENTS.MUTE_STATE_CHANGE)},e.prototype.handleNotification=function(t){var e=t.getUserData();switch(t.type){case f.default.EVENTS.GAME_DID_START:this.onMatchStart();break;case d.default.SHOP.NOT_ENOUGH_MONEY_FOR_ITEM:this.showAdsMsg();break;case s.default.EVENTS.MONEY_UPDATE:this.onMoneyUpdate();break;case c.default.EVENTS.ADS_PLAY_DONE:this.onAdsPlayDone();break;case l.default.EVENTS.MUTE_STATE_CHANGE:this.onMuteChange(e)}},e.prototype.showAdsNode=function(t){t&&(this.getFacade().retrieveProxy(u.default.ADS).isFreeGoldAdsReady()||(t=!1)),this.ui.showAds(t)},e.prototype.showAdsMsg=function(){var t=this.getFacade().retrieveProxy(u.default.ADS);if(t.isFreeGoldAdsReady()){var e=this.getFacade().retrieveMediator(p.default.ADS),o=t.getData().freeGoldValue;e.showAds(h.ADS_KEY.FREE_GOLD,{title2:"FREE GOLD",value:o})}},e.prototype.onMoneyUpdate=function(){var t=this.getFacade().retrieveProxy(u.default.INVENTORY);this.ui.updateMoney(t.getMoney())},e.prototype.onHistoryUpdate=function(){var t=this.getFacade().retrieveProxy(u.default.PLAYER);this.ui.updateHistory(t.getHistoryScore().history.value)},e.prototype.onAdsUpdate=function(){},e.prototype.onAdsPlayDone=function(){this.showAdsNode(!1)},e.prototype.onNewMatch=function(){var t=!1,e=this.getFacade().retrieveProxy(u.default.ADS);e.isFreeGoldAdsReady()?(t=!0,e.calculateFreeGold()):t=!1,this.showAdsNode(t)},e.prototype.onMatchStart=function(){this.showAdsNode(!1)},e.prototype._updateData=function(){this.onMoneyUpdate(),this.onAdsUpdate(),this.onHistoryUpdate()},e.prototype.onMuteChange=function(t){this.ui.onMuteChange(t)},i([_],e)}(a.default));o.default=v,cc._RF.pop()},{"../Account/InventoryProxy":"InventoryProxy","../Ads/AdsProxy":"AdsProxy","../Framework/Audio/AudioControl":"AudioControl","../Framework/View/UIMediator":"UIMediator","../GamePlay/BasePlayground":"BasePlayground","../Settings/AdsSettings":"AdsSettings","../Settings/EventTypes":"EventTypes","../Settings/MediatorType":"MediatorType","../Settings/ProxyTypes":"ProxyTypes"}],BaseMatchData:[function(t,e){"use strict";cc._RF.push(e,"dc1d0jkImxCdKKRDlVJLl1t","BaseMatchData"),cc._RF.pop()},{}],BaseMatchMediator:[function(t,e,o){"use strict";cc._RF.push(e,"6ff25LhvUtBRouH/k2BLlbx","BaseMatchMediator");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/View/MediatorComp"),l=t("./BaseMatchProxy"),u=t("../Framework/Utils/Utils"),p=t("../Settings/ProxyTypes"),d=t("./BasePlayground"),f=cc._decorator,h=f.ccclass,y=f.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playground=null,e._proxy=null,e._matchBegin=!1,e}return r(e,t),e.prototype._initProxy=function(){u.default.isUndefinedOrNull(this._proxy)&&(this._proxy=this.getFacade().retrieveProxy(p.default.MATCH))},e.prototype._updateData=function(){},e.prototype.isMatchBegin=function(){return this._matchBegin},e.prototype.newMatch=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return this._matchBegin=!1,t=this._proxy.getLevel(),[4,this.playground.newMatch(t)];case 1:return e.sent(),[2]}})})},e.prototype.startMatch=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this._matchBegin=!0,[4,this.playground.startMatch()];case 1:return t.sent(),[2]}})})},e.prototype.endMatch=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this._matchBegin=!1,[4,this.playground.endMatch()];case 1:return t.sent(),[2]}})})},e.prototype.stopMatch=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return this._matchBegin=!1,this.playground.stopMatch(t),this._proxy.stopMatch(t),[2]})})},e.prototype.continueMatch=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this._matchBegin=!0,this.playground.continueMatch(),[2]})})},e.prototype.revive=function(){this.continueMatch()},e.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.addEvent(l.default.EVENTS.LEVEL_UPDATE)},e.prototype.handleNotification=function(e){var o=e.getUserData();switch(e.type){case l.default.EVENTS.LEVEL_UPDATE:this.onLevelUpdate(o);break;default:t.prototype.handleNotification.call(this,e)}},e.prototype.onLevelUpdate=function(t){this.playground.onLevelUpdate(t)},i([y(d.default)],e.prototype,"playground",void 0),i([h],e)}(c.default);o.default=_,cc._RF.pop()},{"../Framework/Utils/Utils":"Utils","../Framework/View/MediatorComp":"MediatorComp","../Settings/ProxyTypes":"ProxyTypes","./BaseMatchProxy":"BaseMatchProxy","./BasePlayground":"BasePlayground"}],BaseMatchProxy:[function(t,e,o){"use strict";cc._RF.push(e,"de1a7gxMrJLWI8CQbRuM0dO","BaseMatchProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.RECORDTYPE=void 0;var c,l=cc._decorator,u=l.ccclass,p=(l.property,t("../Framework/Model/Proxy")),d=t("../Settings/ProxyTypes"),f=t("../Framework/Utils/Utils"),h=t("../App/Logger"),y=t("../Settings/Builds");(function(t){t[t.NONE=0]="NONE",t[t.DAILY=1]="DAILY",t[t.ALLTIME=2]="ALLTIME",t[t.WEEKLY=3]="WEEKLY",t[t.MAX=3]="MAX"})(c=o.RECORDTYPE||(o.RECORDTYPE={}));var _={SCORE_UPDATE:"Score.Update.Event",GOLD_UPDATE:"Gold.Update.Event",LEVEL_UPDATE:"Level.Update.Event",NEW_RECORD:"New.Record.Event"},v=function(t){function e(){var e=t.call(this)||this;return e._finalMoney=0,e}var o;return r(e,t),o=e,e.create=function(t){var e=new o;return e.name=t,e},e.prototype.newMatch=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this._initMatchData(t)];case 1:return e.sent(),this._loadMatchRecord(t),this._initExtraData(t),[2]}})})},e.prototype._initMatchData=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.data={score:0,gold:0,timer:0,level:0,ads:0,oldRecord:{history:{value:0,time:0},daily:{value:0,time:0}},isNewRecord:0,win:!1},[2]})})},e.prototype._loadMatchRecord=function(){var t=this.getFacade().retrieveProxy(d.default.PLAYER);if(console.assert(f.default.isNotUndefinedOrNull(t)),f.default.isNotUndefinedOrNull(t)){var e=t.getHistoryScore();this.data.oldRecord.history.value=e.history.value,this.data.oldRecord.history.time=e.history.time,this.data.oldRecord.daily.value=e.daily.value,this.data.oldRecord.daily.time=e.daily.time}},e.prototype._initExtraData=function(){this._finalMoney=0},e.prototype.stopMatch=function(t){this.data.win=t},e.prototype.endMatch=function(){if(this._calculateFinalMoney(),this.data.score>0){var t=100*Math.floor(this.data.score/100);h.default.logMatchScore(t)}},e.prototype._calculateFinalMoney=function(){this._finalMoney=20,this._finalMoney+=Math.ceil(10*this.getTimer())+this.data.gold},e.prototype.getFinalMoney=function(){return this._finalMoney},e.prototype.getMatchData=function(){return this.data},e.prototype.getScore=function(){return this.data.score},e.prototype.setScore=function(t){return!(t<this.data.score||(this.data.score=t,this.sendNotification(_.SCORE_UPDATE,this.data.score),this._compareHistoryScore(t),0))},e.prototype.addScore=function(t){this.setScore(this.getScore()+t)},e.prototype._compareHistoryScore=function(t){var e=this.data.oldRecord.history,o=this.data.oldRecord.daily,n=0;return t>9&&(t>e.value&&this.data.isNewRecord<=c.ALLTIME?(this.data.isNewRecord=c.ALLTIME,n=c.ALLTIME):t>o.value&&this.data.isNewRecord<=c.DAILY&&(this.data.isNewRecord=c.DAILY,n=c.DAILY),n>0&&this.sendNotification(_.NEW_RECORD,n)),n},e.prototype.setTimer=function(t){this.data.timer=t},e.prototype.getTimer=function(){return this.data.timer},e.prototype.getGold=function(){return this.data.gold},e.prototype.setGold=function(t){this.data.gold=t,this.sendNotification(_.GOLD_UPDATE,t)},e.prototype.addGold=function(t){this.setGold(this.data.gold+t)},e.prototype.setLevel=function(t){this.data.level=t,this.sendNotification(_.LEVEL_UPDATE,t)},e.prototype.getLevel=function(){return this.data.level},e.prototype.getLevelGold=function(){var t=this.data.level+1;return f.default.randomInt(1,t+1)},e.prototype.setNewRecord=function(t){this.data.newRecord=t},e.prototype.getNewRecord=function(){return this.data.newRecord},e.prototype.canReviveByAds=function(){return!!y.default.ENABLE_ADS&&!!this.getFacade().retrieveProxy(d.default.ADS).isReviveAdsReady()},e.prototype.reviveByAds=function(){this.data.ads++},e.EVENTS=_,o=i([u],e)}(p.default);o.default=v,cc._RF.pop()},{"../App/Logger":"Logger","../Framework/Model/Proxy":"Proxy","../Framework/Utils/Utils":"Utils","../Settings/Builds":"Builds","../Settings/ProxyTypes":"ProxyTypes"}],BasePlayerProxy:[function(t,e,o){"use strict";cc._RF.push(e,"1be60/bt85BPp/7pFF/c5Al","BasePlayerProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/Model/Proxy"),l=t("../Account/AccountProxy"),u=t("../Framework/Utils/Utils"),p=t("../Settings/ProxyTypes"),d=t("../App/Logger"),f=cc._decorator,h=f.ccclass,y=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isDirty=!1,e}var o;return r(e,t),o=e,e.create=function(t){var e=new o;return e.name=t,e.init(),e},e.prototype.init=function(){this.updateFromData(void 0)},e.prototype.onFirstStart=function(){this.updateFromData(void 0)},e.prototype.updateFromData=function(t){u.default.isUndefinedOrNull(t)&&(t={openId:"0",name:"",photoUrl:"",account:l.ACCOUNT.LOCAL,gamesPlayed:0,daysPlayed:0,historyScore:{value:0,time:0},dailyScore:{value:0,time:0},levelPassed:-1}),this._playerData=t,u.default.isUndefinedOrNull(this._playerData.daysPlayed)&&(this._playerData.daysPlayed=0),u.default.isUndefinedOrNull(this._playerData.gamesPlayed)&&(this._playerData.gamesPlayed=0),u.default.isUndefinedOrNull(this._playerData.historyScore)&&(this._playerData.historyScore={value:0,time:0}),u.default.isUndefinedOrNull(this._playerData.levelPassed)&&(this._playerData.levelPassed=-1),this.data=this._playerData,this._isDirty=!0},e.prototype.setOpenId=function(t){this._playerData.openId=t,this._isDirty=!0},e.prototype.getOpenId=function(){return this._playerData.openId},e.prototype.setPlayerName=function(t){this._playerData.name=t,this._isDirty=!0},e.prototype.getPlayerName=function(){return this._playerData.name},e.prototype.getPlayerPhoto=function(){return this._playerData.photoUrl},e.prototype.setPlayerPhoto=function(t){this._playerData.photoUrl=t,this._isDirty=!0},e.prototype.getAccount=function(){return this._playerData.account},e.prototype.setAccount=function(t){this._playerData.account=t,this._isDirty=!0},e.prototype.addDaysPlayed=function(t){this._playerData.daysPlayed+=t,this._playerData.dailyScore={value:0,time:Date.now()},this._isDirty=!0,d.default.logDaysPlayed(this.getDaysPlayed())},e.prototype.setReturnDays=function(t){var e=u.default.calculateDaysToNow(t,!0);this._playerData.daysReturn=e,d.default.logDaysReturn(e)},e.prototype.getDaysPlayed=function(){return this._playerData.daysPlayed},e.prototype.addGamesPlayed=function(t){this._playerData.gamesPlayed+=t,this._isDirty=!0;var e=this._playerData.gamesPlayed;switch(e){case 1:case 5:case 10:case 20:case 50:case 100:case 200:case 300:d.default.logMatchPlayed(e)}},e.prototype.getGamesPlayed=function(){return this._playerData.gamesPlayed},e.prototype.checkHistoryScore=function(t){var e=!1,o=Date.now();return this._playerData.historyScore.value<t&&(this._playerData.historyScore.value=t,this._playerData.historyScore.time=o,e=!0),this._playerData.dailyScore.value<t&&(this._playerData.dailyScore.value=t,this._playerData.dailyScore.time=o,e=!0),this._isDirty=e,e},e.prototype.getHistoryScore=function(){return{history:this._playerData.historyScore,daily:this._playerData.dailyScore}},e.prototype.isPropSelected=function(){return!1},e.prototype.useProp=function(){},e.prototype.setLevelPassed=function(t){this.data.levelPassed<t&&(this.data.levelPassed=t,this._isDirty=!0)},e.prototype.getLevelPassed=function(){return this.data.levelPassed},e.prototype.isDirty=function(){return this._isDirty},e.prototype.save=function(){return a(this,void 0,void 0,function(){var t,e,n;return s(this,function(r){switch(r.label){case 0:return this.isDirty()?(t=this.getFacade().retrieveProxy(p.default.ACCOUNT),(e={})[o.KEY]=this.data,[4,t.saveDataAsync(e)]):[2];case 1:return n=r.sent(),this._isDirty=!1,[2,n]}})})},e.KEY="player",e.EVENTS={},o=i([h],e)}(c.default));o.default=y,cc._RF.pop()},{"../Account/AccountProxy":"AccountProxy","../App/Logger":"Logger","../Framework/Model/Proxy":"Proxy","../Framework/Utils/Utils":"Utils","../Settings/ProxyTypes":"ProxyTypes"}],BasePlayground:[function(t,e,o){"use strict";cc._RF.push(e,"628c4vN039GuoH/+4Kf0mzr","BasePlayground");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Framework/GamePlay/InputControl"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.input=null,e._matchBegin=!1,e}return r(e,t),e.prototype.onLoad=function(){this.input&&this.input.setHandler(this.onTouchBegin.bind(this),this.onTouchMove.bind(this),this.onTouchEnd.bind(this),this.onTouchCancel.bind(this))},e.prototype.newMatch=function(){this._matchBegin=!1},e.prototype.startMatch=function(){this._matchBegin=!0},e.prototype.stopMatch=function(){this._matchBegin=!1},e.prototype.continueMatch=function(){this._matchBegin=!0},e.prototype.endMatch=function(){this._matchBegin=!1},e.prototype.onLevelUpdate=function(){},e.EVENTS={GAME_DID_START:"Game.Did.Start"},i([l(a.default)],e.prototype,"input",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../Framework/GamePlay/InputControl":"InputControl"}],BaseResultMediator:[function(t,e,o){"use strict";cc._RF.push(e,"7de01LTgHxIpawHGLf8WRHh","BaseResultMediator");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/View/UIMediator"),l=t("../Framework/Utils/Utils"),u=t("../Settings/ProxyTypes"),p=t("../Share/PopUI"),d=t("../App/Logger"),f=cc._decorator,h=f.ccclass,y=f.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._proxy=null,e.popUIPrefab=null,e}return r(e,t),e.prototype._initProxy=function(){t.prototype._initProxy.call(this),l.default.isUndefinedOrNull(this._proxy)&&(this._proxy=this.getFacade().retrieveProxy(u.default.MATCH))},e.prototype._updateData=function(){l.default.isNotUndefinedOrNull(this._proxy.data)&&(this.updateMatchScore(),this.updateFinalMoney(this._proxy.getFinalMoney()))},e.prototype.updateMatchScore=function(){this.ui.updateMatchScore(this._proxy.data)},e.prototype.updateFinalMoney=function(t){this.ui.setMoney(t)},e.prototype.show=function(e){return a(this,void 0,void 0,function(){var o;return s(this,function(n){switch(n.label){case 0:return this.ui.beforeShow(),this._updateData(),[4,t.prototype.show.call(this,e)];case 1:return n.sent(),[4,this.ui.afterShow()];case 2:return n.sent(),(o=this.getFacade().retrieveProxy(u.default.ADS)).isRandomAdsReady()?this.popUIPrefab?[4,p.default.Show(this.popUIPrefab,this.ui.node.parent,"Sorry\n\nWe have to show a short Ads after you click OK",{yesText:"OK",hideCancel:!0})]:[3,4]:[3,6];case 3:n.sent(),n.label=4;case 4:return[4,o.playRandomAds()];case 5:return n.sent(),d.default.logAdsForRandom(),[3,7];case 6:o.increaseFreeMatch(),n.label=7;case 7:return o.isExtraGoldAdsReady()?[4,l.default.waitFor(200)]:[3,9];case 8:return n.sent(),this.ui.showAdsNode(!0),[3,10];case 9:this.ui.showAdsNode(!1),n.label=10;case 10:return[2]}})})},i([y(cc.Prefab)],e.prototype,"popUIPrefab",void 0),i([h],e)}(c.default);o.default=_,cc._RF.pop()},{"../App/Logger":"Logger","../Framework/Utils/Utils":"Utils","../Framework/View/UIMediator":"UIMediator","../Settings/ProxyTypes":"ProxyTypes","../Share/PopUI":"PopUI"}],BaseResultUI:[function(t,e,o){"use strict";cc._RF.push(e,"62f4cJQEtBBAYzwCKp+Vric","BaseResultUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/View/BaseUI"),l=t("../Framework/Utils/Utils"),u=t("../Framework/Utils/UIHelper"),p=t("../Settings/CommandTypes"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scoreLabel=null,e.highScoreLabel=null,e.replayButton=null,e.goHomeButton=null,e.newRecordMark=null,e.shareNode=null,e.screenShot=null,e.txtRewards=null,e.contentNode=null,e.newRecordAnimation=null,e.newRecordParticles=null,e.newRecordSprites=[],e.adsNode=null,e.btnRank=null,e._score=null,e}return r(e,t),e.prototype.initOnce=function(){t.prototype.initOnce.call(this),u.default.bindClickEvent(this.replayButton,p.default.PLAY_NEW_MATCH,!0),u.default.bindClickEvent(this.goHomeButton,p.default.GO_HOME_SCENE,!0),u.default.bindClickEvent(this.shareNode,this.onShare.bind(this),!0),u.default.bindClickEvent(this.adsNode,p.default.SHOW_ADS_FOR_EXTRA_GOLD,!0),u.default.bindClickEvent(this.btnRank,p.default.SHOW_RANK,!0,{world:!1}),this.txtRewards&&(this.txtRewards.string="0"),this.newRecordAnimation&&(this.newRecordAnimation.node.active=!1),this.newRecordParticles&&(this.newRecordParticles.node.active=!1)},e.prototype.beforeShow=function(){this.newRecordAnimation&&(this.newRecordAnimation.node.active=!1),this.newRecordParticles&&this.newRecordParticles.resetSystem()},e.prototype.afterShow=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return l.default.isNotUndefinedOrNull(this._score)&&this._score.isNewRecord>0?[4,l.default.waitFor(200)]:[3,2];case 1:t.sent(),this.playNewRecordAnimation(this._score.isNewRecord),t.label=2;case 2:return[2]}})})},e.prototype.showAdsNode=function(t){this.adsNode&&(this.adsNode.active=t)},e.prototype.updateMatchScore=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return this.newRecordAnimation&&(this.newRecordAnimation.node.active=!1),l.default.isNotUndefinedOrNull(t)&&(this.newRecordMark&&(this.newRecordMark.active=!1),this.setHighScore(t.oldRecord.history.value),this._score=t,this.setScore(t.score)),[2]})})},e.prototype.setHighScore=function(t){this.highScoreLabel&&(this.highScoreLabel.string=t.toString())},e.prototype.setScore=function(t){this.scoreLabel&&(this.scoreLabel.string=t.toString())},e.prototype.setMoney=function(t){this.txtRewards&&(this.txtRewards.string=t.toString())},e.prototype.showScreenShot=function(t,e){t&&e?(this.contentNode.y=-264,this.shareNode.active=!0,this.screenShot.spriteFrame=e,this.screenShot.node.height=this.screenShot.node.width/e.getTexture().width*e.getTexture().height,this.screenShot.node.scale=1.5):(this.shareNode.active=!1,this.contentNode.y=0)},e.prototype.playNewRecordAnimation=function(t){this.newRecordAnimation?(this.newRecordAnimation.node.active=!0,this.newRecordAnimation.getComponent(cc.Sprite).spriteFrame=this.newRecordSprites[t-1],this.newRecordAnimation.play()):this.newRecordMark&&(this.newRecordMark.active=!0),this.newRecordParticles&&(this.newRecordParticles.node.active=!0,this.newRecordParticles.resetSystem())},e.prototype.onShare=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},i([h(cc.Label)],e.prototype,"scoreLabel",void 0),i([h(cc.Label)],e.prototype,"highScoreLabel",void 0),i([h(cc.Button)],e.prototype,"replayButton",void 0),i([h(cc.Button)],e.prototype,"goHomeButton",void 0),i([h(cc.Node)],e.prototype,"newRecordMark",void 0),i([h(cc.Node)],e.prototype,"shareNode",void 0),i([h(cc.Sprite)],e.prototype,"screenShot",void 0),i([h(cc.Label)],e.prototype,"txtRewards",void 0),i([h(cc.Node)],e.prototype,"contentNode",void 0),i([h(cc.Animation)],e.prototype,"newRecordAnimation",void 0),i([h(cc.ParticleSystem)],e.prototype,"newRecordParticles",void 0),i([h(cc.SpriteFrame)],e.prototype,"newRecordSprites",void 0),i([h(cc.Node)],e.prototype,"adsNode",void 0),i([h(cc.Button)],e.prototype,"btnRank",void 0),i([f],e)}(c.default);o.default=y,cc._RF.pop()},{"../Framework/Utils/UIHelper":"UIHelper","../Framework/Utils/Utils":"Utils","../Framework/View/BaseUI":"BaseUI","../Settings/CommandTypes":"CommandTypes"}],BaseReviveMediator:[function(t,e,o){"use strict";cc._RF.push(e,"37bc4UllyNCY6s/fcy9mqwG","BaseReviveMediator");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/View/UIMediator"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.show=function(e){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return this._updateData(),[4,t.prototype.show.call(this,e)];case 1:return o.sent(),[2]}})})},i([u],e)}(c.default));o.default=p,cc._RF.pop()},{"../Framework/View/UIMediator":"UIMediator"}],BaseReviveUI:[function(t,e,o){"use strict";cc._RF.push(e,"7d8d9VlUglKHZVl0m+7MrIw","BaseReviveUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/View/BaseUI"),l=t("../App/AppFacade"),u=t("../Commands/AppCommands"),p=t("../Settings/ProxyTypes"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enableCountdown=!1,e.btnAds=null,e.btnSkip=null,e.txtCountdown=null,e._countdownEffect=null,e._txtEffect=null,e}return r(e,t),e.prototype.initOnce=function(){this._initEffect(),this.btnAds&&this.btnAds.node.on("click",this.onAds,this),this.btnSkip&&this.btnSkip.node.on("click",this.onSkip,this)},e.prototype._initEffect=function(){var t=this;if(this.enableCountdown&&this.txtCountdown&&!this._countdownEffect){var e=cc.scaleTo(.25,1.5);e.easing(cc.easeBackOut()),this._txtEffect=cc.repeatForever(cc.sequence(e,cc.scaleTo(.75,1))),this._txtEffect.setTag(101);for(var o=[],n=function(e){o.push(cc.callFunc(function(){t.txtCountdown.string=e.toString()})),o.push(cc.delayTime(1))},r=9;r>=0;r--)n(r);o.push(cc.callFunc(function(){l.default.getInstance().executeCommand(u.default.COMMANDS.SKIP_ADS_FOR_REVIVE)})),this._countdownEffect=cc.sequence(o),this._countdownEffect.setTag(100)}},e.prototype.onAds=function(){l.default.getInstance().retrieveProxy(p.default.ADS).isReviveAdsReady()?l.default.getInstance().executeCommand(u.default.COMMANDS.ADS_FOR_REVIVE):l.default.getInstance().executeCommand(u.default.COMMANDS.SKIP_ADS_FOR_REVIVE)},e.prototype.onSkip=function(){l.default.getInstance().executeCommand(u.default.COMMANDS.SKIP_ADS_FOR_REVIVE)},e.prototype.show=function(e){return a(this,void 0,void 0,function(){var o;return s(this,function(n){switch(n.label){case 0:return this._initEffect(),[4,t.prototype.show.call(this,e)];case 1:return o=n.sent(),this.enableCountdown&&this.txtCountdown&&(this.node.runAction(this._countdownEffect),this.txtCountdown.node.runAction(this._txtEffect)),[2,o]}})})},e.prototype.hide=function(e){return a(this,void 0,void 0,function(){return s(this,function(){return this._initEffect(),this.enableCountdown&&this.txtCountdown&&(this.txtCountdown.node.stopActionByTag(101),this.node.stopActionByTag(100)),[2,t.prototype.hide.call(this,e)]})})},i([h],e.prototype,"enableCountdown",void 0),i([h(cc.Button)],e.prototype,"btnAds",void 0),i([h(cc.Button)],e.prototype,"btnSkip",void 0),i([h(cc.Label)],e.prototype,"txtCountdown",void 0),i([f],e)}(c.default);o.default=y,cc._RF.pop()},{"../App/AppFacade":"AppFacade","../Commands/AppCommands":"AppCommands","../Framework/View/BaseUI":"BaseUI","../Settings/ProxyTypes":"ProxyTypes"}],BaseScoreData:[function(t,e,o){"use strict";cc._RF.push(e,"902b3eSAPdD1qKwEnopDCPO","BaseScoreData"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],BaseSplashScene:[function(t,e,o){"use strict";cc._RF.push(e,"bb3c3Vh1Q5NHZK74s0NmOCI","BaseSplashScene");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/Scene/SceneControl"),l=t("../Settings/SceneTypes"),u=t("../Settings/Builds"),p=t("../Framework/Utils/Utils"),d=t("../App/AppFacade"),f=t("../Settings/CommandTypes"),h=cc._decorator,y=h.ccclass,_=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nextScene=l.default.GAME,e.delay=1,e.counter=null,e.version=null,e._timer=0,e}return r(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.version&&(this.version.string=u.default.VERSION)},e.prototype._onStart=function(){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return t.prototype._onStart.call(this),this._timer=0,this.delay>0?[4,this._initApp()]:[3,4];case 1:return e.sent(),[4,p.default.waitFor(1e3*this.delay)];case 2:return e.sent(),[4,this._startApp()];case 3:return e.sent(),[3,7];case 4:return[4,this._initApp()];case 5:return e.sent(),[4,this._startApp()];case 6:e.sent(),e.label=7;case 7:return[2]}})})},e.prototype.update=function(t){this._timer+=t,this.counter&&(this.counter.string=this._timer.toFixed(1)+"s"),this.delay>0&&(this.counter.string+="|"+this.delay+"s")},e.prototype._goNextScene=function(){},e.prototype._initApp=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,d.default.getInstance().executeCommand(f.default.APP_INIT)];case 1:return t.sent(),[2]}})})},e.prototype._startApp=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,d.default.getInstance().executeCommand(f.default.APP_START)];case 1:return t.sent(),[2]}})})},i([_({displayName:"\u4e0b\u4e00\u4e2a\u573a\u666f"})],e.prototype,"nextScene",void 0),i([_({displayName:"\u7b49\u5f85\u65f6\u95f4"})],e.prototype,"delay",void 0),i([_(cc.Label)],e.prototype,"counter",void 0),i([_(cc.Label)],e.prototype,"version",void 0),i([y],e)}(c.default);o.default=v,cc._RF.pop()},{"../App/AppFacade":"AppFacade","../Framework/Scene/SceneControl":"SceneControl","../Framework/Utils/Utils":"Utils","../Settings/Builds":"Builds","../Settings/CommandTypes":"CommandTypes","../Settings/SceneTypes":"SceneTypes"}],BaseUI:[function(t,e,o){"use strict";cc._RF.push(e,"4ab93Zea/pMEIv/ptH253u6","BaseUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.show=function(){return a(this,void 0,Promise,function(){return s(this,function(){return this.node.active=!0,[2]})})},e.prototype.hide=function(){return a(this,void 0,Promise,function(){return s(this,function(){return this.node.active=!1,[2]})})},e.prototype.initOnce=function(){},i([l],e)}(cc.Component));o.default=u,cc._RF.pop()},{}],BoardEditor:[function(t,e,o){"use strict";cc._RF.push(e,"317c0aVrsRJ2b3mPFXJYwpO","BoardEditor");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Game/Board"),s=t("../Game/Grid"),c=t("../../../GameKit/Framework/Utils/Utils"),l=t("../Game/LevelAStarNode"),u=t("../Game/Corner"),p=cc._decorator,d=p.ccclass,f=p.property,h=cc.v2(-1,-1),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startPrefab=null,e.endPrefab=null,e.cornerPrefab=null,e._cornerLayer=null,e._corners=[],e.pathPrefab=null,e._pathLayer=null,e._pathNodes=[],e.botPrefab=null,e._botLayer=null,e._bot=null,e._startNode=null,e._startGrid=h,e._endNode=null,e._endGrid=h,e._reachable=!1,e}return r(e,t),e.prototype._clear=function(){t.prototype._clear.call(this),this._startNode=void 0,this._startGrid=h,this._endNode=void 0,this._endGrid=h,this._pathLayer=void 0,this._pathNodes=[],this._cornerLayer=void 0,this._corners=[]},e.prototype._initExtra=function(){var t;this._cornerLayer||((t=new cc.Node("corners")).parent=this.node,t.setPosition(0,0),this._cornerLayer=t),this._pathLayer||((t=new cc.Node("corners")).parent=this.node,t.setPosition(0,0),this._pathLayer=t)},e.prototype.loadLevelData=function(e){t.prototype.loadLevelData.call(this,e);var o=e.getStart();o.equals(h)||this.setStart(o)},e.prototype.setStart=function(t){if(!this.isInBoard(t))return!1;if(t.equals(this._startGrid)||t.equals(this._endGrid))return!1;var e=this.getGrid(t);return!(!e||e.gridType!=s.GRID_TYPE.WALKABLE||(this._startGrid=t,this._startNode||(this._startNode=cc.instantiate(this.startPrefab),this._startNode.parent=this._pathLayer),this._startNode.active=!0,this._startNode.setPosition(this.getGridPosition(t)),0))},e.prototype.setEnd=function(t){if(!this.isInBoard(t))return!1;if(t.equals(this._startGrid)||t.equals(this._endGrid))return!1;var e=this.getGrid(t);return!(!e||e.gridType!=s.GRID_TYPE.WALKABLE||(this._endGrid=t,this._endNode||(this._endNode=cc.instantiate(this.endPrefab),this._endNode.parent=this._pathLayer),this._endNode.active=!0,this._endNode.setPosition(this.getGridPosition(t)),0))},e.prototype.setGrid=function(e,o,n){var r=0;if(c.default.isNotUndefinedOrNull(o.x)?(r=o.x,n=o.y):(r=o,c.default.isUndefinedOrNull(n)&&(n=0)),e==s.GRID_TYPE.WALKABLE&&!this.isInsideEdge(r,n))return!1;var i=t.prototype.setGrid.call(this,e,o,n);if(i){var a=cc.v2(r,n);e==s.GRID_TYPE.UNWALKABLE?this._startGrid.equals(a)?(this._startGrid=h,this._startNode.active=!1):this._endGrid.equals(a)&&(this._endGrid=h,this._endNode.active=!1):s.GRID_TYPE.WALKABLE}return i},e.prototype.hasStart=function(){return!this._startGrid.equals(h)},e.prototype.tryUpdatePath=function(){var t=this;if(this._pathNodes.forEach(function(t){t.active=!1}),!this._startGrid.equals(h)&&!this._endGrid.equals(h)){var e=l.default.findPath(this._level,this._startGrid,this._endGrid);e.length>0?(this._endNode.color=cc.Color.GREEN,e.forEach(function(e,o){if(e.equals(t._startGrid)||e.equals(t._endGrid));else{var n=t._pathNodes[o];n||((n=cc.instantiate(t.pathPrefab)).parent=t._pathLayer,t._pathNodes.push(n)),n.active=!0,n.setPosition(t.getGridPosition(e))}})):this._endNode.color=cc.Color.RED}},e.prototype.updateReachability=function(){this._startGrid.equals(h)||this.checkReachability(this._startGrid)},e.prototype.checkReachability=function(t){if(!this._level.isGridWalkable(t))return!1;this._pathNodes.forEach(function(t){t.active=!1});for(var e=!0,o=this._level.getGridWayouts(t),n=0;n<o.length;n++){var r=l.default.getReachability(this._level,t,o[n]);if(r.unreachable.length>0){for(var i=r.unreachable,a=0;a<i.length;a++){var s=i[a],c=this._pathNodes[a];c||((c=cc.instantiate(this.pathPrefab)).parent=this._pathLayer,this._pathNodes.push(c)),c.color=cc.Color.RED,c.active=!0,c.setPosition(this.getGridPosition(s))}(e=!1)||this.setStart(t);break}}return e},e.prototype.updateCorners=function(){var t=this;this._corners.forEach(function(t){t.active=!1}),this._level.getAllConners().forEach(function(e,o){var n=t._corners[o];n||((n=cc.instantiate(t.cornerPrefab)).parent=t._cornerLayer,t._corners.push(n)),n.active=!0,n.setPosition(t.getGridPosition(e.grid)),n.getComponent(u.default).setData(e)})},e.prototype.toLevelData=function(){var t=this,e=this._level.getAllConners(),o=[];if(this._startGrid.equals(h)){var n=[];e.forEach(function(e){e.dirs.length<=2&&t.checkReachability(e.grid)&&(o.push(e.grid),1==e.dirs.length&&n.push(e.grid))}),n.length>0&&(o=n)}else{if(!this.checkReachability(this._startGrid))return void console.warn("[BoardEditor] invalid start position");o.push(this._startGrid)}if(o.length>0)return this._level.setStarts(o),this._level;console.warn("[BoardEditor] no valid start position")},i([f(cc.Prefab)],e.prototype,"startPrefab",void 0),i([f(cc.Prefab)],e.prototype,"endPrefab",void 0),i([f(cc.Prefab)],e.prototype,"cornerPrefab",void 0),i([f(cc.Prefab)],e.prototype,"pathPrefab",void 0),i([f(cc.Prefab)],e.prototype,"botPrefab",void 0),i([d],e)}(a.default);o.default=y,cc._RF.pop()},{"../../../GameKit/Framework/Utils/Utils":"Utils","../Game/Board":"Board","../Game/Corner":"Corner","../Game/Grid":"Grid","../Game/LevelAStarNode":"LevelAStarNode"}],Board:[function(t,e,o){"use strict";cc._RF.push(e,"d397fUf0aVCaKF1AsCEZ5a4","Board");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./Grid"),s=t("./InputType"),c=t("../../../GameKit/Framework/Utils/Utils"),l=t("./LevelData"),u=t("./WalkableGrid"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gridPrefab=null,e._width=0,e._height=0,e._bgGrids=[],e._grids=[],e._gridSize=cc.size(0,0),e._x0=0,e._y0=0,e._borderPrefab=null,e._gridPrefabs=[],e._level=null,e}return r(e,t),e.prototype._clear=function(){this.node.removeAllChildren(),this._grids=[],this._bgGrids=[]},e.prototype.initBoard=function(t,e){this._clear(),this._width=t,this._height=e,this._level=l.default.create(t,e,a.GRID_TYPE.UNKNOWN);for(var o=0;o<e;o++)for(var n=0;n<t;n++)this.isInsideEdge(n,o)||this._level.setGridType(a.GRID_TYPE.UNWALKABLE,cc.v2(n,o));this._initBg(),this._initBorder(),this._initGrids(this._level.getGridData()),this._initExtra()},e.prototype.loadLevelData=function(t){this._clear();var e=t.clone();this._width=e.getWidth(),this._height=e.getHeight(),this._level=e,this._initBg(),this._initBorder(),this._initGrids(e.getGridData()),this._initExtra()},e.prototype._initExtra=function(){},e.prototype.getLevel=function(){return this._level},e.prototype.fillWithGrid=function(t){for(var e=this._width,o=this._height,n=0;n<o;n++)for(var r=0;r<e;r++)this.setGrid(t,r,n)},e.prototype.setPrefabs=function(t,e){this._borderPrefab=t,this._gridPrefabs=e},e.prototype.setSpecial=function(t){var e=this,o=t.length;this._level.getRandomGrids(o,a.GRID_TYPE.WALKABLE).forEach(function(o,n){e.setSpecialAt(o,t[n])})},e.prototype.setSpecialAt=function(t,e){var o=t.x+this._level.getWidth()*t.y,n=this.getGrid(t);n&&(this._grids[o]=void 0,n.node.active=!1,n.node.destroy(),n=void 0);var r=this._bgGrids[o],i=cc.instantiate(e);return i.parent=r,i.setPosition(cc.v2()),i.active=!0,(n=i.getComponent(a.default)).gridPostion=t,this._grids[o]=n,i},e.prototype._initBg=function(){var t=this._width,e=this._height,o=t*e;this._grids=new Array(o),this._bgGrids=[];for(var n=0;n<o;n++)(u=cc.instantiate(this.gridPrefab)).active=!0,u.parent=this.node,this._bgGrids.push(u);var r=this._bgGrids[0].getContentSize();this._gridSize=r;var i=r.width*t/2*-1+r.width/2,a=r.height*e/2*-1+r.height/2;this._x0=i,this._y0=a;for(var s=0,c=0;c<e;c++)for(var l=0;l<t;l++){var u;s=t*c+l,(u=this._bgGrids[s]).active=!0,u.setPosition(this.getGridPosition(l,c)),u.name="G["+l+","+c+"]",u.color=(l+c)%2==0?cc.color(100,100,100):cc.color(150,150,150)}},e.prototype._initBorder=function(){},e.prototype._initGrids=function(t){for(var e=this._width,o=this._height,n=0;n<o;n++)for(var r=0;r<e;r++){var i=t[e*n+r];this.setGrid(i,r,n)}},e.prototype.getGridPosition=function(t,e){var o=0;return c.default.isNotUndefinedOrNull(t.x)?(o=t.x,e=t.y):(o=t,c.default.isUndefinedOrNull(e)&&(e=0)),cc.v2(this._x0+this._gridSize.width*o,this._y0+this._gridSize.height*e)},e.prototype.getStartGrid=function(){return this._level.getStart()},e.prototype.getNextGrid=function(t,e){var o=a.GRID_DIR.NONE;switch(e){case s.default.UP:o=a.GRID_DIR.UP;break;case s.default.DOWN:o=a.GRID_DIR.DOWN;break;case s.default.LEFT:o=a.GRID_DIR.LEFT;break;case s.default.RIGHT:o=a.GRID_DIR.RIGHT;break;default:return console.warn("[Board] invalid dir: ",e),a.INVALID_GRID}return this._level.getNextWalkable(t,o)},e.prototype.hasUnmarkedGrid=function(t,e){for(var o=!1,n=e.sub(t).normalize(),r=t,i=0;i<100;i++){r=r.add(n);var a=this.getGrid(r).getComponent(u.default);if(a&&!a.isMarked()){o=!0;break}if(r.equals(e))break;if(i>=90){console.warn("[Board] hasUnmarkedGrid, something wrong: ",i,t,e,n);break}}return o},e.prototype.setGrid=function(t,e,o){var n=!1,r=0;c.default.isNotUndefinedOrNull(e.x)?(r=e.x,o=e.y):(r=e,c.default.isUndefinedOrNull(o)&&(o=0));var i=this._width*o+r;if(i<0||i>=this._grids.length)return console.warn("[Board] invalid idx: ",i),n;var s=this._grids[i];if(c.default.isNotUndefinedOrNull(s)){if(s.gridType==t)return n;this._grids[i]=void 0,s.node.active=!1,s.node.destroy(),s=void 0,this._level.setGridType(a.GRID_TYPE.UNKNOWN,cc.v2(r,o))}if(this._level.setGridType(t,cc.v2(r,o)),t<a.GRID_TYPE.MIN)return!0;n=!0;var l=this._bgGrids[i],u=cc.instantiate(this._gridPrefabs[t]);return u.parent=l,u.setPosition(cc.v2()),u.active=!0,(s=u.getComponent(a.default)).gridPostion=cc.v2(r,o),this._grids[i]=s,n},e.prototype.getGrid=function(t,e){var o=0;c.default.isNotUndefinedOrNull(t.x)?(o=t.x,e=t.y):(o=t,c.default.isUndefinedOrNull(e)&&(e=0));var n=this._width*e+o;if(!(n<0||n>=this._grids.length))return this._grids[n];console.warn("[Board] invalid idx: ",n)},e.prototype.positionToGrid=function(t){var e=Math.ceil((t.x-this._x0)/this._gridSize.width-.5),o=Math.ceil((t.y-this._y0)/this._gridSize.height-.5);return cc.v2(e,o)},e.prototype.isInBoard=function(t,e){var o=0;return t instanceof cc.Vec2?(o=t.x,e=t.y):(o=t,c.default.isUndefinedOrNull(e)&&(e=0)),o>=0&&o<this._width&&e>=0&&e<this._height},e.prototype.isInsideEdge=function(t,e){return t>0&&t<this._width-1&&e>0&&e<this._height-1},i([f(cc.Prefab)],e.prototype,"gridPrefab",void 0),i([d],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../GameKit/Framework/Utils/Utils":"Utils","./Grid":"Grid","./InputType":"InputType","./LevelData":"LevelData","./WalkableGrid":"WalkableGrid"}],Builds:[function(t,e,o){"use strict";cc._RF.push(e,"5deeeDDMi5KN5oEPvvkTfDq","Builds"),Object.defineProperty(o,"__esModule",{value:!0});o.default={VERSION:"1.0.10",ADS_INTERSTITIAL:"",ADS_REWARDS:"",ENABLE_SHARE:!1,ENABLE_RANK:!1,ENABLE_ADS:!1,ENABLE_SHOTCUT:!1},cc._RF.pop()},{}],CardboardBox:[function(t,e,o){"use strict";cc._RF.push(e,"a3e9bu+sj1KwJ6hzdW7J9GM","CardboardBox");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.ROOF_STYLE=o.KITTY_PLACE=void 0;var c,l,u=t("../../GameKit/Framework/Utils/Utils"),p=t("../../Kitty/Script/Data/KittyDB"),d=t("../../GameKit/App/AppFacade"),f=t("../../Kitty/Script/KittyConsts"),h=t("../../Kitty/Script/KittyApp"),y=cc._decorator,_=y.ccclass,v=y.property;(function(t){t[t.NONE=0]="NONE",t[t.BEHIND=1]="BEHIND",t[t.INSIDE=2]="INSIDE"})(o.KITTY_PLACE||(o.KITTY_PLACE={})),function(t){t[t.UP=0]="UP",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT"}(c||(c={})),function(t){t[t.NONE=0]="NONE",t[t.CASTLE=1]="CASTLE",t[t.TOWER=2]="TOWER"}(l=o.ROOF_STYLE||(o.ROOF_STYLE={}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.back=null,e.front=null,e.window=null,e.tower=null,e.castle=null,e.flag=null,e.dog=null,e.positionBehindBox=null,e.positionsBebind=[],e.positionInWindow=null,e.positionInBox=null,e.marks=[],e._hasWindow=!1,e._grid=cc.v2(),e._roof=l.NONE,e._neighbours=[],e._kittys=null,e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){this.marks.forEach(function(t){t.active=!1})},e.prototype.setGrid=function(t){this._grid.x=t.x,this._grid.y=t.y},e.prototype.getGrid=function(){return this._grid},e.prototype.setNeighbour=function(t,e,o){this._neighbours.push(t,e,o)},e.prototype.setWindow=function(t){this.window.active=t,this.front.active=!t,this._hasWindow=t},e.prototype.setRoofStyle=function(t){this.tower.active=t===l.TOWER,this.castle.active=t===l.CASTLE,t===l.TOWER?this.flag.active=u.default.randomFloat(0,1)>.5:this.flag.active=!1,this._roof=t},e.prototype.getRoof=function(){return this._roof},e.prototype.setFlag=function(t){this._roof===l.TOWER?this.flag.active=t:this.flag.active=!1},e.prototype.setRandomKitty=function(t){var e=this;this._kittys=[];var o=[];this._hasWindow&&o.push({pos:this.positionInWindow,dir:c.UP}),this._neighbours.forEach(function(t,n){t<=0&&(o.push({pos:e.positionsBebind[n],dir:n}),n===c.UP&&(e._hasWindow||o.push({pos:e.positionInBox,dir:c.UP})))}),this.positionBehindBox.parent.active=!1,this.positionInWindow.parent.active=!1,this.positionInBox.parent.active=!1,this.positionsBebind.forEach(function(t){t.active=!1});var n=!1;if(u.default.random()>t&&o.length>0){n=!0;var r=u.default.randomInt(0,o.length),i=o[r];i.pos.parent.active=!0,i.pos.active=!0;var a=!1,s=p.default.getInstance().getRandomKittyAvatar();u.default.random()<.2&&(s=this.dog,a=!0),i.pos.getComponent(cc.Sprite).spriteFrame=s;var l=i.pos.getChildByName("ClickArea");null==l&&(l=i.pos.children[0]),l.getComponent(cc.Sprite).enabled=!1,this._kittys.push({kitty:i.pos,dir:i.dir,hide:!1,origin:i.pos.getPosition(),clickArea:l,isDog:a})}return n},e.prototype.getKittyCount=function(){return this._kittys.length},e.prototype.hide=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(){return this._kittys.forEach(function(o){e._hideKitty(o,t)}),[2]})})},e.prototype.show=function(t,e){return a(this,void 0,void 0,function(){var o=this;return s(this,function(){return this._kittys.forEach(function(n){o._showKitty(n,t,e)}),[2]})})},e.prototype._resetKitty=function(t){t.clicked=!1,t.hide=!1,this._hideKittyImmediately(t),t.kitty.active=!0},e.prototype._hideKitty=function(t,e){return a(this,void 0,void 0,function(){var n,r=this;return s(this,function(){if(t.clicked)return[2];if(t.hide)return[2];if(t.kitty.stopAllActions(),e){switch(n=void 0,this._showKittyImmediately(t),t.dir){case c.UP:n=cc.moveBy(.5,0,.7*-t.kitty.height);break;case c.LEFT:n=cc.moveBy(.5,.6*t.kitty.width,0);break;case c.RIGHT:n=cc.moveBy(.5,.6*-t.kitty.width,0)}t.kitty.runAction(cc.sequence(n,cc.callFunc(function(){t.hide=!0,t.clicked||(r.showMark(t.isDog,t.kitty),d.default.getInstance().sendNotification(o.EVENTS.MISS_KITTY,t))})))}else this._hideKittyImmediately(t);return[2]})})},e.prototype._showKitty=function(t,e,o){if(t.clicked)return 0;if(!t.hide)return 0;var n;t.kitty.stopAllActions(),this._hideKittyImmediately(t);var r=u.default.randomFloat(0,e),i=cc.delayTime(r),a=u.default.randomFloat(o/2,o);switch(t.dir){case c.UP:n=cc.moveBy(a,0,.7*t.kitty.height);break;case c.LEFT:n=cc.moveBy(a,.6*-t.kitty.width,0);break;case c.RIGHT:n=cc.moveBy(a,.6*t.kitty.width,0)}return t.hide=!1,t.kitty.runAction(cc.sequence(i,n)),e+a},e.prototype._hideKittyImmediately=function(t){switch(t.dir){case c.UP:t.kitty.setPosition(t.origin.add(cc.v2(0,.7*-t.kitty.height)));break;case c.LEFT:t.kitty.setPosition(t.origin.add(cc.v2(.6*t.kitty.width,0)));break;case c.RIGHT:t.kitty.setPosition(t.origin.add(cc.v2(.6*-t.kitty.width,0)))}t.hide=!0},e.prototype._showKittyImmediately=function(t){t.kitty.setPosition(t.origin),t.hide=!1},e.prototype._teskClickKitty=function(t,e){return!(t.hide||t.clicked||!t.clickArea.getBoundingBoxToWorld().contains(e)||(this._onKittyClicked(t),0))},e.prototype._onKittyClicked=function(t){t.hide=!1,t.clicked=!0,t.kitty.stopAllActions(),this._showKittyImmediately(t),t.isDog?h.default.playSound(f.default.SOUNDS.NO):h.default.playSound(f.default.SOUNDS.OK),this.showMark(!t.isDog,t.kitty);var e=cc.blink(.3,3),n=cc.delayTime(.1),r=cc.callFunc(function(){t.kitty.active=!1,d.default.getInstance().sendNotification(o.EVENTS.FOUND_KITTY,t)}),i=cc.sequence(e,n,r);t.kitty.runAction(i)},e.prototype.testClick=function(t){var e=this;this._kittys.forEach(function(o){e._teskClickKitty(o,t)})},e.prototype.showMark=function(t,e){this.marks[0].active=t,this.marks[1].active=!t;var o=u.default.convertNode1PositionToNode2ParentSpaceAR(e,this.marks[0]);o.y<0&&(o.y+=e.height/2),o.x+=e.width*(.5-e.anchorX),o.y+=e.height*(.5-e.anchorY),this.marks[0].position=o,this.marks[1].position=o},e.prototype.resetKitty=function(){var t=this;this.marks.forEach(function(t){t.active=!1}),this._kittys.forEach(function(e){t._resetKitty(e)})},e.EVENTS={FOUND_KITTY:"Found.Kitty",MISS_KITTY:"Miss.Kitty"},i([v(cc.Node)],e.prototype,"back",void 0),i([v(cc.Node)],e.prototype,"front",void 0),i([v(cc.Node)],e.prototype,"window",void 0),i([v(cc.Node)],e.prototype,"tower",void 0),i([v(cc.Node)],e.prototype,"castle",void 0),i([v(cc.Node)],e.prototype,"flag",void 0),i([v(cc.SpriteFrame)],e.prototype,"dog",void 0),i([v(cc.Node)],e.prototype,"positionBehindBox",void 0),i([v(cc.Node)],e.prototype,"positionsBebind",void 0),i([v(cc.Node)],e.prototype,"positionInWindow",void 0),i([v(cc.Node)],e.prototype,"positionInBox",void 0),i([v(cc.Node)],e.prototype,"marks",void 0),o=i([_],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../GameKit/App/AppFacade":"AppFacade","../../GameKit/Framework/Utils/Utils":"Utils","../../Kitty/Script/Data/KittyDB":"KittyDB","../../Kitty/Script/KittyApp":"KittyApp","../../Kitty/Script/KittyConsts":"KittyConsts"}],CellContainer:[function(t,e,o){"use strict";cc._RF.push(e,"81c34sxs8RA77d/o2n7ErOK","CellContainer");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./Cell"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cellPrefab=null,e.cellCount=12,e._cells=[],e}return r(e,t),e.prototype.start=function(){},e.prototype.initCells=function(){this.node.removeAllChildren(),this._cells=[];for(var t=0;t<this.cellCount;t++){var e=cc.instantiate(this.cellPrefab);e.name="cell-"+t,e.getComponent(a.default).setId(t),e.parent=this.node,this._cells.push(e)}},e.prototype.getCellAtScreenPosition=function(t){for(var e=null,o=0;o<this._cells.length;o++){var n=this._cells[o];if(n.getBoundingBoxToWorld().contains(t)){e=n;break}}return e},e.prototype.getCellAt=function(t){return this._cells[t]},e.prototype.getCellCount=function(){return this._cells.length},e.prototype.getNextEmptyCell=function(){for(var t=null,e=0;e<this.cellCount;e++){var o=this._cells[e];if(!o.getComponent(a.default).hasItem()){t=o;break}}return t},e.prototype.hasEmptyCell=function(){for(var t=!1,e=0;e<this.cellCount;e++)if(!this._cells[e].getComponent(a.default).hasItem()){t=!0;break}return t},i([l(cc.Prefab)],e.prototype,"cellPrefab",void 0),i([l],e.prototype,"cellCount",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Cell":"Cell"}],Cell:[function(t,e,o){"use strict";cc._RF.push(e,"8751cjlPnxIWL9BQ7y9l+Dy","Cell");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./KittyItem"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.id=0,e.kittySpot=null,e.fishes=[],e._itemNode=null,e._food=0,e}return r(e,t),e.prototype.start=function(){this.label&&(this.label.string=this.id.toString()),this.setFishCount(0)},e.prototype.setId=function(t){this.id=t,this.label&&(this.label.string=this.id.toString())},e.prototype.setItem=function(t){this._itemNode?console.warn("[Cell] item already exist in cell: ",this.node.name):(this._itemNode=t,t.parent=this.kittySpot,t.setPosition(0,60),t.getComponent(a.default).setKittyMsg(-1))},e.prototype.getItem=function(){return this._itemNode},e.prototype.hasItem=function(){return!!this.getItem()},e.prototype.removeItem=function(){var t=this._itemNode;return this._itemNode=null,t},e.prototype.setFishCount=function(t){this._food=t;for(var e=0;e<this.fishes.length;e++){this.fishes[e].active=e<t}},e.prototype.randomFood=function(){this._food++,this._food>this.fishes.length&&(this._food=0),this.setFishCount(this._food)},i([l(cc.Label)],e.prototype,"label",void 0),i([l],e.prototype,"id",void 0),i([l(cc.Node)],e.prototype,"kittySpot",void 0),i([l(cc.Node)],e.prototype,"fishes",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./KittyItem":"KittyItem"}],ClickGuide:[function(t,e,o){"use strict";cc._RF.push(e,"d88e8YjeGBElLuN3DV1kyjF","ClickGuide");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hand=null,e}return r(e,t),e.prototype.start=function(){this.playClick()},e.prototype.playClick=function(){this.hand.y=0,this.hand.stopAllActions();var t=cc.moveBy(.2,0,15),e=cc.scaleTo(.2,.9,.9),o=cc.spawn(t,e),n=cc.moveBy(.2,0,-15),r=cc.scaleTo(.2,1,1),i=cc.spawn(n,r),a=cc.sequence(o,cc.delayTime(.4),i,cc.delayTime(.5)).repeatForever();this.hand.runAction(a)},i([c(cc.Node)],e.prototype,"hand",void 0),i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],Cloud:[function(t,e,o){"use strict";cc._RF.push(e,"2486eilq51BJ4xjQYTNrnFD","Cloud");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Utils/Utils"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lootLayer=null,e.xRange=500,e.xSpeed=100,e.minY=0,e.maxY=230,e.delay=5,e.hitDelay=1,e._speed=0,e._moving=!0,e._waitCounter=0,e._hitCounter=0,e._hit=!1,e}return r(e,t),e.prototype.onLoad=function(){this._reset(this.xSpeed>0?1:-1)},e.prototype._reset=function(t){this._speed=Math.abs(this.xSpeed)*t,this.node.y=a.default.randomFloat(this.minY,this.maxY),this._speed>0?this.node.scaleX=-1:this.node.scaleX=1,this._hit=!1,this._hitCounter=0},e.prototype.update=function(t){this._hit&&this._hitCounter>0?this._hitCounter-=t:this._moving?this._move(t):this._wait(t)},e.prototype._move=function(t){var e=this._speed*t,o=this.node.x+e;o>this.xRange?(this._moving=!1,o=this.xRange,this._reset(-1)):o<-this.xRange&&(this._moving=!1,o=-this.xRange,this._reset(1)),this.node.x=o},e.prototype._wait=function(t){this._waitCounter+=t,this._waitCounter>=this.delay&&(this._waitCounter=0,this._moving=!0)},e.prototype.onBeginContact=function(){},i([l(cc.Node)],e.prototype,"lootLayer",void 0),i([l],e.prototype,"xRange",void 0),i([l],e.prototype,"xSpeed",void 0),i([l],e.prototype,"minY",void 0),i([l],e.prototype,"maxY",void 0),i([l],e.prototype,"delay",void 0),i([l],e.prototype,"hitDelay",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../Utils/Utils":"Utils"}],CollisionTags:[function(t,e,o){"use strict";cc._RF.push(e,"7122cRvDctBOJNljycANdM7","CollisionTags"),Object.defineProperty(o,"__esModule",{value:!0}),o.default={UNKNOWN:0,BOUNDARY:1,CANDY:2},cc._RF.pop()},{}],CommandTypes:[function(t,e,o){"use strict";cc._RF.push(e,"93c3eOVDLlMY6r/VFiMGcTR","CommandTypes"),Object.defineProperty(o,"__esModule",{value:!0}),o.default={APP_INIT:"Init.App.Cmd",APP_START:"Start.App.Cmd",HIDE_MAIN_UI:"Main.UI.Hide.Cmd",SHOW_HOME_UI:"Home.UI.Show.Cmd",SHOW_GAME_UI:"Game.UI.Show.Cmd",SHOW_RESULT_UI:"Result.UI.Show.Cmd",NEW_MATCH:"New.Match.Cmd",START_MATCH:"Start.Match.Cmd",STOP_MATCH:"Stop.Match.Cmd",END_MATCH:"End.Match.Cmd",MATCH:{ROLLBACK:"Match.Rollback.Cmd",STEP_FORWARD:"Match.Step.Forward.Cmd"},PLAY_NEW_MATCH:"Play.New.Match.Cmd",UPDATE_LEADERBOARD:"Update.Leaderboard.Cmd",END_GAME:"End.Game.Cmd",PAUSE_GAME:"Pause.Game.Cmd",RESUME_GAME:"Resume.Game.Cmd",GO_SCENE:"Go.Scene.Cmd",GO_HOME_SCENE:"Go.Home.Scene.Cmd",BUY_PROP:"Buy.Prop.Cmd",SHOW_REVIVE_UI:"Revive.UI.Show.Cmd",ADS_FOR_REVIVE:"Ads.for.Revive.Cmd",REVIVE_BY_TOOLS:"Revive.By.Tools.Cmd",SKIP_ADS_FOR_REVIVE:"Skip.Ads.for.Revive.Cmd",SHOW_ADS_FOR_FREE_GOLD:"Show.Ads.For.Free.Gold.Cmd",SHOW_ADS_FOR_EXTRA_GOLD:"Show.Ads.For.Extra.Gold.Cmd",SHOW_RANK:"Show.Rank.UI.Cmd",SHOW_REPLAY:"Show.Replay.UI.Cmd"},cc._RF.pop()},{}],ConfigDB:[function(t,e,o){"use strict";cc._RF.push(e,"c47e0sb6RZMp6ZIAbqQMuDb","ConfigDB");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../../GameKit/Framework/Utils/Utils"),a={_config:{},_colors:[],_letters:[],load:function(){return n(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return[4,this._loadConfig("/configs/colors")];case 1:return(t=e.sent())&&(this._config=t.json,this._colors=this._config.colors,this._colors.push(void 0),this._colors.push(void 0),this._colors.unshift(void 0),this._colors.unshift(void 0),this._letters=this._config.letters),[2]}})})},_loadConfig:function(t){return n(this,void 0,void 0,function(){var e;return r(this,function(o){switch(o.label){case 0:return[4,i.default.loadRes(t)];case 1:return(e=o.sent()).error?(console.warn("[Config] loading ",t,", error: ",e),[2,void 0]):[2,e.resource]}})})},getColors:function(){return this._colors},getLetters:function(){return this._letters},getRandomLetter:function(){return i.default.randomItemInArray(this._letters)}};o.default=a,cc._RF.pop()},{"../../../GameKit/Framework/Utils/Utils":"Utils"}],ContextRankProxy:[function(t,e,o){"use strict";cc._RF.push(e,"b3edcdHyAdHpaF87Q186CVv","ContextRankProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./RankProxy"),l=t("../Framework/Utils/Utils"),u=cc._decorator,p=u.ccclass,d=(u.property,function(t){function e(){var e=t.call(this)||this;return e._context="",e._contextBoard="",e._count=0,e._offset=0,e._context="",e}var o;return r(e,t),o=e,e.create=function(t,e){var n=new o;return n.name=t,n.init(e.board,!0),n},e.prototype.init=function(e,o){t.prototype.init.call(this,e,o),this._boardName="",this._board=void 0,this._entries=[],this._worldEntries=[],this._playerEntry=void 0,this._contextBoard=e},e.prototype.isValid=function(){return t.prototype.isValid.call(this)&&!l.default.isUndefinedOrNullOrEmpty(this._context)},e.prototype.changeContextId=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return this._context==t?[2]:(console.info("[ContextRank] context id changed: ",t),l.default.isUndefinedOrNullOrEmpty(this._context),this._board=void 0,this._entries=[],this._context=t,this._boardName=this._contextBoard+"."+t,[2])})})},e.prototype.reloadEntriesAsync=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return[4,this.loadPlayerEntryAsync()];case 1:return o.sent(),[4,this.getEntrisAsync(t,e)];case 2:return o.sent(),[2]}})})},e.prototype.getEntrisAsync=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return this._count=t,this._offset=e,[4,this.getFriendsRanksAsync(t,e)];case 1:return o.sent(),[2]}})})},e.prototype._getBoardAsync=function(){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return l.default.isUndefinedOrNullOrEmpty(this._context)?[2,!1]:[4,t.prototype._getBoardAsync.call(this)];case 1:return[2,e.sent()]}})})},e.prototype.getFriendsRanksAsync=function(t,e){return a(this,void 0,void 0,function(){var o,n;return s(this,function(r){switch(r.label){case 0:return this.isValid()?[4,this._getBoardAsync()]:(this.sendNotification(c.default.EVENTS.RANK_LIST_UPDATE,{board:this.getBoardName(),type:0}),[2]);case 1:if(!r.sent())return[3,5];r.label=2;case 2:return r.trys.push([2,4,,5]),o=void 0,[4,this._board.getEntriesAsync(t,e)];case 3:return o=r.sent(),this._entries=o,this._downloadPhotosForEntriesAsync(o),this.sendNotification(c.default.EVENTS.RANK_LIST_UPDATE,{board:this.getBoardName(),type:0}),[3,5];case 4:return n=r.sent(),console.warn("[ContextRank] can't get leaderboard entries: ",this.getBoardName(),", Error: ",n),[3,5];case 5:return[2]}})})},o=i([p],e)}(c.default));o.default=d,cc._RF.pop()},{"../Framework/Utils/Utils":"Utils","./RankProxy":"RankProxy"}],Controller:[function(t,e,o){"use strict";cc._RF.push(e,"145bbpnQ4JH/KtoyQrXzY0T","Controller");var n=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},r=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,t("../Utils/Utils")),l=function(){function t(){}var e;return e=t,t.getInstance=function(){return c.Utils.isUndefinedOrNull(e._instance)&&(e._instance=new e),e._instance},t.prototype.init=function(t){this._facade=t,this._commands=new Array},t.prototype.executeCommand=function(t){return r(this,void 0,void 0,function(){var e,o,n;return i(this,function(r){switch(r.label){case 0:return e=t.type,"string"==typeof t&&(e=t),(o=this._commands[e])||console.warn("[Controller] cmd not registered: ",e),o.isQuickClass?((n=o).init(),[4,n.execute(t)]):[3,2];case 1:return r.sent(),[3,4];case 2:return(n=new o).init(),[4,n.execute(t)];case 3:r.sent(),r.label=4;case 4:return[2]}})})},t.prototype.registerCommand=function(t,e){this._facade.registerObserver(t,this.executeCommand,this),this._commands[t]=e},t.prototype.hasCommand=function(t){return c.Utils.isUndefinedOrNull(this._commands[t])},t.prototype.removeCommand=function(t){this._facade.removeObserver(t,this.executeCommand,this),this._commands[t]=void 0},e=n([s],t)}();o.default=l,cc._RF.pop()},{"../Utils/Utils":"Utils"}],Corner:[function(t,e,o){"use strict";cc._RF.push(e,"bebebvz60JCJoE9z5ukS8zr","Corner");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./Grid"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.directions=[],e._data=null,e}return r(e,t),e.prototype.setData=function(t){this._data=t,this._updateDir()},e.prototype._updateDir=function(){var t=this;this.directions.forEach(function(t){t.active=!1}),this._data.dirs.forEach(function(e){e.equals(a.GRID_DIR.UP)?t.directions[0].active=!0:e.equals(a.GRID_DIR.DOWN)?t.directions[1].active=!0:e.equals(a.GRID_DIR.LEFT)?t.directions[2].active=!0:e.equals(a.GRID_DIR.RIGHT)&&(t.directions[3].active=!0)})},i([l(cc.Node)],e.prototype,"directions",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Grid":"Grid"}],DebugMenu:[function(t,e,o){"use strict";cc._RF.push(e,"83798rKRGtJrZWHS5eb/HFP","DebugMenu");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/App/AppFacade"),s=t("../../../GameKit/Settings/EventTypes"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtLevel=null,e.editModeLabel=null,e}return r(e,t),e.prototype.setMatch=function(t){if(t){this._match=t;var e=t.getLevel();this.setLevelIdx(e),t.isEditMode()?this.editModeLabel.node.color=cc.Color.GREEN:this.editModeLabel.node.color=cc.Color.BLACK}},e.prototype.getLevelIdx=function(){return parseInt(this.txtLevel.string)},e.prototype.setLevelIdx=function(t){this.txtLevel.string=t.toString()},e.prototype.onAddLevel=function(t,e){var o=parseInt(e);this.setLevelIdx(this.getLevelIdx()+o)},e.prototype.onReplay=function(){a.default.getInstance().sendNotification(s.default.UI.PLAY_CURRENT_LEVEL)},e.prototype.onLoadLevel=function(){a.default.getInstance().sendNotification(s.default.UI.PLAY_LEVEL,{level:this.getLevelIdx()})},e.prototype.onEdit=function(){a.default.getInstance().sendNotification(s.default.UI.EDIT_LEVEL)},i([u(cc.EditBox)],e.prototype,"txtLevel",void 0),i([u(cc.Label)],e.prototype,"editModeLabel",void 0),i([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../GameKit/App/AppFacade":"AppFacade","../../../GameKit/Settings/EventTypes":"EventTypes"}],DownloadCache:[function(t,e,o){"use strict";cc._RF.push(e,"c0de4jfy+BISp22icgCiuCa","DownloadCache");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/Model/Proxy"),l=t("../Framework/Utils/Utils"),u=cc._decorator,p=u.ccclass,d=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return r(e,t),o=e,e.create=function(t){var e=new o;return e.name=t,e.init(),e},e.prototype.init=function(){this._cache=[]},e.prototype.downloadAsync=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(){return e=this,[2,new Promise(function(n,r){cc.loader.load(t,function(i,a){l.default.isNotUndefinedOrNull(i)?(console.warn("[DownloadCache] download failed: "+t.url+"\n Error:"+i),r(i),e.sendNotification(o.EVENTS.DOWNLOAD_FAILED,{url:t.url,err:i})):(e._cache.push({url:t.url,type:t.type,data:a}),n(a),e.sendNotification(o.EVENTS.DOWNLOAD_READY,{url:t.url,data:a}))})})]})})},e.prototype.downloadArrayAsync=function(t,e){return a(this,void 0,void 0,function(){var o,n,r,i,a;return s(this,function(s){switch(s.label){case 0:for(o=[],n=0;n<t.length;n++)this.contains(t[n])||o.push(t[n]);if(!(o.length>0))return[3,4];r=0,i=o,s.label=1;case 1:return r<i.length?(a=i[r],[4,this.downloadAsync({url:a,type:e})]):[3,4];case 2:s.sent(),s.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.contains=function(t){for(var e=!1,o=0;o<this._cache.length;o++)if(this._cache[o].url==t){e=!0;break}return e},e.prototype.get=function(t){for(var e,o=0;o<this._cache.length;o++)if(this._cache[o].url==t){e=this._cache[o];break}return e},e.prototype.getSpriteFrame=function(t){var e=this.get(t);if(e)return e.spriteFrame?e.spriteFrame:(e.spriteFrame=new cc.SpriteFrame(e.data),e.spriteFrame)},e.EVENTS={DOWNLOAD_READY:"Cache.Downloaded.Event",DOWNLOAD_FAILED:"Cache.Doanloaded.Fail.Event"},o=i([p],e)}(c.default));o.default=d,cc._RF.pop()},{"../Framework/Model/Proxy":"Proxy","../Framework/Utils/Utils":"Utils"}],EditorScene:[function(t,e,o){"use strict";cc._RF.push(e,"bc77bCovXJM07eSw3I2/FHY","EditorScene");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Scenes/BaseGameScene"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([c],e)}(a.default));o.default=l,cc._RF.pop()},{"../../../GameKit/Scenes/BaseGameScene":"BaseGameScene"}],EventCenter:[function(t,e,o){"use strict";cc._RF.push(e,"195061nljFAUp+wGvZDWpvp","EventCenter");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Utils/Utils"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return r(e,t),o=e,e.getInstance=function(){if(a.default.isUndefinedOrNull(o._inst)){var t=new cc.Node("EventCenter");cc.game.addPersistRootNode(t);var e=t.addComponent(o);o._inst=e}return o._inst},e.prototype.onLoad=function(){a.default.isUndefinedOrNull(o._inst)?(o._inst,cc.game.addPersistRootNode(this.node)):o._inst!=this&&this.destroy()},e.prototype.registerEvent=function(t,e,o){this.node.on(t,e,o)},e.prototype.unregisterEvent=function(t,e,o){this.node.off(t,e,o)},e.prototype.registerEventHandler=function(t){var e=t.getEvents,o=t.onEvent;if(e&&o)for(var n=e.call(t),r=0;r<n.length;r++)this.node.on(n[r],o.bind(t));else console.warn("[EventCenter] registerEventHandler fail, missing getEvents() or onEvent(), handler=",t)},e.prototype.unregisterEventHandler=function(t){var e=t.getEvents,o=t.onEvent;if(e&&o)for(var n=e.call(t),r=0;r<n.length;r++)this.node.off(n[r],o.bind(t));else console.warn("[EventCenter] unregisterEventHandler fail, missing getEvents() or onEvent(), handler=",t)},e.prototype.fireEvent=function(t,e){var o=new cc.Event.EventCustom(t,!0);o.setUserData(e),this.node.emit(t,o)},o=i([c],e)}(cc.Component));o.default=l,cc._RF.pop()},{"../Utils/Utils":"Utils"}],EventTypes:[function(t,e,o){"use strict";cc._RF.push(e,"31b58iSymRBbpSz1YENvPSj","EventTypes"),Object.defineProperty(o,"__esModule",{value:!0}),o.default={SHOP:{NOT_ENOUGH_MONEY_FOR_ITEM:"not.enough.money.for.item"},GAMEPLAY:{CLICKED:"GamePlay.Clicked",BLOCK_HIT_BOTTOM:"Playground.Block.Hit.Bottom",BLOCK_HIT_LOOT:"Playground.Block.Hit.Loot",STEADY:"Playground.Steadiness.Ready",PASS_STATIC_RULER:"Playground.Pass.Static.Ruler",GAME_STOPPED:"Game.Stop"},MATCHDATA:{ROLLBACKS_UPDATE:"Match.Rollbacks.Update",SCORE_UPDATE:"Match.Score.Update",NEW_STEP_READY:"Match.NewStep.Ready"},UI:{SHOW_RANK:"Show.Rank.Event",RANK_TAB_CHANGE:"Show.Rank.Tab.Change",REQUEST_UNDO:"Request.Undo.Event",SHARE_ON_RESULT:"Share.On.Result",SHARE_ON_RANK:"Share.On.Rank",PLAY_LEVEL:"Play.Level",PLAY_NEXT_LEVEL:"Play.Next.Level",PLAY_CURRENT_LEVEL:"Play.Current.Level",SWITCH_GAME:"Switch.Game",EDIT_LEVEL:"Edit.Level"}},cc._RF.pop()},{}],FB:[function(t,e){"use strict";cc._RF.push(e,"a7ffcn+FV9OsJ3TloQNmi7v","FB"),cc._RF.pop()},{}],Facade:[function(t,e,o){"use strict";cc._RF.push(e,"b9fa1ZTMnpOXp7L4AAwwESZ","Facade");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,u=(c.property,t("./Controller/Controller")),p=t("./Model/Model"),d=t("./View/View"),f=t("./Events/EventCenter"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return r(e,t),o=e,e.getInstance=function(){return o._instance},e._createNotification=function(t,e){var o=new cc.Event.EventCustom(t,!0);return o.setUserData(e),o},e.prototype.init=function(){if(o._instance)return console.warn("[Facade] already inited!"),void this.destroy();o._instance=this,this._model=null,this._controller=null,this._view=null,this.initModel(),this.initController(),this.initView()},e.prototype.initModel=function(){this._model||(this._model=p.default.getInstance(),this._model.init(this))},e.prototype.initController=function(){this._controller||(this._controller=u.default.getInstance(),this._controller.init(this))},e.prototype.initView=function(){this._view||(this._view=d.default.getInstance(),this._view.init(this))},e.prototype.registerCommand=function(t,e){this._controller.registerCommand(t,e)},e.prototype.removeCommand=function(t){this._controller.removeCommand(t)},e.prototype.hasCommand=function(t){return this._controller.hasCommand(t)},e.prototype.executeCommand=function(t,e){return a(this,void 0,void 0,function(){var n;return s(this,function(){return n=o._createNotification(t,e),[2,this._controller.executeCommand(n)]})})},e.prototype.registerProxy=function(t){this._model.registerProxy(t)},e.prototype.retrieveProxy=function(t){return this._model.retrieveProxy(t)},e.prototype.removeProxy=function(t){return this._model.removeProxy(t)},e.prototype.hasProxy=function(t){return this._model.hasProxy(t)},e.prototype.registerMediator=function(t){this._view.registerMediator(t)},e.prototype.retrieveMediator=function(t){return this._view.retrieveMediator(t)},e.prototype.removeMediator=function(t){return this._view.removeMediator(t)},e.prototype.hasMediator=function(t){return this._view.hasMediator(t)},e.prototype.sendNotification=function(t,e){o._createNotification(t,e),f.default.getInstance().fireEvent(t,e)},e.prototype.registerObserver=function(t,e,o){f.default.getInstance().registerEvent(t,e,o)},e.prototype.removeObserver=function(t,e,o){f.default.getInstance().unregisterEvent(t,e,o)},o=i([l],e)}(cc.Component);o.default=h,cc._RF.pop()},{"./Controller/Controller":"Controller","./Events/EventCenter":"EventCenter","./Model/Model":"Model","./View/View":"View"}],FacebookAds:[function(t,e,o){"use strict";cc._RF.push(e,"8a101e+M3VHIJ+5ndowKqH3","FacebookAds");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Facebook"),a="401118510555497_425832138084134",s="401118510555497_401123480555000",c=function(){function t(){}return t.prototype.init=function(){this.loadVideo()},t.prototype.isBannerReady=function(){return!1},t.prototype.showBanner=function(){},t.prototype.hideBanner=function(){},t.prototype.isInterstitialReady=function(){return i.default.isAdsReady(a)},t.prototype.loadInterstitial=function(){console.info("[Facebook Ads] load Interstitial Ads"),i.default.prepareAds(a,i.FB_ADS_TYPE.POPUP)},t.prototype.showInterstitial=function(){return n(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return this.isInterstitialReady()?[4,i.default.playAds(a)]:[3,2];case 1:t.sent(),this.loadInterstitial(),t.label=2;case 2:return[2]}})})},t.prototype.isVideoReady=function(){return i.default.isAdsReady(s)||this.isInterstitialReady()},t.prototype.loadVideo=function(){console.info("[Facebook Ads] load video Ads"),i.default.prepareAds(s,i.FB_ADS_TYPE.VIDEO)},t.prototype.showVideo=function(t){return n(this,void 0,Promise,function(){var e;return r(this,function(o){switch(o.label){case 0:return e=!1,this.isVideoReady()?[3,3]:(e=!1,this.isInterstitialReady()?[4,this.showInterstitial()]:[3,2]);case 1:o.sent(),e=!0,o.label=2;case 2:return[3,5];case 3:return[4,i.default.playAds(s)];case 4:e=o.sent(),this.loadVideo(),o.label=5;case 5:return t&&t(e),[2,!0]}})})},t}();o.default=c,cc._RF.pop()},{"./Facebook":"Facebook"}],FacebookProxy:[function(t,e,o){"use strict";cc._RF.push(e,"04b9fxoe5JHvIUJX4V0M7g8","FacebookProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../AccountProxy"),c=t("../../Framework/Utils/Utils"),l=t("../../Settings/AdsSettings"),u=t("../../Settings/ProxyTypes"),p=(window._facebook,{}),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){return i(this,void 0,void 0,function(){var e,o;return a(this,function(n){switch(n.label){case 0:return t.prototype.init.call(this),this._accountType=s.ACCOUNT.FACEBOOK,e=FBInstant.getEntryPointData(),[4,FBInstant.getEntryPointAsync()];case 1:return o=n.sent(),console.info("[Facebook] entry point: ",o,", data: ",e),this._player.id="0",this._player.name="",[4,this.loadPlayerDataAsync()];case 2:return n.sent(),[4,this.loadContextDataAsync()];case 3:return n.sent(),[2]}})})},e.prototype.getPlayerPhoto=function(){if(this._player.photo)return this._player.photo;var t=this.retrieveProxy(u.default.DOWNLOAD_CACHE);return t&&t.contains(this._player.photoUrl)&&(this._player.photo=t.getSpriteFrame(this._player.photoUrl)),this._player.photo},e.prototype.getPlayerPhotoAsync=function(){return i(this,void 0,Promise,function(){var t;return a(this,function(e){switch(e.label){case 0:return this._player.photo?[2,this._player.photo]:(t=this.retrieveProxy(u.default.DOWNLOAD_CACHE))?t.contains(this._player.photoUrl)?(this._player.photo=t.getSpriteFrame(this._player.photoUrl),[3,3]):[3,1]:[3,3];case 1:return[4,t.downloadAsync({url:this._player.photoUrl})];case 2:e.sent(),e.label=3;case 3:return[2]}})})},e.prototype.isThreadContext=function(){return this._context.type==s.CONTEXT.THREAD},e.prototype.isSoloContext=function(){return this._context.type==s.CONTEXT.SOLO},e.prototype.loadPlayerDataAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return console.info("[Facebook] current player: ","id: "+FBInstant.player.getID()+", name: "+FBInstant.player.getName()),this._player.id=FBInstant.player.getID(),this._player.name=FBInstant.player.getName(),this._player.photoUrl=FBInstant.player.getPhoto(),[4,this.getPlayerPhotoAsync()];case 1:return t.sent(),[2]}})})},e.prototype.loadContextDataAsync=function(){return i(this,void 0,void 0,function(){var t,e;return a(this,function(o){switch(o.label){case 0:if(this._context.id=FBInstant.context.getID(),this._context.type=FBInstant.context.getType(),console.info("[Facebook] current context: ","id:"+FBInstant.context.getID()+", type:"+FBInstant.context.getType()),!FBInstant.context.isSizeBetween(2,null))return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,FBInstant.context.getPlayersAsync()];case 2:return t=o.sent(),console.info("[Facebook] players : ",t),[3,4];case 3:return e=o.sent(),console.warn("[Facebook] get context players failed: ",e),[3,4];case 4:return[3,6];case 5:console.info("[Facebook] context size is 1"),o.label=6;case 6:return[2]}})})},e.prototype.startAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.onFirstStartAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.saveDataAsync=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,FBInstant.player.setDataAsync(t)];case 1:return o.sent(),[3,3];case 2:return e=o.sent(),console.warn("[Facebook] setData failed: ",e),[3,3];case 3:return[2]}})})},e.prototype.loadDataAsync=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,FBInstant.player.getDataAsync(t)];case 1:return[2,o.sent()];case 2:return e=o.sent(),console.warn("[Facebook] getData failed, keys: ",t,"\n Error:",e),[3,3];case 3:return[2]}})})},e.prototype.prepareAds=function(t,e){return i(this,void 0,void 0,function(){var o,n,r,i,s,u;return a(this,function(a){switch(a.label){case 0:if(o=l.Ads.getAdsId(t),n=p[o],c.default.isUndefinedOrNull(n)&&(n={placementId:o,isReady:!1,isLoading:!1,instance:null},p[o]=n),!c.default.isUndefinedOrNull(n.instance))return[3,7];a.label=1;case 1:return a.trys.push([1,6,,7]),0!=e?[3,3]:(r=n,[4,FBInstant.getRewardedVideoAsync(o)]);case 2:return r.instance=a.sent(),[3,5];case 3:return i=n,[4,FBInstant.getInterstitialAdAsync(o)];case 4:i.instance=a.sent(),a.label=5;case 5:return p[o]=n,console.info("[Facebook] get ads ready: pacementId=",o),[3,7];case 6:return s=a.sent(),console.warn("[Facebook] get ads failed: pacementId=",o,"\n Error: ",s),[2];case 7:if(!c.default.isNotUndefinedOrNull(n.instance))return[3,14];if(n.isReady||n.isLoading)return[3,12];if(!c.default.isNotUndefinedOrNull(n.instance))return[3,11];a.label=8;case 8:return a.trys.push([8,10,,11]),console.info("[Facebook] loading ads: pacementId=",o),n.isLoading=!0,[4,n.instance.loadAsync()];case 9:return a.sent(),n.isLoading=!1,n.isReady=!0,console.info("[Facebook] load ads ready: pacementId=",o),[3,11];case 10:return u=a.sent(),console.warn("[Facebook] load ads failed: pacementId=",o,"\n Error: ",u),[2];case 11:return[3,13];case 12:n.isLoading=!1,console.info("[Facebook] ads already loaded or still loading: pacementId=",o),a.label=13;case 13:return[3,15];case 14:console.warn("[Facebook] get ads failed: pacementId=",o),a.label=15;case 15:return[2,n.isReady]}})})},e.prototype.isAdsReady=function(t){var e=l.Ads.getAdsId(t),o=p[e];return!c.default.isUndefinedOrNull(o)&&!c.default.isUndefinedOrNull(o.instance)&&!o.isLoading&&o.isReady},e.prototype.playAds=function(t){return i(this,void 0,Promise,function(){var e,o,n,r;return a(this,function(i){switch(i.label){case 0:if(!this.isAdsReady(t))return[2,!1];e=l.Ads.getAdsId(t),o=p[e],n=!1,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,o.instance.showAsync()];case 2:return i.sent(),n=!0,o.instance=null,o.isReady=!1,console.info("[Facebook] play ads done: pacementId=",e),[3,4];case 3:return r=i.sent(),n=!1,console.warn("[Facebook] play ads failed: pacementId=",e,"\n Error: ",r),[3,4];case 4:return[2,n]}})})},e.prototype.canCreateShortcut=function(){return i(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,FBInstant.canCreateShortcutAsync()];case 1:return[2,t.sent()]}})})},e.prototype.tryCreateShortcut=function(){return i(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return console.info("Try create shortcut"),[4,t.prototype.tryCreateShortcut.call(this)];case 1:return e.sent(),[4,FBInstant.createShortcutAsync()];case 2:return[2,e.sent()]}})})},e.prototype.canShare=function(){return!0},e.prototype.shareAsync=function(t){return i(this,void 0,void 0,function(){var e,o,n,r,i;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t?((e=t.intent)||(e="SHARE"),o=t.image,n=t.text,r=t.data,[4,FBInstant.shareAsync({intent:e,image:o,text:n,data:r})]):(console.warn("[Facebook] share failed, missing paramters"),[2]);case 1:return a.sent(),console.info("[Facebook] share success"),[3,3];case 2:return i=a.sent(),console.warn("[Facebook] share failed: ",i),[3,3];case 3:return[2]}})})},e.prototype.updateAsync=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,FBInstant.updateAsync(t)];case 1:return o.sent(),console.info("[Facebook] updateAsync success"),[3,3];case 2:return e=o.sent(),console.warn("[Facebook] updateAsync failed: ",e),[3,3];case 3:return[2]}})})},e.prototype.inviteAsync=function(t){return i(this,void 0,void 0,function(){var e,o;return a(this,function(n){switch(n.label){case 0:if(!t||!t.playerId)return[3,6];n.label=1;case 1:return n.trys.push([1,4,,5]),[4,FBInstant.context.createAsync(t.playerId)];case 2:return n.sent(),console.info("[Facebook] createAsync success, change to new context"),[4,this.loadContextDataAsync()];case 3:return n.sent(),[2,!0];case 4:return e=n.sent(),console.info("[Facebook] createAsync failed: ",e),console.info("[Facebook] stay in current context"),[2,!1];case 5:return[3,10];case 6:return n.trys.push([6,9,,10]),[4,FBInstant.context.chooseAsync(t)];case 7:return n.sent(),console.info("[Facebook] chooseAsync success, change to new context"),[4,this.loadContextDataAsync()];case 8:return n.sent(),[2,!0];case 9:return o=n.sent(),console.info("[Facebook] chooseAsync failed: ",o),console.info("[Facebook] stay in current context"),[2,!1];case 10:return[2]}})})},e.prototype.logEvent=function(t){console.info("[Logger] event: ",t.name,", value: ",t),FBInstant.logEvent(t.name,t.valueToSum,t.param)},e.prototype.canSwitchGame=function(){return!0},e.prototype.switchGameAsync=function(t,e){return i(this,void 0,void 0,function(){return a(this,function(o){switch(o.label){case 0:return[4,FBInstant.switchGameAsync(t,e)];case 1:return[2,o.sent()]}})})},e}(s.default);o.default=d,cc._RF.pop()},{"../../Framework/Utils/Utils":"Utils","../../Settings/AdsSettings":"AdsSettings","../../Settings/ProxyTypes":"ProxyTypes","../AccountProxy":"AccountProxy"}],Facebook:[function(t,e,o){"use strict";cc._RF.push(e,"63fc2YgPWZHhKNxYWDP0f08","Facebook");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.FB_ADS_TYPE=void 0;var i,a=t("../../Framework/Utils/Utils"),s={};(function(t){t[t.BANNER=0]="BANNER",t[t.POPUP=1]="POPUP",t[t.VIDEO=2]="VIDEO"})(i=o.FB_ADS_TYPE||(o.FB_ADS_TYPE={}));var c={isValid:function(){return a.default.isNotUndefinedOrNull(window._facebook)},canCreateShortcut:function(){return n(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,FBInstant.canCreateShortcutAsync()];case 1:return[2,t.sent()]}})})},tryCreateShortcut:function(){return n(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return console.info("Try create shortcut"),[4,FBInstant.createShortcutAsync()];case 1:return[2,t.sent()]}})})},prepareAds:function(t,e){return n(this,void 0,void 0,function(){var o,n,c,l,u,p;return r(this,function(r){switch(r.label){case 0:if(n=s[o="ADS#"+t],a.default.isUndefinedOrNull(n)&&(n={placementId:t,isReady:!1,isLoading:!1,instance:null},s[o]=n),!a.default.isUndefinedOrNull(n.instance))return[3,7];r.label=1;case 1:return r.trys.push([1,6,,7]),e!=i.VIDEO?[3,3]:(c=n,[4,FBInstant.getRewardedVideoAsync(t)]);case 2:return c.instance=r.sent(),[3,5];case 3:return l=n,[4,FBInstant.getInterstitialAdAsync(t)];case 4:l.instance=r.sent(),r.label=5;case 5:return s[o]=n,console.info("[Facebook] get ads ready: pacementId=",t),[3,7];case 6:return u=r.sent(),console.warn("[Facebook] get ads failed: pacementId=",t,"\n Error: ",u),[2];case 7:if(!a.default.isNotUndefinedOrNull(n.instance))return[3,14];if(n.isReady||n.isLoading)return[3,12];if(!a.default.isNotUndefinedOrNull(n.instance))return[3,11];r.label=8;case 8:return r.trys.push([8,10,,11]),console.info("[Facebook] loading ads: pacementId=",t),n.isLoading=!0,[4,n.instance.loadAsync()];case 9:return r.sent(),n.isLoading=!1,n.isReady=!0,console.info("[Facebook] load ads ready: pacementId=",t),[3,11];case 10:return p=r.sent(),console.warn("[Facebook] load ads failed: pacementId=",t,"\n Error: ",p),[2];case 11:return[3,13];case 12:n.isLoading=!1,console.info("[Facebook] ads already loaded or still loading: pacementId=",t),r.label=13;case 13:return[3,15];case 14:console.warn("[Facebook] get ads failed: pacementId=",t),r.label=15;case 15:return[2,n.isReady]}})})},isAdsReady:function(t){var e=s["ADS#"+t];return!a.default.isUndefinedOrNull(e)&&!a.default.isUndefinedOrNull(e.instance)&&!e.isLoading&&e.isReady},playAds:function(t){return n(this,void 0,Promise,function(){var e,o,n;return r(this,function(r){switch(r.label){case 0:if(!this.isAdsReady(t))return[2,!1];e=s["ADS#"+t],o=!1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.instance.showAsync()];case 2:return r.sent(),o=!0,e.instance=null,e.isReady=!1,console.info("[Facebook] play ads done: pacementId=",t),[3,4];case 3:return n=r.sent(),o=!1,console.warn("[Facebook] play ads failed: pacementId=",t,"\n Error: ",n),[3,4];case 4:return[2,o]}})})},saveDataAsync:function(t){return n(this,void 0,void 0,function(){var e;return r(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,FBInstant.player.setDataAsync(t)];case 1:return o.sent(),[3,3];case 2:return e=o.sent(),console.warn("[Facebook] setData failed: ",e),[3,3];case 3:return[2]}})})},loadDataAsync:function(t){return n(this,void 0,void 0,function(){var e;return r(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,FBInstant.player.getDataAsync(t)];case 1:return[2,o.sent()];case 2:return e=o.sent(),console.warn("[Facebook] getData failed, keys: ",t,"\n Error:",e),[3,3];case 3:return[2]}})})},setItem:function(t,e){return n(this,void 0,void 0,function(){var o,n;return r(this,function(r){switch(r.label){case 0:return o={},n=a.default.replaceAll(t,".","_"),o[n]=e,[4,this.saveDataAsync(o)];case 1:return[2,r.sent()]}})})},getItem:function(t){return n(this,void 0,void 0,function(){var e,o,n;return r(this,function(r){switch(r.label){case 0:return e=a.default.replaceAll(t,".","_"),[4,this.loadDataAsync([e])];case 1:return o=r.sent(),n=void 0,a.default.isUndefinedOrNull(o)||(n=o[e]),[2,n]}})})},shareAsync:function(t){return n(this,void 0,void 0,function(){var e,o,n,i,a;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t?((e=t.intent)||(e="INVITE"),o=t.image,n=t.text,i=t.data,[4,FBInstant.shareAsync({intent:e,image:o,text:n,data:i})]):(console.warn("[Facebook] share failed, missing paramters"),[2,!1]);case 1:return r.sent(),console.info("[Facebook] share success"),[2,!0];case 2:return a=r.sent(),console.warn("[Facebook] share failed: ",a),[2,!1];case 3:return[2,!1]}})})},inviteAsync:function(t){return n(this,void 0,void 0,function(){var e,o;return r(this,function(n){switch(n.label){case 0:if(!t||!t.playerId)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,FBInstant.context.createAsync(t.playerId)];case 2:return n.sent(),console.info("[Facebook] createAsync success, change to new context"),[2,!0];case 3:return e=n.sent(),console.info("[Facebook] createAsync failed: ",e),console.info("[Facebook] stay in current context"),[2,!1];case 4:return[3,8];case 5:return n.trys.push([5,7,,8]),[4,FBInstant.context.chooseAsync(t)];case 6:return n.sent(),console.info("[Facebook] chooseAsync success, change to new context"),[2,!0];case 7:return o=n.sent(),console.info("[Facebook] chooseAsync failed: ",o),console.info("[Facebook] stay in current context"),[2,!1];case 8:return[2]}})})},loadContextDataAsync:function(){return n(this,void 0,void 0,function(){var t,e;return r(this,function(o){switch(o.label){case 0:if(this._context.id=FBInstant.context.getID(),this._context.type=FBInstant.context.getType(),console.info("[Facebook] current context: ","id:"+FBInstant.context.getID()+", type:"+FBInstant.context.getType()),!FBInstant.context.isSizeBetween(2,null))return[3,5];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,FBInstant.context.getPlayersAsync()];case 2:return t=o.sent(),console.info("[Facebook] players : ",t),[3,4];case 3:return e=o.sent(),console.warn("[Facebook] get context players failed: ",e),[3,4];case 4:return[3,6];case 5:console.info("[Facebook] context size is 1"),o.label=6;case 6:return[2]}})})},updateAsync:function(t){return n(this,void 0,void 0,function(){var e;return r(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,FBInstant.updateAsync(t)];case 1:return o.sent(),console.info("[Facebook] updateAsync success"),[3,3];case 2:return e=o.sent(),console.warn("[Facebook] updateAsync failed: ",e),[3,3];case 3:return[2]}})})},getLocale:function(){var t=FBInstant.getLocale();console.info("[Facebook] locale: ",t);var e=t.split("_");return{languageCode:e[0],countryCode:e[1]}},canSubscribeToBot:function(){return n(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,FBInstant.player.canSubscribeBotAsync()];case 1:return[2,t.sent()];case 2:return t.sent(),[3,3];case 3:return[2,!1]}})})},trySubscribeBot:function(){return n(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,FBInstant.player.canSubscribeBotAsync()];case 1:return t.sent()?[4,FBInstant.player.subscribeBotAsync()]:[3,3];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:return t.sent(),[3,5];case 5:return[2]}})})},logEvent:function(t){FBInstant.logEvent(t.name,t.valueToSum,t.param)}};o.default=c,cc._RF.pop()},{"../../Framework/Utils/Utils":"Utils"}],FeedCommands:[function(t,e,o){"use strict";cc._RF.push(e,"8031d2PyMZHxJa/vMfH4iCT","FeedCommands");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../Data/KittyPlaygroundProxy"),c=t("../../../GameKit/Framework/Controller/SimpleCommand"),l=t("../KittyConsts"),u=t("../KittyGuide"),p=t("../KittyApp"),d=t("../Data/KittyDB"),f=(t("../KittyResouces"),t("../../../GameKit/Framework/Ads/AdsManager")),h=t("../Data/KittyConfig"),y=t("../../../GameKit/Tpcl/Baidu/Baidu"),_={PREPARE:"Prepare.Feed.Kitty.Cmd",START:"Start.Feed.Kitty.Cmd",SPAWN:"Spawn.Kitty.Cmd"},v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){var t;return a(this,function(){return this.hasProxy(l.default.PROXIES.KITTY_PLAYGROUND)?t=this.retrieveProxy(l.default.PROXIES.KITTY_PLAYGROUND):(t=s.default.create(l.default.PROXIES.KITTY_PLAYGROUND),this.getFacade().registerProxy(t)),t.init(),[2]})})},e}(c.default),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){var t,e,o,n,r,i,s;return a(this,function(a){switch(a.label){case 0:return[4,(t=this.retrieveProxy(l.default.PROXIES.KITTY_PLAYGROUND)).load()];case 1:return a.sent(),console.info("[cache] loading ... 3"),(e=this.retrieveMediator(l.default.MEDIATORS.KITTY_PLAYGROUND))&&e.startFeedingKitty(),(o=this.retrieveMediator(l.default.MEDIATORS.KITTY_HOME))&&o.startFeedingKitty(),(n=this.retrieveMediator(l.default.MEDIATORS.HUD))&&n.updateData(),r=!1,h.default.isBaidu()&&y.default.isNewVersionReady()&&(r=!0,y.default.tryApplyNewVersion()),r?[3,3]:(u.default.getInstance().prepare(),[4,u.default.getInstance().testGuide()]);case 2:a.sent()||(t.getTotalProduceRate(),this.retrieveProxy(l.default.PROXIES.TASK).getUnlockedLevel()>1&&(i=this.retrieveProxy(l.default.PROXIES.INVENTORY),s=i.getOfflineCoin(),this.sendNotification(l.default.EVENTS.OFFLINE_COIN,s))),p.default.playLobbyBgm(),f.default.getInstance().showBannerAds(!1),a.label=3;case 3:return[2]}})})},e}(c.default),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(t){return i(this,void 0,void 0,function(){var e,o,n,r,i;return a(this,function(){return e=t.getUserData(),(o=this.retrieveMediator(l.default.MEDIATORS.KITTY_PLAYGROUND)).hasEmptyCell()?!e.ignoreWarning&&(n=o.getKittyCountByLevel(e.level),r=this.retrieveProxy(l.default.PROXIES.TASK),i=r.getUnlockedLevel(),e.level<i-7&&n%2==0)?(p.default.playSound(l.default.SOUNDS.NO),this.sendNotification(l.default.EVENTS.LOW_LEVEL_KITTY,e),[2]):(m(this.getFacade(),e),[2]):(p.default.playSound(l.default.SOUNDS.NO),this.sendNotification(l.default.EVENTS.NO_MORE_SPACE,e),[2])})})},e}(c.default);function m(t,e){return i(this,void 0,void 0,function(){var o,n,r,i,s;return a(this,function(a){switch(a.label){case 0:return o=t.retrieveProxy(l.default.PROXIES.INVENTORY),n=t.retrieveProxy(l.default.PROXIES.TASK),o&&o.canBuy(e.price,e.unit)?(r=t.retrieveMediator(l.default.MEDIATORS.KITTY_PLAYGROUND)).hasEmptyCell()?(o.spend(e.price,e.unit),o.save(),i=d.default.getInstance().getIdFromLevel(e.level),s=e.level,[3,2]):[3,3]:[3,5];case 1:a.sent()&&(s+=1),a.label=2;case 2:return(i=r.spawnItem(s))>0&&(n.addSpawnCounter(e.level,i),n.save()),[3,4];case 3:p.default.playSound(l.default.SOUNDS.NO),t.sendNotification(l.default.EVENTS.NO_MORE_SPACE,e),a.label=4;case 4:return[3,6];case 5:console.warn("[SpawnKittyCommand] not enough money: ",e),t.sendNotification(l.default.EVENTS.NOT_ENOUGH_MONEY,{price:e.price,unit:e.unit}),a.label=6;case 6:return[2]}})})}var w={COMMANDS:_,registerToFacade:function(t){t.registerCommand(_.PREPARE,v),t.registerCommand(_.START,g),t.registerCommand(_.SPAWN,b)}};o.default=w,cc._RF.pop()},{"../../../GameKit/Framework/Ads/AdsManager":"AdsManager","../../../GameKit/Framework/Controller/SimpleCommand":"SimpleCommand","../../../GameKit/Tpcl/Baidu/Baidu":"Baidu","../Data/KittyConfig":"KittyConfig","../Data/KittyDB":"KittyDB","../Data/KittyPlaygroundProxy":"KittyPlaygroundProxy","../KittyApp":"KittyApp","../KittyConsts":"KittyConsts","../KittyGuide":"KittyGuide","../KittyResouces":"KittyResouces"}],GameApp:[function(t,e,o){"use strict";cc._RF.push(e,"3419ekJ0CBJyYzyZ1sjac09","GameApp");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/Extension/SingleNode"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enableCollision=!1,e.enablePhysics=!1,e.enablePhysicsDebug=!1,e.gravity=cc.v2(0,-10),e.gameScene="game",e}return r(e,t),e.prototype._onloaded=function(){return a(this,void 0,void 0,function(){return s(this,function(){return t.prototype._onloaded.call(this),this.enableCollision&&(cc.director.getCollisionManager().enabled=!0),this.enablePhysics&&(cc.director.getPhysicsManager().enabled=!0,cc.director.getPhysicsManager().gravity=this.gravity),this.onAppStart(),[2]})})},e.prototype.onAppStart=function(){this.enablePhysics&&this.enablePhysicsDebug&&(cc.director.getPhysicsManager().debugDrawFlags=cc.PhysicsManager.DrawBits.e_aabbBit|cc.PhysicsManager.DrawBits.e_pairBit|cc.PhysicsManager.DrawBits.e_centerOfMassBit|cc.PhysicsManager.DrawBits.e_jointBit|cc.PhysicsManager.DrawBits.e_shapeBit)},e.prototype.loadGameScene=function(){cc.director.loadScene(this.gameScene)},i([p],e.prototype,"enableCollision",void 0),i([p],e.prototype,"enablePhysics",void 0),i([p],e.prototype,"enablePhysicsDebug",void 0),i([p],e.prototype,"gravity",void 0),i([p],e.prototype,"gameScene",void 0),i([u],e)}(c.default);o.default=d,cc._RF.pop()},{"../Framework/Extension/SingleNode":"SingleNode"}],GameEditor:[function(t,e,o){"use strict";cc._RF.push(e,"fbb06SoKlxJCKLfx9OX2+s+","GameEditor");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/GamePlay/BasePlayground"),l=t("../../../GameKit/App/AppFacade"),u=t("../../../GameKit/Settings/CommandTypes"),p=t("../Game/LevelData"),d=t("../Game/Grid"),f=t("../../../GameKit/Framework/Utils/Utils"),h=t("./BoardEditor"),y=t("../../../GameKit/Settings/ProxyTypes"),_=cc._decorator,v=_.ccclass,g=_.property,b=-1,m=!1,w="",S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.board=null,e.txtWidth=null,e.txtHeight=null,e.gridPrefabs=[],e.levelBasePath=null,e.txtLevelIdx=null,e.overrideOption=null,e._width=9,e._height=9,e._selectGridType=d.GRID_TYPE.WALKABLE,e._beginEdit=!1,e}return r(e,t),e.prototype.start=function(){if(l.default.getInstance()){var t=l.default.getInstance().retrieveProxy(y.default.MATCH);this._match=t,this.board.setPrefabs(this.gridPrefabs[0],this.gridPrefabs),b<0&&(b=t.getLevel()),this.setLevelIdx(b),this.overrideOption.isChecked=m,(w=localStorage.getItem("RES"))&&w.length>0&&(this.levelBasePath.string=w);var e=t.getLevelData();e?(this._width=e.getWidth(),this._height=e.getHeight(),this.txtWidth.string=this._width.toString(),this.txtHeight.string=this._height.toString(),this.board.loadLevelData(e)):this.loadLevel(b)}},e.prototype.onTouchBegin=function(t){this._beginEdit=!0;var e=t.getLocation(),o=this.board.node.convertToNodeSpaceAR(e);this._trySetGrid(this._selectGridType,o)},e.prototype.onTouchMove=function(t){if(this._beginEdit){var e=t.getLocation(),o=this.board.node.convertToNodeSpaceAR(e);this._trySetGrid(this._selectGridType,o)}},e.prototype.onTouchEnd=function(){this._beginEdit=!1},e.prototype.onTouchCancel=function(){this._beginEdit=!1},e.prototype._trySetGrid=function(t,e){var o=this.board.positionToGrid(e);this.board.isInBoard(o)&&(100==t?this.board.setStart(o)&&this.board.updateReachability():101==t?this.board.setEnd(o):this.board.setGrid(t,o)&&(t!=d.GRID_TYPE.WALKABLE||this.board.hasStart()||this.board.setStart(o),this.board.updateCorners(),this.board.updateReachability()))},e.prototype.onAddWidth=function(t,e){var o=parseInt(e);this._width+=o,this.txtWidth&&(this.txtWidth.string=this._width.toString())},e.prototype.onAddHeight=function(t,e){var o=parseInt(e);this._height+=o,this.txtHeight&&(this.txtHeight.string=this._height.toString())},e.prototype.onApplySize=function(){this.board.initBoard(this._width,this._height)},e.prototype.onPlay=function(){var t=this.board.toLevelData();t&&(this._match.setLevelData(t),this._match.setEditMode(!0),l.default.getInstance().executeCommand(u.default.PLAY_NEW_MATCH,{level:b,editMode:!0}))},e.prototype.onGridTypeChange=function(t,e){this._selectGridType=parseInt(e)},e.prototype.onLoadLevel=function(){this.loadLevel(b)},e.prototype.onOverrideChange=function(t){m=t.isChecked},e.prototype.setState=function(t){this.txtLevelIdx.node.color=0==t?cc.Color.BLACK:t<0?cc.Color.RED:cc.Color.GREEN},e.prototype.loadLevel=function(t){return a(this,void 0,void 0,function(){var e,o,n,r,i,a,c,l;return s(this,function(s){switch(s.label){case 0:e="level/"+t,s.label=1;case 1:if(s.trys.push([1,5,,6]),this.setState(0),o=void 0,n=this.levelBasePath.string,r=n+"/level/"+b.toString()+".json",!cc.sys.isNative)return[3,2];try{if(!jsb.fileUtils.isFileExist(r))return console.warn("[Editor] load file fail, url=",r,", error: ","File not exists"),this.setState(-1),[2,!1];i=jsb.fileUtils.getStringFromFile(r),o=JSON.parse(i)}catch(u){return console.warn("[Editor] load file fail, url=",r,", error: ",u),this.setState(-1),[2,!1]}return[3,4];case 2:return[4,f.default.loadRes(e)];case 3:if((a=s.sent()).error)return console.warn("[Editor] can't load level: ",e),this.setState(-1),[2,!1];o=a.resource.json,s.label=4;case 4:return(c=p.default.create(this._width,this._height,d.GRID_TYPE.UNKNOWN)).setGridData(o._grids,o._width),c.setStartsData(o._starts),this._width=c.getWidth(),this._height=c.getHeight(),this.txtWidth.string=c.getWidth().toString(),this.txtHeight.string=c.getHeight().toString(),this.board.loadLevelData(c),this.setState(1),[2,!0];case 5:return l=s.sent(),console.warn("[Editor] load level failed, url: ",e,", error: ",l),[3,6];case 6:return[2]}})})},e.prototype.onSaveLevel=function(){return a(this,void 0,void 0,function(){var t,e,o,n;return s(this,function(){if(!cc.sys.isNative)return this.setState(0),console.warn("[Editor] Can't save file on non-native platform"),[2];if(this.setState(0),t=this.levelBasePath.string,e=t+"/level/"+b.toString()+".json",!this.overrideOption.isChecked&&jsb.fileUtils.isFileExist(e))return console.warn("[Editor] Save failed: not override"),this.setState(-1),[2];if(o=this.board.toLevelData()){if(this._match.setLevelData(o),n=JSON.stringify(o),!cc.sys.isNative)return console.warn("[Editor] Can't save file on non-native platform"),[2];jsb.fileUtils.writeStringToFile(n,e)?(this.setState(1),localStorage.setItem("RES",t)):this.setState(-1)}else console.warn("[Editor] save failed, invalid level data"),this.setState(-1);return[2]})})},e.prototype.setLevelIdx=function(t){this.txtLevelIdx.string=t.toString(),b=t},e.prototype.onAddLevelIdx=function(t,e){var o=parseInt(e);NaN!=o&&(b+=o,this.setLevelIdx(b))},e.prototype.onNewLevel=function(){this.onApplySize()},e.prototype.onTestPath=function(){this.board.updateReachability()},e.prototype.onRandomLevel=function(){var t=p.default.createRandomLevel(this._width,this._height,10);this.board.loadLevelData(t),this.board.updateReachability()},e.prototype._resetRandomLevel=function(){},e.prototype.onNextMove=function(){},i([g(h.default)],e.prototype,"board",void 0),i([g(cc.Label)],e.prototype,"txtWidth",void 0),i([g(cc.Label)],e.prototype,"txtHeight",void 0),i([g(cc.Prefab)],e.prototype,"gridPrefabs",void 0),i([g(cc.EditBox)],e.prototype,"levelBasePath",void 0),i([g(cc.Label)],e.prototype,"txtLevelIdx",void 0),i([g(cc.Toggle)],e.prototype,"overrideOption",void 0),i([v],e)}(c.default);o.default=S,cc._RF.pop()},{"../../../GameKit/App/AppFacade":"AppFacade","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/GamePlay/BasePlayground":"BasePlayground","../../../GameKit/Settings/CommandTypes":"CommandTypes","../../../GameKit/Settings/ProxyTypes":"ProxyTypes","../Game/Grid":"Grid","../Game/LevelData":"LevelData","./BoardEditor":"BoardEditor"}],GameFacade:[function(t,e,o){"use strict";cc._RF.push(e,"df0285APxlPT6kEEHCA66Ac","GameFacade");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/App/AppFacade"),l=t("../../../GameKit/Settings/ProxyTypes"),u=t("../Match/MatchProxy"),p=t("./ConfigDB"),d=t("./PlayerProxy"),f=t("../../../GameKit/App/AppProxy"),h=cc._decorator,y=h.ccclass,_=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.createProxy=function(e,o){var n;switch(e){case l.default.ACCOUNT:n=this.createAccountProxy();break;case l.default.PLAYER:n=d.default.create(l.default.PLAYER);break;case l.default.MATCH:n=u.default.create(l.default.MATCH);break;default:n=t.prototype.createProxy.call(this,e,o)}return n},e.prototype.registerGlobalProxies=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i,a;return s(this,function(s){switch(s.label){case 0:return[4,p.default.load()];case 1:return s.sent(),t=f.default.create(),this.registerProxy(t),e=this.createProxy(l.default.DOWNLOAD_CACHE),this.registerProxy(e),(o=this.createAccountProxy()).name=l.default.ACCOUNT,this.registerProxy(o),[4,o.init()];case 2:return s.sent(),n=this.createProxy(l.default.PLAYER),this.registerProxy(n),r=this.createProxy(l.default.INVENTORY),this.registerProxy(r),i=this.createProxy(l.default.MATCH),this.registerProxy(i),a=this.createProxy(l.default.ADS),this.registerProxy(a),[2]}})})},i([y],e)}(c.default));o.default=_,cc._RF.pop()},{"../../../GameKit/App/AppFacade":"AppFacade","../../../GameKit/App/AppProxy":"AppProxy","../../../GameKit/Settings/ProxyTypes":"ProxyTypes","../Match/MatchProxy":"MatchProxy","./ConfigDB":"ConfigDB","./PlayerProxy":"PlayerProxy"}],GameScene:[function(t,e,o){"use strict";cc._RF.push(e,"8c90d1Mj/9JLJDb5LWx14qp","GameScene");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/App/AppFacade"),l=t("../../../GameKit/Settings/CommandTypes"),u=t("../../../GameKit/Settings/MediatorType"),p=t("../../../GameKit/Framework/Scene/SceneControl"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startMatchOnLoad=!1,e}return r(e,t),e.prototype._onStart=function(){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return t.prototype._onStart.call(this),[4,c.default.getInstance().retrieveMediator(u.default.MATCH).newMatch()];case 1:return e.sent(),this.startMatchOnLoad?[4,c.default.getInstance().executeCommand(l.default.START_MATCH)]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2]}})})},i([h],e.prototype,"startMatchOnLoad",void 0),i([f],e)}(p.default);o.default=y,cc._RF.pop()},{"../../../GameKit/App/AppFacade":"AppFacade","../../../GameKit/Framework/Scene/SceneControl":"SceneControl","../../../GameKit/Settings/CommandTypes":"CommandTypes","../../../GameKit/Settings/MediatorType":"MediatorType"}],GridNode:[function(t,e,o){"use strict";cc._RF.push(e,"8ba12dTpNRNLZheAISq3Xmw","GridNode");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./Grid"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._sprite=null,e}return r(e,t),e.prototype.onLoad=function(){this._grid=this.getComponent(a.default),this._grid?this._sprite=this.getComponent(cc.Sprite):console.warn("[GridNode] missing Grid component!")},e.prototype.start=function(){},i([c],e)}(cc.Component));o.default=l,cc._RF.pop()},{"./Grid":"Grid"}],Grid:[function(t,e,o){"use strict";cc._RF.push(e,"1e0ceyRcpFPFLDeuvUc2nYs","Grid");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.GRID_DIR=o.GRID_TYPE=o.INVALID_GRID=void 0;var a=cc._decorator,s=a.ccclass,c=a.property;o.INVALID_GRID=cc.v2(-1,-1),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.MIN=0]="MIN",t[t.UNWALKABLE=0]="UNWALKABLE",t[t.WALKABLE=1]="WALKABLE"}(o.GRID_TYPE||(o.GRID_TYPE={})),o.GRID_DIR={NONE:cc.v2(0,0),UP:cc.v2(0,1),DOWN:cc.v2(0,-1),LEFT:cc.v2(-1,0),RIGHT:cc.v2(1,0)};var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gridType=-1,e}return r(e,t),i([c],e.prototype,"gridType",void 0),i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],HeartEffect:[function(t,e,o){"use strict";cc._RF.push(e,"b638fBC8MtLEpfczzq7tUUD","HeartEffect");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text=null,e.icon=null,e}return r(e,t),e.prototype.play=function(t,e){return a(this,void 0,void 0,function(){var o,n,r,i,a,c,l=this;return s(this,function(){return t&&(this.text.string=t),this.node.setScale(.1),this.node.opacity=255,o=cc.moveBy(.5,0,15),(n=cc.scaleTo(.5,1)).easing(cc.easeBackOut()),r=cc.spawn(o,n),i=cc.delayTime(.25),a=cc.fadeOut(.25),c=cc.callFunc(function(){l.node.active=!1,e&&e(l)}),this.node.runAction(cc.sequence(r,i,a,c)),[2]})})},i([u(cc.Label)],e.prototype,"text",void 0),i([u(cc.Sprite)],e.prototype,"icon",void 0),i([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],HiddenKitty:[function(t,e,o){"use strict";cc._RF.push(e,"2c8b5pD8jNH4quU5OLfJkOs","HiddenKitty");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Framework/Utils/UIHelper"),s=t("../../../GameKit/Framework/Utils/Utils"),c=t("../../../GameKit/App/AppFacade"),l=t("../KittyConsts"),u=cc._decorator,p=u.ccclass,d=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._y0=0,e._hidden=!1,e}return r(e,t),e.prototype.onLoad=function(){this._y0=this.node.y,this._parepare()},e.prototype.start=function(){},e.prototype._parepare=function(){var t=this.getComponent(cc.Button);t||(t=this.addComponent(cc.Button)),t.transition=cc.Button.Transition.NONE,a.default.bindClickEvent(this.node,this._onClick.bind(this))},e.prototype._onClick=function(){this._hidden||this._hide()},e.prototype._hide=function(){var t=this;this._hidden||(this._hidden=!0,this.node.runAction(cc.sequence(cc.callFunc(function(){c.default.getInstance().sendNotification(l.default.EVENTS.HIDDEN_KITTY_CLICKED,{kitty:t.node})}),cc.moveTo(.25,this.node.x,this._y0-this.node.height/2),cc.delayTime(s.default.randomFloat(5,10)),cc.moveTo(1,this.node.x,this._y0),cc.callFunc(function(){t._hidden=!1}))))},i([p],e)}(cc.Component));o.default=d,cc._RF.pop()},{"../../../GameKit/App/AppFacade":"AppFacade","../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/Framework/Utils/Utils":"Utils","../KittyConsts":"KittyConsts"}],HttpRequest:[function(t,e,o){"use strict";cc._RF.push(e,"1e2f3YdZwNNpZ9CWv6L8zTB","HttpRequest");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i={GET:"GET",POST:"POST"};function a(t,e){for(var o in e)cc.log("header["+o+"]=["+e[o]+"]"),e[o]&&t.setRequestHeader(o,e[o])}function s(t){return t==i.GET}function c(t){return t==i.POST}var l=function(){function t(){}return t.Send=function(t,e,o){return n(this,void 0,void 0,function(){return r(this,function(){return[2,new Promise(function(n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState==XMLHttpRequest.DONE){var t=!0;r.status>=200&&r.status<400&&(t=!1);var e={error:t,status:r.status,response:{type:r.responseType,text:r.responseText,rawData:r.response},xhr:r};n(e)}},o&&o.data&&s(t)&&o.data,r.open(t,e,!0),o&&o.header&&a(r,o.header),c(t)&&o&&o.data?r.send(o.data):r.send()})]})})},t.Get=function(e,o){return n(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,t.Send("GET",e,o)];case 1:return[2,n.sent()]}})})},t.Post=function(e,o){return n(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,t.Send("POST",e,o)];case 1:return[2,n.sent()]}})})},t.METHOD=i,t}();o.default=l,cc._RF.pop()},{}],ImageResize:[function(t,e,o){"use strict";cc._RF.push(e,"ded03Y4CWJKTIj7bjBadt7l","ImageResize");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.designResolution=cc.size(640,1136),e.fitHeight=!0,e}return r(e,t),e.prototype.onLoad=function(){this._resize()},e.prototype._resize=function(){var t,e=cc.winSize,o=e.height,n=e.width;t=this.fitHeight?o/this.designResolution.height:n/this.designResolution.width,this.node.scale=t},i([c(cc.Size)],e.prototype,"designResolution",void 0),i([c],e.prototype,"fitHeight",void 0),i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],InputControl:[function(t,e,o){"use strict";cc._RF.push(e,"36f17vGrJBHc4gGNakbB+Vu","InputControl");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Utils/Utils"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._onTouchBegin=null,e._onTouchMove=null,e._onTouchEnd=null,e._onTouchCancel=null,e}return r(e,t),e.prototype.onEnable=function(){this.registerEvent()},e.prototype.onDisable=function(){this.unregisterEvent()},e.prototype.registerEvent=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegin,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)},e.prototype.unregisterEvent=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegin,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)},e.prototype.setHandler=function(t,e,o,n){this._onTouchBegin=t,this._onTouchMove=e,this._onTouchEnd=o,this._onTouchCancel=n},e.prototype.onTouchBegin=function(t){return a.default.isNotUndefinedOrNull(this._onTouchBegin)&&this._onTouchBegin(t),!0},e.prototype.onTouchMove=function(t){return a.default.isNotUndefinedOrNull(this._onTouchMove)&&this._onTouchMove(t),!0},e.prototype.onTouchEnd=function(t){return a.default.isNotUndefinedOrNull(this._onTouchEnd)&&this._onTouchEnd(t),!0},e.prototype.onTouchCancel=function(t){return a.default.isNotUndefinedOrNull(this._onTouchCancel)&&this._onTouchCancel(t),!0},i([c],e)}(cc.Component));o.default=l,cc._RF.pop()},{"../Utils/Utils":"Utils"}],InputType:[function(t,e,o){"use strict";var n;cc._RF.push(e,"dde2e5XSShHda6bYDogBGPe","InputType"),Object.defineProperty(o,"__esModule",{value:!0}),function(t){t[t.NONE=0]="NONE",t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT"}(n||(n={})),o.default=n,cc._RF.pop()},{}],InventoryProxy:[function(t,e,o){"use strict";cc._RF.push(e,"75e52wJ6dtEuadXKfvsxaBs","InventoryProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,u=(c.property,t("../Framework/Model/Proxy")),p=t("../Framework/Utils/Utils"),d=t("../Settings/ProxyTypes"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isDirty=!1,e}var o;return r(e,t),o=e,e.create=function(t){var e=new o;return e.name=t,e.init(),e},e.prototype.init=function(){this.updateFromData(void 0)},e.prototype.onFirstStart=function(){this.updateFromData(void 0)},e.prototype.updateFromData=function(t){p.default.isUndefinedOrNull(t)&&(t={money:0,props:[]}),this._inventory=t,p.default.isUndefinedOrNull(this._inventory.money)&&(this._inventory.money=0),p.default.isUndefinedOrNull(this._inventory.props)&&(this._inventory.props=[]),this.data=this._inventory,this._isDirty=!0},e.prototype.ownProp=function(t){this.isPropOwned(t)||(this._inventory.props.push(t),this._isDirty=!0)},e.prototype.isPropOwned=function(t){for(var e=!1,o=0;o<this._inventory.props.length;o++)if(this._inventory.props[o]==t){e=!0;break}return e},e.prototype.getMoney=function(){return this._inventory.money},e.prototype.addMoney=function(t){return this._inventory.money+=t,this._isDirty=!0,this.sendNotification(o.EVENTS.MONEY_UPDATE,this.getMoney()),this._inventory.money},e.prototype.spendMoney=function(t){return this._inventory.money-=t,this._isDirty=!0,this.sendNotification(o.EVENTS.MONEY_UPDATE,this.getMoney()),this._inventory.money},e.prototype.buyItem=function(t,e){return a(this,void 0,void 0,function(){var n;return s(this,function(){return n=this.spendMoney(e),this.ownProp(t),this._isDirty=!0,this.sendNotification(o.EVENTS.OWN_NEW_PROP,t),[2,n]})})},e.prototype.isDirty=function(){return this._isDirty},e.prototype.save=function(){return a(this,void 0,void 0,function(){var t,e,n;return s(this,function(r){switch(r.label){case 0:return this.isDirty()?(t=this.getFacade().retrieveProxy(d.default.ACCOUNT),(e={})[o.KEY]=this.data,[4,t.saveDataAsync(e)]):[2];case 1:return n=r.sent(),this._isDirty=!1,[2,n]}})})},e.EVENTS={MONEY_UPDATE:"inventory.money.update",OWN_NEW_PROP:"inventory.owned.new.prop.event"},e.KEY="inventory",o=i([l],e)}(u.default);o.default=f,cc._RF.pop()},{"../Framework/Model/Proxy":"Proxy","../Framework/Utils/Utils":"Utils","../Settings/ProxyTypes":"ProxyTypes"}],Item:[function(t,e,o){"use strict";cc._RF.push(e,"4d1d9PZWBlEHZ52MmC8yAgq","Item");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.level=1,e.avatar=null,e}return r(e,t),i([c(cc.Label)],e.prototype,"label",void 0),i([c],e.prototype,"level",void 0),i([c(cc.Sprite)],e.prototype,"avatar",void 0),i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],JobGroup:[function(t,e,o){"use strict";cc._RF.push(e,"a2dbePYjwxG/ZoZmnKIPeW1","JobGroup");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createJobGroup=function(t,o){var n=new e(t);return n.setFinishHander(o),n},e.createJob=function(t,o){var n=new e(t);return o&&(n.setJobBeginHandler(o.onBeginHandler),n.setJobUpdateHandler(o.onUpdateHandler),n.setFinishHander(o.onFinishHandler),n.setCancelHandler(o.tryCancelHandler)),n},e.prototype._generateJob=function(e){t.prototype._generateJob.call(this,e),this._jobs=[],this._newJobs=[]},e.prototype.addJob=function(t){this._newJobs.push(t),this.isFinished()&&this.setFinished(!1)},e.prototype._cleanUp=function(){var t=[];this._jobs.forEach(function(e){e.isFinished()&&t.push(e)}),cc.js.array.removeArray(this._jobs,t),this._jobs=this._jobs.concat(this._newJobs),this._newJobs=[]},e.prototype._onBegin=function(){t.prototype._onBegin.call(this),this._cleanUp(),this._jobs.forEach(function(t){t.begin()})},e.prototype._onUpdate=function(e){var o=t.prototype._onUpdate.call(this,e);return this._jobs.forEach(function(t){if(t.isNew())t.begin(),o=!1;else{var n=t.update(e);n||(o=n)}}),this._cleanUp(),o},e.prototype._tryCancel=function(){this._cleanUp();var e=t.prototype._tryCancel.call(this);return this._jobs.forEach(function(t){var o=t.cancel();o||(e=o)}),e},e.prototype.pause=function(){this._cleanUp(),this._jobs.forEach(function(t){t.pause()}),t.prototype.pause.call(this)},e.prototype.resume=function(){this._cleanUp(),this._jobs.forEach(function(t){t.resume()}),t.prototype.resume.call(this)},e.prototype.hasPendingJob=function(){return this._newJobs.length>0||this._jobs.length>0},e}(t("./Job").default);o.default=i,cc._RF.pop()},{"./Job":"Job"}],JobQueue:[function(t,e,o){"use strict";cc._RF.push(e,"4bce3BVGh5KoZV97gNd4Qd+","JobQueue");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Job"),a=t("./TimerJob"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createJobQueue=function(t,o){var n=new e(t);return o&&(n.setJobBeginHandler(o.onBeginHandler),n.setJobUpdateHandler(o.onUpdateHandler),n.setFinishHander(o.onFinishHandler),n.setCancelHandler(o.tryCancelHandler)),n},e.createJob=function(t,o){var n=new e(t);return o&&(n.setJobBeginHandler(o.onBeginHandler),n.setJobUpdateHandler(o.onUpdateHandler),n.setFinishHander(o.onFinishHandler),n.setCancelHandler(o.tryCancelHandler)),n},e.prototype._generateJob=function(e){t.prototype._generateJob.call(this,e),this._queue=[]},e.prototype._onBegin=function(){t.prototype._onBegin.call(this),this._pickNextJob(!0)},e.prototype._onUpdate=function(e){return t.prototype._onUpdate.call(this,e),!this._currentJob||this._currentJob.isFinished()?this._pickNextJob(!0):this._currentJob.update(e),null==this._currentJob},e.prototype._onFinished=function(){t.prototype._onFinished.call(this),this._currentJob=null},e.prototype._tryCancel=function(){var e=t.prototype._tryCancel.call(this);return this._cancelAll(),e},e.prototype._pickNextJob=function(t){return this._currentJob=null,this._queue.length>0&&(this._currentJob=this._queue.shift(),this.debug("pick next job: ",this._currentJob),t&&this._currentJob&&this._currentJob.begin()),this._currentJob},e.prototype.pushSimpleJob=function(t,e){var o=i.default.createSimpleJob(t,e);this.appendJob(o)},e.prototype.appendJob=function(t){this.debug("[JobQueue.pushJob] ",t._name),this._queue.push(t),this.isFinished()&&this.setFinished(!1)},e.prototype.appendTimer=function(t){var e=a.default.createTimerJob(t);this.appendJob(e)},e.prototype.hasPendingJob=function(){return!!this._currentJob||this._queue.length>0},e.prototype._cancelAll=function(){for(this._currentJob&&this._currentJob.cancel();this._queue.length>0;)this._currentJob=this._pickNextJob(!1),this._currentJob.cancel();this._currentJob=null},e}(i.default);o.default=s,cc._RF.pop()},{"./Job":"Job","./TimerJob":"TimerJob"}],JobSystem:[function(t,e,o){"use strict";cc._RF.push(e,"3a22crDAzRE5ZZDRl+cDbY7","JobSystem"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Job"),r=t("../Utils/Utils"),i=t("./TimerJob"),a=function(){function t(){this._jobs=[],this._newJobs=[]}return t.prototype.createJob=function(){return n.default.createJob()},t.prototype.addNewJob=function(t){return this._newJobs.push(t),this},t.prototype.appendJob=function(t){var e;return this._jobs.length>0?e=this._jobs[0]:this._newJobs.length>0&&(e=this._newJobs[0]),r.default.isUndefinedOrNull(e)?this._newJobs.push(t):e.addNextJob(t),this},t.prototype.appendSimpleJob=function(t,e){var o=n.default.createSimpleJob(t,e);return this.appendJob(o)},t.prototype.appendTimer=function(t){var e=i.default.createTimerJob(t);return this.appendJob(e)},t.prototype._cleanup=function(){var t=this,e=[];this._jobs.forEach(function(o){if(o.isFinished()){e.push(o);var n=o.getNextJob();n&&t._newJobs.push(n)}if(o.hasSiblings()){var r=o.removeSiblings();t._newJobs=t._newJobs.concat(r)}}),cc.js.array.removeArray(this._jobs,e),this._jobs=this._jobs.concat(this._newJobs),this._newJobs=[]},t.prototype.begin=function(){this._cleanup()},t.prototype.update=function(t){var e=this;this._jobs.forEach(function(o){o?e._runJob(o,t):console.warn("[JobSystem] invliad job")}),this._cleanup()},t.prototype._runJob=function(t,e){t.isNew()?t.begin():t.update(e)},t.prototype.cancel=function(){this._newJobs.forEach(function(t){t.cancel()}),this._jobs.forEach(function(t){t.cancel()}),this._jobs=[]},t.prototype.pause=function(){this._jobs.forEach(function(t){t.pause()})},t.prototype.resume=function(){this._jobs.forEach(function(t){t.resume()})},t.prototype.cancelAll=function(){},t.prototype.hasPendingJobs=function(){if(this._newJobs.length>0)return!0;var t=0;return this._jobs.forEach(function(e){!e.isFinished()||e.hasNextJob()||e.hasSiblings()||t++}),t!=this._jobs.length},t}();o.default=a,cc._RF.pop()},{"../Utils/Utils":"Utils","./Job":"Job","./TimerJob":"TimerJob"}],Job:[function(t,e,o){"use strict";cc._RF.push(e,"f59bb9WRstJlK9Te605YnFu","Job"),Object.defineProperty(o,"__esModule",{value:!0}),o.JOB_STATE=void 0;var n,r=t("../Utils/Utils");(function(t){t[t.NEW=0]="NEW",t[t.RUNNING=1]="RUNNING",t[t.PAUSED=2]="PAUSED",t[t.FINISHED=3]="FINISHED"})(n=o.JOB_STATE||(o.JOB_STATE={}));var i=function(){function t(t){this._nextJob=void 0,this._siblings=[],this._state=n.NEW,this._name="",this._generateJob(t),this.debug("Create Job")}return t.prototype.debug=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o]},t.createJob=function(e,o){var n=new t(e);return o&&(n.setJobBeginHandler(o.onBeginHandler),n.setJobUpdateHandler(o.onUpdateHandler),n.setFinishHander(o.onFinishHandler),n.setCancelHandler(o.tryCancelHandler)),n},t.createSimpleJob=function(e,o){return t.createJob({name:o},{onBeginHandler:e})},t.prototype.setJobBeginHandler=function(t){this._onJobBeginHandler=t},t.prototype.setJobUpdateHandler=function(t){this._onJobUpdateHandler=t},t.prototype.setFinishHander=function(t){this._onJobFinishedHandler=t},t.prototype.setCancelHandler=function(t){this._tryCancelHandler=t},t.prototype.setLazyGenerator=function(t,e){this._jobGeneratorConfig=t,this._jobGenerator=e},t.prototype._lazyGenerate=function(){var t=this._jobGenerator(this._jobGeneratorConfig);this._generateJob(t)},t.prototype._generateJob=function(t){t&&(this._param=t,t.name&&(this._name=t.name))},t.prototype.getParam=function(){return this._param},t.prototype.begin=function(){this._jobGenerator&&(this._lazyGenerate(),this.debug("lazy generate")),this.debug("begin"),this._onBegin(),this._onJobBeginHandler&&this._onJobBeginHandler(this,this._param)},t.prototype._onBegin=function(){this._state=n.RUNNING},t.prototype.update=function(t){if(this.isFinished())return!0;if(this.isPaused())return!1;var e=this._onUpdate(t);return this._onJobUpdateHandler&&(e=this._onJobUpdateHandler(this,t,this._param)),e&&this._finish(),e},t.prototype._onUpdate=function(){return!0},t.prototype.cancel=function(){if(this.isNew()||this.isFinished())return!0;this.debug("cancel job");var t=!1;return t=this._tryCancel(),this._tryCancelHandler&&(t=this._tryCancelHandler(this)),t&&(this.setFinished(!0),this._onCanceled(),this._onJobFinishedHandler&&this._onJobFinishedHandler(this,!0)),t},t.prototype._tryCancel=function(){return this.debug("try cancel"),!0},t.prototype._onCanceled=function(){},t.prototype._finish=function(){this.debug("finish"),this.setFinished(!0),this._onFinished(),this._onJobFinishedHandler&&this._onJobFinishedHandler(this,!1)},t.prototype._onFinished=function(){},t.prototype.isFinished=function(){return this._state==n.FINISHED},t.prototype.setFinished=function(t){this._state=t?n.FINISHED:n.RUNNING},t.prototype.pause=function(){this.isRunning()&&(this._state=n.PAUSED)},t.prototype.resume=function(){this.isPaused()&&(this._state=n.RUNNING)},t.prototype.isNew=function(){return this._state==n.NEW},t.prototype.isRunning=function(){return this._state==n.RUNNING},t.prototype.isPaused=function(){return this._state==n.PAUSED},t.prototype.isStopped=function(){return this._state==n.FINISHED||this._state==n.PAUSED},t.prototype.addSiblingJob=function(t){return this._siblings.push(t),this},t.prototype.spawn=function(t){return this.addSiblingJob(t)},t.prototype.getSiblings=function(){return this._siblings},t.prototype.hasSiblings=function(){return this._siblings.length>0},t.prototype.removeSiblings=function(){if(this._siblings.length>0){var t=this._siblings;return this._siblings=[],t}return[]},t.prototype.addNextJob=function(t){return this._nextJob?this._nextJob.addNextJob(t):this._nextJob=t,t},t.prototype.appendToEnd=function(t){return this.addNextJob(t)},t.prototype.appendAsChild=function(t){return this.hasNextJob()?this._nextJob.spawn(t):this.addNextJob(t)},t.prototype.appendTo=function(t,e){return e?t.appendAsChild(this):t.appendToEnd(this),t},t.prototype.insertAsChild=function(t){return this.hasNextJob()&&t.appendAsChild(this._nextJob),this.addNextJob(t)},t.prototype.getNextJob=function(){return this._nextJob},t.prototype.hasNextJob=function(){return r.default.isNotUndefinedOrNull(this._nextJob)},t}();o.default=i,cc._RF.pop()},{"../Utils/Utils":"Utils"}],Jumpy:[function(t,e,o){"use strict";cc._RF.push(e,"616f60scAlM8KQKX5V3ohN0","Jumpy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.height=70,e.time=.5,e._speed=0,e._acc=0,e._dist=0,e._dir=1,e._time=0,e}return r(e,t),e.prototype.onLoad=function(){this._acc=this.height/(this.time*this.time),this._dir=-1,this._y0=this.node.y,this._speed=this._acc*this.time},e.prototype.update=function(t){var e=this._speed,o=this._speed+this._acc*t*this._dir,n=(e+o)*t/2;this._dist+=n,this.node.y=this._y0+this._dist,this._speed=o,this.node.y<this._y0&&(this._dir=-1,this.node.y=this._y0,this._speed=this._acc*this.time),this.node.y>this._y0+this.height&&(this._dir=1,this.node.y=this._y0+this.height,this._speed=0)},i([c],e.prototype,"height",void 0),i([c],e.prototype,"time",void 0),i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],KFPlayground:[function(t,e,o){"use strict";cc._RF.push(e,"d1becKkNOhM86C0Gy8iud9N","KFPlayground");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c,l=t("../../FillUp/Script/Game/LevelData"),u=t("./CardboardBox"),p=t("../../GameKit/Framework/Utils/Utils"),d=t("../../GameKit/Framework/GamePlay/InputControl"),f=t("../../GameKit/App/AppFacade"),h=cc._decorator,y=h.ccclass,_=h.property,v=[{width:1,height:1,count:1,grids:[1]},{width:2,height:1,count:2,grids:[1,1]},{width:1,height:2,count:2,grids:[1,1]},{width:2,height:2,count:3,grids:[1,1,1,0]},{width:3,height:1,count:3,grids:[1,1,1]},{width:1,height:3,count:3,grids:[1,1,1]},{width:3,height:2,count:4,grids:[1,1,1,1,0,0]},{width:3,height:2,count:4,grids:[1,1,1,0,1,0]},{width:3,height:2,count:5,grids:[1,1,1,1,1,0]},{width:3,height:2,count:5,grids:[1,1,1,1,0,1]},{width:3,height:2,count:5,grids:[1,0,1,1,1,1]},{width:3,height:2,count:6,grids:[1,1,1,1,1,1]},{width:2,height:3,count:4,grids:[1,1,1,0,1,0]},{width:2,height:3,count:5,grids:[1,1,1,1,1,0]},{width:2,height:3,count:5,grids:[1,1,1,0,1,1]},{width:2,height:3,count:6,grids:[1,1,1,1,1,1]},{width:3,height:3,count:5,grids:[0,1,0,0,1,0,1,1,1]},{width:3,height:3,count:5,grids:[0,1,0,1,1,1,0,1,0]},{width:3,height:3,count:6,grids:[1,0,1,1,0,1,1,0,1]},{width:3,height:3,count:7,grids:[1,0,1,1,0,1,1,1,1]},{width:3,height:3,count:7,grids:[1,0,1,1,1,1,1,0,1]},{width:3,height:3,grids:[1,0,1,1,1,1,1,0,0]},{width:3,height:3,grids:[1,0,1,1,1,1,0,1,0]},{width:3,height:3,grids:[1,0,1,1,1,1,1,1,1]},{width:3,height:3,grids:[1,1,1,1,0,0,1,0,0]},{width:3,height:3,grids:[1,1,1,0,1,0,0,1,0]},{width:3,height:3,grids:[1,1,1,1,1,0,1,0,0]},{width:3,height:3,grids:[1,1,1,1,1,0,0,1,0]},{width:3,height:3,grids:[1,1,1,1,0,1,1,0,0]},{width:3,height:3,grids:[1,1,1,1,0,1,0,1,0]},{width:3,height:3,grids:[1,1,1,1,1,0,1,1,0]},{width:3,height:3,grids:[1,1,1,1,1,0,0,1,1]},{width:3,height:3,grids:[1,1,1,1,0,1,1,0,1]},{width:3,height:3,grids:[1,1,1,1,0,1,1,1,0]},{width:3,height:3,grids:[1,1,1,1,0,1,1,1,1]},{width:3,height:3,grids:[1,1,1,1,1,1,1,0,0]},{width:3,height:3,grids:[1,1,1,1,1,1,0,1,0]},{width:3,height:3,grids:[1,1,1,1,1,1,1,1,0]},{width:3,height:3,grids:[1,1,1,1,1,1,1,0,1]},{width:3,height:3,grids:[1,1,1,1,1,1,1,1,1]},{width:4,height:1,grids:[1,1,1,1]},{width:4,height:1,grids:[1,1,1,1,1,0,0,1]},{width:4,height:1,grids:[1,1,1,1,0,1,1,0]}];(function(){for(var t=0;t<v.length;t++){for(var e=v[t],o=0,n=0;n<e.grids.length;n++)e.grids[n]>0&&o++;e.count=o}v.sort(function(t,e){return t.count-e.count})})(),function(t){t[t.PREPARE=0]="PREPARE",t[t.READY=1]="READY",t[t.PLAY=2]="PLAY",t[t.SHOW_KITTY=3]="SHOW_KITTY",t[t.HIDE_KITTY=4]="HIDE_KITTY",t[t.END_GAME=5]="END_GAME"}(c||(c={}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cardboardBoxPrefab=null,e.playarea=null,e.input=null,e.shadow=null,e._boxes=[],e._kittyCount=0,e._showedBoxes=[],e._state=c.END_GAME,e._timer=0,e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){this.input.setHandler(this.onTouchBegin.bind(this),this.onTouchMove.bind(this),this.onTouchEnd.bind(this),this.onTouchCancel.bind(this))},e.prototype.onTouchBegin=function(t){var e=t.touch.getLocation();this._boxes.forEach(function(t){t.testClick(e)})},e.prototype.onTouchMove=function(){},e.prototype.onTouchEnd=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.onTouchCancel=function(){},e.prototype._selectLayout=function(t,e){var o=0;e<=0&&(o=p.default.randomInt(0,v.length));for(var n=v[o];e>0&&(n.count<t||n.count>e);)o=p.default.randomInt(0,v.length),n=v[o];return n},e.prototype.prepareGame=function(t,e){return a(this,void 0,void 0,function(){var n,r;return s(this,function(i){switch(i.label){case 0:return this._showedBoxes=[],this.shadow.active=!1,n=this._selectLayout(t,e),(r=l.default.create(n.width,n.height,0)).setGridData(n.grids,n.width),p.default.random()>.5&&r.flipX(),this.setPlayhouse(r),[4,p.default.waitFor(100)];case 1:return i.sent(),cc.isValid(this.node)&&this.node.active&&f.default.getInstance().sendNotification(o.EVENTS.GAME_READY),[2]}})})},e.prototype.resetGame=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this._boxes.forEach(function(t){t.resetKitty()}),[4,p.default.waitFor(100)];case 1:return t.sent(),cc.isValid(this.node)&&this.node.active&&f.default.getInstance().sendNotification(o.EVENTS.GAME_READY),[2]}})})},e.prototype.update=function(t){switch(this._timer+=t,this._state){case c.PREPARE:this._timer>=.1&&(this._timer=0,this._state=c.READY,f.default.getInstance().sendNotification(o.EVENTS.GAME_READY));break;case c.READY:break;case c.PLAY:this._timer>=1&&this._showKitty();break;case c.SHOW_KITTY:this._timer>=2&&this._hideKitty();break;case c.HIDE_KITTY:this._timer>=2&&(this._timer=0,this._state=c.END_GAME,f.default.getInstance().sendNotification(o.EVENTS.GAME_END));break;case c.END_GAME:}},e.prototype.setPlayhouse=function(t){return a(this,void 0,void 0,function(){var e,o,n,r,i,a,c,l,d,f,h,y,_;return s(this,function(){for(this.playarea.removeAllChildren(),this._kittyCount=0,this._boxes=[],e=[],r=0;r<t.getWidth();r++)o=this.getPosition(t.getWidth(),t.getHeight(),r,0),(n=cc.instantiate(this.shadow)).active=!0,n.setParent(this.playarea),n.setPosition(o.x+50,o.y+10);for(r=0;r<t.getWidth();r++)for(i=0;i<t.getHeight();i++)t.getGridType(cc.v2(r,i))>0&&(a=this.addBoxAt(t.getWidth(),t.getHeight(),r,i),c=t.getGridType(cc.v2(r,i+1)),l=t.getGridType(cc.v2(r-1,i)),d=t.getGridType(cc.v2(r+1,i)),t.getWidth()>3&&(0==r&&(l=99),r>=t.getWidth()-1&&(d=99)),0==l&&(t.getGridType(cc.v2(r-1,i+1))>0||t.getGridType(cc.v2(r-1,i-1))>0)&&(l=99),a.setNeighbour(c,l,d),f=p.default.random()>.5,c>0&&l>0&&d>0&&(f=!0),a.setWindow(f),c<=0&&(h=p.default.random()>.5,y=u.ROOF_STYLE.NONE,h?i===t.getHeight()-1?(_=p.default.random()>.5,y=_?u.ROOF_STYLE.TOWER:u.ROOF_STYLE.CASTLE):y=u.ROOF_STYLE.CASTLE:y=u.ROOF_STYLE.NONE,a.setRoofStyle(y),y===u.ROOF_STYLE.TOWER&&e.push(a)),a.setFlag(!1),a.setRandomKitty(0),this._boxes.push(a),this._kittyCount+=a.getKittyCount());return e.length>0&&p.default.randomItemInArray(e).value.setFlag(!0),this._boxes.forEach(function(t){t.resetKitty()}),[2]})})},e.prototype.getKittyCount=function(){return this._kittyCount},e.prototype.playGame=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this._state=c.PLAY,this._timer=0,[2]})})},e.prototype._showKitty=function(){if(this._state=c.SHOW_KITTY,this._timer=0,this._showedBoxes.length<=0){var t=Math.ceil(this._kittyCount*p.default.randomFloat(.2,.8)),e=p.default.randomItems(this._boxes,t);this._showedBoxes=e}this._showedBoxes.forEach(function(t){t.value.show(.9,1)})},e.prototype._hideKitty=function(){this._state=c.HIDE_KITTY,this._timer=0,this._showedBoxes.forEach(function(t){t.value.hide(!0)})},e.prototype.stopGame=function(){this._state=c.END_GAME,this._timer=0},e.prototype.addBoxAt=function(t,e,o,n){var r=this.getPosition(t,e,o,n),i=cc.instantiate(this.cardboardBoxPrefab);i.setParent(this.playarea),i.setPosition(r);var a=i.getComponent(u.default);return a.setGrid(cc.v2(o,n)),a},e.prototype.getPosition=function(t,e,o,n){var r=150*(o-t/2)-15,i=150*n+-this.playarea.height/2;return cc.v2(r,i)},e.EVENTS={GAME_READY:"Kitty.Finding.Game.Ready",GAME_END:"Kitty.Finding.Game.End"},i([_(cc.Prefab)],e.prototype,"cardboardBoxPrefab",void 0),i([_(cc.Node)],e.prototype,"playarea",void 0),i([_(d.default)],e.prototype,"input",void 0),i([_(cc.Node)],e.prototype,"shadow",void 0),o=i([y],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../FillUp/Script/Game/LevelData":"LevelData","../../GameKit/App/AppFacade":"AppFacade","../../GameKit/Framework/GamePlay/InputControl":"InputControl","../../GameKit/Framework/Utils/Utils":"Utils","./CardboardBox":"CardboardBox"}],KMCountdownEffect:[function(t,e,o){"use strict";cc._RF.push(e,"9e63c0avslLDZWDA0VrLOOA","KMCountdownEffect");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.container=null,e.msg=null,e.bgMask=null,e}return r(e,t),e.prototype.play=function(t,e,o){var n=this;this.msg.string=t,this.container.setPosition(500,0),this.container.opacity=255,this.container.setScale(.1);var r,i=cc.scaleTo(.5,1);i.easing(cc.easeBackOut()),(r=cc.moveTo(.5,0,0)).easing(cc.easeBackOut());var a=cc.spawn(i,r),s=cc.moveTo(.3,-500,0);s.easing(cc.easeBackIn());var c=cc.callFunc(function(){n.stopAndHide()});if(o?this.container.runAction(cc.sequence(a,s,c)):this.container.runAction(a),e){this.bgMask.opacity=150,this.bgMask.active=!0;var l=cc.fadeTo(.25,50),u=cc.fadeTo(.25,150),p=cc.sequence(l,u).repeat(1);this.bgMask.runAction(cc.sequence(p,cc.callFunc(function(){n.bgMask.active=!1})))}},e.prototype.stopAndHide=function(){this.container.stopAllActions(),this.bgMask.stopAllActions(),this.node.active=!1,this.bgMask.active=!1},i([c(cc.Node)],e.prototype,"container",void 0),i([c(cc.Label)],e.prototype,"msg",void 0),i([c(cc.Node)],e.prototype,"bgMask",void 0),i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],KMJobs:[function(t,e,o){"use strict";cc._RF.push(e,"d0f7btb9vdF3os9BPPqp+kb","KMJobs"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../../GameKit/Framework/Utils/Utils"),r=t("../../GameKit/Framework/Pool/PoolManager"),i=t("./KMPlayground"),a=t("./KMScoreEffect"),s=t("../../GameKit/Framework/JobSystem/Job"),c=t("../../GameKit/Framework/JobSystem/ActionJob"),l=t("../../Kitty/Script/KittyApp"),u=t("../../Kitty/Script/KittyConsts"),p=t("../../GameKit/Framework/i18n/i18n"),d={creatSpawnJob:function(t,e,o,n){return void 0===o&&(o=5),void 0===n&&(n=0),s.default.createSimpleJob(t.spawn.bind(t,e,o,n),"KMP.Spawn."+e)},createScoreEffectJob:function(t,e,o,s,c,l,u,p){void 0===p&&(p=cc.Color.BLACK);var d=n.default.convertPositionInNode1ToNode2SpaceAR(e,t.playArea,t.effectLayer),f=r.default.getInstance().get(i.default.NAMES.SCORE_NODE);f.active=!0,f.setParent(t.effectLayer),f.setPosition(d);var h=f.getComponent(a.default).createPlayJob(o,s,c,l,p,u);return h.setFinishHander(function(){r.default.getInstance().put(f,i.default.NAMES.SCORE_NODE)}),h},createBonusEffectJob:function(t,e){var o=d.createScoreEffectJob(t,e.pos,e.value,e.title,0,!0,.1,e.color);return e.ball.getBonus()!=i.KITTY_BALL_BONUS.STAR&&o.spawn(s.default.createSimpleJob(function(){l.default.playSound(u.default.SOUNDS.BONUS)})),o},createApplyBonusJob:function(t,e,o){return s.default.createSimpleJob(t.applyBonus.bind(t,e,o),"applyBonus:"+e.getBonus())},createRemoveJobForBall:function(t,e){var o=e.node.getPosition(),n=e.createOpenAnimationJob();n.setFinishHander(function(o,n){n&&(e.node.active=!1,e.setScore(-1,!1),r.default.getInstance().put(e.node,t.ballPrefab),cc.js.array.remove(t._tempBalls,e))});var i=c.default.createActionJob({name:"CollectBall"});if(i.setLazyGenerator(void 0,t._collectKittyBall.bind(t,e)),i.setJobBeginHandler(function(){e.node.active=!1,e.setScore(-1,!1),r.default.getInstance().put(e.node,t.ballPrefab),cc.js.array.remove(t._tempBalls,e)}),i.setFinishHander(function(t){t&&t._node&&(t._node.active=!1,t._node.destroy())}),n.appendAsChild(i),e.isBonus()){var a=t.getBonusInfo(e),s=d.createBonusEffectJob(t,a),l=d.createApplyBonusJob(t,e,o);n.appendAsChild(s),n.appendAsChild(l)}return n},createShowCombo:function(t,e){e.score;var o=e.count,n=(e.combo,e.bonusCount,e.effectBallPos);if(o>=9){var r=p.default.textWithVar("ui.match.kitty.combo.msg","\u8fde\u7eed\u6d88\u9664${value}\u4e2a",o);return d.createScoreEffectJob(t,n,r,"",0,!0,0,cc.Color.RED)}return null},createShowScore:function(t,e){var o=e.score,n=e.count,r=e.combo,i=e.bonusCount,a=e.effectBallPos,s=0;if(r>0&&(s+=.1),n>=5||i>0){var c=0;n>5&&(c=(n-5)/5);var l="",u=n-2;u<0&&(u=0);var f=p.default.value("ui.match.kitty.score.msgs");if(u>=f.length){var h=u-f.length+1;for(l="";h>0;)l+="!",h--;l=f[f.length-1]+l}else l=f[u];return d.createScoreEffectJob(t,a,"+"+o,l,c,!1,s,cc.Color.BLACK)}return null},createRemoveBallsJob:function(t,e){if(!(e.length<=0)){t.hideQuickTip();var o=s.default.createJob(),r=void 0;e.forEach(function(e){var n=d.createRemoveJobForBall(t,e);o.spawn(n),r||(r=n)});var a=t.getScoreForBalls(e),c=s.default.createSimpleJob(function(){t.addChainScore(a)},"addScore:"+a.score),l=d.createShowCombo(t,a),u=d.createShowScore(t,a),p=Math.floor(e.length/5);p=t._context==i.KM_CONTEXT.TIMEUP?0:n.default.randomInt(0,p+1);var f=d.creatSpawnJob(t,e.length,5,p);return r.appendAsChild(c).appendAsChild(f),l&&r.appendAsChild(l),u&&r.appendAsChild(u),o}},createSkillJob:function(){return s.default.createJob()}};o.default=d,cc._RF.pop()},{"../../GameKit/Framework/JobSystem/ActionJob":"ActionJob","../../GameKit/Framework/JobSystem/Job":"Job","../../GameKit/Framework/Pool/PoolManager":"PoolManager","../../GameKit/Framework/Utils/Utils":"Utils","../../GameKit/Framework/i18n/i18n":"i18n","../../Kitty/Script/KittyApp":"KittyApp","../../Kitty/Script/KittyConsts":"KittyConsts","./KMPlayground":"KMPlayground","./KMScoreEffect":"KMScoreEffect"}],KMJob:[function(t,e){"use strict";cc._RF.push(e,"24f4aWgKKJC2adsTOERaHwE","KMJob"),cc._RF.pop()},{}],KMPlayground:[function(t,e,o){"use strict";cc._RF.push(e,"50de514TAtKqY+6cJs6V/5w","KMPlayground");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.KMData=o.KM_CONTEXT=o.KITTY_BALL_OP=o.KITTY_BALL_BONUS=void 0;var c,l,u=t("../../GameKit/Framework/GamePlay/InputControl"),p=t("../../GameKit/Framework/Utils/Utils"),d=t("./KittyBall"),f=t("../../GameKit/Framework/Pool/PoolManager"),h=t("./TimeCounter"),y=t("../../GameKit/App/AppFacade"),_=t("../../Kitty/Script/KittyResouces"),v=t("../../Kitty/Script/Data/KittyDB"),g=t("../../Kitty/Script/KittyConsts"),b=t("./KMSkillEffect"),m=t("./KMSkillProgress"),w=t("./KMScoreEffect"),S=t("../../GameKit/Framework/JobSystem/ActionJob"),P=t("../../GameKit/Framework/JobSystem/Job"),O=t("../../GameKit/Framework/JobSystem/JobGroup"),E=t("./KMJobs"),A=t("../../GameKit/Framework/JobSystem/JobSystem"),T=t("../../GameKit/Framework/JobSystem/TimerJob"),R=t("../../GameKit/Framework/JobSystem/NestedJob"),I=t("./KMCountdownEffect"),C=t("../../Kitty/Script/KittyApp"),N=t("../../GameKit/Framework/i18n/i18n"),k=cc._decorator,x=k.ccclass,D=k.property,K=[["#4ef390","#4ef390","#c0ffd9"],["#ffabdc","#f271bc","#f5d0e6"],["#d06637","#d1793f","#f3c88b"],["#ffd800","#eab015","#fff1a1"],["#20e6e8","#1bbdbf","#bceff0"]];(function(t){t[t.NONE=0]="NONE",t[t.TIME=1]="TIME",t[t.SCOREx2=2]="SCOREx2",t[t.SCOREx3=3]="SCOREx3",t[t.EXTRA_SCORE=4]="EXTRA_SCORE",t[t.STAR=5]="STAR",t[t.BONUS_MAX=6]="BONUS_MAX"})(c=o.KITTY_BALL_BONUS||(o.KITTY_BALL_BONUS={})),function(t){t[t.NONE=0]="NONE",t[t.SPAWN=1]="SPAWN",t[t.REMOVE=2]="REMOVE",t[t.SKILL=3]="SKILL",t[t.WAIT=4]="WAIT"}(o.KITTY_BALL_OP||(o.KITTY_BALL_OP={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.PLAYING=1]="PLAYING",t[t.TIMEUP=2]="TIMEUP"}(l=o.KM_CONTEXT||(o.KM_CONTEXT={}));var F=function(){function t(){this.counter=[],this.combo=0,this.totalScore=0,this.maxChain=0}return t.prototype.init=function(t){this.counter=p.default.createArray(t,0),this.combo=0,this.totalScore=0,this.maxChain=0,this.totalRemove=0},t.prototype.addScore=function(t){this.totalScore+=t},t.prototype.addCombo=function(t){this.combo+=t},t.prototype.addRemoved=function(t){this.totalRemove+=t},t.prototype.setChain=function(t){this.maxChain<t&&(this.maxChain=t)},t.prototype.addCounter=function(t,e){this.counter[t]+=e},t.prototype.addCounters=function(t){var e=this;t.forEach(function(t,o){e.counter[o]+=t})},t}();o.KMData=F;var U=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.input=null,e.playArea=null,e.topBar=null,e.spawnPosition=null,e.effectLayer=null,e.tplScoreEffect=null,e.tplSkillMark=null,e.tplBombMark=null,e.ballPrefab=null,e.linesContainer=null,e.dots=null,e.timerCounter=null,e.scoreLabel=null,e.comboLabel=null,e.assemblyPosition=null,e.skillEffect=null,e.skillProgress=null,e.startBar=null,e.countdownEffect=null,e.quickTip=null,e.kitties=[],e.endMask=null,e._gameDidStart=!1,e._balls=[],e._selected=null,e._linked=[],e._tempBalls=[],e._lines=[],e._scoreNodes=[],e._skillMarks=[],e._counter=0,e._finished=!1,e._ballTypes=[],e._totalTypes=4,e._skillType=0,e._skillTargetValue=0,e._skillPlayTimes=0,e._skillCounter=0,e._skillReady=!1,e._taskQueue=[],e._taskCounter=0,e._tipTimer=0,e._inited=!1,e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){this.playArea.active=!1,this.dots.active=!1,this.input.setHandler(this.onTouchBegin.bind(this),this.onTouchMove.bind(this),this.onTouchEnd.bind(this),this.onTouchCancel.bind(this)),this.input.enabled=!1,this.hideSkillEffect(),this.tplScoreEffect.node.active=!1,this.tplSkillMark.active=!1,this.tplBombMark.active=!1,this.countdownEffect.stopAndHide(),this.quickTip.active=!1,this._tipTimer=0,this._context=l.UNKNOWN,this._data=new F},e.prototype.onTouchBegin=function(t){var e=t.touch.getLocation();e=this.playArea.convertToNodeSpaceAR(e),this.testSelectBall(e)&&this._updateLinkedBalls()},e.prototype.onTouchMove=function(t){var e=t.touch.getLocation();e=this.playArea.convertToNodeSpaceAR(e),this.testSelectBall(e)&&this._updateLinkedBalls()},e.prototype.onTouchEnd=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(){return e=t.touch.getLocation(),e=this.playArea.convertToNodeSpaceAR(e),this.removeSelectedAndLinked(),[2]})})},e.prototype.onTouchCancel=function(){this._unselect()},e.prototype.init=function(){this._inited||(this._inited=!0,f.default.getInstance().initPool({tplNode:this.dots,initSize:0,maxSize:-1}),f.default.getInstance().initPool({poolName:o.NAMES.SCORE_NODE,tplNode:this.tplScoreEffect.node,initSize:1,maxSize:-1,handlerComp:w.default}),f.default.getInstance().initPool({poolName:o.NAMES.SKILL_MARK,tplNode:this.tplSkillMark,initSize:10,maxSize:-1}),f.default.getInstance().initPool({poolName:o.NAMES.BOMB_MARK,tplNode:this.tplBombMark,initSize:8,maxSize:-1}),f.default.getInstance().initPool({tplPrefab:this.ballPrefab,initSize:30,maxSize:40,handlerComp:d.default}),this._jobSystem=new A.default)},e.prototype.startGame=function(){return a(this,void 0,void 0,function(){var t,e,n,r,i,a=this;return s(this,function(){return this._finished||this.endGame(),this._tempBalls.length>0&&console.warn("KM.Start: unremoved balls: ",this._tempBalls.length),this._context=l.PLAYING,this._finished=!1,this._data.init(5),this.setScore(0),this.setCombo(0),this._balls=[],this._selected=null,this._linked=[],this._updateLinkedLines(),this._updateLinkedScore(),this.playArea.active=!0,this.linesContainer.setPosition(this.playArea.getPosition()),this._taskQueue=[],this._taskCounter=0,this.prepareBallTypes(5),this._skillPlayTimes=0,this._skillReady=!1,this.resetSkillTarget(),this.hideSkillEffect(),this.countdownEffect.stopAndHide(),this.timerCounter.setTimer(45,!0,0,function(){a.onTimeout()}),this.endMask.active=!1,this.timerCounter.setInterval(1,function(t,e){var o=t.getTargetTime()-e;if(o>=1&&5==o){a.countdownEffect.node.active=!0;var n=N.default.textWithVar("ui.match.kitty.countdown","\u8fd8\u6709${value}\u79d2",o);a.countdownEffect.play(n,!0,!0),C.default.playSound(g.default.SOUNDS.CLOCK)}else if(0==o){a.countdownEffect.node.active=!0,n=N.default.text("ui.match.kitty.timeout","\u65f6\u95f4\u5230~~~"),a.countdownEffect.play(n,!1,!1),C.default.playSound(g.default.SOUNDS.END),a._jobSystem.addNewJob(T.default.createTimerJob({duration:2}));var r=S.default.createActionJob({node:a.endMask,name:"ending"});a.endMask.opacity=0,a.endMask.active=!0;var i=cc.fadeTo(1,150);r.appendAction(i),a._jobSystem.addNewJob(r)}}),this._tipTimer=0,(t=R.default.createNestedJob(this._createStartAnimationJob.bind(this,.3))).setFinishHander(function(){}),e=p.default.randomInt(0,3),n=R.default.createNestedJob(E.default.creatSpawnJob.bind(E.default,this,36,6,e)),r=P.default.createSimpleJob(function(){a.input.enabled=!0,y.default.getInstance().sendNotification(o.EVENTS.GAME_READY)},"KMP.EnableInput"),(i=this._jobSystem.createJob()).appendToEnd(t).appendToEnd(n).appendToEnd(r),this._jobSystem.addNewJob(i),this._jobSystem.begin(),[2]})})},e.prototype._createStartAnimationJob=function(t){var e=this,o=S.default.createActionJob({node:this.startBar,name:"KMP.StartBar"});this.startBar.scaleY=1;var n=cc.callFunc(function(){e.startBar.scaleY=-1}),r=cc.delayTime(t),i=cc.callFunc(function(){e.startBar.scaleY=1});return o.appendAction(n),o.appendAction(r),o.appendAction(i),o},e.prototype.prepareBallTypes=function(t){var e=this;this._totalTypes=t,this._ballTypes=[];var o=v.default.getInstance().getAllKitties();p.default.randomValuesBetween(0,o.length+1,t).forEach(function(t){if(t>=o.length){var n=_.default.getInstance().getImage("Dog");e._ballTypes.push(n)}else{var r=o[t];e._ballTypes.push(r.avatar)}});for(var n=0;n<this.kitties.length;n++)this.kitties[n].spriteFrame=this._ballTypes[n]},e.prototype.getBallConfigs=function(){return{colors:K,avatars:this._ballTypes}},e.prototype.resetSkillTarget=function(){this._skillPlayTimes<=0?this._skillType=p.default.randomInt(0,this._ballTypes.length):this._skillType=p.default.randomValueBetweenAndNotInList(0,this._ballTypes.length,[this._skillType]),this._skillCounter=0,this._skillTargetValue=10;var t=this._ballTypes[this._skillType];this.skillProgress.setSkillAvatar(t),this.skillProgress.setTotalValue(this._skillTargetValue,!0),this.skillProgress.setColor(K[this._skillType]),this._skillReady=!1},e.prototype.addChainScore=function(t){this.addScore(t.score),this.addCombo(t.combo),this._data.addRemoved(t.count),this._data.setChain(t.count),this._data.addCounters(t.counters)},e.prototype.setScore=function(t){this._data.totalScore=t,this.scoreLabel.string=this._data.totalScore.toString()},e.prototype.addScore=function(t){this.setScore(this._data.totalScore+t)},e.prototype.setCombo=function(t){this._data.combo=t,this.comboLabel.string=this._data.combo.toString()},e.prototype.addCombo=function(t){this.setCombo(this._data.combo+t)},e.prototype.onTimeout=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this._context=l.TIMEUP,this.input.enabled=!1,this.timerCounter.pause(),this._removeBallsOnTimeout(),[2]})})},e.prototype._checkGameFinished=function(){this._finished||!this._gameDidStart||this._jobSystem.hasPendingJobs()||(this.timerCounter.getTimeLeft()<=0?this._removeBallsOnTimeout()<=0&&(this._finished=!0,this._gameDidStart=!1,y.default.getInstance().sendNotification(o.EVENTS.GAME_DID_FINISED)):(this.timerCounter.resume(),this.input.enabled=!0,this.endMask.active=!1))},e.prototype._beginTask=function(){this._taskCounter++},e.prototype._endTask=function(){this._taskCounter--,this._taskCounter<0&&console.warn("Invalid task counter: ",this._taskCounter)},e.prototype._removeBallsOnTimeout=function(){this._unselect();var t=[];return this._getActiveBalls(-1).forEach(function(e){!e.isRemoved()&&e.isBonus()&&(t.push(e),e.markRemoved(!0))}),t.length>0&&(cc.js.array.removeArray(this._balls,t),this._tempBalls=this._tempBalls.concat(t)),this._addToRemoveQueue(t),t.length},e.prototype._clearPlayArea=function(){},e.prototype.endGame=function(){var t=this;this._gameDidStart=!1,this._finished=!1,this.input.enabled=!1,this.timerCounter.stop(),this.skillProgress.resetProgress(),this._balls.forEach(function(e){f.default.getInstance().put(e.node,t.ballPrefab)}),this._balls=[],this._taskQueue=[],this._jobSystem.cancel(),this._tempBalls.forEach(function(e){f.default.getInstance().put(e.node,t.ballPrefab)}),this._tempBalls=[],this._clearPlayArea(),this._selected=null,this._linked=[],this._updateLinkedLines(),this._updateLinkedScore(),this.playArea.active=!1,y.default.getInstance().sendNotification(o.EVENTS.GAME_END)},e.prototype.spawn=function(t,e,o){return void 0===e&&(e=5),void 0===o&&(o=0),a(this,void 0,void 0,function(){var n,r,i,a,l,u,h,y,_,v,g,b;return s(this,function(){for(n=this.spawnPosition.x,r=this.spawnPosition.y,i=[],o>0&&(i=p.default.randomValuesBetween(0,t,o)),a=0,g=0;g<t;g++)g>0&&g%e==0&&a++,(l=f.default.getInstance().get(this.ballPrefab)).active=!0,l.setParent(this.playArea),u=n+1.1*l.width*(this._counter%e+.5-e/2),h=r+2*l.height*a,l.setPosition(u,h),b=l.getComponent(d.default),y=p.default.randomInt(0,5),_=this._ballTypes[y],b.setBallType(y,K[y],_),o>0&&cc.js.array.contains(i,g)?(v=p.default.randomInt(c.NONE,c.BONUS_MAX),b.setBonus(!0,v)):b.setBonus(!1,0),this._balls.push(b),this._counter++;for(g=0;g<this._balls.length;g++)((b=this._balls[g]).isRemoved()||p.default.isUndefinedOrNull(b.node)||p.default.isUndefinedOrNull(b.node.parent))&&console.warn("[KMPlayground] invalid ball: ",b);return this._balls.length>36&&console.warn("[KMPlayground] invalid balls count: ",this._balls.length),[2]})})},e.prototype._selectBall=function(t){this._selected=t,t.setSelected(!0),this._selected.setScore(1,!0),this._updateLinkedBalls()<=1&&!t.isBonus()?C.default.playSound(g.default.SOUNDS.BAD_CLICK):C.default.playSound(g.default.SOUNDS.CLICK)},e.prototype._unselect=function(){this._unlinkall(),null!=this._selected&&(this._selected.setSelected(!1),this._selected.setScore(0,!1)),this._selected=null},e.prototype._unlinkall=function(){this._linked.forEach(function(t){t.to.forEach(function(t){t.setLinked(!1),t.setScore(0,!1)})}),this._linked=[],this._updateLinkedLines(),this._updateLinkedScore()},e.prototype.testSelectBall=function(t){if(null!=this._selected){if(this._selected.node.getPosition().sub(t).mag()<=this._selected.node.width/2)return!0;this._unselect()}for(var e,o=0;o<this._balls.length;o++){var n=this._balls[o];if(!n.isRemoved()&&n.node.getBoundingBox().contains(t)&&n.node.getPosition().sub(t).mag()<=n.node.width/2){e=n;break}}return!!e&&(this._selectBall(e),!0)},e.prototype._getActiveBalls=function(t){var e=this,o=[];return this._balls.forEach(function(n){!n.isRemoved()&&(t<0||n.ballType==t)&&n.node.y<e.topBar.y&&o.push(n)}),o},e.prototype._updateLinkedBalls=function(){var t=this;if(null==this._selected)return 0;this._unlinkall();var e=this._selected,o=this._getActiveBalls(e.ballType),n=[],r=[],i=[];i.push(e);var a=function(e,o){for(var n=[],r=0;r<o.length;r++){var a=o[r];cc.js.array.contains(i,a)||(a!=e?t._testLinkedBallsByDist(e,a)&&(n.push(a),i.push(a)):i.push(a))}return n},s=1;n=a(e,o),s+=n.length,n.length>0&&r.push({from:e,to:n});for(var l=function(){var t=[];n.forEach(function(e){var n=a(e,o);n.length>0&&(r.push({from:e,to:n}),t=t.concat(n))}),s+=(n=t).length};n.length>0;)l();var u=null;return this._selected.isBonus()&&this._selected.getBonus()==c.STAR?u=this._selected:r.forEach(function(t){t.to.forEach(function(e){e.setLinked(!0),e.setScore(s,!0),null==u&&(t.from.isBonus()&&t.from.getBonus()==c.STAR?u=t.from:e.isBonus()&&(e.getBonus(),c.STAR))})}),this._linked=r,this._updateLinkedLines(),this._updateLinkedScore(),this._selected.setScore(s,!0),s},e.prototype._testLinkedBallsByType=function(t,e){return t.ballType==e.ballType},e.prototype._testLinkedBallsByRay=function(t,e){for(var o=p.default.getWorldPositionOfNode(t.node),n=p.default.getWorldPositionOfNode(e.node),r=!0,i=cc.director.getPhysicsManager().rayCast(o,n,cc.RayCastType.All),a=0;a<i.length;a++){var s=i[a].collider.node;if(s!=t.node&&s!=e.node){r=!1;break}}return r},e.prototype._testLinkedBallsByDist=function(t,e){return e.node.getPosition().sub(t.node.getPosition()).mag()<=1.75*(t.node.width*t.node.getScale()/2+e.node.width*e.node.getScale()/2)},e.prototype._updateLinkedLines=function(){},e.prototype._linkBalls=function(t,e,o){o.active=!0,o.setPosition(t.node.getPosition());var n=e.node.getPosition().sub(t.node.getPosition());o.width=n.mag();var r=-1*cc.v2(1,0).signAngle(n)*180/Math.PI;o.rotation=r},e.prototype._updateLinkedScore=function(){null==this._selected||this._linked.length},e.prototype._startGameCountdown=function(){this._gameDidStart||(this._gameDidStart=!0,this.timerCounter.startTimer(),this.countdownEffect.node.active=!0,this.countdownEffect.play(N.default.text("ui.match.kitty.time.start","~\u5f00\u59cb\u8ba1\u65f6~"),!1,!0),C.default.playSound(g.default.SOUNDS.CLOCK),y.default.getInstance().sendNotification(o.EVENTS.GAME_START))},e.prototype.removeSelectedAndLinked=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(){return null==this._selected?[2]:!this._selected.isBonus()&&this._linked.length<=0?(this._unselect(),[2]):this._finished?(this._unselect(),[2]):(this._gameDidStart||this._startGameCountdown(),t=[],this._selected.isRemoved()||(t.push(this._selected),this._selected.setSelected(!1),this._selected.markRemoved(!0)),this._linked.length>0&&this._linked.forEach(function(e){e.to.forEach(function(e){e.setLinked(!1),e.isRemoved()||(e.markRemoved(!0),t.push(e))})}),cc.js.array.removeArray(this._balls,t),this._tempBalls=this._tempBalls.concat(t),this._unselect(),this._addToRemoveQueue(t),[2])})})},e.prototype.update=function(t){this._inited&&(this._jobSystem.hasPendingJobs()&&this._jobSystem.update(t),this._gameDidStart&&this._checkGameFinished(),this._context!=l.TIMEUP&&(this._tipTimer+=t,this.checkQuickTip()))},e.prototype._addToRemoveQueue=function(t){if(!(t.length<=0)){var e=E.default.createRemoveBallsJob(this,t);this._jobSystem.addNewJob(e)}},e.prototype.getScoreForBalls=function(t){var e=0,o=0,n=1,r=t.length,i=p.default.createArray(5,0);t.forEach(function(t){if(t.isRemoved()){if(i[t.ballType]++,t.isBonus())switch(e++,t.getBonus()){case c.SCOREx2:n*=2;break;case c.SCOREx3:n*=3;break;case c.EXTRA_SCORE:o+=99;break;case c.NONE:o+=9}}else console.warn("[KMPlayground] ball not marked as removed: ",t)});var a=r*(r+1)/2;a+=o,a*=n,a*=this._data.combo/50+1;var s=Math.ceil(100*a),l=0,u=t[0].node.getPosition();return r>=5&&(l=1),{counters:i,count:r,score:s,combo:l,bonusCount:e,effectBallPos:u}},e.prototype._collectKittyBall=function(t){var e=this,o=t.getItemNode(),n=t.node.getScale(),r=t.ballType==this._skillType,i=!1,a=this.assemblyPosition;t.getBonus()==c.TIME?(a=this.timerCounter.node,i=!0):r&&t.getBonus()<=0&&(a=this.skillProgress.node,i=!0);var s=a.getPosition(),l=cc.instantiate(o);l.setScale(n),l.active=!0,l.parent=a.parent;var u=p.default.convertNode1PositionToNode2ParentSpaceAR(o,a);l.setPosition(u),l.getComponent(cc.Mask).enabled=!1,s.x=i?a.x:l.x;var d=Math.abs(l.y-s.y)/500;d<.5&&(d=.5);var f=cc.moveTo(d,s);f.easing(cc.easeBackIn());var h=cc.scaleTo(d,l.getScale()/2),y=cc.spawn(f,h),_=cc.fadeOut(.1),v=cc.callFunc(function(){r&&(e._skillReady||(e._skillCounter+=1,e.skillProgress.addProgress(1),e._skillCounter>=e._skillTargetValue&&e.onSkillReady())),e._endTask()});return this._beginTask(),{node:l,actions:[y,_,v]}},e.prototype.getBonusInfo=function(t){var e="",o=cc.Color.WHITE;switch(t.getBonus()){case c.TIME:e=N.default.textWithVar("ui.match.kitty.bonus.time","\u65f6\u95f4+${value}\u79d2",5),o=cc.Color.GREEN;break;case c.SCOREx2:e=N.default.textWithVar("ui.match.kitty.bonus.score.mul","\u5206\u6570x${value}",2),o=cc.Color.ORANGE;break;case c.SCOREx3:e=N.default.textWithVar("ui.match.kitty.bonus.score.mul","\u5206\u6570x${value}",3),o=cc.Color.ORANGE;break;case c.EXTRA_SCORE:e="+10000",o=cc.Color.BLUE;break;case c.STAR:e=N.default.text("ui.match.kitty.bonus.score.lucky","\u4eca\u5929\u8d85\u5e78\u8fd0~"),o=cc.Color.RED.fromHEX("#EC376B")}return{title:"",value:e,color:o,pos:t.node.getPosition(),ball:t}},e.prototype.applyBonus=function(t,e){switch(t.getBonus()){case c.TIME:this.timerCounter.addTimeLeft(5,45);break;case c.SCOREx2:case c.SCOREx3:case c.EXTRA_SCORE:break;case c.STAR:this._removeBallByBomb(t,e);break;case c.NONE:}},e.prototype._removeBallByBonus=function(t){var e=this,o=[],n=this._getActiveBalls(t.ballType);if(n.forEach(function(e){e.isSelected()||e.isRemoved()||e==t||e.ballType!=t.ballType||(p.default.isUndefinedOrNullOrEmpty(e.node)||p.default.isUndefinedOrNull(e.node.parent)?console.warn("Invalid ball, invalid node or parent: ",e):(e.markRemoved(!0),o.push(e)))}),o.length>0){cc.js.array.removeArray(this._balls,o),this._tempBalls=this._tempBalls.concat(o);var r=R.default.createJob();o.forEach(function(o){var n=e._createSkillMarkJob(t.node,o,0);r.hasNestedJob()?r.spawn(n):r.setJob(n)});var i=E.default.createRemoveBallsJob(this,n);r.appendToEnd(i),this._jobSystem.addNewJob(r)}},e.prototype._createBombEffect=function(t,e){var n=O.default.createJobGroup({name:"bomb"}),r=p.default.convertPositionInNode1ToNode2SpaceAR(t,this.playArea,this.tplBombMark.parent),i=cc.v2(e,0);n.spawn(P.default.createSimpleJob(function(){C.default.playSound(g.default.SOUNDS.KM_BOMB)}));for(var a=function(){var t=f.default.getInstance().get(o.NAMES.BOMB_MARK);t.setParent(s.tplBombMark.parent),t.active=!0,t.setPosition(r),t.setScale(.1);var e=i.rotateSelf(2*Math.PI/8),a=cc.moveBy(.25,e),c=cc.scaleTo(.5,1);c.easing(cc.easeBackOut());var l=cc.spawn(a,c),u=cc.delayTime(.1),p=S.default.createActionJob({node:t,actions:[l,u]});p.setFinishHander(function(){t.active=!1,f.default.getInstance().put(t,o.NAMES.BOMB_MARK)}),n.spawn(p)},s=this,c=0;c<8;c++)a();return n},e.prototype._removeBallByBomb=function(t,e){var o=[];this._getActiveBalls(-1).forEach(function(n){n.isSelected()||n.isRemoved()||n==t||e.sub(n.node.getPosition()).mag()<=200&&(n.markRemoved(!0),o.push(n))});var n=this._createBombEffect(e,200);if(o.length>0){cc.js.array.removeArray(this._balls,o),this._tempBalls=this._tempBalls.concat(o);var r=E.default.createRemoveBallsJob(this,o);n.appendToEnd(r)}this._jobSystem.addNewJob(n)},e.prototype.getScore=function(){return this._data},e.prototype.hideSkillEffect=function(){this.skillEffect.node.active=!1},e.prototype._createSkillMarkJob=function(t,e,n){var r=this;void 0===n&&(n=0);var i=f.default.getInstance().get(o.NAMES.SKILL_MARK);i.parent=this.tplSkillMark.parent,i.active=!0,i.scale=.1;var a=p.default.convertNode1PositionToNode2ParentSpaceAR(t,i);i.setPosition(a);var s=p.default.convertNode1PositionToNode2ParentSpaceAR(e.node,i);i.setPosition(s);var c=cc.scaleTo(.5,1.5);c.easing(cc.easeBackOut());var l=cc.callFunc(function(){r._beginTask()}),u=cc.delayTime(.25);return S.default.createActionJob({node:i,actions:[l,cc.delayTime(n),c,u],name:"MarkBall"},function(){i.stopAllActions(),i.active=!1,f.default.getInstance().put(i,o.NAMES.SKILL_MARK)})},e.prototype.onSkillTimeout=function(){this.timerCounter.resume(),this._skillCounter=0,this.skillProgress.resetProgress(),this._skillReady=!1,this.resetSkillTarget(),this._endTask()},e.prototype.onSkillReady=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r;return s(this,function(){return this._skillReady=!0,t=E.default.createSkillJob(this),e=R.default.createNestedJob(this.skillStage0.bind(this)),o=R.default.createNestedJob(this.skillStage1.bind(this)),n=R.default.createNestedJob(this.skillStage1_1.bind(this)),r=R.default.createNestedJob(this.skillStage2.bind(this)),t.spawn(e),e.appendAsChild(o).appendToEnd(r),e.appendAsChild(n),this._jobSystem.addNewJob(t),[2,t]})})},e.prototype.skillStage0=function(){var t=this;return P.default.createSimpleJob(function(){C.default.playSound(g.default.SOUNDS.KM_SKILL),t.timerCounter.pause(),t._skillPlayTimes++,t.skillEffect.node.active=!0})},e.prototype.skillStage1=function(){var t=this,e=this.skillEffect.createPlayJob();return e.setFinishHander(function(){t.skillEffect.node.active=!1}),e},e.prototype.skillStage1_1=function(){var t=this,e=T.default.createTimerJob({duration:2,name:"FreezeProgress"});return e.setJobBeginHandler(function(){t.skillProgress.startReadyCounter(2,void 0)}),e.setFinishHander(function(e,o){o||(t.timerCounter.resume(),t._skillCounter=0,t.skillProgress.resetProgress(),t._skillReady=!1,t.resetSkillTarget())}),e},e.prototype.skillStage2=function(){var t=this,e=cc.v2(0,0),o=cc.size(0,0),n=p.default.randomInt(0,3);if(0==n)e.y=p.default.randomFloat(-50,50),o.width=500,o.height=200;else if(1==n)e.x=p.default.randomFloat(-50,50),o.width=200,o.height=500;else{e.x=p.default.randomFloat(-100,100),e.y=p.default.randomFloat(-100,100);var r=p.default.randomFloat(3,4),i=10/r;o.width=100*r,o.height=100*i}var a=this._skillType,s=this._getBallsBySkill(a,e,o),c=this._jobSystem.createJob(),l=void 0;s.forEach(function(e){var o=R.default.createNestedJob(t._createSkillMarkJob.bind(t,t.skillProgress.node,e,0));c.spawn(o),l=o});var u=E.default.createRemoveBallsJob(this,s);return l.appendAsChild(u),c},e.prototype._getBallsBySkill=function(t,e,o){this._unselect();var n=cc.rect(0,0,o.width,o.height);n.center=e;var r=[t],i=function(t){return!t.isRemoved()&&!t.isSelected()&&(!!cc.js.array.contains(r,t.ballType)||!(!t.isBonus()||0!=t.getBonus())||n.contains(t.node.getPosition()))},a=this._getActiveBalls(-1),s=[];return a.forEach(function(t){i(t)&&s.push(t)}),a.forEach(function(t){!cc.js.array.contains(s,t)&&cc.js.array.contains(r,t.ballType)&&s.push(t)}),cc.js.array.removeArray(this._balls,s),this._tempBalls=this._tempBalls.concat(s),s.forEach(function(t){t.setSelected(!1),t.markRemoved(!0)}),s},e.prototype.checkQuickTip=function(){this._tipTimer>3&&!this.quickTip.active&&this.showQuickTip(),this.quickTip.active&&(this._tipTimer=0,this._updateTipPosition())},e.prototype.hideQuickTip=function(){this.quickTip.active=!1,this._tipTimer=0},e.prototype.findFirstMatchBall=function(){var t=this,e=this._getActiveBalls(-1);if(e.sort(function(e,o){var n=0,r=0;return e.ballType==t._skillType&&(n+=2),e.isBonus()&&n++,o.ballType==t._skillType&&(r+=2),o.isBonus()&&r++,r-n}),!(e.length<=1)){for(var o=!1,n=void 0,r=0;r<e.length;r++){n=e[r];for(var i=0;i<e.length;i++){var a=e[i];if(n!=a&&(n.isBonus()||n.ballType==a.ballType&&this._testLinkedBallsByDist(n,a))){o=!0;break}}if(o)break}return o?n:void 0}},e.prototype.showQuickTip=function(){var t=this.findFirstMatchBall();t?(this._tipBall=t,this._updateTipPosition()):console.warn("[KM] no matching balls, something wrong!")},e.prototype._updateTipPosition=function(){var t=p.default.convertNode1PositionToNode2ParentSpaceAR(this._tipBall.node,this.quickTip);this.quickTip.active=!0,this.quickTip.setPosition(t)},e.EVENTS={GAME_READY:"KittyMatch.Game.Ready",GAME_START:"KittyMatch.Game.Start",TIMEOUT:"KittyMatch.Timeout",GAME_DID_FINISED:"KittyMatch.Game.Did.Finished",GAME_END:"KittyMatch.Game.End"},e.NAMES={SCORE_NODE:"SCORE_NODE",SKILL_MARK:"SKILL_MARK",BOMB_MARK:"BOMB_MARK"},i([D(u.default)],e.prototype,"input",void 0),i([D(cc.Node)],e.prototype,"playArea",void 0),i([D(cc.Node)],e.prototype,"topBar",void 0),i([D(cc.Node)],e.prototype,"spawnPosition",void 0),i([D(cc.Node)],e.prototype,"effectLayer",void 0),i([D(w.default)],e.prototype,"tplScoreEffect",void 0),i([D(cc.Node)],e.prototype,"tplSkillMark",void 0),i([D(cc.Node)],e.prototype,"tplBombMark",void 0),i([D(cc.Prefab)],e.prototype,"ballPrefab",void 0),i([D(cc.Node)],e.prototype,"linesContainer",void 0),i([D(cc.Node)],e.prototype,"dots",void 0),i([D(h.default)],e.prototype,"timerCounter",void 0),i([D(cc.Label)],e.prototype,"scoreLabel",void 0),i([D(cc.Label)],e.prototype,"comboLabel",void 0),i([D(cc.Node)],e.prototype,"assemblyPosition",void 0),i([D(b.default)],e.prototype,"skillEffect",void 0),i([D(m.default)],e.prototype,"skillProgress",void 0),i([D(cc.Node)],e.prototype,"startBar",void 0),i([D(I.default)],e.prototype,"countdownEffect",void 0),i([D(cc.Node)],e.prototype,"quickTip",void 0),i([D(cc.Sprite)],e.prototype,"kitties",void 0),i([D(cc.Node)],e.prototype,"endMask",void 0),o=i([x],e)}(cc.Component);o.default=U,cc._RF.pop()},{"../../GameKit/App/AppFacade":"AppFacade","../../GameKit/Framework/GamePlay/InputControl":"InputControl","../../GameKit/Framework/JobSystem/ActionJob":"ActionJob","../../GameKit/Framework/JobSystem/Job":"Job","../../GameKit/Framework/JobSystem/JobGroup":"JobGroup","../../GameKit/Framework/JobSystem/JobSystem":"JobSystem","../../GameKit/Framework/JobSystem/NestedJob":"NestedJob","../../GameKit/Framework/JobSystem/TimerJob":"TimerJob","../../GameKit/Framework/Pool/PoolManager":"PoolManager","../../GameKit/Framework/Utils/Utils":"Utils","../../GameKit/Framework/i18n/i18n":"i18n","../../Kitty/Script/Data/KittyDB":"KittyDB","../../Kitty/Script/KittyApp":"KittyApp","../../Kitty/Script/KittyConsts":"KittyConsts","../../Kitty/Script/KittyResouces":"KittyResouces","./KMCountdownEffect":"KMCountdownEffect","./KMJobs":"KMJobs","./KMScoreEffect":"KMScoreEffect","./KMSkillEffect":"KMSkillEffect","./KMSkillProgress":"KMSkillProgress","./KittyBall":"KittyBall","./TimeCounter":"TimeCounter"}],KMResult:[function(t,e,o){"use strict";cc._RF.push(e,"22a8dyeHTBDzaaIX1WrHV48","KMResult");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./KittyBallScore"),l=t("../../GameKit/Framework/Components/ScoreLabel"),u=t("../../Kitty/Script/KittyResouces"),p=t("../../GameKit/Framework/Utils/Utils"),d=t("../../Kitty/Script/Data/KittyDB"),f=t("../../Kitty/Script/KittyConsts"),h=t("../../GameKit/App/AppFacade"),y=t("../../GameKit/Framework/i18n/i18n"),_=t("../../Kitty/Script/Data/KittyLogger"),v=cc._decorator,g=v.ccclass,b=v.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.totalScore=null,e.totalRemove=null,e.combo=null,e.maxChain=null,e.ballsList=null,e.ballScores=[],e.buttons=[],e}return r(e,t),e.prototype.show=function(){this.node.active=!0,this._showButtons(!1)},e.prototype.hide=function(){this.node.active=!1},e.prototype._showButtons=function(t){this.buttons.forEach(function(e){e.node.active=t})},e.prototype.updateData=function(t,e){this._data=t,this.totalScore.string=t.totalScore.toString(),this.combo.string=t.combo.toString(),this.maxChain.string=t.maxChain.toString(),this.totalRemove.string=t.totalRemove.toString();for(var o={idx:0,value:0},n=0;n<t.counter.length;n++){var r=t.counter[n];r>o.value&&(o.idx=n,o.value=r),this.ballScores[n].score.string="x"+r.toString(),this.ballScores[n].ball.setBallType(n,e.colors[n],e.avatars[n]),this.ballScores[n].ball.setOpen(!1)}this.totalScore.string="0",this.playScoreAnimation()},e.prototype.playScoreAnimation=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i=this;return s(this,function(){return(t=this.totalScore.getComponent(l.default))||(t=this.totalScore.addComponent(l.default)),e=0,o=0,n=1e4,(o=this._data.totalScore/n)>10&&(r=(o=10)/.1,n=this._data.totalScore/r),t.reset(),t.play({startValue:"0",duration:o,interval:.1,updateFunc:function(){var t=!1;return(e+=n)>=i._data.totalScore&&(e=i._data.totalScore,t=!0),{stop:t,text:e.toFixed(0)}},onStopFunc:function(){i.onScoreAnimationDone()}}),[2]})})},e.prototype.onScoreAnimationDone=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i,a,c,l,v,g,b,m;return s(this,function(s){switch(s.label){case 0:for(u.default.playParticle(),t=this._data,e={idx:0,value:0},o=0;o<t.counter.length;o++)(n=t.counter[o])>e.value&&(e.idx=o,e.value=n);return this.ballScores[e.idx].ball.setOpen(!0),[4,p.default.waitFor(1e3)];case 1:if(s.sent(),this._showButtons(!0),r=this._data.totalRemove+this._data.totalScore/1e3,(r/=5)<30?r=p.default.randomInt(10,30):r>60&&(r=60+p.default.randomInt(1,10)),i=p.default.randomInt(1,11),a=d.default.getInstance().getCoinRewardsBySize(r),a=Math.ceil(a),c="",l=this._data.maxChain,(v=l-2)<0&&(v=0),g=y.default.value("ui.match.kitty.score.msgs"),v>=g.length){for(b=v-g.length+1,c="";b>0;)c+="!",b--;c=g[g.length-1]+c}else c=g[v];return c+="\n"+y.default.text("ui.match.kitty.rewards.msg","\u8fd9\u662f\u7ed9\u4f60\u7684\u5956\u52b1~"),_.default.setAdsSpace(_.KITTY_ADS_SPACE.KITTY_BALL),[4,u.default.showRewardsWithAds(c,a,i,f.default.REWARDS_PREFABS.FISH_CANS_4,1,!0)];case 2:return s.sent().adsShowed&&(a*=i),(m=h.default.getInstance().retrieveProxy(f.default.PROXIES.INVENTORY)).addCoin(a),m.save(),[2]}})})},i([b(cc.Label)],e.prototype,"totalScore",void 0),i([b(cc.Label)],e.prototype,"totalRemove",void 0),i([b(cc.Label)],e.prototype,"combo",void 0),i([b(cc.Label)],e.prototype,"maxChain",void 0),i([b(cc.Node)],e.prototype,"ballsList",void 0),i([b(c.default)],e.prototype,"ballScores",void 0),i([b(cc.Button)],e.prototype,"buttons",void 0),i([g],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../../GameKit/App/AppFacade":"AppFacade","../../GameKit/Framework/Components/ScoreLabel":"ScoreLabel","../../GameKit/Framework/Utils/Utils":"Utils","../../GameKit/Framework/i18n/i18n":"i18n","../../Kitty/Script/Data/KittyDB":"KittyDB","../../Kitty/Script/Data/KittyLogger":"KittyLogger","../../Kitty/Script/KittyConsts":"KittyConsts","../../Kitty/Script/KittyResouces":"KittyResouces","./KittyBallScore":"KittyBallScore"}],KMScoreEffect:[function(t,e,o){"use strict";cc._RF.push(e,"76bb492zktIr55O6EzgNqAY","KMScoreEffect");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../GameKit/Framework/JobSystem/ActionJob"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scoreLabel=null,e.msgLabel=null,e}return r(e,t),e.prototype.play=function(t,e,o,n,r,i,c){return void 0===i&&(i=cc.Color.WHITE),void 0===c&&(c=0),a(this,void 0,void 0,function(){var a,l,u,p,d,f,h,y,_=this;return s(this,function(){return this.scoreLabel.string=t.toString(),this.msgLabel.string=e,a=1+.1*o,this.node.setScale(.1),(l=cc.scaleTo(1,a)).easing(cc.easeBackOut()),this.msgLabel.node.color=i,this.scoreLabel.node.color=i,u=cc.delayTime(c),p=r?cc.moveBy(.25,0,0):cc.moveBy(.25,0,50),d=cc.fadeOut(.1),f=cc.spawn(l,p),h=cc.callFunc(function(){n(_)}),y=cc.sequence(u,f,d,h),this.node.runAction(y),[2]})})},e.prototype.createPlayJob=function(t,e,o,n,r,i){void 0===r&&(r=cc.Color.WHITE),void 0===i&&(i=0),t.length>0?(this.scoreLabel.node.active=!0,this.scoreLabel.string=t.toString()):this.scoreLabel.node.active=!1,e.length>0?(this.msgLabel.node.active=!0,this.msgLabel.string=e):this.msgLabel.node.active=!1;var a=1+.1*o;this.node.setScale(.1);var s=cc.scaleTo(1,a);s.easing(cc.easeBackOut()),this.msgLabel.node.color=r,this.scoreLabel.node.color=r;var l,u=cc.delayTime(i);l=n?cc.moveBy(.25,0,0):cc.moveBy(.25,0,50);var p=cc.fadeOut(.1),d=cc.spawn(s,l),f=c.default.createActionJob({node:this.node,name:"ScoreEffect"});return f.appendAction(u),f.appendAction(d),f.appendAction(p),f},e.prototype.reuse=function(){},e.prototype.unuse=function(){this.node.stopAllActions(),this.node.setScale(1),this.node.opacity=255,this.msgLabel.node.color,this.scoreLabel.node.color},i([p(cc.Label)],e.prototype,"scoreLabel",void 0),i([p(cc.Label)],e.prototype,"msgLabel",void 0),i([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../GameKit/Framework/JobSystem/ActionJob":"ActionJob"}],KMSkillEffect:[function(t,e,o){"use strict";cc._RF.push(e,"37358vmSz9LfbvGy0Gh4a7v","KMSkillEffect");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../GameKit/Framework/Utils/Utils"),l=t("../../GameKit/Framework/JobSystem/AnimationJob"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imageNode=null,e.animation=null,e}return r(e,t),e.prototype.onLoad=function(){},e.prototype.playWillCallback=function(t){var e=this.animation.getClips();this.animation.play(e[0].name),this.animation.off(cc.Animation.EventType.FINISHED),c.default.isNotUndefinedOrNull(t)&&this.animation.once(cc.Animation.EventType.FINISHED,t)},e.prototype.play=function(){return a(this,void 0,void 0,function(){var t,e=this;return s(this,function(){return t=this,[2,new Promise(function(o){var n=e.animation.getClips();t.animation.play(n[0].name),t.animation.off(cc.Animation.EventType.FINISHED),t.animation.once(cc.Animation.EventType.FINISHED,function(){o()})})]})})},e.prototype.createPlayJob=function(){return l.default.createAnimationJob({animation:this.animation,nameOrIdx:0,name:"SkillAnimation"})},i([d(cc.Node)],e.prototype,"imageNode",void 0),i([d(cc.Animation)],e.prototype,"animation",void 0),i([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../GameKit/Framework/JobSystem/AnimationJob":"AnimationJob","../../GameKit/Framework/Utils/Utils":"Utils"}],KMSkillProgress:[function(t,e,o){"use strict";cc._RF.push(e,"8854b1fpgFGnKJsuVrtVuRc","KMSkillProgress");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skillAvatar=null,e.progressBar=null,e.background=null,e.outline=null,e.fillParts=[],e._total=0,e._counter=0,e._readyCounter=0,e._ready=!1,e}return r(e,t),e.prototype.update=function(t){this._ready&&(this._readyCounter-=t,this._readyCounter<=0&&(this._ready=!1,this._onReady&&this._onReady()))},e.prototype.setTotalValue=function(t,e){this._total=t,e?this.resetProgress():this.setProgress(this._counter)},e.prototype.resetProgress=function(){this._ready=!1,this._onReady=void 0,this.setProgress(0)},e.prototype.addProgress=function(t){this.setProgress(this._counter+t)},e.prototype.setProgress=function(t){this._counter=t;var e=0;this._total>0&&(e=this._counter/this._total),e>1&&(e=1),this.progressBar.progress=e},e.prototype.setSkillAvatar=function(t){this.skillAvatar.spriteFrame=t},e.prototype.setColor=function(t){this.fillParts[0].color=cc.Color.WHITE.fromHEX(t[0]),this.fillParts[1].color=cc.Color.WHITE.fromHEX(t[1]),this.fillParts[2].color=cc.Color.WHITE.fromHEX(t[2]),this.outline.color=cc.Color.WHITE.fromHEX(t[0]),this.background.node.color=cc.Color.WHITE.fromHEX(t[0])},e.prototype.startReadyCounter=function(t,e){this._readyCounter=t,this._ready=!0,this._onReady=e},i([c(cc.Sprite)],e.prototype,"skillAvatar",void 0),i([c(cc.ProgressBar)],e.prototype,"progressBar",void 0),i([c(cc.Sprite)],e.prototype,"background",void 0),i([c(cc.Node)],e.prototype,"outline",void 0),i([c(cc.Node)],e.prototype,"fillParts",void 0),i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],KittyAds:[function(t,e,o){"use strict";cc._RF.push(e,"8c9d1neFI1ERLGOMWKNwPQ9","KittyAds");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../../GameKit/Framework/Utils/Utils"),a=t("../KittyResouces"),s=t("../../../GameKit/Framework/Model/LocalCache"),c=t("./KittyConfig"),l=function(){function t(){}return t.getInstance=function(){return i.default.isUndefinedOrNull(t._inst)&&(t._inst=new t,t._inst.init()),t._inst},t.prototype.init=function(){this.resetCounter()},t.prototype.save=function(){return n(this,void 0,void 0,function(){var t;return r(this,function(){return(t={}).counter=this._counter,t.time=this._time,s.default.putObj("Ads",t),[2]})})},t.prototype.load=function(){return n(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return[4,s.default.getObj("Ads")];case 1:return t=e.sent(),i.default.isNotUndefinedOrNull(t)&&(i.default.isNotUndefinedOrNull(t.time)&&(this._time=t.time),i.default.isNotUndefinedOrNull(t.counter)&&(this._counter=t.counter)),this.verifyCounter(),[2]}})})},t.prototype.verifyCounter=function(){i.default.isSameDayToday(new Date(this._time))||this.resetCounter()},t.prototype.showBanner=function(){a.default.showBanner(!0)},t.prototype.hideBanner=function(){a.default.showBanner(!1)},t.prototype.canShowAds=function(){return this._counter<c.default.ADS.DAILY_MAX},t.prototype.showAds=function(){return n(this,void 0,void 0,function(){return r(this,function(){return[2,a.default.showTempAds()]})})},t.prototype.addCounter=function(){this.verifyCounter(),this._counter++},t.prototype.resetCounter=function(){console.info(""),this._time=Date.now(),this._counter=0},t}();o.default=l,cc._RF.pop()},{"../../../GameKit/Framework/Model/LocalCache":"LocalCache","../../../GameKit/Framework/Utils/Utils":"Utils","../KittyResouces":"KittyResouces","./KittyConfig":"KittyConfig"}],KittyApp:[function(t,e,o){"use strict";cc._RF.push(e,"d48e3R4wtpBJLG93dW/ASN/","KittyApp");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../GameKit/App/GameApp"),l=t("./KittyFacade"),u=t("./View/KittyScene"),p=t("./KittyConsts"),d=t("./Cmd/FeedCommands"),f=t("./KittyResouces"),h=t("../../GameKit/Framework/Ads/AdsManager"),y=t("./Data/KittyConfig"),_=t("../../GameKit/Framework/Audio/AudioControl"),v=t("../../GameKit/Framework/Pool/PoolManager"),g=t("../../GameKit/Framework/Model/LocalCache"),b=t("../../GameKit/Tpcl/Baidu/Baidu"),m=t("../../GameKit/Framework/i18n/i18n"),w=t("../../GameKit/App/Logger"),S=t("./Data/KittyLogger"),P=cc._decorator,O=P.ccclass,E=P.property,A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.splash=null,e.splashTime=2,e.loadingProgress=null,e.versionText=null,e.audioControl=null,e.kittyResources=null,e.poolManager=null,e.facade=null,e._timeCounter=0,e._expectLoadingTime=10,e._gameReady=!1,e._resourceReady=!1,e._jobs=0,e}return r(e,t),e.prototype._onloaded=function(){return a(this,void 0,void 0,function(){var e=this;return s(this,function(o){switch(o.label){case 0:return this.showSplash(!0),this.versionText.string=y.default.Version(),this.facade.initFacade(),console.info("init facade ====> "),t.prototype._onloaded.call(this),y.default.isBaidu()?[4,b.default.init()]:[3,2];case 1:o.sent(),o.label=2;case 2:return y.default.isFacebook()?(this.splashTime=.1,S.default.initLogger(w.LOGGER_PROVIDER.FACEBOOK)):S.default.initLogger(),this.splashTime=.1,g.default.init(y.default.CACHE.PROVIDER()),h.default.getInstance().init(y.default.ADS.PROVIDER(),y.default.ADS),[4,h.default.getInstance().load()];case 3:return o.sent(),this._jobs++,l.default.getInstance().registerObserver(p.default.EVENTS.READY_TO_START_GAME,function(){e._gameReady=!0}),l.default.getInstance().registerObserver(p.default.EVENTS.RESOURCE_READY,function(){e._resourceReady=!0}),l.default.getInstance().registerObserver(p.default.EVENTS.NETWORK_ERROR,function(t){return a(e,void 0,void 0,function(){var e,o;return s(this,function(n){switch(n.label){case 0:return(e=t.getUserData().errorCount)>=10?(o=m.default.text("network.error.tooManyError","\u55b5\uff0c\u53d1\u751f\u4e86\u592a\u591a\u7f51\u7edc\u9519\u8bef\n\u8bf7\u91cd\u542f\u6e38\u620f\u8bd5\u8bd5"),[4,f.default.showNetworkError(o)]):[3,2];case 1:return n.sent(),cc.game.end(),[2];case 2:o=m.default.textWithVar("network.error.connectionFail","\u55b5\uff0c\u597d\u50cf\u8fde\u4e0d\u4e0a\u670d\u52a1\u5668\u4e86[${value}]",e),f.default.showToast(o),n.label=3;case 3:return[2]}})})}),[2]}})})},e.prototype.showSplash=function(t){this.splash.active=t},e.prototype.onAppStart=function(){t.prototype.onAppStart.call(this),l.default.getInstance().startFacade()},e.prototype.start=function(){this.poolManager.init(),this.audioControl.init(),this.kittyResources.init()},e.MainScene=function(){return l.default.getInstance().retrieveMediator(u.default.MAIN_SCENE)},e.prototype.update=function(t){if(!(this._jobs<=0)){this._timeCounter+=t;var e=this._timeCounter/this._expectLoadingTime;e>=.7&&(e=.7);var o=0;this._resourceReady=f.default.getInstance().isReady(),this._resourceReady&&o++,this._gameReady&&o++,this._timeCounter>this.splashTime&&o++,e+=.1*o,o>=3&&(e=1),this.loadingProgress.progress=e,e>=1&&(this.showSplash(!1),this._jobs--,this.startGame())}},e.prototype.startGame=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,l.default.getInstance().executeCommand(d.default.COMMANDS.START)];case 1:return t.sent(),[2]}})})},e.getAudio=function(){return _.default.getInstance()},e.playLobbyBgm=function(){_.default.getInstance().playBgmGroup2([0,1,2,3,4],3,_.default.getInstance()._bgmClipId)},e.playSlowBgm=function(){_.default.getInstance().playBgmGroup2([2,3,4],3,_.default.getInstance()._bgmClipId)},e.playFastBgm=function(){_.default.getInstance().playBgmGroup2([3,4,5],2,_.default.getInstance()._bgmClipId)},e.playSound=function(t){_.default.getInstance().playSoundByName(t)},i([E(cc.Node)],e.prototype,"splash",void 0),i([E({tooltip:"\u95ea\u5c4f\u81f3\u5c11\u663e\u793a\u591a\u957f\u65f6\u95f4"})],e.prototype,"splashTime",void 0),i([E(cc.ProgressBar)],e.prototype,"loadingProgress",void 0),i([E(cc.Label)],e.prototype,"versionText",void 0),i([E(_.default)],e.prototype,"audioControl",void 0),i([E(f.default)],e.prototype,"kittyResources",void 0),i([E(v.default)],e.prototype,"poolManager",void 0),i([E(l.default)],e.prototype,"facade",void 0),i([O],e)}(c.default);o.default=A,cc._RF.pop()},{"../../GameKit/App/GameApp":"GameApp","../../GameKit/App/Logger":"Logger","../../GameKit/Framework/Ads/AdsManager":"AdsManager","../../GameKit/Framework/Audio/AudioControl":"AudioControl","../../GameKit/Framework/Model/LocalCache":"LocalCache","../../GameKit/Framework/Pool/PoolManager":"PoolManager","../../GameKit/Framework/i18n/i18n":"i18n","../../GameKit/Tpcl/Baidu/Baidu":"Baidu","./Cmd/FeedCommands":"FeedCommands","./Data/KittyConfig":"KittyConfig","./Data/KittyLogger":"KittyLogger","./KittyConsts":"KittyConsts","./KittyFacade":"KittyFacade","./KittyResouces":"KittyResouces","./View/KittyScene":"KittyScene"}],KittyBallInfo:[function(t,e,o){"use strict";cc._RF.push(e,"09a13UnvqtELbZFzY+F7r8D","KittyBallInfo");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./KMPlayground"),s=t("../../GameKit/Framework/JobSystem/ActionJob"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.foregroundUp=null,e.foregroundDown=null,e.foregroundDownFill=null,e.backgroundUp=null,e.backgroundUpFill=null,e.backgroundDown=null,e.backgroundDownFill=null,e.itemNode=null,e.avatar=null,e.sprites=[],e.specialImages=[],e.scoreLabel=null,e.positions=[],e.openDelta=20,e._originOpacity=255,e._removed=!1,e._isBonus=!1,e._bonus=0,e._selected=!1,e}return r(e,t),e.prototype.onLoad=function(){this._body=this.getComponent(cc.RigidBody),this._collider=this.getComponent(cc.PhysicsCollider),this._body.gravityScale=10,this._body.linearDamping=0,this._body.angularDamping=1,this._collider.density=10,this._collider.friction=.5,this._collider.restitution=0,this._collider.apply(),this._body.linearVelocity=cc.v2(0,-500),this._originOpacity=255,this.scoreLabel.node.parent.active=!1,this.setSelected(!1),this.setOpen(!1),this.itemNode.active=!0},Object.defineProperty(e.prototype,"ballType",{get:function(){return this._ballType},enumerable:!1,configurable:!0}),e.prototype.setBallType=function(t,e,o){this._ballType=t,this.setColor(e[0],e[1],e[2]),this.avatar.spriteFrame=o,this.avatar.node.setScale(.5,.5)},e.prototype.setBonus=function(t,e){this._isBonus=t,this._bonus=0,t?(this.node.scale=1.5,e>0&&(this.avatar.spriteFrame=this.specialImages[e-1],this.avatar.node.setScale(.5,.5),this._bonus=e,e==a.KITTY_BALL_BONUS.STAR&&this.avatar.node.setScale(.75))):this.node.scale=1},e.prototype.isBonus=function(){return this._isBonus},e.prototype.getBonus=function(){return this._isBonus?this._bonus:-1},e.prototype.setColor=function(t,e,o){this.foregroundDownFill.color=cc.Color.WHITE.fromHEX(t),this.backgroundDownFill.color=cc.Color.WHITE.fromHEX(e),this.backgroundUpFill.color=cc.Color.WHITE.fromHEX(o)},e.prototype.isSelected=function(){return this._selected},e.prototype.setSelected=function(t){this._selected=t,this.foregroundDown.opacity=t?50:this._originOpacity},e.prototype.setOpen=function(t){t?(this.foregroundUp.y=this.positions[0].x+this.openDelta,this.backgroundUp.y=this.positions[1].x+this.openDelta,this.foregroundDown.y=this.positions[2].x-this.openDelta,this.backgroundDown.y=this.positions[3].x-this.openDelta):(this.foregroundUp.y=this.positions[0].x,this.backgroundUp.y=this.positions[1].x,this.foregroundDown.y=this.positions[2].x,this.backgroundDown.y=this.positions[3].x)},e.prototype.setLinked=function(t){this.setSelected(t)},e.prototype.markRemoved=function(t){this._removed=t},e.prototype.isRemoved=function(){return this._removed},e.prototype.setScore=function(){},e.prototype.getItemNode=function(){return this.itemNode},e.prototype.playOpenAnimation=function(){var t=this;this.setOpen(!1),this.foregroundUp.runAction(cc.moveTo(.1,0,this.positions[0].x+this.openDelta)),this.backgroundUp.runAction(cc.moveTo(.1,0,this.positions[1].x+this.openDelta)),this.foregroundDown.runAction(cc.moveTo(.1,0,this.positions[2].x-this.openDelta)),this.backgroundDown.runAction(cc.moveTo(.1,0,this.positions[3].x-this.openDelta)),this.itemNode.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(){t.itemNode.active=!1})))},e.prototype.createOpenAnimationJob=function(){var t=this,e=s.default.createActionJob({node:this.foregroundUp,actions:[cc.moveTo(.1,0,this.positions[0].x+this.openDelta)]}),o=s.default.createActionJob({node:this.backgroundUp,actions:[cc.moveTo(.1,0,this.positions[1].x+this.openDelta)]}),n=s.default.createActionJob({node:this.foregroundDown,actions:[cc.moveTo(.1,0,this.positions[2].x-this.openDelta)]}),r=s.default.createActionJob({node:this.backgroundDown,actions:[cc.moveTo(.1,0,this.positions[3].x-this.openDelta)]}),i=s.default.createActionJob({node:this.itemNode,actions:[cc.delayTime(.2)],name:"openBall"});return i.setJobBeginHandler(function(){t.setOpen(!1)}),i.setFinishHander(function(){t.itemNode.active=!1}),i.spawn(e),i.spawn(o),i.spawn(n),i.spawn(r),i},e.prototype.reuse=function(){this.itemNode.active=!0,this.setOpen(!1),this.setSelected(!1),this.markRemoved(!1),this.setBonus(!1,0)},e.prototype.unuse=function(){this.markRemoved(!0),this.foregroundDown.stopAllActions(),this.backgroundDown.stopAllActions(),this.foregroundUp.stopAllActions(),this.backgroundUp.stopAllActions(),this.itemNode.stopAllActions()},i([u(cc.Node)],e.prototype,"foregroundUp",void 0),i([u(cc.Node)],e.prototype,"foregroundDown",void 0),i([u(cc.Node)],e.prototype,"foregroundDownFill",void 0),i([u(cc.Node)],e.prototype,"backgroundUp",void 0),i([u(cc.Node)],e.prototype,"backgroundUpFill",void 0),i([u(cc.Node)],e.prototype,"backgroundDown",void 0),i([u(cc.Node)],e.prototype,"backgroundDownFill",void 0),i([u(cc.Node)],e.prototype,"itemNode",void 0),i([u(cc.Sprite)],e.prototype,"avatar",void 0),i([u(cc.SpriteFrame)],e.prototype,"sprites",void 0),i([u(cc.SpriteFrame)],e.prototype,"specialImages",void 0),i([u(cc.Label)],e.prototype,"scoreLabel",void 0),i([u({type:cc.Vec2,tooltip:"x \u8868\u793a\u5173\u95ed\u65f6\u7684\u5750\u6807\uff0cy\u8868\u793a\u6253\u5f00\u65f6\u7684\u5750\u6807 \uff08\u4e0a\u524d\uff0c\u4e0a\u540e\uff0c\u4e0b\u524d\uff0c\u4e0b\u540e\uff09"})],e.prototype,"positions",void 0),i([u],e.prototype,"openDelta",void 0),i([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../GameKit/Framework/JobSystem/ActionJob":"ActionJob","./KMPlayground":"KMPlayground"}],KittyBallScore:[function(t,e,o){"use strict";cc._RF.push(e,"df866aESilMCYHxDbomYQQ+","KittyBallScore");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./KittyBall"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.score=null,e.ball=null,e}return r(e,t),e.prototype.onLoad=function(){},e.prototype.setScore=function(t){this.score.string=t},i([l(cc.Label)],e.prototype,"score",void 0),i([l(a.default)],e.prototype,"ball",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./KittyBall":"KittyBall"}],KittyBall:[function(t,e,o){"use strict";cc._RF.push(e,"808f2X4SlJKIJqE84mmXnjJ","KittyBall");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../GameKit/Framework/JobSystem/ActionJob"),s=t("./KMPlayground"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.foregroundUp=null,e.foregroundDown=null,e.foregroundDownFill=null,e.backgroundUp=null,e.backgroundUpFill=null,e.backgroundDown=null,e.backgroundDownFill=null,e.itemNode=null,e.avatar=null,e.specialImages=[],e.scoreLabel=null,e.positions=[],e.openDelta=20,e.isStatic=!1,e._originOpacity=255,e._removed=!1,e._isBonus=!1,e._bonus=0,e._selected=!1,e}return r(e,t),e.prototype.onLoad=function(){this.isStatic||(this._body=this.getComponent(cc.RigidBody),this._collider=this.getComponent(cc.PhysicsCollider),this._body.gravityScale=10,this._body.linearDamping=0,this._body.angularDamping=1,this._collider.density=10,this._collider.friction=.5,this._collider.restitution=0,this._collider.apply(),this._body.linearVelocity=cc.v2(0,-500)),this._originOpacity=255,this.scoreLabel.node.parent.active=!1,this.setSelected(!1),this.setOpen(!1),this.itemNode.active=!0},Object.defineProperty(e.prototype,"ballType",{get:function(){return this._ballType},enumerable:!1,configurable:!0}),e.prototype.setBallType=function(t,e,o){this._ballType=t,this.setColor(e[0],e[1],e[2]),this.avatar.spriteFrame=o,this.avatar.node.setScale(.5,.5)},e.prototype.setBonus=function(t,e){this._isBonus=t,this._bonus=0,t?(this.node.scale=1.5,e>0&&(this.avatar.spriteFrame=this.specialImages[e-1],this.avatar.node.setScale(.5,.5),this._bonus=e,e==s.KITTY_BALL_BONUS.STAR&&this.avatar.node.setScale(.75))):this.node.scale=1},e.prototype.isBonus=function(){return this._isBonus},e.prototype.getBonus=function(){return this._isBonus?this._bonus:-1},e.prototype.setColor=function(t,e,o){this.foregroundDownFill.color=cc.Color.WHITE.fromHEX(t),this.backgroundDownFill.color=cc.Color.WHITE.fromHEX(e),this.backgroundUpFill.color=cc.Color.WHITE.fromHEX(o)},e.prototype.isSelected=function(){return this._selected},e.prototype.setSelected=function(t){this._selected=t,this.foregroundDown.opacity=t?50:this._originOpacity},e.prototype.setOpen=function(t){t?(this.foregroundUp.y=this.positions[0].x+this.openDelta,this.backgroundUp.y=this.positions[1].x+this.openDelta,this.foregroundDown.y=this.positions[2].x-this.openDelta,this.backgroundDown.y=this.positions[3].x-this.openDelta):(this.foregroundUp.y=this.positions[0].x,this.backgroundUp.y=this.positions[1].x,this.foregroundDown.y=this.positions[2].x,this.backgroundDown.y=this.positions[3].x)},e.prototype.setLinked=function(t){this.setSelected(t)},e.prototype.markRemoved=function(t){this._removed=t},e.prototype.isRemoved=function(){return this._removed},e.prototype.setScore=function(){},e.prototype.getItemNode=function(){return this.itemNode},e.prototype.playOpenAnimation=function(){var t=this;this.setOpen(!1),this.foregroundUp.runAction(cc.moveTo(.1,0,this.positions[0].x+this.openDelta)),this.backgroundUp.runAction(cc.moveTo(.1,0,this.positions[1].x+this.openDelta)),this.foregroundDown.runAction(cc.moveTo(.1,0,this.positions[2].x-this.openDelta)),this.backgroundDown.runAction(cc.moveTo(.1,0,this.positions[3].x-this.openDelta)),this.itemNode.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(){t.itemNode.active=!1})))},e.prototype.createOpenAnimationJob=function(){var t=this,e=a.default.createActionJob({node:this.foregroundUp,actions:[cc.moveTo(.1,0,this.positions[0].x+this.openDelta)]}),o=a.default.createActionJob({node:this.backgroundUp,actions:[cc.moveTo(.1,0,this.positions[1].x+this.openDelta)]}),n=a.default.createActionJob({node:this.foregroundDown,actions:[cc.moveTo(.1,0,this.positions[2].x-this.openDelta)]}),r=a.default.createActionJob({node:this.backgroundDown,actions:[cc.moveTo(.1,0,this.positions[3].x-this.openDelta)]}),i=a.default.createActionJob({node:this.itemNode,actions:[cc.delayTime(.2)],name:"openBall"});return i.setJobBeginHandler(function(){t.setOpen(!1)}),i.setFinishHander(function(){t.itemNode.active=!1}),i.spawn(e),i.spawn(o),i.spawn(n),i.spawn(r),i},e.prototype.reuse=function(){this.itemNode.active=!0,this.setOpen(!1),this.setSelected(!1),this.markRemoved(!1),this.setBonus(!1,0)},e.prototype.unuse=function(){this.markRemoved(!0),this.foregroundDown.stopAllActions(),this.backgroundDown.stopAllActions(),this.foregroundUp.stopAllActions(),this.backgroundUp.stopAllActions(),this.itemNode.stopAllActions()},i([u(cc.Node)],e.prototype,"foregroundUp",void 0),i([u(cc.Node)],e.prototype,"foregroundDown",void 0),i([u(cc.Node)],e.prototype,"foregroundDownFill",void 0),i([u(cc.Node)],e.prototype,"backgroundUp",void 0),i([u(cc.Node)],e.prototype,"backgroundUpFill",void 0),i([u(cc.Node)],e.prototype,"backgroundDown",void 0),i([u(cc.Node)],e.prototype,"backgroundDownFill",void 0),i([u(cc.Node)],e.prototype,"itemNode",void 0),i([u(cc.Sprite)],e.prototype,"avatar",void 0),i([u(cc.SpriteFrame)],e.prototype,"specialImages",void 0),i([u(cc.Label)],e.prototype,"scoreLabel",void 0),i([u({type:cc.Vec2,tooltip:"x \u8868\u793a\u5173\u95ed\u65f6\u7684\u5750\u6807\uff0cy\u8868\u793a\u6253\u5f00\u65f6\u7684\u5750\u6807 \uff08\u4e0a\u524d\uff0c\u4e0a\u540e\uff0c\u4e0b\u524d\uff0c\u4e0b\u540e\uff09"})],e.prototype,"positions",void 0),i([u],e.prototype,"openDelta",void 0),i([u],e.prototype,"isStatic",void 0),i([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../GameKit/Framework/JobSystem/ActionJob":"ActionJob","./KMPlayground":"KMPlayground"}],KittyBonus:[function(t,e,o){"use strict";cc._RF.push(e,"da0396xcKJMsKvg7BSDpREk","KittyBonus");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Share/PopUI"),s=t("../Components/KittyCard"),c=t("../Data/KittyDB"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.kittys=[],e}return r(e,t),e.prototype.setStyle=function(e){t.prototype.setStyle.call(this,e);var o=e,n=c.default.getInstance().getKittyInfoById(o.kitty1),r=c.default.getInstance().getKittyInfoById(o.kitty2);this.kittys[0].setKittyInfo(n,!1),this.kittys[1].setKittyInfo(r,!1)},i([p(s.default)],e.prototype,"kittys",void 0),i([u],e)}(a.default);o.default=d,cc._RF.pop()},{"../../../GameKit/Share/PopUI":"PopUI","../Components/KittyCard":"KittyCard","../Data/KittyDB":"KittyDB"}],KittyCard:[function(t,e,o){"use strict";cc._RF.push(e,"3734dDOzMNHMYeI6JnOK5VN","KittyCard");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.quotes=null,e.kittyName=null,e.avatar=null,e.starContainer=null,e}return r(e,t),e.prototype.setKittyInfo=function(t,e){void 0===e&&(e=!0),this.avatar.spriteFrame=t.avatar,e?(this.kittyName.string="by "+t.name,t.quotes&&this.quotes&&(this.quotes.string=t.quotes)):this.kittyName.string=t.name;for(var o=Math.ceil(t.level/5),n=0;n<this.starContainer.childrenCount;n++)this.starContainer.children[n].active=n<o},i([c(cc.Label)],e.prototype,"quotes",void 0),i([c(cc.Label)],e.prototype,"kittyName",void 0),i([c(cc.Sprite)],e.prototype,"avatar",void 0),i([c(cc.Node)],e.prototype,"starContainer",void 0),i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],KittyCheckinItem:[function(t,e,o){"use strict";cc._RF.push(e,"1d305kqMXJD7Keid7m7HSpH","KittyCheckinItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Framework/Utils/Utils"),s=t("../KittyResouces"),c=t("../../../GameKit/Framework/i18n/i18n"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgNode=null,e.day=null,e.amount=null,e.image=null,e.checkMark=null,e._rewardsNode=null,e}return r(e,t),e.prototype.setItemData=function(t){a.default.isNotUndefinedOrNull(t)&&(this.node.active=!1);var e=t.day+1;if(this.node.active=!0,this.node.name="Day"+e,this.day.string=c.default.textWithVar("ui.checkin.days.number","\u7b2c${value}\u5929",e),this.amount.string=t.config.desc,a.default.isNotUndefinedOrNull(t.config.rewardsPrefab)){var o=s.default.getInstance().getOtherPrefab(t.config.rewardsPrefab);if(a.default.isNotUndefinedOrNull(o)){var n=cc.instantiate(o);n.setParent(this.image.node.parent),this.image.node.active=!1,n.setPosition(this.image.node.getPosition()),n.active=!0,t.config.scale>0&&(n.scale*=t.config.scale),this._rewardsNode=n}}t.isToday?this.bgNode.color=this.bgNode.color.fromHEX("#FBEAB5"):this.bgNode.color=cc.Color.WHITE,this.checkMark.active=t.isCheckedin},e.prototype.getRewardsNode=function(){return this._rewardsNode},i([p(cc.Node)],e.prototype,"bgNode",void 0),i([p(cc.Label)],e.prototype,"day",void 0),i([p(cc.Label)],e.prototype,"amount",void 0),i([p(cc.Sprite)],e.prototype,"image",void 0),i([p(cc.Node)],e.prototype,"checkMark",void 0),i([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/i18n/i18n":"i18n","../KittyResouces":"KittyResouces"}],KittyCheckin:[function(t,e,o){"use strict";cc._RF.push(e,"9bcf2Q1hadINLFTkU6E4SLS","KittyCheckin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Framework/View/UIMediator2"),l=t("./KittyCheckinItem"),u=t("../KittyResouces"),p=t("../KittyConsts"),d=t("../../../GameKit/Framework/Utils/UIHelper"),f=t("../Data/KittyTaskProxy"),h=t("../../../GameKit/Framework/Utils/Utils"),y=t("../Data/KittyDB"),_=t("../../../GameKit/Framework/i18n/i18n"),v=t("../Data/KittyLogger"),g=cc._decorator,b=g.ccclass,m=g.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemPrefab=null,e.positions=[],e.btnCheckin=null,e.continuedDays=null,e.lastCheckinDate=null,e.continuedCheckin=null,e.lastCheckin=null,e._items=[],e._todayItem=null,e}return r(e,t),e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),d.default.bindClickEvent(this.btnCheckin,this.checkin.bind(this));for(var e=0;e<this.positions.length;e++){var o=this.positions[e],n=cc.instantiate(this.itemPrefab);n.setParent(o),n.setPosition(0,0);var r=n.getComponent(l.default);this._items.push(r)}this._btnClose.node.active=!1,this.btnCheckin.node.active=!0,this.continuedCheckin.active=!1,this.lastCheckin.active=!1},e.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.addEvent(f.default.EVENTS.CHECK_IN,this.updateData,this)},e.prototype.updateData=function(){for(var t=this.retrieveProxy(p.default.PROXIES.TASK),e=t.getCheckinData(),o=0;o<this._items.length;o++){var n=this._items[o];if(o<e.length){var r=e[o];n.setItemData(r),n.node.active=!0,r.isToday&&(this._todayItem=n)}else n.node.active=!1}var i=t.getContinuedCheckin();if(this.continuedCheckin.active=i>1,this.lastCheckin.active=i<=1,t.getTotalCheckin()>0)if(i>1)this.continuedDays.string=_.default.textWithVar("ui.checkin.continued.days.value","${value}\u5929",i);else{var a=h.default.calculateDaysToNow(new Date(t.getLastCheckin()),!0);this.lastCheckinDate.string=a<=0?_.default.text("ui.checkin.last.date.today","\u4eca\u5929"):1==a?_.default.text("ui.checkin.last.date.yestoday","\u6628\u5929"):_.default.textWithVar("ui.checkin.last.date.others","${value}\u5929\u524d",a)}else this.lastCheckin.active=!1;var s=t.isTodayCheckined();this._btnClose.node.active=s,this.btnCheckin.node.active=!s},e.prototype.checkin=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i,a;return s(this,function(s){switch(s.label){case 0:return(t=this.retrieveProxy(p.default.PROXIES.TASK)).isTodayCheckined()?(this.sendNotification(p.default.EVENTS.TOAST,"\u4eca\u5929\u5df2\u7ecf\u6253\u8fc7\u5361\u5566"),[2]):(v.default.logAction(v.KITTY_ACTIONS.CHECK_IN),e=t.getTodayRewards(),t.checkin(),o=y.default.getInstance().generateRewards(e.rewardsAmount,e.rewardsType,e.rewardsPrefab,e.popupPrefab),e.showPopup?(n=_.default.text("ui.checkin.rewards.msg","\u55b5~\n\u8fd9\u662f\u4eca\u65e5\u4efd\u7684\u6253\u5361\u5956\u52b1"),v.default.setAdsSpace(v.KITTY_ADS_SPACE.CHECK_IN),[4,u.default.showRewardsWithAds(n,o.amount,2,o.prefab,e.scale,!0)]):[3,2]);case 1:return s.sent().adsShowed&&(o.amount*=2),[3,4];case 2:return r=this._todayItem.getRewardsNode(),[4,u.default.getInstance().playRewardsAssemlyEffect(r)];case 3:s.sent(),s.label=4;case 4:return(i=this.retrieveProxy(p.default.PROXIES.INVENTORY)).addRewards(o),t.save(),i.save(),(a=t.getContinuedCheckin())>=2?[4,this.showExtraRewards(a)]:[3,6];case 5:s.sent(),s.label=6;case 6:return[2]}})})},e.prototype.showExtraRewards=function(t){return a(this,void 0,void 0,function(){var e,o,n,r;return s(this,function(i){switch(i.label){case 0:return e=y.default.getInstance().generateRewards(60,p.PRICE_UNIT.COIN,p.default.REWARDS_PREFABS.FISH_CANS_4,p.default.REWARDS_PREFABS.FISH_CANS_4),o=_.default.textWithVar("ui.checkin.continued.days.rewards.msg","\u4f60\u5df2\u7ecf\u8fde\u7eed\u6253\u5361${value}\u5929\n\u8fd9\u662f\u732b\u54aa\u4eec\u7ed9\u4f60\u7684\u4e00\u4e2a\u60ca\u559c",t),n=10,v.default.setAdsSpace(v.KITTY_ADS_SPACE.CHECK_IN_BONUS),[4,u.default.showRewardsWithAds(o,e.amount,n,e.prefab,1,!0)];case 1:return i.sent().adsShowed&&(e.amount*=n),(r=this.retrieveProxy(p.default.PROXIES.INVENTORY)).addRewards(e),r.save(),[2]}})})},i([m(cc.Prefab)],e.prototype,"itemPrefab",void 0),i([m(cc.Node)],e.prototype,"positions",void 0),i([m(cc.Button)],e.prototype,"btnCheckin",void 0),i([m(cc.Label)],e.prototype,"continuedDays",void 0),i([m(cc.Label)],e.prototype,"lastCheckinDate",void 0),i([m(cc.Node)],e.prototype,"continuedCheckin",void 0),i([m(cc.Node)],e.prototype,"lastCheckin",void 0),i([b],e)}(c.default);o.default=w,cc._RF.pop()},{"../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/View/UIMediator2":"UIMediator2","../../../GameKit/Framework/i18n/i18n":"i18n","../Data/KittyDB":"KittyDB","../Data/KittyLogger":"KittyLogger","../Data/KittyTaskProxy":"KittyTaskProxy","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces","./KittyCheckinItem":"KittyCheckinItem"}],KittyCollectionItem:[function(t,e,o){"use strict";cc._RF.push(e,"77d091YK9dKDZ1XOhKcQdGz","KittyCollectionItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Framework/Extension/TableViewCell"),s=t("../../../GameKit/Framework/Utils/UIHelper"),c=t("../../../GameKit/App/AppFacade"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.level=null,e.kittyName=null,e.avatar=null,e.background=null,e.locked=null,e.special=null,e.light=null,e.lockedOnlyNode=[],e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){s.default.bindClickEvent(this,this.showDetail.bind(this))},e.prototype.showDetail=function(){c.default.getInstance().sendNotification(o.EVENT.SHOW_KITTY,this._data)},e.prototype.updateData=function(e,o,n){t.prototype.updateData.call(this,e,o,n),this.level.string=o.level.toString(),this.kittyName.string=o.name,this.special.active=o.special,this.avatar.spriteFrame=o.avatar,o.locked?(this.kittyName.string="???",this.level.string="?",this.avatar.node.color=cc.Color.BLACK,this.lockedOnlyNode.forEach(function(t){t.active=!0}),this.light.color=cc.Color.BLACK):(this.avatar.node.color=cc.Color.WHITE,this.lockedOnlyNode.forEach(function(t){t.active=!1}),this.light.color=cc.Color.YELLOW),this.light.active=o.generation>0,this._kittyId=o.id},e.EVENT={SHOW_KITTY:"Show.Kitty.Info.Event"},i([p(cc.Label)],e.prototype,"level",void 0),i([p(cc.Label)],e.prototype,"kittyName",void 0),i([p(cc.Sprite)],e.prototype,"avatar",void 0),i([p(cc.Sprite)],e.prototype,"background",void 0),i([p(cc.Node)],e.prototype,"locked",void 0),i([p(cc.Node)],e.prototype,"special",void 0),i([p(cc.Node)],e.prototype,"light",void 0),i([p(cc.Node)],e.prototype,"lockedOnlyNode",void 0),o=i([u],e)}(a.default);o.default=d,cc._RF.pop()},{"../../../GameKit/App/AppFacade":"AppFacade","../../../GameKit/Framework/Extension/TableViewCell":"TableViewCell","../../../GameKit/Framework/Utils/UIHelper":"UIHelper"}],KittyCollection:[function(t,e,o){"use strict";cc._RF.push(e,"92d51a3gb5HX7FlMXC1WZa1","KittyCollection");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Framework/View/UIMediator2"),l=t("../../../GameKit/Framework/Extension/TableView"),u=t("../Data/KittyDB"),p=t("../KittyConsts"),d=t("./KittyCollectionItem"),f=t("../../../GameKit/Framework/Utils/Utils"),h=t("../Components/KittyCard"),y=t("../../../GameKit/Framework/Utils/UIHelper"),_=t("../../../GameKit/Framework/Utils/ScreenShotNode"),v=t("../Data/KittyConfig"),g=t("../KittyResouces"),b=t("../../../GameKit/Framework/i18n/i18n"),m=t("../Data/KittyLogger"),w=cc._decorator,S=w.ccclass,P=w.property,O=0,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.kittyList=null,e.card=null,e.inputTest=null,e.btnPrevious=null,e.btnNext=null,e.btnShare=null,e.shareTxt=null,e._currentIdx=0,e._kitties=[],e}return r(e,t),e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),y.default.bindClickEvent(this.btnNext,this.nextKitty.bind(this)),y.default.bindClickEvent(this.btnPrevious,this.previousKitty.bind(this)),y.default.bindClickEvent(this.btnShare,this.share.bind(this)),y.default.bindClickEvent(this.inputTest,this.hideCard.bind(this))},e.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.addEvent(d.default.EVENT.SHOW_KITTY,this.showKittyCard,this)},e.prototype.updateData=function(){var t=u.default.getInstance().getAllKitties();this._kitties=t,this._currentIdx=0;for(var e=this.retrieveProxy(p.default.PROXIES.TASK),o=0;o<t.length;o++){var n=t[o];n.locked=n.level>e.getUnlockedLevel()}this.kittyList.initTableView(t),this.hideCard()},e.prototype.hideCard=function(){this.inputTest.node.active=!1,this.card.node.active=!1},e.prototype.showKittyCard=function(t){m.default.logAction(m.KITTY_ACTIONS.VIEW_KITTY_INFO),this.inputTest.node.active=!0,this.card.node.active=!0,this._currentIdx=t.index;var e=this.retrieveProxy(p.default.PROXIES.TASK);if(t.level<=e.getUnlockedLevel())this.card.setKittyInfo(t);else{var o=u.default.getInstance().getDogeInfo();this._currentIdx=-1,this.card.setKittyInfo(o)}},e.prototype.nextKitty=function(){var t;if(this._currentIdx++,this._currentIdx>=this._kitties.length)this._currentIdx=-1,t=u.default.getInstance().getDogeInfo();else{var e=this.retrieveProxy(p.default.PROXIES.TASK);(t=this._kitties[this._currentIdx]).level>e.getUnlockedLevel()&&(this._currentIdx=-1,t=u.default.getInstance().getDogeInfo())}this.showKittyCard(t)},e.prototype.previousKitty=function(){var t;this._currentIdx--,-1==this._currentIdx?t=u.default.getInstance().getDogeInfo():this._currentIdx<-1?(this._currentIdx=this._kitties.length-1,t=this._kitties[this._currentIdx]):t=this._kitties[this._currentIdx];for(var e=this.retrieveProxy(p.default.PROXIES.TASK);t.level>e.getUnlockedLevel();)if(this._currentIdx--,t=this._kitties[this._currentIdx],this._currentIdx<0){this._currentIdx=-1,t=u.default.getInstance().getDogeInfo();break}this.showKittyCard(t)},e.prototype.share=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i,a,c,l;return s(this,function(s){switch(s.label){case 0:return t=!1,0==O||O>5&&f.default.random()>.9?(e=b.default.text("ui.like.share","\u55b5~\n\u8c22\u8c22\u4f60\u559c\u6b22\u6211\u4eec~\n\u628a\u8fd9\u4e2a\u4e50\u8da3\u4e5f\u5206\u4eab\u7ed9\u597d\u53cb\u5427~"),c=u.default.getInstance().getCoinRewardsBySize(f.default.randomInt(10,15)),o=f.default.randomInt(5,11),n=void 0,v.default.SHARE_SCREENSHOT()?(r=this.card.node.getContentSize(),i=this.card.node.convertToWorldSpaceAR(cc.v2(0,0)),[4,_.default.takeAsync(!1,r,i,1)]):[3,3]):[3,5];case 1:return s.sent(),[4,_.default.getDataUrl()];case 2:n=s.sent(),s.label=3;case 3:return m.default.setSharePosition(m.KITTY_SHARE_POSITION.KITTY_INFO),[4,g.default.showCoinRewardsWithShareAndSave(e,c,o,1,{image:n,text:"The kitty is so cute~~"})];case 4:a=s.sent(),t=a.shared,O=0,s.label=5;case 5:return t||(c=u.default.getInstance().getCoinRewardsBySize(1),g.default.gatherCoinRewardsAndSave(c,this.btnShare.node),O%5==1&&(l=b.default.text("ui.like.toast","\u8c22\u8c22\u4f60\u7684\u559c\u6b22\uff0c\u4f60\u5feb\u4e50\u662f\u6211\u4eec\u6700\u5927\u7684\u5feb\u4e50\uff01"),g.default.showToast(l))),O++,[2]}})})},i([P(l.default)],e.prototype,"kittyList",void 0),i([P(h.default)],e.prototype,"card",void 0),i([P(cc.Button)],e.prototype,"inputTest",void 0),i([P(cc.Button)],e.prototype,"btnPrevious",void 0),i([P(cc.Button)],e.prototype,"btnNext",void 0),i([P(cc.Button)],e.prototype,"btnShare",void 0),i([P(cc.Label)],e.prototype,"shareTxt",void 0),i([S],e)}(c.default);o.default=E,cc._RF.pop()},{"../../../GameKit/Framework/Extension/TableView":"TableView","../../../GameKit/Framework/Utils/ScreenShotNode":"ScreenShotNode","../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/View/UIMediator2":"UIMediator2","../../../GameKit/Framework/i18n/i18n":"i18n","../Components/KittyCard":"KittyCard","../Data/KittyConfig":"KittyConfig","../Data/KittyDB":"KittyDB","../Data/KittyLogger":"KittyLogger","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces","./KittyCollectionItem":"KittyCollectionItem"}],KittyCommands:[function(t,e,o){"use strict";cc._RF.push(e,"fde95INKYVJA7Q4aIicaoqn","KittyCommands");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../../GameKit/Framework/Controller/SimpleCommand"),c=t("../KittyConsts"),l=t("../KittyResouces"),u=t("../Data/KittyDB"),p=t("../Data/KittyConfig"),d=t("../Network/RemoteCache"),f=t("../Network/KittyHttp"),h=t("../../../GameKit/Tpcl/Baidu/Baidu"),y=t("../../../GameKit/Framework/i18n/i18n"),_={INIT:"Init.App.Cmd"},v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.execute=function(){return i(this,void 0,void 0,function(){var t,e,o,n,r,i;return a(this,function(a){switch(a.label){case 0:return console.info("=====> language: "+cc.sys.language+", language code: "+cc.sys.languageCode),console.info("=====> chinese: "+cc.sys.LANGUAGE_CHINESE),console.info("=====> english: "+cc.sys.LANGUAGE_ENGLISH),[4,y.default.init("en","en","en")];case 1:return a.sent(),p.default.CACHE.USE_REMOTE_CACHE()?(t="user001",p.default.isBaidu()?[4,h.default.getSwanId()]:[3,4]):[3,10];case 2:return(t=a.sent())?[3,4]:(n=y.default.text("network.error.baiduLoginFail","\u554a\u54e6\uff0c\u767b\u5f55\u767e\u5ea6\u5931\u8d25\u4e86\uff01\n\n\u65e0\u6cd5\u8fde\u63a5\u670d\u52a1\u5668\uff0c\u8bf7\u91cd\u542f\u6e38\u620f\u8bd5\u8bd5\u3002"),[4,l.default.showNetworkError(n)]);case 3:return a.sent(),console.error("login failed"),cc.game.end(),[2];case 4:return[4,f.default.Login(t)];case 5:return(e=a.sent())&&e.success?[3,7]:(n=y.default.text("network.error.loginFail","\u554a\u54e6\uff0c\u767b\u5f55\u5931\u8d25\u4e86\uff01\n\n\u65e0\u6cd5\u8fde\u63a5\u670d\u52a1\u5668\uff0c\u8bf7\u91cd\u542f\u6e38\u620f\u8bd5\u8bd5\u3002"),[4,l.default.showNetworkError(n)]);case 6:return a.sent(),console.error("login failed"),cc.game.end(),[2];case 7:return console.info("[remote cache] loading ... "),[4,d.default.load()];case 8:return o=a.sent(),console.info("[remote cache] ready: ",o),o?[3,10]:(n=y.default.text("network.error.getDataFail","\u554a\u54e6\uff0c\u51fa\u95ee\u9898\u4e86\uff01\n\n\u65e0\u6cd5\u8fde\u63a5\u670d\u52a1\u5668\uff0c\u8bf7\u91cd\u542f\u6e38\u620f\u8bd5\u8bd5\u3002"),[4,l.default.showNetworkError(n)]);case 9:return a.sent(),console.error("login failed"),cc.game.end(),[2];case 10:return console.info("[cache] loading ... 0"),[4,this.retrieveProxy(c.default.PROXIES.INVENTORY).load()];case 11:return a.sent(),console.info("[cache] loading ... 1"),[4,(r=this.retrieveProxy(c.default.PROXIES.TASK)).load()];case 12:return a.sent(),console.info("[cache] loading ... 2"),i=r.getUnlockedLevel(),(i+=10)<30&&(i=30),u.default.getInstance().loadKittySequence(i),[2]}})})},e}(s.default),g={COMMANDS:_,registerToFacade:function(t){t.registerCommand(_.INIT,v)}};o.default=g,cc._RF.pop()},{"../../../GameKit/Framework/Controller/SimpleCommand":"SimpleCommand","../../../GameKit/Framework/i18n/i18n":"i18n","../../../GameKit/Tpcl/Baidu/Baidu":"Baidu","../Data/KittyConfig":"KittyConfig","../Data/KittyDB":"KittyDB","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces","../Network/KittyHttp":"KittyHttp","../Network/RemoteCache":"RemoteCache"}],KittyConfig:[function(t,e,o){"use strict";cc._RF.push(e,"806ebvdY69Ng4Ukl//aY/0X","KittyConfig"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../../../GameKit/Framework/Ads/AdsInterface"),r=t("../../../GameKit/Tpcl/Baidu/Baidu"),i=t("../../../GameKit/Framework/Model/LocalCache"),a=t("../../../GameKit/Tpcl/Facebook/Facebook"),s=t("../../../GameKit/Framework/Utils/Utils");function c(){return r.default.isValid()}function l(){return a.default.isValid()}function u(){return cc.sys.isNative&&cc.sys.isMobile}var p={ENABLE_RANK:!1,ENABLE_SHARE:function(){return!!c()||(l(),!0)},SHARE_SCREENSHOT:function(){return l(),!0},CACHE:{PROVIDER:function(){return c()?i.CACHE_PROVIDER.BAIDU:l()?i.CACHE_PROVIDER.FACEBOOK:i.CACHE_PROVIDER.LOCAL},USE_REMOTE_CACHE:function(){return!!c()}},ADS:{DAILY_MAX:10,PROVIDER:function(){return c()?n.ADS_PROVIDER.BAIDU:l()?n.ADS_PROVIDER.FACEBOOK:u()?n.ADS_PROVIDER.ADMOB:n.ADS_PROVIDER.NONE},ENABLE_BANNER_ADS:!0,ENABLE_RANDOM_ADS:!1,ENABLE_REWARDS_ADS:!0},isBaidu:c,isFacebook:l,isMinigame:function(){return"undefined"!=typeof MiniGameAds},isNativeMobile:u,isWechat:function(){return s.default.isNotUndefinedOrNull(void 0)},VERSION:"1.0.3",BUILD:25,Version:function(){return p.VERSION+"."+p.BUILD.toString()}};o.default=p,cc._RF.pop()},{"../../../GameKit/Framework/Ads/AdsInterface":"AdsInterface","../../../GameKit/Framework/Model/LocalCache":"LocalCache","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Tpcl/Baidu/Baidu":"Baidu","../../../GameKit/Tpcl/Facebook/Facebook":"Facebook"}],KittyConsts:[function(t,e,o){"use strict";cc._RF.push(e,"7ea6dZZgfJNhKulkOKTAnld","KittyConsts"),Object.defineProperty(o,"__esModule",{value:!0}),o.PRICE_UNIT=void 0,function(t){t[t.COIN=0]="COIN",t[t.GOLD=1]="GOLD",t[t.TICKET=2]="TICKET",t[t.SPECIAL_KITTY=3]="SPECIAL_KITTY",t[t.TOY=4]="TOY",t[t.OTHER=99]="OTHER"}(o.PRICE_UNIT||(o.PRICE_UNIT={}));o.default={PROXIES:{INVENTORY:"Inventory.Proxy",KITTY_PLAYGROUND:"Kitty.Playground.Proxy",TASK:"Task.Proxy",SHOP:"Shop.Proxy"},MEDIATORS:{HUD:"Kitty.Hud.Mediator",KITTY_PLAYGROUND:"Kitty.Playground.Mediator",KITTY_HOME:"Kitty.Home.Mediator",KITTY_SHOP:"Kitty.Shop.Mediator",KITTY_PETTING:"Kitty.Petting.Mediator",KITTY_LOTTERY:"Kitty.Lottery.Mediator",TASK:"Kitty.Tasks.Mediator",TEAM_TASK:"Kitty.Team.Tasks.Mediator",RANK:"Kitty.Rank.Mediator",HIDE_AND_SEEK:"Kitty.Hide.And.Seek.Mediator",CHECK_IN:"Kitty.Check.In.Mediator",KITTY_COLLECTION:"Kitty.Collections.Mediator",TREASURES:"Kitty.Treasures.Mediator",TOYS:"Kitty.Toys.Mediator",KITTY_FINDING:"Kitty.Finding.Mediator",KITTY_MATCH:"Kitty.Match.Mediator"},EVENTS:{READY_TO_START_GAME:"Ready.To.Start",RESOURCE_READY:"Resouce.Is.Ready",HIDDEN_KITTY_CLICKED:"Click.Hidden.Kitty",TOAST:"Normal.Toast",NOT_ENOUGH_MONEY:"Not.Enough.Money.Event",LOW_LEVEL_KITTY:"Low.Level.Kitty",NOT_ENOUGH_GOLD:"Not.Enough.Gold.Event",NO_MORE_SPACE:"No.More.Space.Event",NOT_ENOUGH_TICKETS:"Not.Enough.Tickets.Event",PLAYGROUND_KITTIES_UPDATE:"Playground.Kitties.Update.Event",KITTY_PRODUCE_COIN:"Kitty.Produce.Coin.Event",OFFLINE_COIN:"Kitty.Offline.Coin.Event",AUTO_SPAWN_LEVEL_UPDATE:"Auto.Spawn.Level.Update.Event",NETWORK_ERROR:"Network.Error"},UIEVENTS:{SHOW_SHOP:"Show.Shop.Request",BUY_KITTY:"Buy.Kitty.Request",SHOW_PETTING:"Show.Petting.Request",SHOW_LOTTERY:"Show.Lottery.Request",SHOW_HIDE_AND_SEEK:"Show.HideAndSeek.Request",SHOW_KITTY_COLLECTION:"Show.Kitty.Collection.Request",SHOW_KITTY_GIFTS:"Show.Kitty.Gifts.Request",SHOW_KITTY_TOYS:"Show.Kitty.Toys.Request",SHOW_KITTY_YARD:"Show.Kitty.Yard.Request",SHOW_RANK:"Show.Rank.Request",SHOW_CHECKIN:"Show.Checkin.Request",SHOW_TASK:"Show.Tasks.Request",SHOW_TEAM_TASK:"Show.Team.Tasks.Request",SHOW_TREASURES:"Show.Treasures.Request",SHOW_KITTY_FINDING:"Show.FindingKitty.Request",SHOW_KITTY_MATCH:"Show.KittyMatch.Request"},POP_PREFABS:{TOAST:"Toast",TEXT:"Text",REWARDS:"Rewards",KITTY_UNLOCKED:"KittyUnlocked",KITTY_BONUS:"KittyBonus",KITTY_NEW_GAMES:"KittyGameUnlocked",TEMP_ADS:"TempAds",KITTY_OPTION:"KittyOption"},REWARDS_PREFABS:{FISH_CANS_1:"FishCans1",FISH_CANS_2:"FishCans2",FISH_CANS_3:"FishCans3",FISH_CANS_4:"FishCans4",HEARTS_1:"Hearts1",HEARTS_2:"Hearts2",TICKETS:"Tickets"},SOUNDS:{CLICK:"click",BAD_CLICK:"bad_click",KITTY:"kitty",KITTY_UPGRADE:"kitty_upgrade",LOOT:"loot",CLOCK:"clock",EVENT:"event",WIN:"win",LOSE:"lose",NO:"no",OK:"ok",END:"end",BONUS:"bonus",KM_REMOVE:"remove",KM_SKILL:"skill",KM_BOMB:"bomb"}},cc._RF.pop()},{}],KittyDB:[function(t,e,o){"use strict";cc._RF.push(e,"dc681o9f/1FF7J3V2UWHvEM","KittyDB");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../../GameKit/Framework/Utils/Utils"),a=t("./KittyTaskInfo"),s=t("../KittyConsts"),c=t("../KittyResouces"),l=t("./KittyLevelSequence"),u=t("../../../GameKit/App/AppFacade"),p=t("../../../GameKit/Framework/i18n/i18n"),d=function(){function t(){this._shareId=-1}return t.getInstance=function(){return i.default.isUndefinedOrNull(t._inst)&&(t._inst=new t),t._inst},t.prototype.loadConfigs=function(){return n(this,void 0,void 0,function(){var t,e,o;return r(this,function(n){switch(n.label){case 0:return[4,i.default.loadRes("Config/Kitty",cc.JsonAsset)];case 1:return null!=(t=n.sent()).error?(console.error("[KittyDB] can't load kitty config: ",t.error),[2]):(e=t.resource,o=e.json,[4,this._loadKitty(o)]);case 2:return n.sent(),[2]}})})},t.prototype.loadKittySequence=function(t){this._sequence=l.default.createSequenceToLevel(t),this._sequence.flatternSequence(0)},t.prototype._loadKitty=function(t){return n(this,void 0,void 0,function(){var e,o,n,a,s,l,u,p;return r(this,function(){for(e=t.kitties,s=0;s<e.length;s++)o=e[s],n=c.default.getInstance().getKittyImageByName(o.avatar),i.default.isUndefinedOrNull(n)?console.warn("[KittyDB] loading kitty failed! kitty: ",o.avatar):o.sprite=n;for(this._kittyConfigs=e,a=t.kittyInfos,s=0;s<a.length;s++)l=a[s],u=l,p=this._getKittyConfig(l.kitty),i.default.isNotUndefinedOrNull(p)?u.config=p:u.config={id:0,name:"***",avatar:"",sprite:void 0,quotes:""},u.level<=0&&(u.level=this.getLevelFromId(u.id));return a.sort(function(t,e){return t.level==e.level?t.id-e.id:t.level-e.level}),this._kittys=a,this._totalLevels=t.totalLevels,[2]})})},t.prototype._loadToyes=function(t){return n(this,void 0,void 0,function(){var e,o,n,a,s,c,l,u;return r(this,function(r){switch(r.label){case 0:e=t.toyes,o=t.toyInfos,c=0,r.label=1;case 1:return c<e.length?(n=e[c],[4,i.default.loadRes("Toy/"+n.avatar,cc.SpriteFrame)]):[3,4];case 2:if(null!=(a=r.sent()).error)return console.warn("[KittyDB] loading toy: ",n.avatar,", error: ",a.error),[3,3];n.sprite=a.resource,r.label=3;case 3:return c++,[3,1];case 4:for(this._toyConfigs=e,s=[],c=0;c<o.length;c++)l=o[c],u=this._getToyConfig(l.toy),i.default.isNotUndefinedOrNull(u)?s.push({id:l.id,config:u}):console.warn("[KittyDB] loading toy error, missing config for toy id: ",l);return s.sort(function(t,e){return t.id-e.id}),this._toys=s,[2]}})})},t.prototype._getKittyConfig=function(t){for(var e,o=0;o<this._kittyConfigs.length;o++)if(this._kittyConfigs[o].id==t){e=this._kittyConfigs[o];break}return e},t.prototype._getKittyInfoConfig=function(t){for(var e,o=0;o<this._kittys.length;o++)if(this._kittys[o].id==t){e=this._kittys[o];break}return e},t.prototype.getTotalKittyLevels=function(){return this._totalLevels},t.prototype.getDogeInfo=function(){var t={},e=p.default.subItem("kitties","k0"),o=e?e.name:"Doge",n=e?e.quotes:"\u6211\u5ba3\u5e03,\n\u6211\u624d\u6700\u53ef\u7231~",r=i.default.concateStrings(n);return r=i.default.replaceAll(r,"<br>","\n"),t.level=0,t.avatar=c.default.getInstance().getImage("Dog"),t.name=o,t.quotes=r,t.index=-1,t},t.prototype.getKittyInfoById=function(t){if(!(t<=0)){var e=this._kittys.length,o=Math.floor((t-1)/e),n=t-o*e,r=this._getKittyInfoConfig(n);if(!i.default.isUndefinedOrNull(r)){var a=t,s="k"+r.config.id,c=p.default.subItem("kitties",s),l=c?c.name:r.config.name,u=c?c.quotes:r.config.quotes,d=i.default.concateStrings(u);d=i.default.replaceAll(d,"<br>","\n");var f={id:t,generation:0,name:l,level:a,avatar:r.config.sprite,produceRate:this.getProduceRate(a),sellRate:this.getSellRate(a),special:!1,quotes:d};return this.isSpecialKitty(t)&&(f.special=!0),f.generation=o,o>0&&(f.name=f.name+p.default.textWithVar("kitty.generation","${value}\u4e16",o+1)),f}cc.error("Invalid kitty id: ",n)}},t.prototype.getDefaultKittyInfoByLevel=function(t){if(!(t<=0)){var e=this.getIdFromLevel(t);return this.getKittyInfoById(e)}},t.prototype.getIdFromLevel=function(t){return t},t.prototype.getLevelFromId=function(t){return t%1e3},t.prototype.hasSpecialKittyByLevel=function(){return!1},t.prototype.getSpecialKittyIdByLevel=function(t){return 1e3+t},t.prototype.isSpecialKitty=function(t){return t>1e3},t.prototype.getRandomKittyAvatar=function(){var t=i.default.randomInt(0,this._kittys.length);return this._kittys[t].config.sprite},t.prototype.getAllKitties=function(){for(var t=[],e=0;e<this._totalLevels;e++){var o=e+1,n=this.getKittyInfoById(o);n.index=e,t.push(n)}return t},t.prototype.getAllKitties2=function(){for(var t=[],e=0;e<this._kittys.length;e++){var o=this._kittys[e].id,n=this.getKittyInfoById(o);n.index=e,t.push(n)}return t},t.prototype._getRate=function(t){if(t<=0)return 1},t.prototype.isExceedLevelLimit=function(t,e){return this._sequence.isLevelExceedLimit(t,e+1)},t.prototype.getSpawnPrice=function(t,e){var o=this._sequence.getLevelPrice(t,e+1);return o<=0&&(this._sequence=l.default.createSequenceToLevel(t+10),this._sequence.flatternSequence(0),o=this._sequence.getLevelPrice(t,e+1)),100*o},t.prototype.getSpawnPriceInGold=function(){return 100},t.prototype.getProduceRate=function(t){return 300*l.default.levelProduceRate(t)},t.prototype.getSellRate=function(t){var e=this.getSpawnPrice(t,0);return Math.ceil(.25*e)},t.prototype.getCheckinConfig=function(){return y},t.prototype._getToyConfig=function(t){for(var e,o=0;o<this._toyConfigs.length;o++)if(this._toyConfigs[o].id==t){e=this._toyConfigs[o];break}return e},t.prototype.getToyInfoById=function(t){for(var e,o=0;o<this._toys.length;o++)if(this._toys[o].id==t){e=this._toys[o];break}return e},t.prototype._kittyToyId=function(t){return 2e3+t},t.prototype.getAllToys=function(){for(var t=[],e=0;e<this._toys.length;e++){var o=this._toys[e],n={id:o.id,name:o.config.name,avatar:o.config.sprite};t.push(n)}return t},t.prototype.getDailyTaskCount=function(){return f.length},t.prototype.getAllDailyTasks=function(){return f},t.prototype.getDailyTaskById=function(t){for(var e,o=0;o<f.length;o++){var n=f[o];if(n.id==t){e=n;break}}return e},t.prototype.getLotteryConfigs=function(){return h},t.prototype.getCoinRewardsBySize=function(t){return u.default.getInstance().retrieveProxy(s.default.PROXIES.KITTY_PLAYGROUND).getTotalProduceRatePerSecond()*t},t.prototype.generateRewards=function(t,e,o,n){var r=t;return e==s.PRICE_UNIT.COIN&&(r=this.getCoinRewardsBySize(t)),{amount:r,unit:e,prefab:n||o}},t.prototype.getShareTitle=function(){var t=p.default.value("share.titles"),e=i.default.randomValueBetweenAndNotInList(0,t.length,[this._shareId]);return this._shareId=e,t[e]},t}();o.default=d;var f=[{id:3001,taskType:a.TASK_TYPE.MERGE_KITTY,target:9,rewardsAmount:20,rewardsType:s.PRICE_UNIT.GOLD,rewardsPrefab:s.default.REWARDS_PREFABS.HEARTS_1,showPopup:!1,popupPrefab:s.default.REWARDS_PREFABS.HEARTS_2,popupScale:1.5,desc:"\u5408\u6210{target}\u53ea\u732b\u54aa"},{id:3002,taskType:a.TASK_TYPE.CHECKIN,target:1,rewardsAmount:60,rewardsType:s.PRICE_UNIT.COIN,rewardsPrefab:s.default.REWARDS_PREFABS.FISH_CANS_2,showPopup:!0,popupPrefab:s.default.REWARDS_PREFABS.FISH_CANS_4,popupScale:1.5,rewardsString:"id:task.config.rewards.large.amount",adsRate:5,desc:"\u6253\u5361{target}\u6b21"},{id:3003,taskType:a.TASK_TYPE.PETTING,target:3,rewardsAmount:20,rewardsType:s.PRICE_UNIT.GOLD,rewardsPrefab:s.default.REWARDS_PREFABS.HEARTS_1,showPopup:!1,popupPrefab:s.default.REWARDS_PREFABS.HEARTS_2,popupScale:1.5,desc:"\u64b8\u732b{target}\u6b21"},{id:3004,taskType:a.TASK_TYPE.LOTTERY,target:3,rewardsAmount:60,rewardsType:s.PRICE_UNIT.COIN,rewardsPrefab:s.default.REWARDS_PREFABS.FISH_CANS_2,showPopup:!0,popupPrefab:s.default.REWARDS_PREFABS.FISH_CANS_4,popupScale:1.5,rewardsString:"id:task.config.rewards.large.amount",adsRate:5,desc:"\u62c6\u798f\u888b{target}\u6b21"},{id:3005,taskType:a.TASK_TYPE.HIDE_AND_SEEK,target:5,rewardsAmount:60,rewardsType:s.PRICE_UNIT.COIN,rewardsPrefab:s.default.REWARDS_PREFABS.FISH_CANS_2,showPopup:!0,popupPrefab:s.default.REWARDS_PREFABS.FISH_CANS_4,popupScale:1.5,rewardsString:"id:task.config.rewards.large.amount",adsRate:5,desc:"\u73a9\u627e\u5b9d\u85cf{target}\u6b21"}],h=[{slot:0,prefab:s.default.REWARDS_PREFABS.FISH_CANS_1,amount:10,rewardType:s.PRICE_UNIT.COIN,info:"id:fishcan.size.1"},{slot:1,prefab:s.default.REWARDS_PREFABS.FISH_CANS_2,amount:20,rewardType:s.PRICE_UNIT.COIN,showPopup:!0,popRewards:s.default.REWARDS_PREFABS.FISH_CANS_4,popupScale:1,adsRate:10,info:"id:fishcan.size.2"},{slot:2,prefab:s.default.REWARDS_PREFABS.FISH_CANS_3,amount:30,rewardType:s.PRICE_UNIT.COIN,showPopup:!0,popRewards:s.default.REWARDS_PREFABS.FISH_CANS_4,info:"id:fishcan.size.3",popupScale:1,adsRate:10},{slot:3,prefab:s.default.REWARDS_PREFABS.FISH_CANS_1,amount:10,rewardType:s.PRICE_UNIT.COIN,info:"id:fishcan.size.1"},{slot:4,prefab:s.default.REWARDS_PREFABS.HEARTS_2,amount:20,rewardType:s.PRICE_UNIT.GOLD,showPopup:!1,popupScale:1.5,adsRate:5,info:"+20"},{slot:5,prefab:s.default.REWARDS_PREFABS.FISH_CANS_1,amount:10,rewardType:s.PRICE_UNIT.COIN,info:"id:fishcan.size.1"},{slot:6,prefab:s.default.REWARDS_PREFABS.FISH_CANS_2,amount:20,rewardType:s.PRICE_UNIT.COIN,showPopup:!0,popRewards:s.default.REWARDS_PREFABS.FISH_CANS_4,popupScale:1,adsRate:7,info:"id:fishcan.size.2"},{slot:7,prefab:s.default.REWARDS_PREFABS.FISH_CANS_3,amount:30,rewardType:s.PRICE_UNIT.COIN,showPopup:!0,popRewards:s.default.REWARDS_PREFABS.FISH_CANS_4,popupScale:1,adsRate:9,info:"id:fishcan.size.3"},{slot:8,prefab:s.default.REWARDS_PREFABS.FISH_CANS_1,amount:1,rewardType:s.PRICE_UNIT.COIN,info:"id:fishcan.size.1"},{slot:9,prefab:s.default.REWARDS_PREFABS.TICKETS,amount:3,rewardType:s.PRICE_UNIT.TICKET,showPopup:!1,popupScale:1.5,info:"+3"}],y=[{day:0,rewardsAmount:50,rewardsType:s.PRICE_UNIT.GOLD,rewardsPrefab:s.default.REWARDS_PREFABS.HEARTS_1,scale:1.5,desc:"+50",isSpecial:!1,showPopup:!1,popupScale:1.5,popupPrefab:s.default.REWARDS_PREFABS.HEARTS_2},{day:1,rewardsAmount:50,rewardsType:s.PRICE_UNIT.GOLD,scale:1.5,rewardsPrefab:s.default.REWARDS_PREFABS.HEARTS_1,desc:"+50",isSpecial:!1,showPopup:!1,popupScale:1.5,popupPrefab:s.default.REWARDS_PREFABS.HEARTS_2},{day:2,rewardsAmount:100,rewardsType:s.PRICE_UNIT.GOLD,rewardsPrefab:s.default.REWARDS_PREFABS.HEARTS_2,scale:1.5,desc:"+100",isSpecial:!1,showPopup:!0,popupScale:1.5,popupPrefab:s.default.REWARDS_PREFABS.HEARTS_2},{day:3,rewardsAmount:50,rewardsType:s.PRICE_UNIT.GOLD,rewardsPrefab:s.default.REWARDS_PREFABS.HEARTS_1,scale:1.5,desc:"+50",isSpecial:!1,showPopup:!1,popupScale:1.5,popupPrefab:s.default.REWARDS_PREFABS.HEARTS_2},{day:4,rewardsAmount:50,rewardsType:s.PRICE_UNIT.GOLD,rewardsPrefab:s.default.REWARDS_PREFABS.HEARTS_1,scale:1.5,desc:"+50",isSpecial:!1,showPopup:!1,popupScale:1.5,popupPrefab:s.default.REWARDS_PREFABS.HEARTS_2},{day:5,rewardsAmount:50,rewardsType:s.PRICE_UNIT.GOLD,rewardsPrefab:s.default.REWARDS_PREFABS.HEARTS_1,scale:1.5,desc:"+50",isSpecial:!1,showPopup:!1,popupScale:1.5,popupPrefab:s.default.REWARDS_PREFABS.HEARTS_2},{day:6,rewardsAmount:200,rewardsType:s.PRICE_UNIT.GOLD,rewardsPrefab:s.default.REWARDS_PREFABS.HEARTS_2,scale:1.5,desc:"+200",isSpecial:!1,showPopup:!0,popupScale:1.5,popupPrefab:s.default.REWARDS_PREFABS.HEARTS_2}];cc._RF.pop()},{"../../../GameKit/App/AppFacade":"AppFacade","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/i18n/i18n":"i18n","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces","./KittyLevelSequence":"KittyLevelSequence","./KittyTaskInfo":"KittyTaskInfo"}],KittyFacade:[function(t,e,o){"use strict";cc._RF.push(e,"eb1bc3Nc3pJSqu7c7AOmZkz","KittyFacade");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../GameKit/Framework/Facade"),l=t("./Cmd/KittyCommands"),u=t("./Data/KittyInventoryProxy"),p=t("./KittyConsts"),d=t("./Cmd/FeedCommands"),f=t("./Data/KittyTaskProxy"),h=t("./Data/KittyShopProxy"),y=cc._decorator,_=y.ccclass,v=(y.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.getInstance=function(){return c.default._instance},e.prototype.initFacade=function(){this.init(),this.registerCommands(),this.registerGlobalProxies(),this.registerGlobalMediators()},e.prototype.startFacade=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.executeCommand(l.default.COMMANDS.INIT)];case 1:return t.sent(),[4,this.executeCommand(d.default.COMMANDS.PREPARE)];case 2:return t.sent(),console.info("=====> ready to start game"),this.sendNotification(p.default.EVENTS.READY_TO_START_GAME),[2]}})})},e.prototype.registerCommands=function(){l.default.registerToFacade(this),d.default.registerToFacade(this)},e.prototype.registerGlobalProxies=function(){var t=u.default.create(p.default.PROXIES.INVENTORY);this.registerProxy(t),t.init();var e=f.default.create(p.default.PROXIES.TASK);this.registerProxy(e),e.init();var o=h.default.create(p.default.PROXIES.SHOP);this.registerProxy(o),o.init()},e.prototype.registerGlobalMediators=function(){},i([_],e)}(c.default));o.default=v,cc._RF.pop()},{"../../GameKit/Framework/Facade":"Facade","./Cmd/FeedCommands":"FeedCommands","./Cmd/KittyCommands":"KittyCommands","./Data/KittyInventoryProxy":"KittyInventoryProxy","./Data/KittyShopProxy":"KittyShopProxy","./Data/KittyTaskProxy":"KittyTaskProxy","./KittyConsts":"KittyConsts"}],KittyFinding:[function(t,e,o){"use strict";cc._RF.push(e,"0819bGC+itB57oFtg0Vqvp3","KittyFinding");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Framework/View/UIMediator2"),l=t("../../../GameKit/Framework/Utils/UIHelper"),u=t("../KittyConsts"),p=t("../../../GameKit/Framework/Utils/Utils"),d=t("../KittyResouces"),f=t("../../../FindingKitty/Scripts/KFPlayground"),h=t("../../../FindingKitty/Scripts/CardboardBox"),y=t("./Wallet"),_=t("../Data/KittyInventoryProxy"),v=t("../Components/HeartEffect"),g=t("../KittyApp"),b=t("../Data/KittyDB"),m=t("../../../GameKit/Framework/i18n/i18n"),w=t("../Data/KittyLogger"),S=cc._decorator,P=S.ccclass,O=S.property,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playground=null,e.btnReplay=null,e.wallet=null,e.heartEffect=null,e.level=null,e._levelCounter=0,e._wrongInput=0,e}return r(e,t),e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),this.btnReplay.node.active=!1,l.default.bindClickEvent(this.btnReplay,this.replayGame.bind(this))},e.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.addEvent(f.default.EVENTS.GAME_READY,this.onGameReady,this),this.addEvent(f.default.EVENTS.GAME_END,this.onGameEnd,this),this.addEvent(h.default.EVENTS.FOUND_KITTY,this.onFindKitty,this),this.addEvent(h.default.EVENTS.MISS_KITTY,this.onMissKitty,this),this.addEvent(_.default.EVENTS.COIN_UPDATE,this.updateWallet,this),this.addEvent(_.default.EVENTS.GOLD_UPDATE,this.updateWallet,this)},e.prototype.onClose=function(){this.playground.stopGame(),t.prototype.onClose.call(this),g.default.playLobbyBgm()},e.prototype.tryPlay=function(){var t=this.retrieveProxy(u.default.PROXIES.INVENTORY);return t.addGold(1),t.save(),!0},e.prototype._updateLevel=function(){this.level.string=m.default.textWithVar("ui.hide.seek.level","\u7b2c${value}\u5c40",this._levelCounter+1)},e.prototype.prepareGame=function(){var t=this._levelCounter%5,e=0,o=-1;if(this._levelCounter<5)switch(t){case 0:e=0,o=3;break;case 1:e=2,o=4;break;case 2:e=3,o=5;break;case 3:e=4,o=7;break;case 4:e=5,o=9}else 4==t&&(e=7,o=9);this.playground.prepareGame(e,o)},e.prototype.resetGame=function(){this.playground.resetGame()},e.prototype.startGame=function(){return this._levelCounter=0,this._wrongInput=0,g.default.playSlowBgm(),this.heartEffect.node.active=!1,this.updateWallet(),this.tryPlay()?(this._updateLevel(),this.prepareGame(),!0):(this.sendNotification(u.default.EVENTS.NOT_ENOUGH_GOLD),this.onClose(),!1)},e.prototype.playHeartEffect=function(t,e){var o=cc.instantiate(this.heartEffect.node);o.setPosition(e),o.setParent(this.heartEffect.node.parent),o.active=!0;var n=o.getComponent(v.default);n.play(t.toString(),function(){n.destroy()})},e.prototype.onGameReady=function(){w.default.logAction(w.KITTY_ACTIONS.PLAY_HIDE_AND_SEEK),this.playground.playGame()},e.prototype.onGameEnd=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r;return s(this,function(i){switch(i.label){case 0:return t=!1,this._wrongInput>0?(n=m.default.text("ui.hide.seek.guide.msg","\u4f60\u8f93\u4e86\uff01\n\n\u6e38\u620f\u89c4\u5219\n1).\u4e0d\u8981\u9519\u8fc7\u4efb\u4f55\u4e00\u53ea\u732b\u54aa\n2).\u4e5f\u4e0d\u8981\u70b9\u5230\u6363\u4e71\u7684\u72d7\u72d7"),[4,d.default.showMsg(n,{yesText:m.default.text("ui.hide.seek.restart","\u518d\u6765\u4e00\u6b21"),hideCancel:!0})]):[3,2];case 1:return t=i.sent(),[3,4];case 2:return this._levelCounter++,this._levelCounter%5!=0?[3,4]:(e=b.default.getInstance().getCoinRewardsBySize(this._levelCounter),o=p.default.randomInt(5,11),n=m.default.textWithVar("event.hide.seek.rewards.msg","\u55b5\uff0c\u4f60\u53ef\u771f\u4f1a\u73a9\u85cf\u732b\u732b~\n\u4f60\u5df2\u7ecf\u8d62\u4e86${value}\u5c40\uff01\uff01\n\u8fd9\u662f\u4f60\u5e94\u5f97\u7684\u5956\u52b1:",this._levelCounter),w.default.setAdsSpace(w.KITTY_ADS_SPACE.HIDE_AND_SEEK),[4,d.default.showRewardsWithAds(n,e,o,u.default.REWARDS_PREFABS.FISH_CANS_4,1,!0)]);case 3:i.sent().adsShowed&&(e*=o),(r=this.retrieveProxy(u.default.PROXIES.INVENTORY)).addCoin(e),r.save(),i.label=4;case 4:return this._wrongInput=0,t?this.resetGame():this.tryPlay()?(this._updateLevel(),this.prepareGame()):(this.sendNotification(u.default.EVENTS.NOT_ENOUGH_GOLD),this.onClose()),[2]}})})},e.prototype.onFindKitty=function(t){t.isDog?(p.default.convertNode1PositionToNode2ParentSpaceAR(t.kitty,this.heartEffect.node),this._wrongInput++):this.gatherRewards(t)},e.prototype.onMissKitty=function(t){t.isDog||this._wrongInput++},e.prototype.gatherRewards=function(t){var e=this.wallet.coinIcon,o=(this.wallet.goldIcon,t.kitty),n=d.default.getInstance().getOtherPrefab(u.default.REWARDS_PREFABS.FISH_CANS_1),r=e;d.default.getInstance().playRewardsAssembly(n,o,r,!0,1);var i=this.retrieveProxy(u.default.PROXIES.INVENTORY);i.addCoinBySize(1),i.save()},e.prototype.replayGame=function(){},e.prototype.onWin=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.updateWallet=function(){var t=this.retrieveProxy(u.default.PROXIES.INVENTORY),e=t.getCoin(),o=t.getGold();this.wallet.updateData({coin:e,gold:o})},i([O(f.default)],e.prototype,"playground",void 0),i([O(cc.Button)],e.prototype,"btnReplay",void 0),i([O(y.default)],e.prototype,"wallet",void 0),i([O(v.default)],e.prototype,"heartEffect",void 0),i([O(cc.Label)],e.prototype,"level",void 0),i([P],e)}(c.default);o.default=E,cc._RF.pop()},{"../../../FindingKitty/Scripts/CardboardBox":"CardboardBox","../../../FindingKitty/Scripts/KFPlayground":"KFPlayground","../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/View/UIMediator2":"UIMediator2","../../../GameKit/Framework/i18n/i18n":"i18n","../Components/HeartEffect":"HeartEffect","../Data/KittyDB":"KittyDB","../Data/KittyInventoryProxy":"KittyInventoryProxy","../Data/KittyLogger":"KittyLogger","../KittyApp":"KittyApp","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces","./Wallet":"Wallet"}],KittyGameUnlocked:[function(t,e,o){"use strict";cc._RF.push(e,"6d729UN149N7rPTXke9zOcO","KittyGameUnlocked");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Share/PopUI"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.avatar=null,e}return r(e,t),e.prototype.setStyle=function(e){t.prototype.setStyle.call(this,e)},i([l(cc.Sprite)],e.prototype,"avatar",void 0),i([c],e)}(a.default);o.default=u,cc._RF.pop()},{"../../../GameKit/Share/PopUI":"PopUI"}],KittyGuideSettings:[function(t,e,o){"use strict";var n;cc._RF.push(e,"cfa2c2VrY9B+4n2ILwNagT1","KittyGuideSettings"),Object.defineProperty(o,"__esModule",{value:!0}),o.GUIDE_INPUT=void 0,function(t){t[t.NONE=-1]="NONE",t[t.ClICK=0]="ClICK",t[t.DRAG=1]="DRAG"}(n=o.GUIDE_INPUT||(o.GUIDE_INPUT={}));var r={steps:[{id:1,msg:"\u55b5<br>\u770b\u8d77\u6765\u4f60\u662f\u4e2a\u65b0\u624b<br>\u8ba9\u6211\u6765\u6559\u6559\u4f60\u5427",begin:{account:0},end:{event:0}},{id:2,msg:"\u9996\u5148\uff0c\u70b9\u51fb\u732b\u98df\u76c6<br>\u9886\u517b\u4e00\u53ea\u732b\u54aa",begin:void 0,input:{op:n.ClICK,area:0,expension:{x:50,y:10},tip:"\u70b9\u51fb\u732b\u98df\u76c6"},end:{event:1,kitty:{level:1,count:1}}},{id:3,msg:"\u4f60\u9886\u517b\u4e86\u4e00\u53ea\u5c0f\u5976\u732b~<br><br>\u8981\u4e0d\u8981\u518d\u6765\u4e00\u53ea\uff1f",begin:{account:1,kitty:{level:1,count:1,slot:1}},end:{event:0}},{id:4,msg:"\u73b0\u5728\uff0c\u518d\u70b9\u4e00\u6b21\u732b\u98df\u76c6",begin:void 0,input:{op:n.ClICK,expension:{x:50,y:10},area:0,tip:"\u70b9\u51fb\u732b\u98df\u76c6"},end:{event:1,kitty:{level:1,count:2}}},{id:5,msg:"\u770b<br>\u73b0\u5728\u4f60\u67092\u53ea\u5c0f\u5976\u732b\u4e86<br>\u8bd5\u8bd5\u628a\u4ed6\u4eec\u62d6\u5230\u4e00\u8d77\u5427",begin:{account:1,kitty:{level:1,count:2}},input:{op:n.DRAG,expension:{x:400,y:50},area:1,tip:"\u62d6\u52a8\u732b\u54aa",kitty:1},end:{event:1,kitty:{level:2,count:1}}},{id:6,msg:"\u54c7\u54e6<br>\u5c0f\u5976\u732b\u5347\u7ea7\u4e86\uff01",begin:void 0,end:{event:0}},{id:7,msg:"\u73b0\u5728\uff0c\u6211\u4eec\u6765\u91cd\u590d\u4e00\u4e0b\u64b8\u732b\u6b65\u9aa4: \n\n\u7b2c\u4e00\u6b65\uff0c\u70b9\u51fb\u732b\u98df\u76c6\uff0c\u9886\u517b\u732b\u54aa",begin:{account:2,kitty:{level:2,count:1}},end:{event:0}},{id:8,msg:"\u7b2c\u4e8c\u6b65\uff0c\u62d6\u52a8\u540c\u7ea7\u732b\u54aa\u8fdb\u884c\u5347\u7ea7~",begin:void 0,end:{event:0}},{id:9,msg:"\u90a3\u4e48\uff0c\u5f00\u59cb\u9886\u517b\u66f4\u591a\u732b\u54aa\u5427~",begin:void 0,end:{event:0}}]};o.default=r,cc._RF.pop()},{}],KittyGuide:[function(t,e,o){"use strict";cc._RF.push(e,"e43c17VOH5FQI21j+PwvVhj","KittyGuide");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../GameKit/Framework/Extension/SingleNode"),l=t("./Data/KittyGuideSettings"),u=t("../../GameKit/Framework/Utils/Utils"),p=t("../../GameKit/App/AppFacade"),d=t("./KittyConsts"),f=t("../../GameKit/Framework/i18n/i18n"),h=t("./Data/KittyLogger"),y=cc._decorator,_=y.ccclass,v=y.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputAreas=[],e.guideLayer=null,e.highlight=null,e.highlightMask=null,e.dialogNode=null,e.dialog=null,e.autoNextHint=null,e.inputHand=null,e.inputTip=null,e.inputBackground=null,e.inputBlocker=null,e.inputTestLayer=null,e._current=0,e}var o;return r(e,t),o=e,e.getInstance=function(){return o._inst},e.prototype._onloaded=function(){return a(this,void 0,void 0,function(){return s(this,function(){return t.prototype._onloaded.call(this),o._inst=this,[2]})})},e.prototype.start=function(){this.guideLayer.active=!1},e.prototype.prepare=function(){return a(this,void 0,void 0,function(){return s(this,function(){return p.default.getInstance().registerObserver(d.default.EVENTS.PLAYGROUND_KITTIES_UPDATE,this._onKittyEvent,this),this._current=0,this.inputTestLayer.on(cc.Node.EventType.TOUCH_START,this._onTouchBegin,this),[2]})})},e.prototype.hasStep=function(t){return t>=0&&t<l.default.steps.length},e.prototype.loadStep=function(t){if(this._current=t,!this.hasStep(t))return this.guideLayer.active=!1,!1;this.guideLayer.active=!0,h.default.logGuideStep(t);var e=l.default.steps[t];return this._currentStep=e,this._updateDialog(e),this._updateInput(e),!0},e.prototype.nextStep=function(){var t=this._current+1;this.hasStep(t)?this.loadStep(t):(h.default.logPageExit(),this.endGuide(t))},e.prototype.endGuide=function(t){this.guideLayer.active=!1,this._current=t,this._currentStep=void 0,p.default.getInstance().removeObserver(d.default.EVENTS.PLAYGROUND_KITTIES_UPDATE,this._onKittyEvent,this)},e.prototype._updateDialog=function(t){var e="";if(!u.default.isUndefinedOrNullOrEmpty(t.msg)){var o="guide.step."+t.id+".msg";e=f.default.text(o,t.msg)}this.dialog.string=u.default.replaceAll(e,"<br>","\n")},e.prototype._updateInput=function(t){if(u.default.isUndefinedOrNull(t.input)||t.input.op<=l.GUIDE_INPUT.NONE)this.inputBlocker.active=!0,this.highlight.active=!1,this.inputHand.active=!1,this.inputTip.node.parent.active=!1,this.autoNextHint.active=!0;else{this.inputBlocker.active=!1,this.highlight.active=!0,this.inputHand.active=!0,this.inputTip.node.parent.active=!0,this.autoNextHint.active=!1;var e=this.inputAreas[t.input.area],o=e.getContentSize();t.input.expension&&(o.width+=t.input.expension.x,o.height+=t.input.expension.y);var n=e.convertToWorldSpaceAR(cc.v2()),r=this.highlight.parent.convertToNodeSpaceAR(n);if(this.highlight.setPosition(r),this.highlight.setContentSize(o),this.highlightMask.updateAlignment(),this._inputArea=cc.rect(n.x-o.width/2,n.y-o.height/2,o.width,o.height),t.input.tip){var i="guide.step."+t.id+".input.tip",a=f.default.text(i,t.input.tip);this.inputTip.string=a,this.inputTip._forceUpdateRenderData(!0),this.inputBackground.width=this.inputTip.node.width+30,this.inputBackground.height=this.inputTip.node.height}this.inputHand.stopAllActions(),this.inputHand.setPosition(r),t.input.op==l.GUIDE_INPUT.DRAG?this._showDragAnimation(t.input.kitty):t.input.op==l.GUIDE_INPUT.ClICK&&this._showClickAnimation()}},e.prototype._showClickAnimation=function(){this.inputHand.stopAllActions(),this.inputHand.y;var t=cc.moveBy(.2,0,15),e=cc.scaleTo(.2,.9,.9),o=cc.spawn(t,e),n=cc.moveBy(.2,0,-15),r=cc.scaleTo(.2,1,1),i=cc.spawn(n,r),a=cc.sequence(o,cc.delayTime(.4),i,cc.delayTime(.5)).repeatForever();this.inputHand.runAction(a)},e.prototype._showDragAnimation=function(t){var e=this,o=p.default.getInstance().retrieveMediator(d.default.MEDIATORS.KITTY_PLAYGROUND).getKitties(t);if(o.length<2)console.error("[Guide] invalid kitties with level: ",t);else{var n=o[1].node,r=o[0].node,i=n.convertToWorldSpaceAR(cc.v2());i=this.inputHand.parent.convertToNodeSpaceAR(i);var a=r.convertToWorldSpaceAR(cc.v2());a=this.inputHand.parent.convertToNodeSpaceAR(a);var s=cc.callFunc(function(){e.inputHand.setPosition(i)}),c=cc.moveTo(.75,a),l=cc.delayTime(.75),u=cc.sequence(s,c,l).repeatForever();this.inputHand.runAction(u)}},e.prototype.testBeginCondition=function(t){if(u.default.isUndefinedOrNull(t.begin)||u.default.isUndefinedOrNull(t.begin.account))return!1;var e=p.default.getInstance().retrieveProxy(d.default.PROXIES.TASK),o=!0;u.default.isNotUndefinedOrNull(t.begin.account)&&e.getUnlockedLevel()!=t.begin.account&&(o=!1);var n=!0;if(u.default.isNotUndefinedOrNull(t.begin.kitty)){var r=p.default.getInstance().retrieveMediator(d.default.MEDIATORS.KITTY_PLAYGROUND);if(t.begin.kitty.count>0&&(i=r.getKitties(t.begin.kitty.level)).length!=t.begin.kitty.count&&(n=!1),t.begin.kitty.slot>0){var i=r.getKitties(0);r.cellContainer.cellCount-i.length<t.begin.kitty.slot&&(n=!1)}}return o&&n},e.prototype.testEndCondition=function(){var t=!1,e=this._currentStep;return e.end.event<=0?t=!0:1==e.end.event&&p.default.getInstance().retrieveMediator(d.default.MEDIATORS.KITTY_PLAYGROUND).getKitties(e.end.kitty.level).length>=e.end.kitty.count&&(t=!0),t},e.prototype.testGuide=function(){return a(this,void 0,void 0,function(){var t,e,o;return s(this,function(n){switch(n.label){case 0:for(t=this._current,e=!1;t<l.default.steps.length;t++)if(o=l.default.steps[t],this.testBeginCondition(o)){e=!0;break}return e?(h.default.logPageEnter(h.KITTY_PAGES.GUIDE),[4,u.default.waitFor(.02)]):[3,2];case 1:return n.sent(),this.loadStep(t),[3,3];case 2:this.endGuide(t),n.label=3;case 3:return[2,e]}})})},e.prototype._onTouchBegin=function(t){var e=l.default.steps[this._current];if(u.default.isNotUndefinedOrNull(e.input)&&e.input.op!=l.GUIDE_INPUT.NONE){var o=t.getLocation();this._inputArea.contains(o)||(t.stopPropagation(),this.inputTestLayer._touchListener.setSwallowTouches(!0))}else t.stopPropagation(),this._clickToNext();this.inputTestLayer._touchListener.setSwallowTouches(!1)},e.prototype._clickToNext=function(){this.testEndCondition()&&this.nextStep()},e.prototype._onKittyEvent=function(){this.hasStep(this._current)&&(this.testEndCondition()?this.nextStep():this._updateInput(this._currentStep))},i([v(cc.Node)],e.prototype,"inputAreas",void 0),i([v(cc.Node)],e.prototype,"guideLayer",void 0),i([v(cc.Node)],e.prototype,"highlight",void 0),i([v(cc.Widget)],e.prototype,"highlightMask",void 0),i([v(cc.Node)],e.prototype,"dialogNode",void 0),i([v(cc.Label)],e.prototype,"dialog",void 0),i([v(cc.Node)],e.prototype,"autoNextHint",void 0),i([v(cc.Node)],e.prototype,"inputHand",void 0),i([v(cc.Label)],e.prototype,"inputTip",void 0),i([v(cc.Node)],e.prototype,"inputBackground",void 0),i([v(cc.Node)],e.prototype,"inputBlocker",void 0),i([v(cc.Node)],e.prototype,"inputTestLayer",void 0),o=i([_],e)}(c.default);o.default=g,cc._RF.pop()},{"../../GameKit/App/AppFacade":"AppFacade","../../GameKit/Framework/Extension/SingleNode":"SingleNode","../../GameKit/Framework/Utils/Utils":"Utils","../../GameKit/Framework/i18n/i18n":"i18n","./Data/KittyGuideSettings":"KittyGuideSettings","./Data/KittyLogger":"KittyLogger","./KittyConsts":"KittyConsts"}],KittyHideAndSeek:[function(t,e,o){"use strict";cc._RF.push(e,"f0ac16X6apHYJK9XuS/aVnX","KittyHideAndSeek");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Framework/View/UIMediator2"),l=t("../../../FillUp/Script/Game/Playground"),u=t("../../../GameKit/Framework/Utils/UIHelper"),p=t("../KittyConsts"),d=t("../../../GameKit/Framework/Utils/Utils"),f=t("../KittyResouces"),h=t("./Wallet"),y=t("../Data/KittyInventoryProxy"),_=t("../KittyApp"),v=t("../Data/KittyDB"),g=t("../../../GameKit/Framework/i18n/i18n"),b=t("../Data/KittyLogger"),m=cc._decorator,w=m.ccclass,S=m.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hsPlayground=null,e.btnReplay=null,e.wallet=null,e._produceRate=0,e._lootCounter=0,e}return r(e,t),e.prototype.onClose=function(){t.prototype.onClose.call(this),_.default.playLobbyBgm()},e.prototype.show=function(e){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return _.default.playSlowBgm(),[4,t.prototype.show.call(this,e)];case 1:return o.sent(),[2]}})})},e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),u.default.bindClickEvent(this.btnReplay,this.replayGame.bind(this))},e.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.addEvent(l.HIDE_AND_SEEK.EVENTS.WIN,this.onWin,this),this.addEvent(l.HIDE_AND_SEEK.EVENTS.LOOT,this.onLoot,this),this.addEvent(y.default.EVENTS.COIN_UPDATE,this.updateWallet,this),this.addEvent(y.default.EVENTS.GOLD_UPDATE,this.updateWallet,this)},e.prototype.startGame=function(){b.default.logAction(b.KITTY_ACTIONS.PLAY_TREASURE_HUNT),this._lootCounter=0,this.updateWallet();var t=this.retrieveProxy(p.default.PROXIES.KITTY_PLAYGROUND);return this._produceRate=t.getTotalProduceRatePerSecond(),this.tryPlay()?(this.hsPlayground.startGame(),!0):(this.onClose(),this.sendNotification(p.default.EVENTS.NOT_ENOUGH_GOLD),!1)},e.prototype.tryPlay=function(){var t=this.retrieveProxy(p.default.PROXIES.INVENTORY);return t.addGold(1),t.save(),!0},e.prototype.replayGame=function(){this.tryPlay()?(this._lootCounter=0,this.hsPlayground.replayGame()):this.sendNotification(p.default.EVENTS.NOT_ENOUGH_GOLD)},e.prototype.onWin=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i;return s(this,function(a){switch(a.label){case 0:return(t=this.retrieveProxy(p.default.PROXIES.TASK)).addHideAndSeekTaskCounter(),t.save(),this._lootCounter>=5?[4,d.default.waitFor(500)]:[3,3];case 1:return a.sent(),e=g.default.text("event.treasure.hunt.rewards.msg","\u54c7\u54e6~\n\u4f60\u53d1\u73b0\u4e86\u4e00\u4e2a\u5927\u5b9d\u85cf~~~"),o=d.default.randomInt(10,20),n=v.default.getInstance().getCoinRewardsBySize(o),r=d.default.randomInt(5,11),b.default.setAdsSpace(b.KITTY_ADS_SPACE.TREASURE_HUNT),[4,f.default.showRewardsWithAds(e,n,r,p.default.REWARDS_PREFABS.FISH_CANS_4,1,!0)];case 2:a.sent().adsShowed&&(n*=r),(i=this.retrieveProxy(p.default.PROXIES.INVENTORY)).addCoin(n),i.save(),a.label=3;case 3:return[4,d.default.waitFor(500)];case 4:return a.sent(),this.startGame(),[2]}})})},e.prototype.updateWallet=function(){var t=this.retrieveProxy(p.default.PROXIES.INVENTORY),e=t.getCoin(),o=t.getGold();this.wallet.updateData({coin:e,gold:o})},e.prototype.onLoot=function(t){this._lootCounter++;var e=this.retrieveProxy(p.default.PROXIES.INVENTORY);switch(t.type){case l.HIDE_AND_SEEK.LOOT_TYPE.COIN:var o=this._produceRate*t.amount;e.addCoin(o);break;case l.HIDE_AND_SEEK.LOOT_TYPE.HEART:e.addGold(t.amount);break;case l.HIDE_AND_SEEK.LOOT_TYPE.KITTY:e.addTicket(t.amount);break;case l.HIDE_AND_SEEK.LOOT_TYPE.EXIT:console.info("[HideAndSeek] exit")}e.save()},i([S(l.default)],e.prototype,"hsPlayground",void 0),i([S(cc.Button)],e.prototype,"btnReplay",void 0),i([S(h.default)],e.prototype,"wallet",void 0),i([w],e)}(c.default);o.default=P,cc._RF.pop()},{"../../../FillUp/Script/Game/Playground":"Playground","../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/View/UIMediator2":"UIMediator2","../../../GameKit/Framework/i18n/i18n":"i18n","../Data/KittyDB":"KittyDB","../Data/KittyInventoryProxy":"KittyInventoryProxy","../Data/KittyLogger":"KittyLogger","../KittyApp":"KittyApp","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces","./Wallet":"Wallet"}],KittyHome:[function(t,e,o){"use strict";cc._RF.push(e,"d34ebfQ7R9M8LMsZwNHuqEc","KittyHome");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Cmd/FeedCommands"),l=t("../../../GameKit/Framework/View/MediatorComp"),u=t("../KittyConsts"),p=t("../../../GameKit/Framework/Utils/UIHelper"),d=t("../KittyUtils"),f=t("../Data/KittyTaskProxy"),h=t("../Data/KittyLogger"),y=cc._decorator,_=y.ccclass,v=y.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.topMenu=null,e.bottomMenu=null,e.btnRank=null,e.btnFriends=null,e.btnCheckin=null,e.checkinRedDot=null,e.btnDailyTask=null,e.taskRedDot=null,e.btnSpawn=null,e.btnLottery=null,e.btnPetting=null,e.btnHideAndSeek=null,e.btnKittyInBox=null,e.btnKittyMatch=null,e.btnToys=null,e.btnRecycle=null,e.spawnLevel=null,e.spawnPrice=null,e.toyButtons=null,e._toysShow=!0,e.btnCollections=null,e.btnShop=null,e}return r(e,t),e.prototype.initEvents=function(){var e=this;t.prototype.initEvents.call(this),this.addEvent(u.default.EVENTS.AUTO_SPAWN_LEVEL_UPDATE,function(t){e.updateSpawnInfo(t.level,t.price)}),this.addEvent(f.default.EVENTS.NEW_KITTY_LEVEL_UNLOCKED,this.updateButtons,this),this.addEvent(f.default.EVENTS.TASK_COUNTER_CHANGE,this._updateTaskNofication,this),this.addEvent(f.default.EVENTS.TASK_CLAIM_STATUS_CHANGE,this._updateTaskNofication,this),this.addEvent(u.default.UIEVENTS.SHOW_KITTY_TOYS,this.showToys,this)},e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),p.default.bindClickEvent(this.btnSpawn,this.onSpawnRequest.bind(this),!1,void 0,"none"),p.default.bindClickEvent(this.btnShop,u.default.UIEVENTS.SHOW_SHOP)},e.prototype.onSpawnRequest=function(){return a(this,void 0,void 0,function(){var t,e,o;return s(this,function(){return h.default.logAction(h.KITTY_ACTIONS.SPAWN_KITTY),t=this.retrieveProxy(u.default.PROXIES.KITTY_PLAYGROUND),e=t.getAutoSpawnLevel(),o=t.getAutoSpawnPrice(),this.executeCommand(c.default.COMMANDS.SPAWN,{level:e,price:o.price,unit:o.unit}),[2]})})},e.prototype.startFeedingKitty=function(){var t=this.retrieveProxy(u.default.PROXIES.KITTY_PLAYGROUND),e=t.getAutoSpawnLevel(),o=t.getAutoSpawnPrice();this.updateSpawnInfo(e,o.price),this.updateButtons(),this._updateTaskNofication(),this._showToyButtons(!0)},e.prototype.updateSpawnInfo=function(t,e){var o="Lv."+t,n=d.default.formatNumber(e);this.retrieveProxy(u.default.PROXIES.TASK).getSpawnCounter(t),this.spawnLevel.string=o,this.spawnPrice.string=n},e.prototype.updateButtons=function(){var t=this.retrieveProxy(u.default.PROXIES.TASK).getUnlockedLevel();this._showComponentOnLevel(this.btnFriends,-1,t),this._showComponentOnLevel(this.btnRank,-1,t),this._showComponentOnLevel(this.btnShop,-1,t),this._showComponentOnLevel(this.btnRecycle,0,t),this._showComponentOnLevel(this.btnCollections,0,t),this._showComponentOnLevel(this.btnToys,0,t),this._showNodeOnLevel(this.btnHideAndSeek.node.parent,0,t),this._showComponentOnLevel(this.btnCheckin,0,t),this._showComponentOnLevel(this.btnPetting,0,t),this._showComponentOnLevel(this.btnLottery,0,t),this._showComponentOnLevel(this.btnHideAndSeek,0,t),this._showComponentOnLevel(this.btnKittyInBox,0,t),this._showComponentOnLevel(this.btnKittyMatch,0,t),this._showComponentOnLevel(this.btnDailyTask,0,t)},e.prototype._showComponentOnLevel=function(t,e,o){this._showNodeOnLevel(t.node,e,o)},e.prototype._showNodeOnLevel=function(t,e,o){t.active=e>=0&&o>=e},e.prototype._updateTaskNofication=function(){var t=this.retrieveProxy(u.default.PROXIES.TASK),e=t.hasUnclaimedTask();this._playButtonShake(this.btnDailyTask,e),this.taskRedDot.active=e;var o=!t.isTodayCheckined();this.checkinRedDot.active=o,this._playButtonShake(this.btnCheckin,o)},e.prototype._playButtonShake=function(t,e){e?t.getComponent(cc.Animation).play():(t.getComponent(cc.Animation).stop(),t.node.setScale(1))},e.prototype.showToys=function(){this._showToyButtons(!this._toysShow)},e.prototype._showToyButtons=function(t){this._toysShow=t,this.toyButtons.getComponent(cc.Layout).updateLayout();var e=this.toyButtons.getComponent(cc.Widget);e.updateAlignment(),e.left=t?-30:75-this.toyButtons.width,e.updateAlignment()},i([v(cc.Node)],e.prototype,"topMenu",void 0),i([v(cc.Node)],e.prototype,"bottomMenu",void 0),i([v(cc.Button)],e.prototype,"btnRank",void 0),i([v(cc.Button)],e.prototype,"btnFriends",void 0),i([v(cc.Button)],e.prototype,"btnCheckin",void 0),i([v(cc.Node)],e.prototype,"checkinRedDot",void 0),i([v(cc.Button)],e.prototype,"btnDailyTask",void 0),i([v(cc.Node)],e.prototype,"taskRedDot",void 0),i([v(cc.Button)],e.prototype,"btnSpawn",void 0),i([v(cc.Button)],e.prototype,"btnLottery",void 0),i([v(cc.Button)],e.prototype,"btnPetting",void 0),i([v(cc.Button)],e.prototype,"btnHideAndSeek",void 0),i([v(cc.Button)],e.prototype,"btnKittyInBox",void 0),i([v(cc.Button)],e.prototype,"btnKittyMatch",void 0),i([v(cc.Button)],e.prototype,"btnToys",void 0),i([v(cc.Button)],e.prototype,"btnRecycle",void 0),i([v(cc.Label)],e.prototype,"spawnLevel",void 0),i([v(cc.Label)],e.prototype,"spawnPrice",void 0),i([v(cc.Node)],e.prototype,"toyButtons",void 0),i([v(cc.Button)],e.prototype,"btnCollections",void 0),i([v(cc.Button)],e.prototype,"btnShop",void 0),i([_],e)}(l.default);o.default=g,cc._RF.pop()},{"../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/Framework/View/MediatorComp":"MediatorComp","../Cmd/FeedCommands":"FeedCommands","../Data/KittyLogger":"KittyLogger","../Data/KittyTaskProxy":"KittyTaskProxy","../KittyConsts":"KittyConsts","../KittyUtils":"KittyUtils"}],KittyHttp:[function(t,e,o){"use strict";cc._RF.push(e,"e9525gY4SpL7rgbjG2HmI3T","KittyHttp");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../../GameKit/Framework/Network/HttpRequest"),a=t("../KittyFacade"),s=t("../KittyConsts"),c=0,l=function(){function t(){}return t.addError=function(){c++,console.warn("[KittyHttp] error count: ",c),a.default.getInstance().sendNotification(s.default.EVENTS.NETWORK_ERROR,{errorCount:c})},t.resetError=function(){c=0},t.Request=function(e,o,a){return n(this,void 0,void 0,function(){var n,s,l;return r(this,function(r){switch(r.label){case 0:return c>10?(console.warn("[KittyHttp] too many errors: ",c),[2]):(n=a?JSON.stringify(a):void 0,s="https://gc01.xmanyou.com/"+o,[4,i.default.Send(e,s,{header:{},data:n})]);case 1:return(l=r.sent()).error?(console.warn("[KittyHttp] Request error, status=",l.status,", resp=",l.response),t.addError(),[2]):l.response?(t.resetError(),[2,JSON.parse(l.response.text)]):(console.warn("[KittyHttp] Request error, no response, status=",l.status),t.addError(),[2])}})})},t.Login=function(e){return n(this,void 0,Promise,function(){var o,n;return r(this,function(r){switch(r.label){case 0:return[4,t.Request(i.default.METHOD.POST,"login",{user:e})];case 1:return o=r.sent(),n={success:!1},o&&(console.info("[Login] resp: ",o),t.token=o.result,0!=o.errorCode?n.success=!1:n.success=!0),[2,n]}})})},t.Heartbeat=function(){return n(this,void 0,void 0,function(){return r(this,function(){return[2]})})},t.SetData=function(e,o){return n(this,void 0,void 0,function(){var n,a,s;return r(this,function(r){switch(r.label){case 0:return n="string"==typeof o?o:JSON.stringify(o),[4,t.Request(i.default.METHOD.POST,"storage/set",{token:t.token,key:e,data:n})];case 1:return a=r.sent(),s={success:!1},a&&(0!=a.errorCode?s.success=!1:s.success=!0),[2,s]}})})},t.GetData=function(e){return n(this,void 0,void 0,function(){var o,n,a;return r(this,function(r){switch(r.label){case 0:return[4,t.Request(i.default.METHOD.POST,"storage/get",{token:t.token,key:e})];case 1:return o=r.sent(),n={success:!1,data:void 0},o&&(0!=o.errorCode?n.success=!1:(n.success=!0,a={},o.result&&o.result.length>0&&(a=JSON.parse(o.result)),n.data=a)),[2,n]}})})},t.token="",t.xrsf="",t.loginTime=0,t}();o.default=l,cc._RF.pop()},{"../../../GameKit/Framework/Network/HttpRequest":"HttpRequest","../KittyConsts":"KittyConsts","../KittyFacade":"KittyFacade"}],KittyHud:[function(t,e,o){"use strict";cc._RF.push(e,"5f67aWiSF9FJ7vCO/Zq+6J7","KittyHud");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Framework/View/MediatorComp"),s=t("../Data/KittyInventoryProxy"),c=t("../KittyConsts"),l=t("../KittyUtils"),u=t("../Data/KittyTaskProxy"),p=t("../Data/KittyDB"),d=t("../../../GameKit/Framework/Utils/Utils"),f=t("../../../GameKit/Framework/Extension/ToggleButton"),h=t("../../../GameKit/Framework/Utils/UIHelper"),y=t("../../../GameKit/Framework/Audio/AudioControl"),_=cc._decorator,v=_.ccclass,g=_.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelIcon=null,e.levelValue=null,e.levelName=null,e.coinValue=null,e.coinProduceValue=null,e.goldValue=null,e.avatar=null,e.btnMuteSound=null,e}return r(e,t),e.prototype.start=function(){},e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),y.default.getInstance()&&this.btnMuteSound.setOn(y.default.getInstance().isMute()),h.default.bindClickEvent(this.btnMuteSound,function(){y.default.getInstance().swithMuteState()})},e.prototype.initEvents=function(){var e=this;t.prototype.initEvents.call(this),this.addEvent(s.default.EVENTS.COIN_UPDATE,this.onCoinUpdate,this),this.addEvent(s.default.EVENTS.GOLD_UPDATE,this.onGoldUpdate,this),this.addEvent(s.default.EVENTS.DATA_UPDATE,this.onInventoryUpdate,this),this.addEvent(u.default.EVENTS.NEW_KITTY_LEVEL_UNLOCKED,this.updateData,this),this.addEvent(c.default.EVENTS.PLAYGROUND_KITTIES_UPDATE,this.updateData,this),this.addEvent(y.default.EVENTS.MUTE_STATE_CHANGE,function(t){e.btnMuteSound.setOn(t)})},e.prototype.onCoinUpdate=function(t){this.coinValue.string=l.default.formatNumber(t.current)},e.prototype.onGoldUpdate=function(t){this.goldValue.string=l.default.formatNumber(t.current)},e.prototype.onInventoryUpdate=function(){var t=this.retrieveProxy(c.default.PROXIES.INVENTORY),e=t.getCoin(),o=t.getGold();this.coinValue.string=l.default.formatNumber(e),this.goldValue.string=l.default.formatNumber(o)},e.prototype.updateAccountLevelInfo=function(t){this.levelValue.string="Lv."+t;var e=p.default.getInstance().getDefaultKittyInfoByLevel(t);d.default.isUndefinedOrNull(e)?(this.avatar.node.color=cc.Color.BLACK,this.levelName.string=""):(this.avatar.node.color=cc.Color.WHITE,this.levelName.string=e.name,this.avatar.spriteFrame=e.avatar)},e.prototype.updateData=function(){var t=this.retrieveProxy(c.default.PROXIES.INVENTORY),e=this.retrieveProxy(c.default.PROXIES.KITTY_PLAYGROUND),o=this.retrieveProxy(c.default.PROXIES.TASK),n=t.getCoin(),r=t.getGold(),i=Math.ceil(e.getTotalProduceRate()/3);this.coinValue.string=l.default.formatNumber(n),this.goldValue.string=l.default.formatNumber(r),this.coinProduceValue.string="+"+l.default.formatNumber(i);var a=o.getUnlockedLevel();this.updateAccountLevelInfo(a)},i([g(cc.Sprite)],e.prototype,"levelIcon",void 0),i([g(cc.Label)],e.prototype,"levelValue",void 0),i([g(cc.Label)],e.prototype,"levelName",void 0),i([g(cc.Label)],e.prototype,"coinValue",void 0),i([g(cc.Label)],e.prototype,"coinProduceValue",void 0),i([g(cc.Label)],e.prototype,"goldValue",void 0),i([g(cc.Sprite)],e.prototype,"avatar",void 0),i([g(f.default)],e.prototype,"btnMuteSound",void 0),i([v],e)}(a.default);o.default=b,cc._RF.pop()},{"../../../GameKit/Framework/Audio/AudioControl":"AudioControl","../../../GameKit/Framework/Extension/ToggleButton":"ToggleButton","../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/View/MediatorComp":"MediatorComp","../Data/KittyDB":"KittyDB","../Data/KittyInventoryProxy":"KittyInventoryProxy","../Data/KittyTaskProxy":"KittyTaskProxy","../KittyConsts":"KittyConsts","../KittyUtils":"KittyUtils"}],KittyInfo:[function(t,e,o){"use strict";cc._RF.push(e,"e8822iL4ZdPDKkfyY+IvRwG","KittyInfo"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],KittyInventoryProxy:[function(t,e,o){"use strict";cc._RF.push(e,"e4da4E0WqNNOJnnjK5Vk8I0","KittyInventoryProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Framework/Model/Proxy"),l=t("../../../GameKit/Framework/Utils/Utils"),u=t("../KittyConsts"),p=t("../../../GameKit/Framework/Model/LocalCache"),d=t("./KittyDB"),f=t("./KittyConfig"),h=t("../Network/RemoteCache"),y=cc._decorator,_=y.ccclass,v=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._toys=[],e._treasures=[],e._tickets=0,e}var o;return r(e,t),o=e,e.create=function(t){var e=new o;return e.name=t,e},e.prototype.getCoin=function(){return this._coin},e.prototype.setCoin=function(t){this._coin=t},e.prototype.addRewards=function(t){switch(t.unit){case u.PRICE_UNIT.GOLD:this.addGold(t.amount);break;case u.PRICE_UNIT.TICKET:this.addTicket(t.amount);break;case u.PRICE_UNIT.TOY:this.addToy(t.amount,1);break;case u.PRICE_UNIT.SPECIAL_KITTY:case u.PRICE_UNIT.OTHER:break;case u.PRICE_UNIT.COIN:default:this.addCoin(t.amount)}},e.prototype.addCoin=function(t){this.setCoin(this._coin+t),this.sendNotification(o.EVENTS.COIN_UPDATE,{current:this.getCoin()})},e.prototype.spendCoin=function(t){this.setCoin(this._coin-t),this.sendNotification(o.EVENTS.COIN_UPDATE,{current:this.getCoin()})},e.prototype.addCoinBySize=function(t){var e=d.default.getInstance().getCoinRewardsBySize(t);this.addCoin(e)},e.prototype.getGold=function(){return this._gold},e.prototype.setGold=function(t){this._gold=t},e.prototype.addGold=function(t){this.setGold(this._gold+t),this.sendNotification(o.EVENTS.GOLD_UPDATE,{current:this.getGold()})},e.prototype.spendGold=function(t){this.setGold(this._gold-t),this.sendNotification(o.EVENTS.GOLD_UPDATE,{current:this.getGold()})},e.prototype.canBuy=function(t,e){return e==u.PRICE_UNIT.GOLD?this.getGold()>=t:this.getCoin()>=t},e.prototype.spend=function(t,e){e==u.PRICE_UNIT.GOLD?this.spendGold(t):this.spendCoin(t)},e.prototype.getOfflineTime=function(){return this._offlineTime},e.prototype.getOfflineCoin=function(){var t=this.getOfflineTime();l.default.formatTime(t).hours>=1&&(t=l.default.msHour(1));var e=this.retrieveProxy(u.default.PROXIES.KITTY_PLAYGROUND).getTotalProduceRatePerSecond();return{coin:Math.ceil(e*t/1e3),time:t}},e.prototype.init=function(){this.setCoin(6e4),this.setGold(0),this._time=Date.now(),this._offlineTime=0,this._tickets=0,this._toys=[],this.sendNotification(o.EVENTS.DATA_UPDATE,{proxy:this})},e.prototype.save=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(){return t={coin:this.getCoin(),gold:this.getGold(),time:Date.now(),toys:this._toys,tickets:this._tickets},f.default.CACHE.USE_REMOTE_CACHE()?(h.default.putObj(o.KEY,t),h.default.save()):p.default.putObj(o.KEY,t),[2]})})},e.prototype.load=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return f.default.CACHE.USE_REMOTE_CACHE()?(t=h.default.getObj(o.KEY),[3,3]):[3,1];case 1:return[4,p.default.getObj(o.KEY)];case 2:t=e.sent(),e.label=3;case 3:return l.default.isNotUndefinedOrNull(t)&&(l.default.isNotUndefinedOrNull(t.coin)&&this.setCoin(t.coin),l.default.isNotUndefinedOrNull(t.gold)&&this.setGold(t.gold),l.default.isNotUndefinedOrNull(t.time)&&(this._time=t.time),l.default.isNotUndefinedOrNull(t.toys)&&(this._toys=t.toys),l.default.isNotUndefinedOrNull(t.tickets)&&(this._tickets=t.tickets)),this._offlineTime=Date.now()-this._time,this.sendNotification(o.EVENTS.DATA_UPDATE,{proxy:this}),[2]}})})},e.prototype.addToy=function(t,e){var n;void 0===e&&(e=1);for(var r=0;r<this._toys.length;r++)if(l.default.isNotUndefinedOrNull(this._toys[r])&&this._toys[r].id==t){n=this._toys[r];break}return l.default.isUndefinedOrNull(n)?(n={id:t,count:e},this._toys.push(n)):n.count+=e,this.sendNotification(o.EVENTS.TOY_UPDATE,{proxy:this}),n.count},e.prototype.getToyCount=function(t){for(var e,o=0;o<this._toys.length;o++)if(l.default.isNotUndefinedOrNull(this._toys[o])&&this._toys[o].id==t){e=this._toys[o];break}return l.default.isUndefinedOrNull(e)?0:e.count},e.prototype.getTickets=function(){return this._tickets},e.prototype.useTicket=function(t){if(void 0===t&&(t=1),this._tickets<t)return!1;this._tickets-=t,this.sendNotification(o.EVENTS.TICKET_UPDATE,{current:this._tickets});var e=this.retrieveProxy(u.default.PROXIES.TASK);return e.addLotteryTaskCounter(),e.save(),!0},e.prototype.addTicket=function(t){this._tickets+=t,this.sendNotification(o.EVENTS.TICKET_UPDATE,{current:this._tickets})},e.KEY="Kitty.Inventory",e.EVENTS={DATA_UPDATE:"Inventory.Update.Event",COIN_UPDATE:"Coin.Update.Event",GOLD_UPDATE:"Gold.Update.Event",TOY_UPDATE:"Toys.Update.Event",TICKET_UPDATE:"Ticket.Update.Event"},o=i([_],e)}(c.default));o.default=v,cc._RF.pop()},{"../../../GameKit/Framework/Model/LocalCache":"LocalCache","../../../GameKit/Framework/Model/Proxy":"Proxy","../../../GameKit/Framework/Utils/Utils":"Utils","../KittyConsts":"KittyConsts","../Network/RemoteCache":"RemoteCache","./KittyConfig":"KittyConfig","./KittyDB":"KittyDB"}],KittyItem:[function(t,e,o){"use strict";cc._RF.push(e,"7f79fV6FKxHWYNpBlH2agWq","KittyItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../KittyUtils"),l=t("../KittyFacade"),u=t("../KittyConsts"),p=t("../../../GameKit/Framework/Utils/Utils"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.avatarNode=null,e.avatar=null,e.producerNode=null,e.producerValue=null,e.specialMark=null,e.kittyMsgs=[],e.stars=[],e.light=null,e._interval=3,e._timeCounter=0,e._y0=0,e._level=1,e._produceRate=100,e}return r(e,t),e.prototype.start=function(){this._setLevel(this._level),this.producerNode.active=!1,this._y0=this.producerNode.y},e.prototype._setLevel=function(t){this._level=t,this.label&&(this.label.string=t.toString());var e=Math.ceil(t/5);this.setStars(e)},Object.defineProperty(e.prototype,"level",{get:function(){return this._level},enumerable:!1,configurable:!0}),e.prototype._setProduceRate=function(t){this._produceRate=t,this.producerValue.string="+"+c.default.formatNumber(t)},e.prototype.setKittyInfo=function(t){this._kittyId=t.id,this._kittyInfo=t,this._setLevel(t.level),this._setProduceRate(t.produceRate),this.avatar.spriteFrame=t.avatar,this.light.active=t.generation>0},e.prototype.setDelay=function(t){this._timeCounter-=t},e.prototype.getKittyId=function(){return this._kittyId},e.prototype.update=function(t){this._timeCounter+=t,this._timeCounter>=this._interval&&(this._timeCounter-=this._interval,this.autoProduce())},e.prototype.highlight=function(t){this.avatar.node.color=t?cc.Color.WHITE:cc.Color.GRAY},e.prototype.autoProduce=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.producerNode.active=!0,this.producerNode.y=this._y0,this.playProduceAnimation(),l.default.getInstance().sendNotification(u.default.EVENTS.KITTY_PRODUCE_COIN,{coin:this._produceRate}),[2]})})},e.prototype.playProduceAnimation=function(){var t=this,e=cc.moveBy(.35,0,25),o=cc.callFunc(function(){t.producerNode.active=!1}),n=cc.sequence(e,o);this.producerNode.runAction(n);var r=cc.scaleTo(.1,1.1,1.1),i=cc.scaleTo(.2,1,1);this.avatarNode.runAction(cc.sequence(r,i))},e.prototype.setKittyMsg=function(t){t<0&&(t=p.default.randomInt(0,this.kittyMsgs.length));for(var e=0;e<this.kittyMsgs.length;e++)this.kittyMsgs[e].active=e==t},e.prototype.setStars=function(t){t<0&&(t=p.default.randomInt(0,this.stars.length));for(var e=0;e<this.stars.length;e++)this.stars[e].active=e<t},i([h(cc.Label)],e.prototype,"label",void 0),i([h(cc.Node)],e.prototype,"avatarNode",void 0),i([h(cc.Sprite)],e.prototype,"avatar",void 0),i([h(cc.Node)],e.prototype,"producerNode",void 0),i([h(cc.Label)],e.prototype,"producerValue",void 0),i([h(cc.Node)],e.prototype,"specialMark",void 0),i([h(cc.Node)],e.prototype,"kittyMsgs",void 0),i([h(cc.Node)],e.prototype,"stars",void 0),i([h(cc.Node)],e.prototype,"light",void 0),i([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../GameKit/Framework/Utils/Utils":"Utils","../KittyConsts":"KittyConsts","../KittyFacade":"KittyFacade","../KittyUtils":"KittyUtils"}],KittyLevelSequence:[function(t,e,o){"use strict";cc._RF.push(e,"2b909ugkodJpaH77WjFpX7Y","KittyLevelSequence"),Object.defineProperty(o,"__esModule",{value:!0}),o.PRODUCE_RATE=o.PRICE_RATE=void 0,o.PRICE_RATE=1.5,o.PRODUCE_RATE=2;var n=function(){function t(){}return t.create=function(e,o,n){var r=new t;return r.levels=o,r.repeat=n,r.owner=e,r},t.prototype.getCount=function(){return this.levels.length*this.repeat},t.prototype.flatternSequence=function(t){for(var e=this,o=[],n=t,r=[],i=0;i<this.repeat;i++)this.levels.forEach(function(i){r[i]?r[i]++:r[i]=1,o.push({owner:e.owner,seq:n,seq2:n-t,level:i,counter:r[i],price:1}),n++});return o},t}(),r=function(){function t(){this.flatternedSequence=[],this.levelCounters=[],this.priceMatrix=[],this.sequence=[]}return t.prototype.add=function(t){this.sequence.push(t)},t.prototype.getSequence=function(){return this.sequence},t.prototype.calculateSpawnCount=function(){return this.flatternedSequence.length},t.prototype.calculateMergeCount=function(){for(var t=0,e=0,o=0,n=0;n<this.levelCounters.length;n++){var r=this.levelCounters[n];if(isNaN(r)){if(e<1){o++;continue}}else e+=r;e>1&&(e%2!=0&&console.warn("invalid level counter: ",this.levelCounters),t+=e/=2,o++)}for(;e>1;)e%2!=0&&console.warn("invalid level counter: ",this.levelCounters),t+=e/=2,o++;return{cont:t,level:o}},t.prototype.flatternSequence=function(e){var n=e,r=[],i=[],a=[],s=[],c=void 0;return this.sequence.forEach(function(e){e.flatternSequence(n).forEach(function(e){r[e.level]?r[e.level]++:r[e.level]=1,i[e.owner]?i[e.owner]++:i[e.owner]=1;var n={owner:e.owner,seq:e.seq,seq2:i[e.owner],level:e.level,counter:r[e.level],price:1};if(s.push(n),c){a[n.level]||(a[n.level]=[]);var l=a[n.level];n.price=c.price*Math.pow(o.PRICE_RATE,n.level-c.level),n.price*=t.sequencePriceRate(n.seq),n.price=Math.ceil(n.price),l[n.counter]=n.price}c=n}),n+=e.getCount()}),this.flatternedSequence=s,this.levelCounters=r,this.priceMatrix=a,{seq:s,counter:r}},t.prototype.getFlatternedSequence=function(){return{seq:this.flatternedSequence,counter:this.levelCounters}},t.prototype.isLevelExceedLimit=function(t,e){if(1==t&&1==e)return!1;var o=!1,n=this.priceMatrix[t];return n&&(o=!n[e]),o},t.prototype.getLevelPrice=function(t,e){if(1==t&&1==e)return 1;var o=0,n=this.priceMatrix[t];if(n){var r=n[e];o=r||(r=n[n.length-1])*Math.pow(2,e-n.length+1)}return o},t.createSpawnSequenceForLevel=function(e){var o=new t;switch(e){case 0:case 1:o.add(n.create(e,[1],1));break;case 2:o.add(n.create(e,[1],2));break;case 3:o.add(n.create(e,[1],4));break;case 4:o.add(n.create(e,[1],8));break;case 5:o.add(n.create(e,[1],16));break;case 6:o.add(n.create(e,[2],4)),o.add(n.create(e,[2,1],8));break;case 7:o.add(n.create(e,[3],2)),o.add(n.create(e,[3,2,1],8));break;case 8:default:o.add(n.create(e,[e-4],1)),o.add(n.create(e,[e-4,e-5,e-6,e-7],8))}return o},t.createSequenceToLevel=function(e){var o=new t;return 0==e?o=t.createSpawnSequenceForLevel(e):(o=t.createSequenceToLevel(e-1),t.createSpawnSequenceForLevel(e).getSequence().forEach(function(t){o.add(t)})),o},t.printFlattened=function(e){var o=e.getFlatternedSequence(),n=0,r=0,i=0,a=600,s=0;console.info("==============="),console.info("spawn sequence ===>"),o.seq.forEach(function(e){var o=0,c=0;c=e.price/n,a<e.price&&n>0&&((o=(e.price-a)/n)>=60&&o<3600&&(o=3600),o>=3600&&(s++,console.info("[",s,"] ===> "+e.seq+"|Lv."+e.owner+":"+e.counter+", wait time: "+o))),a-=e.price,a+=o*n,i+=o,r+=e.price;var l=t.levelProduceRate(e.level);n+=l;var u=t.sequencePriceRate(e.seq);u>=2&&console.info("new stage ===>",e.seq,"rate: ",u),console.info("["+e.seq+"|"+e.owner+":"+e.seq2+"|"+e.level+":"+e.counter+"] [price: "+e.price+", produce:"+l+", time: "+c.toFixed(1)+", wait: "+o.toFixed(1)+"] total: [ produce:"+n+", cost:"+r+", time: "+i.toFixed(1)+" ] [rate="+u+"}]")}),console.info("counters ===>"),o.counter.forEach(function(t,e){t&&console.info("["+e+":"+t+"]")}),console.info("merge count = ",e.calculateMergeCount()),console.info("===============")},t.printMergeCountsForLevel=function(e){for(var o=0;o<=e;o++){var r=t.createSpawnSequenceForLevel(o);o>0&&r.add(n.create(o,[o],1)),r.flatternSequence(0);var i=r.calculateSpawnCount();o>0&&(i-=1);var a=r.calculateMergeCount();console.info("Lv["+o+"]: ["+i+"|"+a.cont+"] => "+a.level)}},t.levelMergeCount=function(t){t},t.sequencePriceRate=function(t){var e=1.01,o=Math.floor(t/10);return o>8&&t%10==0&&(e=o<=13?2:30==o||45==o?1.5:1.01),e},t.levelProduceRate=function(e){if(e<=1)return.25;var n=o.PRODUCE_RATE;return t.levelProduceRate(e-1)*n},t}();o.default=r,cc._RF.pop()},{}],KittyLogger:[function(t,e,o){"use strict";cc._RF.push(e,"3cf76c5P5pGgKVH1s2sAiRM","KittyLogger"),Object.defineProperty(o,"__esModule",{value:!0}),o.KITTY_ACTIONS=o.KITTY_PAGES=o.KITTY_SHARE_POSITION=o.KITTY_ADS_SPACE=void 0;var n=t("../../../GameKit/App/Logger"),r=t("../../../GameKit/Framework/Utils/Utils");o.KITTY_ADS_SPACE={UNKNOWN:"Unknown",NO_MONEY:"NoMoney",OFFLINE:"Offline",CHECK_IN:"Checkin",CHECK_IN_BONUS:"Checkin_Bonus",TASK:"Task_",TASK_BONUS:"Task_Bonus",LOTTERY:"Lottery",LOTTERY_TICKET:"Lottery_Ticket",PETTING:"Petting",SHARE_NEW_LEVEL:"Share_NewKitty",SHARE_KITTY_INFO:"Share_KittyInfo",TREASURE_HUNT:"TreasureHunt",HIDE_AND_SEEK:"HideAndSeek",KITTY_BALL:"KittyInBall",HIDDEN_KITTY:"HiddenKitty"},o.KITTY_SHARE_POSITION={UNKNOWN:"Unknown",NEW_KITTY:"NewKitty",KITTY_INFO:"KittyInfo",HIDDEN_KITTY:"HiddenKitty"},o.KITTY_PAGES={HOME:"Home",TREASURE_HUNT:"TreasureHunt",HIDE_AND_SEEK:"HideAndSeek",KITTY_BALL:"KittyInBall",PETTING:"Petting",LOTTERY:"Lottery",CHECKIN:"CheckIn",COLLECTION:"Collection",TASK:"Task",MSG:"Msg",REWARDS:"Rewards",SHARE:"Share",GUIDE:"Guide"},o.KITTY_ACTIONS={CHECK_IN:"CheckIn",CONFIRM_TASK:"ConfirmTask",PLAY_PETTING:"Petting",DRAW_LOTTERY:"Lottery",PLAY_TREASURE_HUNT:"PlayTreasureHunt",PLAY_HIDE_AND_SEEK:"PlayHideAndSeek",PLAY_KITTY_BALL:"PlayKittyInBall",VIEW_KITTY_INFO:"ViewKittyInfo",SPAWN_KITTY:"Kitty_Spawn",UPGRADE_KITTY:"Kitty_Upgrade",PICK_KITTY:"Kitty_Pick",RECYCLE_KITTY:"Kitty_Recycle"},o.KITTY_PAGES.HOME,o.KITTY_PAGES.PETTING,o.KITTY_PAGES.LOTTERY,o.KITTY_PAGES.TREASURE_HUNT,o.KITTY_PAGES.HIDE_AND_SEEK,o.KITTY_PAGES.KITTY_BALL;var i=o.KITTY_ADS_SPACE.UNKNOWN,a=o.KITTY_SHARE_POSITION.UNKNOWN,s=[],c={logger:n.default,initLogger:function(t){n.default.initLoggerProvider(t)},logKittyLevel:function(t){var e="Kitty_Level_"+r.default.paddingNumber(t,3);n.default.quickLog(e)},logGuideStep:function(t){var e="Guide_Step_"+r.default.paddingNumber(t,3);n.default.quickLog(e)},_logAdsEvent:function(t){var e="Kitty_Ads_"+t;n.default.quickLog(e)},setAdsSpace:function(t){i=t},resetAdsSpace:function(){i=o.KITTY_ADS_SPACE.UNKNOWN},quickLogAds:function(){c._logAdsEvent(i),c.resetAdsSpace()},_logShareEvent:function(t){var e="Kitty_Share_"+t;n.default.quickLog(e)},quickLogShare:function(){c._logShareEvent(a),c.resetSharePosition()},setSharePosition:function(t){a=t},resetSharePosition:function(){a=o.KITTY_SHARE_POSITION.UNKNOWN},logShortcut:function(){n.default.quickLog("Kitty_Shortcut")},logBot:function(){n.default.quickLog("Kitty_Bot")},logCrossPromote:function(){n.default.quickLog("Kitty_CrossPromote")},logGameStart:function(){c.logPageEnter(o.KITTY_PAGES.HOME)},logPageEnter:function(t){s.push(t);var e="Kitty_Page_Counter_"+t,o="Kitty_Full_Path_Counter_"+c._getPagePath();n.default.quickLog(e),n.default.quickLog(o)},logPageExit:function(){s.pop()},logAction:function(t){var e="Kitty_Action_"+t;n.default.quickLog(e)},logHeartbeat:function(){var t="Kitty_Page_Timer_"+s[s.length-1],e="Kitty_Full_Path_Timer_"+c._getPagePath();n.default.quickLog("Kitty_Page_Timer_Overrall"),n.default.quickLog(t),n.default.quickLog(e)},_getPagePath:function(){var t="";return s.forEach(function(e,o){o>0&&(t+="-"),t+=e}),t}};o.default=c,cc._RF.pop()},{"../../../GameKit/App/Logger":"Logger","../../../GameKit/Framework/Utils/Utils":"Utils"}],KittyLottery:[function(t,e,o){"use strict";cc._RF.push(e,"f651fdjn/pCb7jj3Wfs7XfY","KittyLottery");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Framework/View/UIMediator2"),l=t("../../../GameKit/Framework/Utils/Utils"),u=t("../../../GameKit/Framework/Utils/UIHelper"),p=t("../KittyResouces"),d=t("../Data/KittyInventoryProxy"),f=t("../KittyConsts"),h=t("../Data/KittyDB"),y=t("./LotterySlot"),_=t("../../../GameKit/Framework/i18n/i18n"),v=t("../Data/KittyLogger"),g=cc._decorator,b=g.ccclass,m=g.property,w=[6,2,5,3,4,4,3,5,3,0,4,5,5,5,6,5,10,5,20,3,30,2],S=cc.Color.GREEN,P=cc.Color.WHITE.fromHEX("#fcccb8"),O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnDraw=null,e.items=[],e.amount=null,e.detailNode=null,e.detailInfo=null,e.slotPrefab=null,e._currentIdx=0,e._targetIdx=0,e._totalSteps=0,e._stepCounter=0,e._frameCounter=0,e._stageFrames=0,e._stageIdx=0,e._stageSteps=0,e._loopSteps=0,e._stop=!0,e._itemDetails=[],e._details=[],e._configs=[],e._ready=!1,e}return r(e,t),e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),u.default.bindClickEvent(this.btnDraw,this.drawLottery.bind(this)),this.detailInfo.node.parent.active=!1,this.initLottery(),this._ready=!0},e.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.addEvent(d.default.EVENTS.TICKET_UPDATE,this.onTicketUpdate,this)},e.prototype.updateData=function(){var t=this.retrieveProxy(f.default.PROXIES.INVENTORY).getTickets();this.amount.string="x"+t.toString()},e.prototype.onTicketUpdate=function(t){this.amount.string="x"+t.current.toString()},e.prototype.initLottery=function(){var t=h.default.getInstance().getLotteryConfigs();console.assert(t.length==this.items.length),this.detailNode.removeAllChildren(),this._configs=t;for(var e=0;e<this.items.length;e++){this.items[e].width=110,this.items[e].height=110;var o=t[e];if(!l.default.isUndefinedOrNull(o)){var n=p.default.getInstance().getOtherPrefab(o.prefab),r=cc.instantiate(n);r.setParent(this.detailNode),r.setPosition(cc.v2(0,0)),this._details.push(r),r.active=!1;var i=cc.instantiate(this.slotPrefab);i.setParent(this.items[e]),i.setPosition(0,0),i.getComponent(y.default).setRewards(o.prefab)}}},e.prototype.drawLottery=function(){if(this._ready)if(v.default.logAction(v.KITTY_ACTIONS.DRAW_LOTTERY),this.retrieveProxy(f.default.PROXIES.INVENTORY).useTicket(1)){this._ready=!1,this._targetIdx=l.default.randomInt(0,this.items.length);for(var t=0,e=0;e<w.length/2;e++)t+=w[2*e+1];var o=t%this.items.length;o=this.items.length-o;var n=(this._targetIdx-this._currentIdx+this.items.length)%this.items.length,r=3*this.items.length+o+n;this._totalSteps=t+r,this._loopSteps=r,this._frameCounter=0,this._stageIdx=0,this._stageFrames=w[2*this._stageIdx],this._stageSteps=w[2*this._stageIdx+1],this._stop=!1,this._selectItem(this._currentIdx)}else this.sendNotification(f.default.EVENTS.NOT_ENOUGH_TICKETS)},e.prototype.update=function(){this._stop||this._updateStep()},e.prototype._updateStep=function(){if(this._frameCounter++,this._frameCounter>=this._stageFrames){this._frameCounter=0;var t=this._currentIdx+1;t>=this.items.length&&(t=0),this._selectItem(t),this._stageSteps--,this._stageSteps<=0&&(this._stageIdx++,this._stageIdx>=w.length/2?this._stopDraw():(this._stageFrames=w[2*this._stageIdx],this._stageSteps=w[2*this._stageIdx+1],this._stageSteps<=0&&(this._stageSteps=this._loopSteps)))}},e.prototype._selectItem=function(t){this.items[this._currentIdx].color=P,this._details[this._currentIdx].active=!1,this._currentIdx=t,this.items[this._currentIdx].color=S,this._details[this._currentIdx].active=!0;var e=this._configs[t];if(this.detailInfo.node.parent.active=!0,0==e.info.indexOf("id:")){var o=e.info.substr(3),n=_.default.text(o);this.detailInfo.string=n}else this.detailInfo.string=e.info},e.prototype._stopDraw=function(){this._stop=!0,this.showResult()},e.prototype.showResult=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r;return s(this,function(i){switch(i.label){case 0:return[4,l.default.waitFor(1e3)];case 1:return i.sent(),t=this.retrieveProxy(f.default.PROXIES.INVENTORY),e=this._configs[this._currentIdx],o=h.default.getInstance().generateRewards(e.amount,e.rewardType,e.prefab,e.popRewards),e.showPopup?((n=e.adsRate)||(n=2),this._details[this._currentIdx].active=!1,r=_.default.text("ui.lottery.large.rewards.msg","\u8fd0\u6c14\u4e0d\u9519\u54df\n\u8fd9\u662f\u4f60\u5e94\u5f97\u7684"),v.default.setAdsSpace(v.KITTY_ADS_SPACE.LOTTERY),[4,p.default.showRewardsWithAds(r,o.amount,n,o.prefab,e.popupScale,!0)]):[3,3];case 2:return i.sent().adsShowed&&(o.amount*=n),[3,5];case 3:return this._details[this._currentIdx].active=!1,[4,p.default.getInstance().playRewardsAssemlyEffect(this._details[this._currentIdx])];case 4:i.sent(),i.label=5;case 5:return t.addRewards(o),t.save(),this._ready=!0,[2]}})})},e.prototype._getFreeTickets=function(t){return a(this,void 0,void 0,function(){var e,o,n;return s(this,function(r){switch(r.label){case 0:return e=_.default.text("ui.lottery.free.coupon","\u8fd9\u662f\u4eca\u5929\u7684\u514d\u8d39\u798f\u888b~"),o=1,v.default.setAdsSpace(v.KITTY_ADS_SPACE.LOTTERY_TICKET),[4,p.default.showRewardsWithAds(e,t,o,f.default.REWARDS_PREFABS.TICKETS,1.5,!0)];case 1:return r.sent().adsShowed&&(t*=o),(n=this.retrieveProxy(f.default.PROXIES.INVENTORY)).addTicket(t),n.save(),[2]}})})},e.prototype.show=function(e){return a(this,void 0,void 0,function(){var o;return s(this,function(n){switch(n.label){case 0:return t.prototype.show.call(this,e),(o=this.retrieveProxy(f.default.PROXIES.TASK)).isFreeTicketReady()?[4,this._getFreeTickets(5)]:[3,2];case 1:n.sent(),o.markTodayFreeTicketDone(),o.save(),n.label=2;case 2:return[2]}})})},i([m(cc.Button)],e.prototype,"btnDraw",void 0),i([m(cc.Node)],e.prototype,"items",void 0),i([m(cc.Label)],e.prototype,"amount",void 0),i([m(cc.Node)],e.prototype,"detailNode",void 0),i([m(cc.Label)],e.prototype,"detailInfo",void 0),i([m(cc.Prefab)],e.prototype,"slotPrefab",void 0),i([b],e)}(c.default);o.default=O,cc._RF.pop()},{"../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/View/UIMediator2":"UIMediator2","../../../GameKit/Framework/i18n/i18n":"i18n","../Data/KittyDB":"KittyDB","../Data/KittyInventoryProxy":"KittyInventoryProxy","../Data/KittyLogger":"KittyLogger","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces","./LotterySlot":"LotterySlot"}],KittyMatch:[function(t,e,o){"use strict";cc._RF.push(e,"5bb282odttIj40Rnklsh0tz","KittyMatch");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Framework/View/UIMediator2"),l=t("../../../GameKit/Framework/Utils/UIHelper"),u=t("../KittyConsts"),p=t("../../../KittyMatch/Script/KMPlayground"),d=t("../Data/KittyInventoryProxy"),f=t("./Wallet"),h=t("../../../KittyMatch/Script/KMResult"),y=t("../KittyApp"),_=t("../Data/KittyLogger"),v=cc._decorator,g=v.ccclass,b=v.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playground=null,e.btnReplay=null,e.subUI=null,e.resultUI=null,e.btnReplay2=null,e.btnExit=null,e.score=null,e.wallet=null,e._resultBalls=[],e}return r(e,t),e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),l.default.bindClickEvent(this.btnReplay,this.replayGame.bind(this)),l.default.bindClickEvent(this.btnReplay2,this.replayGame.bind(this)),l.default.bindClickEvent(this.btnExit,this.onClose.bind(this))},e.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.addEvent(p.default.EVENTS.GAME_DID_FINISED,this.onGameFinished,this),this.addEvent(d.default.EVENTS.COIN_UPDATE,this.updateWallet,this),this.addEvent(d.default.EVENTS.GOLD_UPDATE,this.updateWallet,this)},e.prototype.updateWallet=function(){var t=this.retrieveProxy(u.default.PROXIES.INVENTORY),e=t.getCoin(),o=t.getGold();this.wallet.updateData({coin:e,gold:o})},e.prototype.show=function(e){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return this.resultUI.hide(),[4,t.prototype.show.call(this,e)];case 1:return o.sent(),[2]}})})},e.prototype.onClose=function(){this.playground.endGame(),cc.director.getPhysicsManager().enabled=!1,t.prototype.onClose.call(this),y.default.playLobbyBgm()},e.prototype.startGame=function(){return _.default.logAction(_.KITTY_ACTIONS.PLAY_KITTY_BALL),this.resultUI.hide(),this.playground.init(),this.updateWallet(),this.tryPlay()?(cc.director.getPhysicsManager().enabled=!0,cc.director.getPhysicsManager().gravity=cc.v2(0,-10),this.playground.startGame(),y.default.playFastBgm(),!0):(this.sendNotification(u.default.EVENTS.NOT_ENOUGH_GOLD),this.onClose(),!1)},e.prototype.tryPlay=function(){var t=this.retrieveProxy(u.default.PROXIES.INVENTORY);return t.addGold(2),t.save(),!0},e.prototype.onGameReady=function(){},e.prototype.onGameFinished=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.resultUI.show(),this._updateResultUI(),[2]})})},e.prototype._updateResultUI=function(){var t=this.playground._data,e=this.playground.getBallConfigs();this.resultUI.updateData(t,e)},e.prototype.replayGame=function(){this.playground.endGame(),this.startGame()},e.prototype.onWin=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},i([b(p.default)],e.prototype,"playground",void 0),i([b(cc.Button)],e.prototype,"btnReplay",void 0),i([b(cc.Node)],e.prototype,"subUI",void 0),i([b(h.default)],e.prototype,"resultUI",void 0),i([b(cc.Button)],e.prototype,"btnReplay2",void 0),i([b(cc.Button)],e.prototype,"btnExit",void 0),i([b(cc.Label)],e.prototype,"score",void 0),i([b(f.default)],e.prototype,"wallet",void 0),i([g],e)}(c.default);o.default=m,cc._RF.pop()},{"../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/Framework/View/UIMediator2":"UIMediator2","../../../KittyMatch/Script/KMPlayground":"KMPlayground","../../../KittyMatch/Script/KMResult":"KMResult","../Data/KittyInventoryProxy":"KittyInventoryProxy","../Data/KittyLogger":"KittyLogger","../KittyApp":"KittyApp","../KittyConsts":"KittyConsts","./Wallet":"Wallet"}],KittyOption:[function(t,e,o){"use strict";cc._RF.push(e,"6f9fdXNfDlB5oezy7EeoEuw","KittyOption");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Share/PopUI"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.optPetting=null,e.optLottery=null,e.optHidding=null,e.optKittyInBox=null,e.optKittyMatch=null,e}return r(e,t),e.prototype.setStyle=function(e){t.prototype.setStyle.call(this,e);var o=e;this.optPetting.active=!o.hidePetting,this.optLottery.active=!o.hideLottery,this.optHidding.active=!o.hideHidding,this.optKittyInBox.active=!o.hideKittyInBox,this.optKittyMatch.active=!o.hideKittyMatch,this.updateLayout()},e.prototype.updateLayout=function(){var t=this.optPetting.parent,e=t.parent;t.getComponent(cc.Layout).updateLayout();var o=0;t.children.forEach(function(t){t.active&&(o+=t.height)}),t.height=o,e.height=t.height+200},i([l(cc.Node)],e.prototype,"optPetting",void 0),i([l(cc.Node)],e.prototype,"optLottery",void 0),i([l(cc.Node)],e.prototype,"optHidding",void 0),i([l(cc.Node)],e.prototype,"optKittyInBox",void 0),i([l(cc.Node)],e.prototype,"optKittyMatch",void 0),i([c],e)}(a.default);o.default=u,cc._RF.pop()},{"../../../GameKit/Share/PopUI":"PopUI"}],KittyPetting:[function(t,e,o){"use strict";cc._RF.push(e,"baeban0mRFCMab56dG5UOWA","KittyPetting");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Framework/Utils/UIHelper"),l=t("../../../GameKit/Framework/View/UIMediator2"),u=t("../KittyResouces"),p=t("../KittyConsts"),d=t("../../../GameKit/Framework/Utils/Utils"),f=t("../../../GameKit/Framework/GamePlay/InputControl"),h=t("../Data/KittyDB"),y=t("../../../GameKit/Tpcl/Baidu/Baidu"),_=t("../Data/KittyConfig"),v=t("../../../GameKit/Framework/i18n/i18n"),g=t("../Data/KittyLogger"),b=cc._decorator,m=b.ccclass,w=b.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnPet=null,e.petProgress=null,e.maxTime=20,e.timerLabel=null,e.maxValue=100,e.counterLabel=null,e.avatar=null,e.kittyFaces=[],e.effectPrefab=null,e.effectPosition=null,e.input=null,e.pettingArea=null,e._petCounter=0,e._timer=0,e._end=!1,e._petting=!1,e._moveDist=0,e}return r(e,t),e.prototype._onLoaded=function(){t.prototype._onLoaded.call(this),this.input.setHandler(this.onTouchBegin.bind(this),this.onTouchMove.bind(this),this.onTouchEnd.bind(this),this.onTouchCancel.bind(this)),this.input.enabled=!1,this.startPetting(this.maxTime,this.maxValue)},e.prototype.update=function(t){!this._end&&this._petCounter>0&&(this._timer+=t,this._timer>=this.maxTime&&(this._timer=this.maxTime,this.stopPetting()),this.timerLabel.string=(this.maxTime-this._timer).toFixed(1))},e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),c.default.bindClickEvent(this.btnPet,this.onPet.bind(this))},e.prototype.onTouchBegin=function(t){var e=t.touch.getLocation();this._moveDist=0,!this._end&&this.pettingArea.getBoundingBoxToWorld().contains(e)&&this.onPet(e)},e.prototype.onTouchMove=function(t){var e=t.touch.getLocation();this._moveDist+=t.getDelta().mag(),!this._end&&this._moveDist>=200&&this.pettingArea.getBoundingBoxToWorld().contains(e)&&this.onPet(e)},e.prototype.onTouchEnd=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(){return e=t.touch.getLocation(),this._moveDist+=t.getDelta().mag(),!this._end&&this._moveDist>=200&&this.pettingArea.getBoundingBoxToWorld().contains(e)&&this.onPet(e),[2]})})},e.prototype.onTouchCancel=function(){},e.prototype.onPet=function(t){var e=this;if(!this._end){this._moveDist=0,this.showEffect(t),this._petCounter<=0&&g.default.logAction(g.KITTY_ACTIONS.PLAY_PETTING),this._petCounter++;var o=this._petCounter/this.maxValue;if(o>=.9&&(this.avatar.spriteFrame=this.kittyFaces[1]),this._petting||(this._petting=!0,_.default.isBaidu()?y.default.vibrateShort():_.default.isNativeMobile(),this.avatar.node.runAction(cc.sequence(cc.callFunc(function(){e.avatar.spriteFrame=e.kittyFaces[1]}),cc.moveBy(.1,d.default.randomFloat(-10,10),d.default.randomFloat(10,20)),cc.moveTo(.1,0,0),cc.callFunc(function(){e._petting=!1,e.avatar.spriteFrame=o>=.9?e.kittyFaces[1]:e.kittyFaces[0]})))),o>=1)return o=1,void this.stopPetting();this.petProgress.progress=o,this.counterLabel.string=this._petCounter.toString()}},e.prototype.showEffect=function(t){var e=cc.instantiate(this.effectPrefab);e.parent=this.effectPosition,e.position=this.effectPosition.convertToNodeSpaceAR(t),e.x+=d.default.randomFloat(-20,20),e.y+=d.default.randomFloat(-10,10)},e.prototype._resetData=function(){this._end=!1,this._moveDist=0,this._petCounter=0,this._timer=0,this.timerLabel.string=this.maxTime.toFixed(1),this.petProgress.progress=0,this.counterLabel.string=this._petCounter.toString(),this.avatar.spriteFrame=this.kittyFaces[0]},e.prototype.startPetting=function(t,e){this.input.enabled=!0,this.maxTime=t,this.maxValue=e,this._resetData()},e.prototype.stopPetting=function(){this._end=!0;var t=this._petCounter/this.maxValue;this.showResult(t>=1)},e.prototype.showResult=function(t){return a(this,void 0,void 0,function(){var e,o,n,r,i,a,c;return s(this,function(s){switch(s.label){case 0:e=d.default.randomInt(10,30),o=d.default.randomInt(5,11),n=v.default.text("ui.petting.result.win.msg","\u732b\u54aa\u5f88\u6ee1\u610f~~\n\u8fd9\u662f\u5956\u52b1\u4f60\u7684\u7f50\u5934"),t||(n=v.default.text("ui.petting.result.lose.msg","\u4f60\u597d\u50cf\u4e0d\u662f\u5f88\u5356\u529b\u554a~~\n\u4e0b\u6b21\u52a0\u6cb9\u5427\uff0c\u8fd9\u662f\u5956\u52b1\u4f60\u7684"),e=d.default.randomInt(5,10),o=d.default.randomInt(1,11)),r=h.default.getInstance().getCoinRewardsBySize(e),s.label=1;case 1:return s.trys.push([1,3,,4]),g.default.setAdsSpace(g.KITTY_ADS_SPACE.PETTING),[4,u.default.showRewardsWithAds(n,r,o,p.default.REWARDS_PREFABS.FISH_CANS_4,1,!0)];case 2:return s.sent().adsShowed&&(r*=o),(i=this.retrieveProxy(p.default.PROXIES.INVENTORY)).addCoin(r),i.save(),(a=this.retrieveProxy(p.default.PROXIES.TASK)).addPettingTaskCounter(),a.save(),this._resetData(),this.onClose(),[3,4];case 3:return c=s.sent(),console.warn("[Petting] something wrong here: "+c.toString()),[3,4];case 4:return[2]}})})},e.prototype.onClose=function(){this._resetData(),t.prototype.onClose.call(this)},i([w(cc.Button)],e.prototype,"btnPet",void 0),i([w(cc.ProgressBar)],e.prototype,"petProgress",void 0),i([w],e.prototype,"maxTime",void 0),i([w(cc.Label)],e.prototype,"timerLabel",void 0),i([w],e.prototype,"maxValue",void 0),i([w(cc.Label)],e.prototype,"counterLabel",void 0),i([w(cc.Sprite)],e.prototype,"avatar",void 0),i([w(cc.SpriteFrame)],e.prototype,"kittyFaces",void 0),i([w(cc.Prefab)],e.prototype,"effectPrefab",void 0),i([w(cc.Node)],e.prototype,"effectPosition",void 0),i([w(f.default)],e.prototype,"input",void 0),i([w(cc.Node)],e.prototype,"pettingArea",void 0),i([m],e)}(l.default);o.default=S,cc._RF.pop()},{"../../../GameKit/Framework/GamePlay/InputControl":"InputControl","../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/View/UIMediator2":"UIMediator2","../../../GameKit/Framework/i18n/i18n":"i18n","../../../GameKit/Tpcl/Baidu/Baidu":"Baidu","../Data/KittyConfig":"KittyConfig","../Data/KittyDB":"KittyDB","../Data/KittyLogger":"KittyLogger","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces"}],KittyPlaygroundProxy:[function(t,e,o){"use strict";cc._RF.push(e,"be645XSYgFAF5JkrCxaW+eh","KittyPlaygroundProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Framework/Model/Proxy"),l=t("../../../GameKit/Framework/Model/LocalCache"),u=t("../../../GameKit/Framework/Utils/Utils"),p=t("../KittyConsts"),d=t("./KittyDB"),f=t("./KittyLevelSequence"),h=t("./KittyConfig"),y=t("../Network/RemoteCache"),_=cc._decorator,v=_.ccclass,g=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._kittySpawnCounter=[],e._autoSpawnLevel=1,e}var o;return r(e,t),o=e,e.create=function(t){var e=new o;return e.name=t,e},e.prototype.init=function(){this.initKitties(o.CELL_COUNT),this.updateAutoSpawn(!0)},e.prototype.save=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(){return t={kittyIds:this._kittyIds},h.default.CACHE.USE_REMOTE_CACHE()?(y.default.putObj(o.KEY,t),y.default.save()):l.default.putObj(o.KEY,t),[2]})})},e.prototype.load=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return h.default.CACHE.USE_REMOTE_CACHE()?(t=y.default.getObj(o.KEY),[3,3]):[3,1];case 1:return[4,l.default.getObj(o.KEY)];case 2:t=e.sent(),e.label=3;case 3:return u.default.isNotUndefinedOrNull(t)&&u.default.isNotUndefinedOrNull(t.kittyIds)&&(this._kittyIds=t.kittyIds),this.updateAutoSpawn(!0),[2]}})})},e.prototype.initKitties=function(t){this._kittyIds=u.default.createArray(t,0)},e.prototype.getAutoSpawnLevel=function(){return this._autoSpawnLevel},e.prototype.setAutoSpawnLevel=function(t){this._autoSpawnLevel=t},e.prototype._getSpawnCounter=function(t){return this.retrieveProxy(p.default.PROXIES.TASK).getSpawnCounter(t)},e.prototype.getAutoSpawnPrice=function(){var t=this._getSpawnCounter(this._autoSpawnLevel);return{price:d.default.getInstance().getSpawnPrice(this.getAutoSpawnLevel(),t),unit:p.PRICE_UNIT.COIN}},e.prototype.getSpawnPrice=function(t){var e=this._getSpawnCounter(t);return{price:d.default.getInstance().getSpawnPrice(t,e),unit:p.PRICE_UNIT.COIN}},e.prototype.getKitties=function(){for(var t=[],e=0;e<this._kittyIds.length;e++){var o=this._kittyIds[e];if(o<=0)t.push(void 0);else{var n=this.getKittyInfoById(o);t.push(n)}}return t},e.prototype.spawnKittyByLevel=function(t){var e=d.default.getInstance().getIdFromLevel(t),o=this.retrieveProxy(p.default.PROXIES.TASK);return d.default.getInstance().hasSpecialKittyByLevel(t)&&o.getUnlockedLevel()>t&&u.default.randomFloat(0,10)>5&&(e=d.default.getInstance().getSpecialKittyIdByLevel(t)),this.getKittyInfoById(e)},e.prototype.getKittyInfoById=function(t){return d.default.getInstance().getKittyInfoById(t)},e.prototype.saveKitties=function(t){var e=this._getMinLevelOnGround();this._kittyIds=t,this.save();var o=this._getMinLevelOnGround();this.sendNotification(p.default.EVENTS.PLAYGROUND_KITTIES_UPDATE),o!=e&&this.updateAutoSpawn(!0)},e.prototype.getTotalProduceRate=function(){for(var t=this.getKitties(),e=0,o=0;o<t.length;o++){var n=t[o];u.default.isUndefinedOrNull(n)||(e+=n.produceRate)}return e},e.prototype.getTotalProduceRatePerSecond=function(){return this.getTotalProduceRate()/3},e.prototype.getUnlockedKittyProduceRatePerSecond=function(){var t=this.retrieveProxy(p.default.PROXIES.TASK);return u.default.isUndefinedOrNull(t)?(console.warn("Task proxy not ready"),0):d.default.getInstance().getProduceRate(t.getUnlockedLevel())/3},e.prototype._getMinLevelOnGround=function(){var t=0,e=this.getKitties();return e.length<=0?t=0:(e.forEach(function(e){u.default.isNotUndefinedOrNull(e)&&(t<=0||t>e.level)&&(t=e.level)}),t)},e.prototype.updateAutoSpawn=function(t){var e=this.retrieveProxy(p.default.PROXIES.TASK).getUnlockedLevel()-4;e<=0&&(e=1);var o=e-4;o<0&&(o=0);var n=0,r=this._getMinLevelOnGround();if(r>0&&r<=o)n=r;else if(t)n=e;else if((n=this._autoSpawnLevel-1)<=o)n=e;else{var i=this.getSpawnPrice(n),a=this.getSpawnPrice(n+1);i.price*f.PRICE_RATE>=a.price&&(n+=1)}this._autoSpawnLevel=n,this.sendNotification(p.default.EVENTS.AUTO_SPAWN_LEVEL_UPDATE,{level:n,price:this.getSpawnPrice(n).price})},e.KEY="Kitty.Playground",e.CELL_COUNT=12,e.EVENTS={},o=i([v],e)}(c.default));o.default=g,cc._RF.pop()},{"../../../GameKit/Framework/Model/LocalCache":"LocalCache","../../../GameKit/Framework/Model/Proxy":"Proxy","../../../GameKit/Framework/Utils/Utils":"Utils","../KittyConsts":"KittyConsts","../Network/RemoteCache":"RemoteCache","./KittyConfig":"KittyConfig","./KittyDB":"KittyDB","./KittyLevelSequence":"KittyLevelSequence"}],KittyPlayground:[function(t,e,o){"use strict";cc._RF.push(e,"966d1MYKbtFRKkFmxsTKnvo","KittyPlayground");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./CellContainer"),l=t("./Cell"),u=t("./KittyItem"),p=t("../../../GameKit/Framework/View/MediatorComp"),d=t("../../../GameKit/Framework/GamePlay/InputControl"),f=t("../KittyConsts"),h=(t("../KittyUtils"),t("../../../GameKit/Framework/Utils/Utils")),y=t("../Data/KittyTaskProxy"),_=t("../KittyResouces"),v=t("../KittyApp"),g=t("../../../GameKit/Framework/i18n/i18n"),b=t("../Data/KittyLogger"),m=cc._decorator,w=m.ccclass,S=m.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputControl=null,e.cellContainer=null,e.actionLayer=null,e.mergeEffect=null,e.itemPrefab=null,e.recycleArea=null,e.sellPriceLabel=null,e._sellPriceNodeY0=0,e._pickedItemNode=null,e._pickedCellNode=null,e._inAction=!1,e._proxy=null,e}return r(e,t),e.prototype._onLoaded=function(){this.enableInput(!1),this._sellPriceNodeY0=this.sellPriceLabel.node.y,this.sellPriceLabel.node.active=!1,this.inputControl.setHandler(this.onTouchBegin.bind(this),this.onTouchMove.bind(this),this.onTouchEnd.bind(this),this.onTouchCancel.bind(this)),this.mergeEffect.active=!1,t.prototype._onLoaded.call(this)},e.prototype.onTouchBegin=function(t){if(!this._inAction&&!this._pickedCellNode){var e=t.touch.getLocation(),o=this.cellContainer.getCellAtScreenPosition(e);o&&this.pickFromCell(o,e)}},e.prototype.onTouchMove=function(t){if(!this._inAction&&this._pickedItemNode){var e=t.touch.getLocation();this.moveItem(e)}},e.prototype.onTouchEnd=function(t){return a(this,void 0,void 0,function(){var e,o;return s(this,function(n){switch(n.label){case 0:return this._inAction?[2]:this._pickedCellNode?(this._inAction=!0,e=t.touch.getLocation(),this.tryRecycle(e)?[3,4]:(o=this.cellContainer.getCellAtScreenPosition(e))?[4,this.dropToCell(o)]:[3,2]):[2];case 1:return n.sent(),[3,3];case 2:this.dropToCell(this._pickedCellNode),n.label=3;case 3:return[3,4];case 4:return this._highlightKitty(0),this._inAction=!1,[2]}})})},e.prototype.onTouchCancel=function(){this._inAction||(this._inAction=!0,this._pickedCellNode&&this.dropToCell(this._pickedCellNode),this._highlightKitty(0),this._inAction=!1)},e.prototype.enableInput=function(t){this.inputControl.enabled=t},e.prototype.initEvents=function(){var e=this;t.prototype.initEvents.call(this),this.addEvent(f.default.EVENTS.KITTY_PRODUCE_COIN,function(t){var o=e.retrieveProxy(f.default.PROXIES.INVENTORY);o.addCoin(t.coin),o.save()}),this.addEvent(y.default.EVENTS.SPAWN_COUNTER_UPDATE,function(){e._proxy.updateAutoSpawn(!1)}),this.addEvent(y.default.EVENTS.NEW_KITTY_LEVEL_UNLOCKED,function(){e._proxy.updateAutoSpawn(!0)})},e.prototype.startFeedingKitty=function(){var t=this.retrieveProxy(f.default.PROXIES.KITTY_PLAYGROUND);this._proxy=t,this.loadKitties(),this.enableInput(!0)},e.prototype.hasEmptyCell=function(){return this.cellContainer.hasEmptyCell()},e.prototype.spawnItem=function(t){var e=0,o=this.cellContainer.getNextEmptyCell();if(!o)return v.default.playSound(f.default.SOUNDS.NO),e;var n=o.getComponent(l.default);if(this.itemPrefab){v.default.playSound(f.default.SOUNDS.KITTY);var r=cc.instantiate(this.itemPrefab);n.setItem(r);var i=this._proxy.spawnKittyByLevel(t,!0);r.getComponent(u.default).setKittyInfo(i),e=i.id}return this.saveKitties(),e},e.prototype.pickFromCell=function(t,e){if(this._pickedCellNode)console.warn("[Playground] previous picked cell not dropped yet: ",t.name);else{var o=t.getComponent(l.default);if(o.hasItem()){b.default.logAction(b.KITTY_ACTIONS.PICK_KITTY);var n=o.removeItem();this._pickedCellNode=t,this._pickedItemNode=n,n.setParent(this.actionLayer);var r=this.actionLayer.convertToNodeSpaceAR(e);n.position=r;var i=n.getComponent(u.default).level;return this._highlightKitty(i),n}}},e.prototype._highlightKitty=function(t){for(var e=this.getKitties(0),o=0;o<e.length;o++){var n=e[o];t<=0?n.highlight(!0):n.level!=t?n.highlight(!1):n.highlight(!0)}},e.prototype.moveItem=function(t){if(this._pickedItemNode){var e=this.actionLayer.convertToNodeSpaceAR(t);this._pickedItemNode.position=e}},e.prototype.dropToCell=function(t){return a(this,void 0,void 0,function(){var e,o,n,r,i,a,c,p,d,h,y,_;return s(this,function(s){switch(s.label){case 0:return this._pickedCellNode&&this._pickedItemNode?(e=t.getComponent(l.default)).hasItem()?[3,1]:(e.setItem(this._pickedItemNode),[3,4]):[2];case 1:return o=e.getItem(),n=o.getComponent(u.default),(r=this._pickedItemNode.getComponent(u.default)).level!=n.level?[3,3]:(b.default.logAction(b.KITTY_ACTIONS.UPGRADE_KITTY),i=o.position,i=o.parent.convertToWorldSpaceAR(i),i=this.actionLayer.convertToNodeSpaceAR(i),(y=e.removeItem()).setParent(this.actionLayer),a=r.level+1,c=this._proxy.spawnKittyByLevel(a,!0),(p=cc.instantiate(this.itemPrefab)).getComponent(u.default).setKittyInfo(c),p.setParent(this.actionLayer),Math.ceil(c.level/5),[4,this.playMergeAnimation(i,this._pickedItemNode,y,p,c.level)]);case 2:return s.sent(),o.destroy(),this._pickedItemNode.destroy(),e.setItem(p),(d=this.retrieveProxy(f.default.PROXIES.TASK)).addMergeCounter(a,c.id),d.save(),(h=this.retrieveProxy(f.default.PROXIES.INVENTORY)).addGold(Math.ceil(a/5)),h.save(),[3,4];case 3:y=e.removeItem(),e.setItem(this._pickedItemNode),(_=this._pickedCellNode.getComponent(l.default)).removeItem(),_.setItem(y),s.label=4;case 4:return this._pickedCellNode=null,this._pickedItemNode=null,this.saveKitties(),[2]}})})},e.prototype.playMergeAnimation=function(t,e,o,n,r){return a(this,void 0,void 0,function(){var i,a=this;return s(this,function(){return i=this,[2,new Promise(function(s){e.x=t.x-e.width/2-10,e.y=t.y,o.x=t.x+o.width/2+10,o.y=t.y,n.x=t.x,n.y=t.y,n.active=!1;var c=cc.moveTo(.35,t);c.easing(cc.easeBackIn());var l=cc.callFunc(function(){e.active=!1,o.active=!1});o.runAction(c.clone()),e.runAction(cc.sequence(c,l)),i.mergeEffect.position=t,i.mergeEffect.active=!0,i.mergeEffect.opacity=0,i.mergeEffect.scale=.1;var u=cc.delayTime(.1),p=cc.fadeIn(.1),d=cc.scaleTo(.25,1),h=cc.fadeOut(.1),y=cc.callFunc(function(){v.default.playSound(f.default.SOUNDS.KITTY_UPGRADE),i.mergeEffect.active=!1,n.active=!0;var t=Math.ceil(r/5);a._spawnHeartOnMerge(n,t),s()});i.mergeEffect.runAction(cc.sequence(u,p,d,h,y))})]})})},e.prototype._spawnHeartOnMerge=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(){return e=_.default.getInstance().getOtherPrefab(f.default.REWARDS_PREFABS.HEARTS_1),_.default.getInstance().playDefaultRewardsAssemly(t,e,!0,1,1),[2]})})},e.prototype.tryRecycle=function(t){if(this.recycleArea.getBoundingBoxToWorld().contains(t)){if(!this._pickedCellNode)return!1;b.default.logAction(b.KITTY_ACTIONS.RECYCLE_KITTY);var e=g.default.text("warn.kitty.recycle","\u5582\uff01\n\u4e0d\u53ef\u4ee5\u629b\u5f03\u732b\u54aa\u554a\uff01\uff01\n\u53bb\u5408\u6210\u6210\u9ad8\u7ea7\u732b\u54aa\u5427\u3002");return _.default.showMsg(e,{hideCancel:!0}),!1}return!1},e.prototype.playSellAnimation=function(){return a(this,void 0,void 0,function(){var t,e,o,n;return s(this,function(){return this.sellPriceLabel.node.active=!0,this.sellPriceLabel.node.y=this._sellPriceNodeY0,t=this,e=cc.moveBy(.35,0,25),o=cc.callFunc(function(){t.sellPriceLabel.node.active=!1}),n=cc.sequence(e,o),this.sellPriceLabel.node.runAction(n),[2]})})},e.prototype.tryAutoMerge=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.loadKitties=function(){var t=this._proxy.getKitties();this.cellContainer.initCells(t.length);for(var e=0;e<t.length;e++){var o=t[e];if(!h.default.isUndefinedOrNull(o)){var n=this.cellContainer.getCellAt(e),r=n.getComponent(l.default),i=r.getItem();if(h.default.isNotUndefinedOrNull(i))console.warn("[Playground] kitty already exists in cell: ",n,i);else if(o.id>0){i=cc.instantiate(this.itemPrefab),r.setItem(i);var a=i.getComponent(u.default);a.setKittyInfo(o),a.setDelay(.2*e)}}}},e.prototype.saveKitties=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i;return s(this,function(){for(t=[],e=0;e<this.cellContainer.getCellCount();e++)o=this.cellContainer.getCellAt(e),(n=o.getComponent(l.default).getItem())?(r=n.getComponent(u.default),i=r.getKittyId(),t.push(i)):t.push(0);return this._proxy.saveKitties(t),[2]})})},e.prototype.getKitties=function(t){for(var e=[],o=0;o<this.cellContainer.getCellCount();o++){var n=this.cellContainer.getCellAt(o).getComponent(l.default).getItem();if(n){var r=n.getComponent(u.default);(t<=0||r.level==t)&&e.push(r)}}return e},e.prototype.getKittyCountByLevel=function(t){return this.getKitties(t).length},i([S(d.default)],e.prototype,"inputControl",void 0),i([S(c.default)],e.prototype,"cellContainer",void 0),i([S(cc.Node)],e.prototype,"actionLayer",void 0),i([S(cc.Node)],e.prototype,"mergeEffect",void 0),i([S(cc.Prefab)],e.prototype,"itemPrefab",void 0),i([S(cc.Node)],e.prototype,"recycleArea",void 0),i([S(cc.Label)],e.prototype,"sellPriceLabel",void 0),i([w],e)}(p.default);o.default=P,cc._RF.pop()},{"../../../GameKit/Framework/GamePlay/InputControl":"InputControl","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/View/MediatorComp":"MediatorComp","../../../GameKit/Framework/i18n/i18n":"i18n","../Data/KittyLogger":"KittyLogger","../Data/KittyTaskProxy":"KittyTaskProxy","../KittyApp":"KittyApp","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces","../KittyUtils":"KittyUtils","./Cell":"Cell","./CellContainer":"CellContainer","./KittyItem":"KittyItem"}],KittyRank:[function(t,e,o){"use strict";cc._RF.push(e,"78fe4D0jxRHZoE6QnaNoF0X","KittyRank");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Framework/View/UIMediator2"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([c],e)}(a.default));o.default=l,cc._RF.pop()},{"../../../GameKit/Framework/View/UIMediator2":"UIMediator2"}],KittyResouces:[function(t,e,o){"use strict";cc._RF.push(e,"c7696s/yIVGI6sTL8Uk2/uW","KittyResouces");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../GameKit/Framework/Extension/SingleNode"),l=t("./Data/PrefabPair"),u=t("../../GameKit/Framework/Utils/Utils"),p=t("./KittyConsts"),d=t("../../GameKit/Framework/View/ToastUI"),f=t("../../GameKit/Share/PopUI"),h=t("../../GameKit/App/AppFacade"),y=t("./Data/KittyDB"),_=t("./KittyFacade"),v=t("./KittyUtils"),g=t("../../GameKit/Framework/Ads/AdsManager"),b=t("./Data/KittyConfig"),m=t("../../GameKit/Tpcl/Baidu/Baidu"),w=t("../../GameKit/Framework/i18n/i18n"),S=t("../../GameKit/Tpcl/Facebook/Facebook"),P=t("./Data/KittyLogger"),O=cc._decorator,E=O.ccclass,A=O.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.popPrefabs=[],e.mediatorPrefabs=[],e.otherPrefabs=[],e.images=[],e.kitties=[],e.l2Layer=null,e.popupLayer=null,e.toastLayer=null,e.effectLayer=null,e.bannerAds=null,e.assemblyPosition=null,e.assemblies=[],e.particles=null,e._isReady=!1,e}var o;return r(e,t),o=e,e.getInstance=function(){return o._inst},e.prototype.setLayers=function(t,e,o,n,r){this.l2Layer=t,this.popupLayer=e,this.toastLayer=o,this.effectLayer=n,this.assemblyPosition=r},e.prototype._onloaded=function(){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return t.prototype._onloaded.call(this),o._inst=this,[4,this._loadResouce()];case 1:return e.sent(),[2]}})})},e.prototype._loadResouce=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.init=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,y.default.getInstance().loadConfigs()];case 1:return t.sent(),h.default.getInstance().sendNotification(p.default.EVENTS.RESOURCE_READY),this._isReady=!0,[2]}})})},e.prototype.isReady=function(){return this._isReady},e.prototype._getPrefabInArray=function(t,e){for(var o=null,n=0;n<t.length;n++){var r=t[n];if(r.name==e||r.prefab.name==e){o=r;break}}if(u.default.isNotUndefinedOrNull(o))return o.prefab},e.prototype.getPopPrefab=function(t){return this._getPrefabInArray(this.popPrefabs,t)},e.prototype.getRewardsPrefab=function(){return this.getPopPrefab(p.default.POP_PREFABS.REWARDS)},e.prototype.getMediatorPrefab=function(t){return this._getPrefabInArray(this.mediatorPrefabs,t)},e.prototype.getOtherPrefab=function(t){return this._getPrefabInArray(this.otherPrefabs,t)},e.prototype.getPrefab=function(t){var e=this.getPopPrefab(t);return u.default.isNotUndefinedOrNull(e)?e:(e=this.getMediatorPrefab(t),u.default.isNotUndefinedOrNull(e)?e:(e=this.getOtherPrefab(t),u.default.isNotUndefinedOrNull(e)?e:void console.warn("[KittyResource] can't find prefab: ",t)))},e.prototype.getImage=function(t){if(!u.default.isUndefinedOrNullOrEmpty(t)){for(var e=void 0,o=0;o<this.images.length;o++){var n=this.images[o];if(n.name==t||n.image.name==t){e=n.image;break}}return e}},e.prototype.getKittyImageByName=function(t){for(var e,o=0;o<this.kitties.length;o++)if(this.kitties[o].name==t){e=this.kitties[o];break}return e},e.prototype.playCoinAssemblyFromPos=function(t){return a(this,void 0,void 0,function(){var e,o;return s(this,function(){return e=p.default.REWARDS_PREFABS.FISH_CANS_4,o=this.assemblies[0],[2,this.playRewardsAssemblyFromPos(e,t,o,!0,1)]})})},e.prototype.playRewardsAssemblyFromPos=function(t,e,o,n,r){return void 0===r&&(r=1),a(this,void 0,void 0,function(){var i,a,c,l,p,d,f,h,y,_;return s(this,function(){if(i=t,"string"==typeof t&&(i=this.getPrefab(t)),(a=cc.instantiate(i)).active=!0,a.setParent(o.parent),a.setPosition(e),a.setScale(r),n){for(f=u.default.convertNode1PositionToNode2SpaceAR(o,a),c=0;c<a.childrenCount;c++)l=a.children[c],p=cc.delayTime(.05*c),h=cc.moveTo(.2,f),y=cc.fadeOut(.1),l.runAction(cc.sequence(p,h,y));d=cc.delayTime(.5*a.childrenCount),_=cc.callFunc(function(){a.active=!1,a.destroy()}),a.runAction(cc.sequence(d,_))}else f=o.position,h=cc.moveTo(.2,f),y=cc.fadeOut(.1),_=cc.callFunc(function(){a.active=!1,a.destroy()}),a.runAction(cc.sequence(h,y,_));return[2]})})},e.prototype.getAssemblyPos=function(t,e){return u.default.convertNode1PositionToNode2ParentSpaceAR(t,e)},e.prototype.getCoinAssemblyPos=function(t){var e=this.assemblies[0];return this.getAssemblyPos(t,e)},e.prototype.playRewardsAssembly=function(t,e,o,n,r){return void 0===r&&(r=1),a(this,void 0,void 0,function(){var i;return s(this,function(){return i=this.getAssemblyPos(e,o),this.playRewardsAssemblyFromPos(t,i,o,n,r),[2]})})},e.prototype.playDefaultRewardsAssemly=function(t,e,o,n,r){return void 0===n&&(n=1),void 0===r&&(r=0),a(this,void 0,void 0,function(){var i;return s(this,function(){return(i=this.assemblies[r])||(i=this.assemblies[0]),this.playRewardsAssembly(e,t,i,o,n),[2]})})},e.gatherCoinRewardsAndSave=function(t,e){return a(this,void 0,void 0,function(){var n,r;return s(this,function(i){switch(i.label){case 0:return(n=h.default.getInstance().retrieveProxy(p.default.PROXIES.INVENTORY)).addCoin(t),n.save(),r=o.getInstance().getOtherPrefab(p.default.REWARDS_PREFABS.FISH_CANS_1),[4,o.getInstance().playDefaultRewardsAssemly(e,r,!0,1)];case 1:return i.sent(),[2]}})})},e.prototype.playRewardsAssemlyEffect=function(t,e,o,n){return void 0===e&&(e=!0),void 0===o&&(o=1),void 0===n&&(n=0),a(this,void 0,void 0,function(){return s(this,function(){return[2,this.playDefaultRewardsAssemly(t,t,e,o,n)]})})},e.showToast=function(t){var e=o.getInstance().getPopPrefab(p.default.POP_PREFABS.TOAST);d.default.showToast(t,e,o.getInstance().toastLayer)},e.showMsg=function(t,e){return a(this,void 0,void 0,function(){var n;return s(this,function(r){switch(r.label){case 0:return n=o.getInstance().getPopPrefab(p.default.POP_PREFABS.TEXT),[4,f.default.Show(n,o.getInstance().popupLayer,t,e)];case 1:return[2,r.sent()]}})})},e.showMsgOnTop=function(t,e){return a(this,void 0,void 0,function(){var n;return s(this,function(r){switch(r.label){case 0:return n=o.getInstance().getPopPrefab(p.default.POP_PREFABS.TEXT),[4,f.default.Show(n,o.getInstance().toastLayer,t,e)];case 1:return[2,r.sent()]}})})},e.showNetworkError=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return e={hideCancel:!0},[4,o.showMsgOnTop(t,e)];case 1:return[2,n.sent()]}})})},e.showCoinRewardsWithAdsAndSave=function(t,e,n){return a(this,void 0,void 0,function(){var r,i,a;return s(this,function(s){switch(s.label){case 0:return[4,o.showRewardsWithAds(t,e,n,p.default.REWARDS_PREFABS.FISH_CANS_4,1,!0)];case 1:return r=s.sent(),i=e,r.adsShowed&&(i*=n),(a=h.default.getInstance().retrieveProxy(p.default.PROXIES.INVENTORY)).addCoin(i),a.save(),[2,r]}})})},e.showCoinRewardsWithShareAndSave=function(t,e,n,r){return a(this,void 0,void 0,function(){var i,c,l,u,d,f,h,y,_,g,m,S,P=this;return s(this,function(O){switch(O.label){case 0:return i=e,c=p.default.REWARDS_PREFABS.FISH_CANS_4,l=b.default.ENABLE_SHARE(),u=!1,d=!1,f=!1,l?(h=!1,y={rewardsAmount:"+"+v.default.formatNumber(i),rewardsImage:void 0,avatar:void 0,yesText:w.default.textWithVar("btn.share.with.rewards","\u5206\u4eab\u540e\u5956\u52b1\u7ffb${value}\u500d",n),cancelText:w.default.text("btn.share.with.rewards.no","\u4e0d\u7ffb\u500d"),hideCancel:!1,rewardsPrefabName:c,scale:1,hideAds:!0,shouldShare:!0,amount:i,shareRate:n},[4,o.showRewards(t,y,!1)]):[3,2];case 1:return(_=O.sent()).ui.rewardCallback=function(){return a(P,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return t=!1,[4,_.ui.share()];case 1:return(t=e.sent())?(d=t,i*=n,o.getInstance().playCoinAssemblyFromPos(g),o.showToast(w.default.text("msg.thansk.for.share","\u8c22\u8c22\u5206\u4eab\uff0c\u4f60\u5feb\u4e50\u662f\u6211\u4eec\u6700\u5927\u7684\u5feb\u4e50\uff01")),o.addCoinToInventory(i)):(o.getInstance().playCoinAssemblyFromPos(g),o.showToast(w.default.text("msg.for.no.share","\u8c22\u8c22\u652f\u6301\uff0c\u4f60\u5feb\u4e50\u6240\u4ee5\u6211\u5feb\u4e50~")),o.addCoinToInventory(i)),[2]}})})},g=o.getInstance().getCoinAssemblyPos(_.ui.getRewardsNode()),_.result?u=_.result:h||(o.getInstance().playCoinAssemblyFromPos(g),o.showToast(w.default.text("msg.thanks.rewards","\u8c22\u8c22\u652f\u6301\uff0c\u5956\u52b1\u5df2\u7ecf\u5230\u8d26~")),o.addCoinToInventory(i)),[3,4];case 2:return m=n*r,[4,o.showCoinRewardsWithAdsAndSave(t,i,m)];case 3:S=O.sent(),f=S.adsShowed,O.label=4;case 4:return[2,{result:u,shared:d,adsShowed:f}]}})})},e.addCoinToInventory=function(t){var e=h.default.getInstance().retrieveProxy(p.default.PROXIES.INVENTORY);e.addCoin(t),e.save()},e.showRewardsWithAds=function(t,e,n,r,i){return a(this,void 0,void 0,function(){var a,c,l,u,p,d,f;return s(this,function(s){switch(s.label){case 0:return a=g.default.getInstance().isRewardsAdsReady(),l=!1,a&&n>1?c={rewardsAmount:"+"+v.default.formatNumber(e),rewardsImage:void 0,avatar:void 0,yesText:w.default.textWithVar("btn.ads.with.rewards.yes","\u770b\u5e7f\u544a\u5f97${value}\u500d!",n),cancelText:w.default.text("btn.ads.with.rewards.no","\u4e0d\u7ffb\u500d"),rewardsPrefabName:r,scale:i,hideAds:!1}:(l=!0,c={rewardsAmount:"+"+v.default.formatNumber(e),rewardsImage:void 0,avatar:void 0,yesText:w.default.text("btn.collect.rewards","\u6536\u4e0b\u54af~"),hideCancel:!0,rewardsPrefabName:r,scale:i,hideAds:!0}),u={adsShowed:!1},[4,o.showRewards(t,c,!1)];case 1:return p=s.sent(),d=o.getInstance().getCoinAssemblyPos(p.ui.getRewardsNode()),p.result?[3,2]:(l||o.getInstance().playRewardsAssemblyFromPos(r,d,o.getInstance().assemblies[0],!0,1),[3,5]);case 2:return a&&n>1?[4,g.default.getInstance().showRewardsAds(function(){})]:[3,4];case 3:return f=s.sent(),P.default.quickLogAds(),o.getInstance().playCoinAssemblyFromPos(d),f?(o.showToast(w.default.text("msg.thanks.rewards","\u55b5\uff0c\u8c22\u8c22\u652f\u6301\uff0c\u5956\u52b1\u5df2\u7ecf\u5230\u8d26~~")),e*=n):o.showToast(w.default.text("msg.ads.rewards.failed","\u55b5\uff0c\u5e7f\u544a\u9700\u8981\u64ad\u653e\u5b8c\u624d\u6709\u989d\u5916\u5956\u52b1\u54e6~~")),u.adsShowed=f,g.default.getInstance().addCounter(),[3,5];case 4:o.getInstance().playRewardsAssemblyFromPos(r,d,o.getInstance().assemblies[0],!0,1),s.label=5;case 5:return[2,u]}})})},e.showAdsOptionWithCoinRewards=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(){return[2,o.showAdsOptionWithRewards(t,e,p.default.REWARDS_PREFABS.FISH_CANS_4,1)]})})},e.showAdsOptionWithRewards=function(t,e,n,r){return a(this,void 0,void 0,function(){var i,a,c,l,u,p;return s(this,function(s){switch(s.label){case 0:return i={adsShowed:!1},(a=g.default.getInstance().isRewardsAdsReady())?(c={rewardsAmount:"+"+v.default.formatNumber(e),rewardsImage:void 0,avatar:void 0,yesText:w.default.text("btn.ads.with.rewards.yes.2","\u770b\u5e7f\u544a\u9886\u53d6"),cancelText:w.default.text("btn.ads.with.rewards.no.2","\u4e0d\u8981\u4e86"),rewardsPrefabName:n,scale:r,hideAds:!1},[4,o.showRewards(t,c,!1)]):[3,3];case 1:return l=s.sent(),u=o.getInstance().getCoinAssemblyPos(l.ui.getRewardsNode()),a&&l.result?[4,g.default.getInstance().showRewardsAds()]:[3,3];case 2:p=s.sent(),P.default.quickLogAds(),i.adsShowed=p,g.default.getInstance().addCounter(),p&&o.getInstance().playCoinAssemblyFromPos(u),s.label=3;case 3:return[2,i]}})})},e.showRewards=function(t,e,n){return a(this,void 0,void 0,function(){var r,i,a,c,l;return s(this,function(s){switch(s.label){case 0:return e.avatar||(r=_.default.getInstance().retrieveProxy(p.default.PROXIES.TASK))&&(i=r.getUnlockedLevel(),(a=y.default.getInstance().getDefaultKittyInfoByLevel(i))&&(e.avatar=a.avatar)),c=o.getInstance().getPopPrefab(p.default.POP_PREFABS.REWARDS),[4,f.default.Show2(c,o.getInstance().popupLayer,t,e)];case 1:return l=s.sent(),n&&o.getInstance().playRewardsAssemlyEffect(l.ui.getRewardsNode()),[2,l]}})})},e.showNewKitty=function(t,e){return a(this,void 0,void 0,function(){var n,r,i;return s(this,function(a){switch(a.label){case 0:return n=o.getInstance().getPopPrefab(p.default.POP_PREFABS.KITTY_UNLOCKED),[4,f.default.Show2(n,o.getInstance().popupLayer,t,e)];case 1:return r=a.sent(),i=r.ui.isShared(),[2,{result:r.result,shared:i}]}})})},e.showKittyBonus=function(t,e){return a(this,void 0,void 0,function(){var n,r;return s(this,function(){return n=o.getInstance().getPopPrefab(p.default.POP_PREFABS.KITTY_BONUS),(r={}).kitty1=t,r.kitty2=e,[2,f.default.Show(n,o.getInstance().popupLayer,"",r)]})})},e.showKittyOption=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(){return e=o.getInstance().getPopPrefab(p.default.POP_PREFABS.KITTY_OPTION),[2,f.default.Show(e,o.getInstance().popupLayer,"",t)]})})},e.playParticle=function(){o.getInstance().particles.node.active=!0,o.getInstance().particles.resetSystem()},e.showTempAds=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(){return t=o.getInstance().getPopPrefab(p.default.POP_PREFABS.TEMP_ADS),[2,f.default.Show(t,o.getInstance().popupLayer)]})})},e.showBanner=function(t){t?MiniGameAds.showBanner().then(function(){console.info("showBanner success")}).catch(function(t){console.error("showBanner fail: "+t.message)}):MiniGameAds.hideBanner().then(function(){console.info("hideBanner success")}).catch(function(t){console.error("hideBanner fail: "+t.message)})},e.share=function(t,e){return a(this,void 0,void 0,function(){var o,n,r,i,a,c;return s(this,function(s){switch(s.label){case 0:return o=!1,n=e||y.default.getInstance().getShareTitle(),r=t,console.info("share image: "+t+", text: "+n),b.default.isBaidu()?(r||(r="https://xmanyou.com/games/xmkitty/baidu/share/cat-in-a-box",i=u.default.randomInt(1,11),r+=u.default.paddingNumber(i,2)+".jpg"),a={title:n,imageUrl:r},[4,m.default.shareMessage(a)]):[3,2];case 1:return o=s.sent(),[3,10];case 2:return b.default.isFacebook()?[4,S.default.inviteAsync()]:[3,6];case 3:return(o=s.sent())?[4,S.default.updateAsync({action:"CUSTOM",cta:"Join",image:r,text:{default:"Come join me with these adorable kitties"},template:"new_match",strategy:"IMMEDIATE",notification:"NO_PUSH"})]:[3,5];case 4:s.sent(),s.label=5;case 5:return[3,10];case 6:if(!b.default.isMinigame())return[3,10];s.label=7;case 7:return s.trys.push([7,9,,10]),console.info("======> share start"),[4,FBInstant.shareAsync({image:r,text:n})];case 8:return s.sent(),console.info("======> share end"),o=!0,[3,10];case 9:return c=s.sent(),o=!1,console.error({code:"share fail",message:c.message}),[3,10];case 10:return P.default.quickLogShare(),[2,o]}})})},e._inst=null,i([A(l.default)],e.prototype,"popPrefabs",void 0),i([A(l.default)],e.prototype,"mediatorPrefabs",void 0),i([A(l.default)],e.prototype,"otherPrefabs",void 0),i([A(l.ImagePair)],e.prototype,"images",void 0),i([A(cc.SpriteFrame)],e.prototype,"kitties",void 0),i([A(cc.Node)],e.prototype,"l2Layer",void 0),i([A(cc.Node)],e.prototype,"popupLayer",void 0),i([A(cc.Node)],e.prototype,"toastLayer",void 0),i([A(cc.Node)],e.prototype,"effectLayer",void 0),i([A(cc.Node)],e.prototype,"bannerAds",void 0),i([A(cc.Node)],e.prototype,"assemblyPosition",void 0),i([A(cc.Node)],e.prototype,"assemblies",void 0),i([A(cc.ParticleSystem)],e.prototype,"particles",void 0),o=i([E],e)}(c.default);o.default=T,cc._RF.pop()},{"../../GameKit/App/AppFacade":"AppFacade","../../GameKit/Framework/Ads/AdsManager":"AdsManager","../../GameKit/Framework/Extension/SingleNode":"SingleNode","../../GameKit/Framework/Utils/Utils":"Utils","../../GameKit/Framework/View/ToastUI":"ToastUI","../../GameKit/Framework/i18n/i18n":"i18n","../../GameKit/Share/PopUI":"PopUI","../../GameKit/Tpcl/Baidu/Baidu":"Baidu","../../GameKit/Tpcl/Facebook/Facebook":"Facebook","./Data/KittyConfig":"KittyConfig","./Data/KittyDB":"KittyDB","./Data/KittyLogger":"KittyLogger","./Data/PrefabPair":"PrefabPair","./KittyConsts":"KittyConsts","./KittyFacade":"KittyFacade","./KittyUtils":"KittyUtils"}],KittyScene:[function(t,e,o){"use strict";cc._RF.push(e,"88b7fw0fGBNeYdPVDfVyh12","KittyScene");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Framework/View/MediatorComp"),l=t("../KittyConsts"),u=t("../KittyUtils"),p=t("../Data/KittyTaskProxy"),d=t("./KittyShop"),f=t("../../../GameKit/Framework/Utils/Utils"),h=t("../KittyResouces"),y=t("./KittyPetting"),_=t("./KittyLottery"),v=t("../Data/KittyDB"),g=t("../Data/KittyConfig"),b=t("../../../GameKit/Framework/Ads/AdsManager"),m=t("../Cmd/FeedCommands"),w=t("../../../GameKit/Framework/i18n/i18n"),S=t("../../../GameKit/Tpcl/Facebook/Facebook"),P=t("../Data/KittyLogger"),O=cc._decorator,E=O.ccclass,A=O.property,T=0,R=0,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.uiLayer=null,e.popupLayer=null,e.toastLayer=null,e.effectLayer=null,e.assemblyPosition=null,e._busy=!1,e}var o;return r(e,t),o=e,e.prototype._onLoaded=function(){t.prototype._onLoaded.call(this),this.mediatorName=o.MAIN_SCENE,P.default.logGameStart(),this.schedule(function(){P.default.logHeartbeat()},6)},e.prototype.start=function(){},e.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.addEvent(l.default.EVENTS.RESOURCE_READY,this.onResourceReady,this),this.addEvent(l.default.EVENTS.NOT_ENOUGH_MONEY,this.onNoMoney,this),this.addEvent(l.default.EVENTS.LOW_LEVEL_KITTY,this.onLowLevel,this),this.addEvent(l.default.EVENTS.NOT_ENOUGH_GOLD,this.onNoGold,this),this.addEvent(l.default.EVENTS.NO_MORE_SPACE,this.onNoSpace,this),this.addEvent(l.default.EVENTS.NOT_ENOUGH_TICKETS,this.onNoTickets,this),this.addEvent(l.default.EVENTS.OFFLINE_COIN,this.onOfflineCoin,this),this.addEvent(p.default.EVENTS.NEW_KITTY_LEVEL_UNLOCKED,this.onNewKittyLevel,this),this.addEvent(p.default.EVENTS.NEW_KITTY_TYPE_UNLOCKED,this.onNewKittyLevel,this),this.addEvent(l.default.UIEVENTS.SHOW_SHOP,this.showShop,this),this.addEvent(l.default.UIEVENTS.SHOW_CHECKIN,this.showCheckin,this),this.addEvent(l.default.UIEVENTS.SHOW_KITTY_COLLECTION,this.showKittyCollections,this),this.addEvent(l.default.UIEVENTS.SHOW_KITTY_YARD,this.showYard,this),this.addEvent(l.default.UIEVENTS.SHOW_HIDE_AND_SEEK,this.showHideAndSeek,this),this.addEvent(l.default.UIEVENTS.SHOW_LOTTERY,this.showLottery,this),this.addEvent(l.default.UIEVENTS.SHOW_PETTING,this.showPetting,this),this.addEvent(l.default.UIEVENTS.SHOW_RANK,this.showRank,this),this.addEvent(l.default.UIEVENTS.SHOW_TASK,this.showTask,this),this.addEvent(l.default.UIEVENTS.SHOW_TEAM_TASK,this.showTeamTask,this),this.addEvent(l.default.UIEVENTS.SHOW_TREASURES,this.showTreasures,this),this.addEvent(l.default.UIEVENTS.SHOW_KITTY_FINDING,this.showKittyFinding,this),this.addEvent(l.default.UIEVENTS.SHOW_KITTY_MATCH,this.showKittyMatch,this),this.addEvent(l.default.EVENTS.TOAST,this.showToast,this),this.addEvent(l.default.EVENTS.HIDDEN_KITTY_CLICKED,this.onHiddenKittyClicked,this)},e.prototype.onResourceReady=function(){h.default.getInstance().setLayers(this.uiLayer,this.popupLayer,this.toastLayer,this.effectLayer,this.assemblyPosition)},e.prototype.showMsg=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(){return[2,h.default.showMsg(t,e)]})})},e.prototype.showToast=function(t){h.default.showToast(t)},e.prototype.getOrCreateMediator=function(t,e,o){var n=h.default.getInstance().getMediatorPrefab(t);if(!f.default.isUndefinedOrNull(n)){var r=this.retrieveMediator(t);if(f.default.isUndefinedOrNull(r)){var i=cc.instantiate(n);i.setParent(e),r=f.default.isNotUndefinedOrNull(o)?i.getComponent(o):i.getComponent(c.default)}return r}},e.prototype.onNoSpace=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(){return this._busy?[2]:(t=w.default.text("ui.kitty.nospace.0","\u6ca1\u6709\u7a7a\u95f4\u5566\n\u8bf7\u5148\u5408\u6210\u4f4e\u7ea7\u732b\u54aa\u5427"),this.showToast(t),[2])})})},e.prototype.onHiddenKittyClicked=function(t){return a(this,void 0,void 0,function(){var e,o,n,r,i;return s(this,function(a){switch(a.label){case 0:return T<=0||T>5&&f.default.random()>.5?(i=v.default.getInstance().getCoinRewardsBySize(f.default.randomInt(10,15)),e=f.default.randomInt(5,11),o=w.default.text("ui.secret.share","\u55b5~\n\u4f60\u53d1\u73b0\u4e86\u4e0d\u5f97\u4e86\u7684\u79d8\u5bc6\u5462~~\n\u5206\u4eab\u7ed9\u597d\u53cb\uff0c\u5f97\u66f4\u591a\u5956\u52b1~~~"),n=w.default.text("ui.secret.noshare","\u55b5~\n\u4f60\u53d1\u73b0\u4e86\u4e0d\u5f97\u4e86\u7684\u79d8\u5bc6\u5462~~\n\u8bb0\u5f97\u622a\u56fe\u5206\u4eab\u7ed9\u597d\u53cb\u54e6"),r=g.default.ENABLE_SHARE()?o:n,P.default.setAdsSpace(P.KITTY_ADS_SPACE.HIDDEN_KITTY),P.default.setSharePosition(P.KITTY_SHARE_POSITION.HIDDEN_KITTY),[4,h.default.showCoinRewardsWithShareAndSave(r,i,e,1)]):[3,2];case 1:return a.sent(),T=0,[3,3];case 2:i=v.default.getInstance().getCoinRewardsBySize(1),h.default.gatherCoinRewardsAndSave(i,t.kitty),a.label=3;case 3:return T++,[2]}})})},e.prototype.onLowLevel=function(t){return a(this,void 0,void 0,function(){var e,o;return s(this,function(n){switch(n.label){case 0:return e={yesText:w.default.text("warn.kitty.low.level.yes","\u53bb\u5408\u6210"),hideCancel:!1,cancelText:w.default.text("warn.kitty.low.level.no","\u575a\u6301\u9886\u517b")},o=w.default.text("warn.kitty.low.level","\u4f4e\u7ea7\u732b\u54aa\u592a\u591a\uff0c\u4ef7\u683c\u4e5f\u4f1a\u6bd4\u8f83\u8d35\u54e6\n\n\u5148\u53bb\u5408\u6210\u9ad8\u7ea7\u732b\u54aa\u5427~"),[4,this.showMsg(o,e)];case 1:return n.sent()||(t.ignoreWarning=!0,this.executeCommand(m.default.COMMANDS.SPAWN,t)),[2]}})})},e.prototype.onNoMoney=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i,a,c,u,p,d,f,y;return s(this,function(s){switch(s.label){case 0:return this._busy?[2]:(this._busy=!0,t=this.retrieveProxy(l.default.PROXIES.TASK),e=this.retrieveProxy(l.default.PROXIES.INVENTORY),o=!1,t.isNextPettingReady()&&(o=!0),t.isFreeTicketReady()&&(o=!0),n=b.default.getInstance().isRewardsAdsReady(10),o||!n?[3,2]:(r=this.retrieveProxy(l.default.PROXIES.KITTY_PLAYGROUND),i=r.getAutoSpawnPrice().price,a=this.retrieveProxy(l.default.PROXIES.TASK),(c=a.getUnlockedLevel()-4)<1&&(c=1),u=r.getSpawnPrice(c).price,p=3*Math.max(i,u),d=w.default.text("warn.kitty.no.money","\u55b5~\u7f50\u5934\u4e0d\u591f\u5566\n\u770b\u4e00\u6bb5\u89c6\u9891\u653e\u677e\u4e00\u4e0b~\n\u987a\u4fbf\u8d5a\u70b9\u7f50\u5934,\u600e\u4e48\u6837\uff1f"),P.default.setAdsSpace(P.KITTY_ADS_SPACE.NO_MONEY),[4,h.default.showAdsOptionWithRewards(d,p,l.default.REWARDS_PREFABS.FISH_CANS_4,1)]));case 1:return s.sent().adsShowed&&(console.info("Ads Coin: ",p),(f=this.retrieveProxy(l.default.PROXIES.INVENTORY)).addCoin(p),f.save()),[3,3];case 2:y={},t.isNextPettingReady()?y.hidePetting=!1:y.hidePetting=!0,t.isFreeTicketReady()||o&&e.getTickets()>0?y.hideLottery=!1:y.hideLottery=!0,o?(y.hideHidding=!0,y.hideKittyInBox=!0,y.hideKittyMatch=!0):(y.hideHidding=!1,y.hideKittyInBox=!1,y.hideKittyMatch=!1,e.getGold()<=0&&(console.warn("No coin or gold"),y.hideHidding=!0,y.hideKittyInBox=!0,y.hideKittyMatch=!0)),h.default.showKittyOption(y),s.label=3;case 3:return this._busy=!1,[2]}})})},e.prototype.onNoGold=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return this._busy?[2]:(this._busy=!0,t=w.default.text("warn.kitty.no.gold","\u732b\u54aa\u4eec\u6709\u70b9\u7d2f\u4e86\n\n\u518d\u53bb\u5582\u70b9\u7f50\u5934\u5427~"),[4,this.showMsg(t,{hideCancel:!0})]);case 1:return e.sent(),this._busy=!1,[2]}})})},e.prototype.onNoTickets=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return this._busy?[2]:(this._busy=!0,t=w.default.text("warn.kitty.no.ticket","\u6ca1\u6709\u798f\u888b\u5566\n\n\u53bb\u73a9\u70b9\u522b\u7684\u5427"),[4,this.showMsg(t,{hideCancel:!0})]);case 1:return e.sent(),this._busy=!1,[2]}})})},e.prototype.showAds=function(){return a(this,void 0,void 0,function(){return s(this,function(){return console.warn("[KittyScene] Play Ads"),[2,!0]})})},e.prototype.showBanner=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return console.warn("[KittyScene] Show Banner: ",t),[2]})})},e.prototype.onOfflineCoin=function(t){return a(this,void 0,void 0,function(){var e,o,n,r,i,a;return s(this,function(s){switch(s.label){case 0:return e=f.default.formatTime(t.time),o=t.coin,e.minutes>10?(u.default.formatNumber(t.coin),n=w.default.text("msg.kitty.offline.money","\u6b22\u8fce\u56de\u5bb6~\n\u8fd9\u662f\u5728\u4f60\u79bb\u5f00\u7684\u65f6\u5019\uff0c\u732b\u54aa\u8d5a\u5230\u7684\uff1a"),r=2,r=e.minutes<=10?f.default.randomInt(5,11):3,P.default.setAdsSpace(P.KITTY_ADS_SPACE.OFFLINE),[4,h.default.showRewardsWithAds(n,t.coin,r,l.default.REWARDS_PREFABS.FISH_CANS_4,1,!0)]):[3,2];case 1:s.sent().adsShowed&&(o*=r),s.label=2;case 2:return console.info("Offline Coin: ",o,", time: ",e),(i=this.retrieveProxy(l.default.PROXIES.INVENTORY)).addCoin(o),a=e.minutes,i.getGold()<=a&&(a=i.getGold()),i.spendGold(Math.floor(a)),i.save(),[2]}})})},e.prototype.onNewKittyLevel=function(t){return a(this,void 0,void 0,function(){var e,o,n,r,i,a,c,p,d,f,y,_;return s(this,function(s){switch(s.label){case 0:return this._busy?(console.warn("[KittyScene] is busy"),[2]):(e=this.retrieveProxy(l.default.PROXIES.INVENTORY),t.level>=4&&g.default.isFacebook()?[4,S.default.canSubscribeToBot()]:[3,8]);case 1:return s.sent()?[4,S.default.trySubscribeBot()]:[3,3];case 2:return s.sent(),[3,8];case 3:return(o=t.level>=8)?[4,S.default.canCreateShortcut()]:[3,5];case 4:o=s.sent(),s.label=5;case 5:return o?(r=w.default.text("event.shortcut","\u4f60\u597d\u50cf\u633a\u559c\u6b22\u8fd9\u4e2a\u6e38\u620f\u7684\uff0c\u8981\u4e0d\u8981\u5728\u684c\u9762\u6dfb\u52a0\u4e00\u4e2a\u5feb\u6377\u65b9\u5f0f\uff1f\n\u4f5c\u4e3a\u56de\u62a5\uff0c\u8fd9\u662f\u6211\u4eec\u7ed9\u4f60\u7684\u4e00\u70b9\u70b9\u5956\u52b1\u3002"),n=v.default.getInstance().getCoinRewardsBySize(60),f={rewardsAmount:"+"+u.default.formatNumber(n),rewardsImage:void 0,avatar:void 0,yesText:w.default.text("event.shortcut.yes","\u597d\u5440"),cancelText:w.default.text("event.shortcut.no","\u4e0d\u8981\u4e86"),rewardsPrefabName:l.default.REWARDS_PREFABS.FISH_CANS_4,hideAds:!0},[4,h.default.showRewards(r,f,!0)]):[3,8];case 6:return(y=s.sent()).result?(P.default.logShortcut(),[4,S.default.tryCreateShortcut()]):[3,8];case 7:s.sent(),e.addCoin(n),e.save(),s.label=8;case 8:this._busy=!0,s.label=9;case 9:return s.trys.push([9,13,,14]),P.default.setAdsSpace(P.KITTY_ADS_SPACE.SHARE_NEW_LEVEL),P.default.setSharePosition(P.KITTY_SHARE_POSITION.NEW_KITTY),r=w.default.text("event.kitty.new.level.title","\u65b0\u7684\u732b\u54aa"),i=g.default.ENABLE_SHARE(),a=v.default.getInstance().getCoinRewardsBySize(60),c=10,p={amount:a,unit:l.PRICE_UNIT.COIN},t.level<5&&(p.amount=0,c=1),d=i?w.default.text("event.kitty.new.level.share","\u5206\u4eab\u7ed9\u597d\u53cb"):w.default.text("event.kitty.new.level.noshare","\u597d\u7684"),f=void 0,f={kittyId:t.id,yesText:d,cancelText:w.default.text("event.kitty.new.level.share.no","\u4e0b\u6b21\u5427"),hideCancel:!i,shareRewards:p},[4,h.default.showNewKitty(r,f)];case 10:return y=s.sent(),i&&y.shared?[4,h.default.showRewardsWithAds(w.default.text("event.share.rewards.msg","\u611f\u8c22\u5206\u4eab!\n\u8fd9\u662f\u7ed9\u4f60\u7684\u5956\u52b1:"),a,c,l.default.REWARDS_PREFABS.FISH_CANS_4,1,!0)]:[3,12];case 11:s.sent().adsShowed&&(a*=c),e.addCoin(a),e.save(),s.label=12;case 12:return[3,14];case 13:return _=s.sent(),cc.warn(_),[3,14];case 14:return this._busy=!1,[2]}})})},e.prototype.onNewKittyType=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return[2,this.onNewKittyLevel(t)]})})},e.prototype.showShop=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return(t=this.getOrCreateMediator(l.default.MEDIATORS.KITTY_SHOP,this.uiLayer,d.default)).updateData(),[4,t.show(!0)];case 1:return e.sent(),[2]}})})},e.prototype.showPetting=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i,a;return s(this,function(s){switch(s.label){case 0:return(t=this.retrieveProxy(l.default.PROXIES.TASK)).isNextPettingReady()&&(R=0),e=this.getOrCreateMediator(l.default.MEDIATORS.KITTY_PETTING,this.uiLayer,y.default),(o=10*(R+1))>60&&(o=60),e.startPetting(10,o),[4,e.show(!0)];case 1:return s.sent(),R++,[3,3];case 2:n=t.getNextPettingTime(),r=Math.abs(Date.now()-n),i=f.default.formatTime(r),"",a=i.h<=0&&i.m<=0?"\u8fd8\u6709\u4e0d\u52301\u5206\u949f\u5c31\u53ef\u4ee5\u518d\u6b21\u64b8\u732b\u5566":i.h>0?"\u518d\u7b49\u7b49\uff0c\u8fd8\u6709"+i.h+"\u5c0f\u65f6"+i.m+"\u5206\u949f\u5c31\u53ef\u4ee5\u64b8\u732b\u5566\n\n\u5148\u53bb\u73a9\u70b9\u522b\u7684\u5427":"\u518d\u7b49\u7b49\uff0c\u8fd8\u6709"+i.m+"\u5206\u949f\u5c31\u53ef\u4ee5\u64b8\u732b\u5566\n\n\u5148\u53bb\u73a9\u70b9\u522b\u7684\u5427",this.showMsg(a,{hideCancel:!0}),s.label=3;case 3:return[2]}})})},e.prototype.showLottery=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return(t=this.getOrCreateMediator(l.default.MEDIATORS.KITTY_LOTTERY,this.uiLayer,_.default)).updateData(),[4,t.show(!0)];case 1:return e.sent(),[2]}})})},e.prototype.showCheckin=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return(t=this.getOrCreateMediator(l.default.MEDIATORS.CHECK_IN,this.uiLayer)).updateData(),[4,t.show(!0)];case 1:return e.sent(),[2]}})})},e.prototype.showTask=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return(t=this.getOrCreateMediator(l.default.MEDIATORS.TASK,this.uiLayer)).updateData(),[4,t.show(!0)];case 1:return e.sent(),[2]}})})},e.prototype.showTeamTask=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.getOrCreateMediator(l.default.MEDIATORS.TEAM_TASK,this.uiLayer).show(!0)];case 1:return t.sent(),[2]}})})},e.prototype.showTreasures=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.getOrCreateMediator(l.default.MEDIATORS.TREASURES,this.uiLayer).show(!0)];case 1:return t.sent(),[2]}})})},e.prototype.showToys=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return(t=this.getOrCreateMediator(l.default.MEDIATORS.TOYS,this.uiLayer)).updateData(),[4,t.show(!0)];case 1:return e.sent(),[2]}})})},e.prototype.showKittyCollections=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return(t=this.getOrCreateMediator(l.default.MEDIATORS.KITTY_COLLECTION,this.uiLayer)).updateData(),[4,t.show(!0)];case 1:return e.sent(),[2]}})})},e.prototype.showRank=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.getOrCreateMediator(l.default.MEDIATORS.RANK,this.uiLayer).show(!0)];case 1:return t.sent(),[2]}})})},e.prototype.showHideAndSeek=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return(t=this.getOrCreateMediator(l.default.MEDIATORS.HIDE_AND_SEEK,this.uiLayer)).startGame()?[4,t.show(!0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.showKittyFinding=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,(t=this.getOrCreateMediator(l.default.MEDIATORS.KITTY_FINDING,this.uiLayer)).show(!0)];case 1:return e.sent(),t.startGame(),[2]}})})},e.prototype.showKittyMatch=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,(t=this.getOrCreateMediator(l.default.MEDIATORS.KITTY_MATCH,this.uiLayer)).show(!0)];case 1:return e.sent(),[4,f.default.waitFor(100)];case 2:return e.sent(),t.startGame(),[2]}})})},e.prototype.showYard=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.showMsg(w.default.text("warn.kitty.yard.under.construction","\u300a\u732b\u54aa\u6e38\u4e50\u573a\u300b\u8fd8\u5728\u5efa\u8bbe\u4e2d~"),{hideCancel:!0}),[2]})})},e.MAIN_SCENE="Main.Scene",i([A(cc.Node)],e.prototype,"uiLayer",void 0),i([A(cc.Node)],e.prototype,"popupLayer",void 0),i([A(cc.Node)],e.prototype,"toastLayer",void 0),i([A(cc.Node)],e.prototype,"effectLayer",void 0),i([A(cc.Node)],e.prototype,"assemblyPosition",void 0),o=i([E],e)}(c.default);o.default=I,cc._RF.pop()},{"../../../GameKit/Framework/Ads/AdsManager":"AdsManager","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/View/MediatorComp":"MediatorComp","../../../GameKit/Framework/i18n/i18n":"i18n","../../../GameKit/Tpcl/Facebook/Facebook":"Facebook","../Cmd/FeedCommands":"FeedCommands","../Data/KittyConfig":"KittyConfig","../Data/KittyDB":"KittyDB","../Data/KittyLogger":"KittyLogger","../Data/KittyTaskProxy":"KittyTaskProxy","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces","../KittyUtils":"KittyUtils","./KittyLottery":"KittyLottery","./KittyPetting":"KittyPetting","./KittyShop":"KittyShop"}],KittyShopItem:[function(t,e,o){"use strict";cc._RF.push(e,"91b36nijx9OZb13aVNo6iD+","KittyShopItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Framework/Extension/TableViewCell"),s=t("../Data/KittyShopProxy"),c=t("../KittyUtils"),l=t("../../../GameKit/Framework/Utils/UIHelper"),u=t("../KittyFacade"),p=t("../KittyConsts"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.level=null,e.avatar=null,e.nameLabel=null,e.btnBuyWithCoin=null,e.coinPrice=null,e.btnBuyWithGold=null,e.goldPrice=null,e.btnLocked=null,e.unlockPrice=null,e}return r(e,t),e.prototype.onLoad=function(){l.default.bindClickEvent(this.btnBuyWithCoin,this.onBuy.bind(this)),l.default.bindClickEvent(this.btnBuyWithGold,this.onBuy.bind(this))},e.prototype.updateData=function(e,o,n){switch(t.prototype.updateData.call(this,e,o,n),this.level.string=o.level.toString(),this.nameLabel.string=o.name,this.btnLocked.node.active=!1,this.btnBuyWithCoin.node.active=!1,this.btnBuyWithGold.node.active=!1,this.avatar.spriteFrame=o.avatar,o.state){case s.KITTY_SHOP_STATE.LOCKED:this.btnLocked.node.active=!0,this.avatar.node.color=cc.Color.BLACK;break;case s.KITTY_SHOP_STATE.UNLOCKED:this.btnLocked.node.active=!0,this.avatar.node.color=cc.Color.WHITE;break;case s.KITTY_SHOP_STATE.BUY_WITH_GOLD:this.btnBuyWithGold.node.active=!0,this.goldPrice.string=c.default.formatNumber(o.price),this.avatar.node.color=cc.Color.WHITE;break;default:this.btnBuyWithCoin.node.active=!0,this.coinPrice.string=c.default.formatNumber(o.price),this.avatar.node.color=cc.Color.WHITE}},e.prototype.onBuy=function(){u.default.getInstance().sendNotification(p.default.UIEVENTS.BUY_KITTY,this._data)},i([h(cc.Label)],e.prototype,"level",void 0),i([h(cc.Sprite)],e.prototype,"avatar",void 0),i([h(cc.Label)],e.prototype,"nameLabel",void 0),i([h(cc.Button)],e.prototype,"btnBuyWithCoin",void 0),i([h(cc.Label)],e.prototype,"coinPrice",void 0),i([h(cc.Button)],e.prototype,"btnBuyWithGold",void 0),i([h(cc.Label)],e.prototype,"goldPrice",void 0),i([h(cc.Button)],e.prototype,"btnLocked",void 0),i([h(cc.Label)],e.prototype,"unlockPrice",void 0),i([f],e)}(a.default);o.default=y,cc._RF.pop()},{"../../../GameKit/Framework/Extension/TableViewCell":"TableViewCell","../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../Data/KittyShopProxy":"KittyShopProxy","../KittyConsts":"KittyConsts","../KittyFacade":"KittyFacade","../KittyUtils":"KittyUtils"}],KittyShopProxy:[function(t,e,o){"use strict";cc._RF.push(e,"59a8aFXLItJubn3LH1a3Bd7","KittyShopProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.KITTY_SHOP_STATE=void 0;var c,l=t("../../../GameKit/Framework/Model/Proxy"),u=t("./KittyDB"),p=t("../KittyConsts"),d=cc._decorator,f=d.ccclass;d.property,function(t){t[t.LOCKED=0]="LOCKED",t[t.UNLOCKED=1]="UNLOCKED",t[t.BUY_WITH_COIN=2]="BUY_WITH_COIN",t[t.BUY_WITH_GOLD=3]="BUY_WITH_GOLD"}(c=o.KITTY_SHOP_STATE||(o.KITTY_SHOP_STATE={}));var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return r(e,t),o=e,e.create=function(t){var e=new o;return e.name=t,e},e.prototype.init=function(){},e.prototype.load=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.save=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.getKitties=function(){for(var t=this.retrieveProxy(p.default.PROXIES.TASK),e=t.getUnlockedLevel(),o=u.default.getInstance().getTotalKittyLevels(),n=[],r=0;r<o;r++){var i=u.default.getInstance().getIdFromLevel(r+1),a=u.default.getInstance().getKittyInfoById(i),s={id:i,level:a.level,name:a.name,avatar:a.avatar,state:c.BUY_WITH_COIN,price:100};s.level<=e?s.level<=1||s.level<=e-4?(s.state=c.BUY_WITH_COIN,s.price=u.default.getInstance().getSpawnPrice(s.level,t.getSpawnCounter(s.level))):s.level<=e-2?(s.state=c.BUY_WITH_GOLD,s.price=u.default.getInstance().getSpawnPriceInGold(s.level,t.getSpawnCounter(s.level))):(s.state=c.UNLOCKED,s.price=s.level+2):(s.state=c.LOCKED,s.price=s.level+4,s.name="???"),n.push(s)}return n},e.KEY="Kitty.Shop",e.EVENTS={},o=i([f],e)}(l.default);o.default=h,cc._RF.pop()},{"../../../GameKit/Framework/Model/Proxy":"Proxy","../KittyConsts":"KittyConsts","./KittyDB":"KittyDB"}],KittyShop:[function(t,e,o){"use strict";cc._RF.push(e,"b5cbc9K6fpCO5OQKK2zqGLF","KittyShop");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Data/KittyShopProxy"),s=t("../KittyConsts"),c=t("../../../GameKit/Framework/View/UIMediator2"),l=t("../Cmd/FeedCommands"),u=t("../../../GameKit/Framework/Extension/TableView"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemList=null,e}return r(e,t),e.prototype._onLoaded=function(){t.prototype._onLoaded.call(this)},e.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.addEvent(s.default.UIEVENTS.BUY_KITTY,this.onBuyKitty,this)},e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this)},e.prototype.updateData=function(){if(this._proxy||(this._proxy=this.retrieveProxy(s.default.PROXIES.SHOP)),this._proxy){var t=this._proxy.getKitties();this.itemList.isInited()?this.itemList.reload(t):this.itemList.initTableView(t)}else console.warn("[KittyShop] missing shop proxy: ",s.default.PROXIES.SHOP)},e.prototype.onBuyKitty=function(t){if(t.state!=a.KITTY_SHOP_STATE.LOCKED){var e=s.PRICE_UNIT.COIN;t.state==a.KITTY_SHOP_STATE.BUY_WITH_GOLD&&(e=s.PRICE_UNIT.GOLD),this.retrieveProxy(s.default.PROXIES.INVENTORY).canBuy(t.price,e)?(this.executeCommand(l.default.COMMANDS.SPAWN,{level:t.level,price:t.price,unit:e}),this.hide(!0)):e==s.PRICE_UNIT.GOLD?this.sendNotification(s.default.EVENTS.NOT_ENOUGH_GOLD,{price:t.price,unit:e}):this.sendNotification(s.default.EVENTS.NOT_ENOUGH_MONEY,{price:t.price,unit:e})}else console.warn("[Shop] Kitty is locked, can't buy: ",t)},i([f(u.default)],e.prototype,"itemList",void 0),i([d],e)}(c.default);o.default=h,cc._RF.pop()},{"../../../GameKit/Framework/Extension/TableView":"TableView","../../../GameKit/Framework/View/UIMediator2":"UIMediator2","../Cmd/FeedCommands":"FeedCommands","../Data/KittyShopProxy":"KittyShopProxy","../KittyConsts":"KittyConsts"}],KittyTaskInfo:[function(t,e,o){"use strict";cc._RF.push(e,"53d881hpMdJCYcDYingVCde","KittyTaskInfo"),Object.defineProperty(o,"__esModule",{value:!0}),o.TASK_IMAGE_NAME=o.TASK_TYPE=void 0,function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.FEED_KITTY=1]="FEED_KITTY",t[t.MERGE_KITTY=2]="MERGE_KITTY",t[t.CHECKIN=3]="CHECKIN",t[t.LOTTERY=4]="LOTTERY",t[t.HIDE_AND_SEEK=5]="HIDE_AND_SEEK",t[t.PETTING=6]="PETTING",t[t.SPECIAL_KITTY=7]="SPECIAL_KITTY"}(o.TASK_TYPE||(o.TASK_TYPE={})),o.TASK_IMAGE_NAME=["","Spawn","Spawn","CheckIn","Lottery","HideAndSeek","Petting","Collection"],cc._RF.pop()},{}],KittyTaskItem:[function(t,e,o){"use strict";cc._RF.push(e,"cda96l3/KtCfocZc2evHbUf","KittyTaskItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Framework/Extension/TableViewCell"),s=t("../../../GameKit/Framework/Utils/Utils"),c=t("../../../GameKit/App/AppFacade"),l=t("../../../GameKit/Framework/Utils/UIHelper"),u=t("../KittyConsts"),p=t("../KittyResouces"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.finishedNode=null,e.avatar=null,e.desc=null,e.progress=null,e.rewardsAmount=null,e.rewardsIcon=null,e.btnClaimRewards=null,e._taskId=0,e._rewardsNode=null,e}var o;return r(e,t),o=e,e.prototype.start=function(){l.default.bindClickEvent(this.btnClaimRewards,this.claimRewards.bind(this))},e.prototype.updateData=function(e,o,n){t.prototype.updateData.call(this,e,o,n),this._taskId=o.id,s.default.isNotUndefinedOrNull(o.avatar)&&(this.avatar.spriteFrame=o.avatar,this.avatar.node.setScale(o.avatarScale)),o.current>=o.target?this.progress.string="100%":this.progress.string=o.current+"/"+o.target,this.rewardsAmount.string="+"+o.config.rewardsAmount.toString();var r=p.default.getInstance().getOtherPrefab(o.config.rewardsPrefab),i=cc.instantiate(r);i.setParent(this.rewardsIcon),i.active=!0,i.setPosition(0,0),this._rewardsNode=i,this.rewardsIcon.getComponent(cc.Sprite).enabled=!1,o.config.rewardsType==u.PRICE_UNIT.COIN?(this.rewardsAmount.node.active=!1,this.rewardsIcon.x=0):this.rewardsAmount.node.active=!0,this.finishedNode.active=!1,this.btnClaimRewards.interactable=!0,o.current>=o.target?o.claimed?(this.btnClaimRewards.interactable=!1,this.finishedNode.active=!0):this.btnClaimRewards.node.active=!0:this.btnClaimRewards.interactable=!1,this.desc.string=o.desc},e.prototype.claimRewards=function(){c.default.getInstance().sendNotification(o.EVENTS.CLAIM,{taskId:this._taskId,item:this})},e.prototype.getRewardsNode=function(){return this._rewardsNode},e.EVENTS={CLAIM:"Claim.Task.Rewards.Event"},i([h(cc.Node)],e.prototype,"finishedNode",void 0),i([h(cc.Sprite)],e.prototype,"avatar",void 0),i([h(cc.Label)],e.prototype,"desc",void 0),i([h(cc.Label)],e.prototype,"progress",void 0),i([h(cc.Label)],e.prototype,"rewardsAmount",void 0),i([h(cc.Node)],e.prototype,"rewardsIcon",void 0),i([h(cc.Button)],e.prototype,"btnClaimRewards",void 0),o=i([f],e)}(a.default);o.default=y,cc._RF.pop()},{"../../../GameKit/App/AppFacade":"AppFacade","../../../GameKit/Framework/Extension/TableViewCell":"TableViewCell","../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/Framework/Utils/Utils":"Utils","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces"}],KittyTaskProxy:[function(t,e,o){"use strict";cc._RF.push(e,"7667empTitGqbP0rx8cr5rR","KittyTaskProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Framework/Model/Proxy"),l=t("../../../GameKit/Framework/Model/LocalCache"),u=t("../../../GameKit/Framework/Utils/Utils"),p=t("./KittyDB"),d=t("./KittyTaskInfo"),f=t("../KittyResouces"),h=t("./KittyConfig"),y=t("../Network/RemoteCache"),_=t("../../../GameKit/Framework/i18n/i18n"),v=t("./KittyLogger"),g=cc._decorator,b=g.ccclass,m=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._kittySpawnCounter=[],e._specialKittyCounter=[],e._unlockedLevel=0,e._checkInDays=0,e._continuedCheckin=0,e._lastCheckinDate=0,e._lastFreeTicketDate=0,e._lastPettingDate=0,e._dailyTaskCounter=[],e._dailyTasks=[],e._dailyTaskTime=0,e._dailyTaskClaimCounter=[],e._overallRewardsClaimed=!1,e}var o;return r(e,t),o=e,e.create=function(t){var e=new o;return e.name=t,e},e.prototype.init=function(){var t=p.default.getInstance().getTotalKittyLevels();this._kittySpawnCounter=u.default.createArray(t,0),this._unlockedLevel=0,this._checkInDays=0,this._continuedCheckin=0,this._lastCheckinDate=0,this._lastFreeTicketDate=0,this._dailyTaskCounter=[],this._dailyTasks=[],this._dailyTaskTime=0,this._dailyTaskClaimCounter=[],this._overallRewardsClaimed=!1},e.prototype.load=function(){return a(this,void 0,void 0,function(){var t,e,n;return s(this,function(r){switch(r.label){case 0:return h.default.CACHE.USE_REMOTE_CACHE()?(t=y.default.getObj(o.KEY),[3,3]):[3,1];case 1:return[4,l.default.getObj(o.KEY)];case 2:t=r.sent(),r.label=3;case 3:if(u.default.isNotUndefinedOrNull(t)){if(u.default.isNotUndefinedOrNull(t.spawnCouner))for(e=0;e<t.spawnCouner.length;e++)n=t.spawnCouner[e],u.default.isNotUndefinedOrNull(n)?this._kittySpawnCounter[e]=n:this._kittySpawnCounter[e]=0;u.default.isNotUndefinedOrNull(t.unlockedLevel)&&(this._unlockedLevel=t.unlockedLevel),u.default.isNotUndefinedOrNull(t.checkInDays)&&(this._checkInDays=t.checkInDays),u.default.isNotUndefinedOrNull(t.lastCheckinDate)&&(this._lastCheckinDate=t.lastCheckinDate),u.default.isNotUndefinedOrNull(t.continuedCheckin)&&(this._continuedCheckin=t.continuedCheckin),u.default.isNotUndefinedOrNull(t.kittyCounter)&&(this._specialKittyCounter=t.kittyCounter),u.default.isNotUndefinedOrNull(t.lastFreeTicketDate)&&(this._lastFreeTicketDate=t.lastFreeTicketDate),u.default.isNotUndefinedOrNull(t.lastPettingDate)&&(this._lastPettingDate=t.lastPettingDate),u.default.isNotUndefinedOrNull(t.dailyTaskCounter)&&(this._dailyTaskCounter=t.dailyTaskCounter),u.default.isNotUndefinedOrNull(t.dailyTasks)&&(this._dailyTasks=t.dailyTasks),u.default.isNotUndefinedOrNull(t.dailyTaskTime)&&(this._dailyTaskTime=t.dailyTaskTime),u.default.isNotUndefinedOrNull(t.dailyTaskClaimCounter)&&(this._dailyTaskClaimCounter=t.dailyTaskClaimCounter),u.default.isNotUndefinedOrNull(t.overallRewardsClaimed)&&(this._overallRewardsClaimed=t.overallRewardsClaimed)}return this.updateCounter(),[2]}})})},e.prototype.save=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(){return t={spawnCouner:this._kittySpawnCounter,unlockedLevel:this._unlockedLevel,checkInDays:this._checkInDays,lastCheckinDate:this._lastCheckinDate,continuedCheckin:this._continuedCheckin,kittyCounter:this._specialKittyCounter,lastFreeTicketDate:this._lastFreeTicketDate,lastPettingDate:this._lastPettingDate,dailyTaskCounter:this._dailyTaskCounter,dailyTasks:this._dailyTasks,dailyTaskTime:this._dailyTaskTime,dailyTaskClaimCounter:this._dailyTaskClaimCounter,overallRewardsClaimed:this._overallRewardsClaimed},h.default.CACHE.USE_REMOTE_CACHE()?(y.default.putObj(o.KEY,t),y.default.save()):l.default.putObj(o.KEY,t),[2]})})},e.prototype.getSpawnCounter=function(t){var e=t-1,o=this._kittySpawnCounter[e];return u.default.isUndefinedOrNull(o)&&(o=0),o},e.prototype.addSpawnCounter=function(t,e){var n=t-1,r=this._kittySpawnCounter[n];u.default.isUndefinedOrNull(r)?r=0:r++,this._kittySpawnCounter[n]=r,this.sendNotification(o.EVENTS.SPAWN_COUNTER_UPDATE),this._addFeedCounter(t,e)},e.prototype.addMergeCounter=function(t,e){this.sendNotification(o.EVENTS.MERGE_COUNTER_UPDATE),this._addFeedCounter(t,e),this.addMergeTaskCounter()},e.prototype._addFeedCounter=function(t,e){this._unlockedLevel<t&&(this._unlockedLevel=t,v.default.logKittyLevel(t),this.sendNotification(o.EVENTS.NEW_KITTY_LEVEL_UNLOCKED,{level:t,id:e})),this._isSpecialKitty(e)&&1==this._addSpecialKittyCounter(e)&&this.sendNotification(o.EVENTS.NEW_KITTY_TYPE_UNLOCKED,{level:t,id:e})},e.prototype._isSpecialKitty=function(t){return p.default.getInstance().isSpecialKitty(t)},e.prototype._addSpecialKittyCounter=function(t){for(var e,o=0;o<this._specialKittyCounter.length;o++){var n=this._specialKittyCounter[o];if(!u.default.isUndefinedOrNull(n)&&n.id==t){e=n;break}}return u.default.isUndefinedOrNull(e)?(e={id:t,count:1},this._specialKittyCounter.push(e)):e.count++,e.count},e.prototype.getSpecialKittyCounterByLevel=function(t){var e=p.default.getInstance().getSpecialKittyIdByLevel(t);return this.getSpecialKittyCounterById(e)},e.prototype.getSpecialKittyCounterById=function(t){for(var e,o=0;o<this._specialKittyCounter.length;o++){var n=this._specialKittyCounter[o];if(!u.default.isUndefinedOrNull(n)&&n.id==t){e=n;break}}return u.default.isUndefinedOrNull(e)?0:e.count},e.prototype.getUnlockedLevel=function(){return this._unlockedLevel},e.prototype.getUnlockedLevelName=function(){var t=p.default.getInstance().getKittyInfoById(this._unlockedLevel);return t?t.name:""},e.prototype.checkin=function(){var t=Date.now(),e=u.default.calculateDaysToNow(new Date(this._lastCheckinDate),!0);this._checkInDays<=0&&(e=0),this._lastCheckinDate=t,this._checkInDays++,e<=1?this._continuedCheckin++:this._continuedCheckin=0,this.sendNotification(o.EVENTS.CHECK_IN),this.addCheckinTaskCounter()},e.prototype.updateCounter=function(){var t=!1,e=u.default.calculateDaysToNow(new Date(this._lastCheckinDate),!0);e>1&&(this._continuedCheckin=0,t=!0),(e=u.default.calculateDaysToNow(new Date(this._dailyTaskTime),!0))>=1&&(this._resetDailyTasks(),t=!0),t&&this.save()},e.prototype._freeTicketTime=function(){var t=new Date;return t.setHours(0,0,0,0),t.getTime()},e.prototype.isFreeTicketReady=function(){var t=this._freeTicketTime();return u.default.calculateDays2(new Date(this._lastFreeTicketDate),new Date(t),!0)>=1},e.prototype.markTodayFreeTicketDone=function(){this._lastFreeTicketDate=this._freeTicketTime()},e.prototype.getTotalCheckin=function(){return this._checkInDays},e.prototype.getContinuedCheckin=function(){return this._continuedCheckin},e.prototype.getLastCheckin=function(){return this._lastCheckinDate},e.prototype.isTodayCheckined=function(){return u.default.isSameDayToday(new Date(this._lastCheckinDate))},e.prototype.getCheckinData=function(){var t=p.default.getInstance().getCheckinConfig(),e=[],o=0,n=0;this._checkInDays>0&&(n=o=this._checkInDays%t.length,u.default.isSameDayToday(new Date(this._lastCheckinDate))&&(0==o&&(o=t.length),n=o-1));for(var r=0;r<t.length;r++){var i={day:r,config:t[r],isCheckedin:!1,isToday:!1};i.day<o?i.isCheckedin=!0:i.isCheckedin=!1,i.day==n&&(i.isToday=!0),e.push(i)}return e},e.prototype.getTodayRewards=function(){var t=p.default.getInstance().getCheckinConfig(),e=0,o=0;return this._checkInDays>0?(o=e=this._checkInDays%t.length,u.default.isSameDayToday(new Date(this._lastCheckinDate))&&(0==e&&(e=t.length),o=e-1)):o=0,t[o]},e.prototype._resetDailyTasks=function(){this._dailyTaskTime=Date.now(),this._dailyTaskCounter=[],this._dailyTasks=[],this._dailyTaskClaimCounter=[],this._overallRewardsClaimed=!1;var t=p.default.getInstance().getAllDailyTasks(),e=u.default.randomValuesBetween(0,t.length,5);u.default.sortArray(e,function(t,e){return t<e});for(var o=0;o<e.length;o++){var n=t[e[o]].id;this._dailyTasks.push(n)}this._overallRewardsClaimed=!1},e.prototype._getDailyTaskCounter=function(t){for(var e=0,o=0;o<this._dailyTaskCounter.length;o++){var n=this._dailyTaskCounter[o];n.id==t&&(e=n.count)}return e},e.prototype._addDailyTaskCounter=function(t,e){for(var n=0,r=0;r<this._dailyTaskCounter.length;r++){var i=this._dailyTaskCounter[r];i.id==t&&(i.count+=e,n=i.count)}return n<=0&&(this._dailyTaskCounter.push({id:t,count:e}),n=e),this.sendNotification(o.EVENTS.TASK_COUNTER_CHANGE),n},e.prototype.addCheckinTaskCounter=function(){this._addDailyTaskCounter(d.TASK_TYPE.CHECKIN,1)},e.prototype.addMergeTaskCounter=function(){this._addDailyTaskCounter(d.TASK_TYPE.MERGE_KITTY,1)},e.prototype.addPettingTaskCounter=function(){this._addDailyTaskCounter(d.TASK_TYPE.PETTING,1),this._lastPettingDate=Date.now()},e.prototype.getPettingCounter=function(){return this._getDailyTaskCounter(d.TASK_TYPE.PETTING)},e.prototype.getNextPettingTime=function(){return this._lastPettingDate<=0?0:this._lastPettingDate+u.default.msHour(1)},e.prototype.isNextPettingReady=function(){var t=Date.now();return this._lastPettingDate<=0||t>=this.getNextPettingTime()},e.prototype.addHideAndSeekTaskCounter=function(){this._addDailyTaskCounter(d.TASK_TYPE.HIDE_AND_SEEK,1)},e.prototype.addLotteryTaskCounter=function(){this._addDailyTaskCounter(d.TASK_TYPE.LOTTERY,1)},e.prototype.getDailyTaskProgress=function(t){var e=p.default.getInstance().getDailyTaskById(t);if(u.default.isUndefinedOrNull(e))return 0;var o=e.taskType;return this._getDailyTaskCounter(o)},e.prototype.getDailyTaskClaimStatus=function(t){for(var e=0,o=0;o<this._dailyTaskClaimCounter.length;o++){var n=this._dailyTaskClaimCounter[o];if(n.id==t){e=n.count;break}}return e>0},e.prototype.getDailyTasks=function(){for(var t=[],e=0,o=0;o<this._dailyTasks.length;o++){var n=this._dailyTasks[o],r=p.default.getInstance().getDailyTaskById(n);if(u.default.isNotUndefinedOrNull(r)){r.target<=this.getDailyTaskProgress(n)&&e++;var i={id:n,current:this.getDailyTaskProgress(n),target:r.target,claimed:this.getDailyTaskClaimStatus(n),config:r,avatar:void 0},a=_.default.value("task.config.item.desc")["t"+i.id];a||(a=r.desc),a=u.default.replaceAll(a,"{target}",r.target.toString()),i.desc=a;var s=d.TASK_IMAGE_NAME[r.taskType];u.default.isNotUndefinedOrNull(s)&&(i.avatar=f.default.getInstance().getImage(s),i.avatarScale=1,r.taskType==d.TASK_TYPE.CHECKIN?i.avatarScale=1.5:r.taskType==d.TASK_TYPE.MERGE_KITTY&&(i.avatarScale=.75)),t.push(i)}}return{tasks:t,overall:{total:this._dailyTasks.length,finished:e,claimed:this._overallRewardsClaimed}}},e.prototype.getTaskById=function(t){return p.default.getInstance().getDailyTaskById(t)},e.prototype.claimTaskRewards=function(t){for(var e,n=0;n<this._dailyTaskClaimCounter.length;n++){var r=this._dailyTaskClaimCounter[n];if(r.id==t){e=r;break}}if(u.default.isUndefinedOrNull(e))e={id:t,count:1},this._dailyTaskClaimCounter.push(e);else{if(e.count>0)return!1;e.count=1}return this.sendNotification(o.EVENTS.TASK_CLAIM_STATUS_CHANGE),!0},e.prototype.isOverallTaskRewardsClaimed=function(){return this._overallRewardsClaimed},e.prototype.canClaimOverallTaskReward=function(){if(this.isOverallTaskRewardsClaimed())return!1;for(var t=0,e=0;e<this._dailyTasks.length;e++){var o=this._dailyTasks[e];this.getDailyTaskClaimStatus(o)&&t++}return t>=this._dailyTasks.length},e.prototype.setOverallTaskRewardsClaimed=function(){return!this._overallRewardsClaimed&&(this._overallRewardsClaimed=!0,this.sendNotification(o.EVENTS.TASK_CLAIM_STATUS_CHANGE),!0)},e.prototype.hasUnclaimedTask=function(){if(this.canClaimOverallTaskReward())return!0;for(var t=!1,e=this.getDailyTasks(),o=0;o<e.tasks.length;o++){var n=e.tasks[o];if(!n.claimed&&n.current>=n.target){t=!0;break}}return t},e.KEY="Kitty.Task",e.EVENTS={SPAWN_COUNTER_UPDATE:"Kitty.Spawn.Counter.Update",MERGE_COUNTER_UPDATE:"Kitty.Merge.Counter.Update",NEW_KITTY_TYPE_UNLOCKED:"New.Kitty.Unlocked",NEW_KITTY_LEVEL_UNLOCKED:"New.Kitty.Level.Unlocked",CHECK_IN:"Checkin.Done",TASK_COUNTER_CHANGE:"Task.Counter.Change",TASK_CLAIM_STATUS_CHANGE:"Task.Claim.Status.Change"},o=i([b],e)}(c.default));o.default=m,cc._RF.pop()},{"../../../GameKit/Framework/Model/LocalCache":"LocalCache","../../../GameKit/Framework/Model/Proxy":"Proxy","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/i18n/i18n":"i18n","../KittyResouces":"KittyResouces","../Network/RemoteCache":"RemoteCache","./KittyConfig":"KittyConfig","./KittyDB":"KittyDB","./KittyLogger":"KittyLogger","./KittyTaskInfo":"KittyTaskInfo"}],KittyTask:[function(t,e,o){"use strict";cc._RF.push(e,"8f77dW/EVhPwZE5lKT6GzY/","KittyTask");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Framework/View/UIMediator2"),l=t("../../../GameKit/Framework/Extension/TableView"),u=t("../KittyConsts"),p=t("../../../GameKit/Framework/Utils/UIHelper"),d=t("./KittyTaskItem"),f=t("../KittyResouces"),h=t("../Data/KittyDB"),y=t("../../../GameKit/Framework/i18n/i18n"),_=t("../Data/KittyLogger"),v=cc._decorator,g=v.ccclass,b=v.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.taskList=null,e.btnCompleteRewards=null,e.overallProgress=null,e.overallClaimMark=null,e}return r(e,t),e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),p.default.bindClickEvent(this.btnCompleteRewards,this.claimOverallTaskRewards.bind(this))},e.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.addEvent(d.default.EVENTS.CLAIM,this.claimTaskRewards,this)},e.prototype.updateData=function(){var t=this.retrieveProxy(u.default.PROXIES.TASK),e=t.getDailyTasks();this.taskList.initTableView(e.tasks),this.overallProgress.string=e.overall.finished+"/"+e.overall.total,this.overallClaimMark.active=!1,this.btnCompleteRewards.interactable=!0,t.canClaimOverallTaskReward()?this.btnCompleteRewards.interactable=!0:(this.btnCompleteRewards.interactable=!1,t.isOverallTaskRewardsClaimed()&&(this.overallClaimMark.active=!0))},e.prototype.claimTaskRewards=function(t){return a(this,void 0,void 0,function(){var e,o,n,r,i,a;return s(this,function(s){switch(s.label){case 0:return _.default.logAction(_.KITTY_ACTIONS.CONFIRM_TASK+"#"+t.taskId),(e=this.retrieveProxy(u.default.PROXIES.TASK)).claimTaskRewards(t.taskId)?(o=e.getTaskById(t.taskId),n=h.default.getInstance().generateRewards(o.rewardsAmount,o.rewardsType,o.rewardsPrefab,o.popupPrefab),o.showPopup?(r=y.default.text("ui.task.complete.msg","\u55b5~\u606d\u559c\u4f60\u5b8c\u6210\u4e86\u4efb\u52a1"),i=2,_.default.setAdsSpace(_.KITTY_ADS_SPACE.TASK+"_"+t.taskId),[4,f.default.showRewardsWithAds(r,n.amount,i,o.popupPrefab,o.popupScale,!0)]):[3,2]):[3,5];case 1:return s.sent().adsShowed&&(n.amount*=i),[3,4];case 2:return[4,f.default.getInstance().playRewardsAssemlyEffect(t.item.getRewardsNode())];case 3:s.sent(),s.label=4;case 4:return(a=this.retrieveProxy(u.default.PROXIES.INVENTORY)).addRewards(n),a.save(),e.save(),this.updateData(),[3,5];case 5:return[2]}})})},e.prototype.claimOverallTaskRewards=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r;return s(this,function(i){switch(i.label){case 0:return _.default.logAction(_.KITTY_ACTIONS.CONFIRM_TASK+"#0"),(t=this.retrieveProxy(u.default.PROXIES.TASK)).canClaimOverallTaskReward()?t.setOverallTaskRewardsClaimed()?(this.overallClaimMark.active=!0,e=h.default.getInstance().generateRewards(60,u.PRICE_UNIT.COIN,u.default.REWARDS_PREFABS.FISH_CANS_3,u.default.REWARDS_PREFABS.FISH_CANS_4),o=y.default.text("ui.task.all.complete.msg","\u55b5~\u4eca\u5929\u4efb\u52a1\u90fd\u5b8c\u6210\u5566\n\u8fd9\u662f\u4eca\u5929\u7684\u60ca\u559c\u5927\u793c\u5305~~~"),n=10,_.default.setAdsSpace(_.KITTY_ADS_SPACE.TASK_BONUS),[4,f.default.showRewardsWithAds(o,e.amount,n,e.prefab,1,!0)]):[3,2]:[2];case 1:i.sent().adsShowed&&(e.amount*=n),(r=this.retrieveProxy(u.default.PROXIES.INVENTORY)).addRewards(e),r.save(),t.save(),i.label=2;case 2:return[2]}})})},i([b(l.default)],e.prototype,"taskList",void 0),i([b(cc.Button)],e.prototype,"btnCompleteRewards",void 0),i([b(cc.Label)],e.prototype,"overallProgress",void 0),i([b(cc.Node)],e.prototype,"overallClaimMark",void 0),i([g],e)}(c.default);o.default=m,cc._RF.pop()},{"../../../GameKit/Framework/Extension/TableView":"TableView","../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/Framework/View/UIMediator2":"UIMediator2","../../../GameKit/Framework/i18n/i18n":"i18n","../Data/KittyDB":"KittyDB","../Data/KittyLogger":"KittyLogger","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces","./KittyTaskItem":"KittyTaskItem"}],KittyTeamTask:[function(t,e,o){"use strict";cc._RF.push(e,"cd3ea0LcohDMKKvsucqKdXB","KittyTeamTask");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Framework/View/UIMediator2"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([c],e)}(a.default));o.default=l,cc._RF.pop()},{"../../../GameKit/Framework/View/UIMediator2":"UIMediator2"}],KittyToyInfo:[function(t,e,o){"use strict";cc._RF.push(e,"37ecelzkDRMurIqAEr2R8+R","KittyToyInfo"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],KittyToyItem:[function(t,e,o){"use strict";cc._RF.push(e,"4d617jHQmBFUbUX99lsXK+3","KittyToyItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Framework/Extension/TableViewCell"),s=t("../../../GameKit/Framework/Utils/Utils"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.amount=null,e.avatar=null,e.btnSend=null,e.toyName=null,e.lockedOnlyNode=[],e}return r(e,t),e.prototype.updateData=function(e,o,n){t.prototype.updateData.call(this,e,o,n),this.toyName.string=o.name,this.amount.string="x"+o.count.toString(),s.default.isNotUndefinedOrNull(o.avatar)&&(this.avatar.spriteFrame=o.avatar),o.count<=0?(this.toyName.string="???",this.lockedOnlyNode.forEach(function(t){t.active=!0}),this.avatar.node.color=cc.Color.BLACK):(this.lockedOnlyNode.forEach(function(t){t.active=!1}),this.avatar.node.color=cc.Color.WHITE),this.btnSend.node.active=!1},i([u(cc.Label)],e.prototype,"amount",void 0),i([u(cc.Sprite)],e.prototype,"avatar",void 0),i([u(cc.Button)],e.prototype,"btnSend",void 0),i([u(cc.Label)],e.prototype,"toyName",void 0),i([u(cc.Node)],e.prototype,"lockedOnlyNode",void 0),i([l],e)}(a.default);o.default=p,cc._RF.pop()},{"../../../GameKit/Framework/Extension/TableViewCell":"TableViewCell","../../../GameKit/Framework/Utils/Utils":"Utils"}],KittyToys:[function(t,e,o){"use strict";cc._RF.push(e,"a845ck7WwFPbZ4lg3sJm2Gf","KittyToys");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Framework/View/UIMediator2"),s=t("../../../GameKit/Framework/Extension/TableView"),c=t("../Data/KittyDB"),l=t("../KittyConsts"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toyList=null,e}return r(e,t),e.prototype.updateData=function(){for(var t=c.default.getInstance().getAllToys(),e=this.retrieveProxy(l.default.PROXIES.INVENTORY),o=0;o<t.length;o++){var n=t[o],r=e.getToyCount(n.id);n.count=r}this.toyList.initTableView(t)},i([d(s.default)],e.prototype,"toyList",void 0),i([p],e)}(a.default);o.default=f,cc._RF.pop()},{"../../../GameKit/Framework/Extension/TableView":"TableView","../../../GameKit/Framework/View/UIMediator2":"UIMediator2","../Data/KittyDB":"KittyDB","../KittyConsts":"KittyConsts"}],KittyTreasures:[function(t,e,o){"use strict";cc._RF.push(e,"44bd84/0yRDa6CBzcwYnrBx","KittyTreasures");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Framework/View/UIMediator2"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([c],e)}(a.default));o.default=l,cc._RF.pop()},{"../../../GameKit/Framework/View/UIMediator2":"UIMediator2"}],KittyUnlocked:[function(t,e,o){"use strict";cc._RF.push(e,"3ef8eHvSYlP1rq83bE+3qHv","KittyUnlocked");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Share/PopUI"),l=t("../Components/KittyCard"),u=t("../Data/KittyDB"),p=t("../../../GameKit/Framework/Utils/ScreenShotNode"),d=t("../Data/KittyConfig"),f=t("../KittyConsts"),h=t("../KittyUtils"),y=t("../KittyResouces"),_=t("../Data/KittyLogger"),v=t("../../../GameKit/App/AppFacade"),g=cc._decorator,b=g.ccclass,m=g.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.kittyCard=null,e.rewardsNode=null,e.shareRewards=null,e.testSprite=null,e._shared=!1,e}return r(e,t),e.prototype.setStyle=function(e){t.prototype.setStyle.call(this,e);var o=e,n=o.kittyId,r=u.default.getInstance().getKittyInfoById(n);this._opt=o,this.kittyCard.setKittyInfo(r),d.default.ENABLE_SHARE()?this.setShareRewards(o.shareRewards):this.setShareRewards({amount:0,unit:f.PRICE_UNIT.COIN})},e.prototype.setShareRewards=function(t){t&&t.amount>0?(this.rewardsNode.active=!0,this.shareRewards.string="+"+h.default.formatNumber(t.amount),this.txtYes.node.y=-9):(this.rewardsNode.active=!1,this.txtYes.node.y=0)},e.prototype._onAction=function(e){return a(this,void 0,void 0,function(){var o,n,r,i,a;return s(this,function(s){switch(s.label){case 0:return e&&d.default.ENABLE_SHARE()?(o=void 0,d.default.SHARE_SCREENSHOT()?(n=this.kittyCard.node.getContentSize(),r=this.kittyCard.node.convertToWorldSpaceAR(cc.v2(0,0)),[4,p.default.takeAsync(!1,n,r,1)]):[3,3]):[3,5];case 1:return s.sent(),[4,p.default.getDataUrl()];case 2:o=s.sent(),s.label=3;case 3:return _.default.setSharePosition(_.KITTY_SHARE_POSITION.NEW_KITTY),i=this,[4,y.default.share(o)];case 4:i._shared=s.sent(),this._opt.shareRewards.amount>0&&((a=v.default.getInstance().retrieveProxy(f.default.PROXIES.INVENTORY)).addRewards({amount:this._opt.shareRewards.amount,unit:this._opt.shareRewards.unit}),a.save(),y.default.getInstance().playCoinAssemblyFromPos(this.rewardsNode.position)),s.label=5;case 5:return[2,t.prototype._onAction.call(this,e)]}})})},e.prototype.isShared=function(){return this._shared},e.prototype.waitSeconds=function(){return new Promise(function(t){setTimeout(function(){t()},2e3)})},i([m(l.default)],e.prototype,"kittyCard",void 0),i([m(cc.Node)],e.prototype,"rewardsNode",void 0),i([m(cc.Label)],e.prototype,"shareRewards",void 0),i([m(cc.Node)],e.prototype,"testSprite",void 0),i([b],e)}(c.default);o.default=w,cc._RF.pop()},{"../../../GameKit/App/AppFacade":"AppFacade","../../../GameKit/Framework/Utils/ScreenShotNode":"ScreenShotNode","../../../GameKit/Share/PopUI":"PopUI","../Components/KittyCard":"KittyCard","../Data/KittyConfig":"KittyConfig","../Data/KittyDB":"KittyDB","../Data/KittyLogger":"KittyLogger","../KittyConsts":"KittyConsts","../KittyResouces":"KittyResouces","../KittyUtils":"KittyUtils"}],KittyUtils:[function(t,e,o){"use strict";cc._RF.push(e,"611cc16vuZG6ZHLwGgH+7bF","KittyUtils"),Object.defineProperty(o,"__esModule",{value:!0});var n=["","k","m","b","t"],r={log10:function(t){return Math.log(t)/Math.LN10},getIntegerDigits:function(t,e){for(var o=0,n=Math.abs(t);n>=e;)n/=e,o++;return o},getUnit:function(t){var e="";if(t<n.length)e=n[t];else{var o=t-n.length;if(o<26){var r="a".charCodeAt(0),i=String.fromCharCode(o+r);e=i+i}else e="??"}return e},formatNumber:function(t){if(0==t)return"0";var e=Math.abs(t),o=t>0,n=r.getIntegerDigits(e,1e3),i=e/Math.pow(1e3,n),a=r.getUnit(n),s=(Math.floor(100*i)/100).toFixed(2);return o||(s="-"+s),"0"==s.charAt(s.length-1)&&"0"==(s=s.substr(0,s.length-1)).charAt(s.length-1)&&(s=s.substr(0,s.length-2)),s+a},testNumbers:function(t){void 0===t&&(t=Number.MAX_VALUE)},createRichText:function(t,e){if(!e)return t;var o=function(t,e){return"<"+e+">"+t+"</"+e+">"},n=t;if(e.size&&(n="<size="+e.size+">"+n+"</size>"),e.color&&("string"==typeof(r=e.color)||(r="#"+r.toHEX("#rrggbb")),n="<color="+r+">"+n+"</color>"),e.defaultOutline&&(n=o(n,"outline")),e.outlineColor||e.outlineWidth){var r;"string"==typeof(r=e.outlineColor)||(r="#"+r.toHEX("#rrggbb"));var i=e.outlineWidth;n="<outline "+(r?"color="+r:"")+" "+(i>0?"width="+i:"")+">"+n+"</outline>"}return e.u&&(n=o(n,"u")),e.b&&(n=o(n,"b")),e.i&&(n=o(n,"i")),n},createTextWithColorAndOutline:function(t,e,o,n){return void 0===n&&(n=2),r.createRichText(t,{color:e,outlineColor:o,outlineWidth:n})},createWightTextWithBlackOutline:function(t){return r.createTextWithColorAndOutline(t,cc.Color.WHITE,cc.Color.BLACK,2)},setRichTextForNode:function(t,e,o){var n=t.getComponent(cc.Label);n&&(n.enabled=!1);var i=t.getComponent(cc.RichText);i||(i=t.addComponent(cc.RichText)),i.enabled=!0,i.string=r.createRichText(e,o)},setRichTextForNodeWidthDefaultStyle:function(t,e){r.setRichTextForNode(t,e,{color:cc.Color.WHITE,outlineColor:cc.Color.BLACK,outlineWidth:2})}};o.default=r,cc._RF.pop()},{}],LanguageButton:[function(t,e,o){"use strict";cc._RF.push(e,"aa64bIQ5z5FyYVZmjAw7+tx","LanguageButton");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Utils/UIHelper"),s=t("./i18n"),c=t("../Utils/Utils"),l=t("./LanguageOption"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.button=null,e.listNode=null,e.inputBlocker=null,e.options=[],e._lans=[],e._show=!1,e}return r(e,t),e.prototype.onLoad=function(){if(a.default.bindClickEvent(this.node,this._onClick.bind(this)),a.default.bindClickEvent(this.inputBlocker,this._onClick.bind(this)),this._lans=s.default.getLanOptions(),console.info("[LanguageButton] options: ",this._lans),this._lans.length<=1)return this._showList(!1),void(this.node.active=!1);this._initOptions(),this._showList(!1)},e.prototype._initOptions=function(){for(var t=0;t<this._lans.length;t++){var e=this.options[t];e&&(e.setLan(this._lans[t]),this._lans[t].lan==s.default.current?e.setSelected(!0):e.setSelected(!1))}},e.prototype._onClick=function(){console.info("[LanguageButton] lan button clicked"),this._showList(!this._show)},e.prototype.onChangeLan=function(t,e){console.info("[LanguageButton] opt clicked: ",e);var o=parseInt(e),n=this._lans[o];c.default.isUndefinedOrNull(n)?console.warn("[LanguageButton] invalid option: ",e):(s.default.hasLanguage(n.lan)||s.default.init(n.lan),s.default.setLanguage(n.lan),s.default.onReady(),this._showList(!1))},e.prototype._showList=function(t){this._show=t,this.listNode&&(this.listNode.active=t),this.inputBlocker&&(this.inputBlocker.active=t)},i([d(cc.Label)],e.prototype,"label",void 0),i([d(cc.Button)],e.prototype,"button",void 0),i([d(cc.Node)],e.prototype,"listNode",void 0),i([d(cc.Node)],e.prototype,"inputBlocker",void 0),i([d(l.default)],e.prototype,"options",void 0),i([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../Utils/UIHelper":"UIHelper","../Utils/Utils":"Utils","./LanguageOption":"LanguageOption","./i18n":"i18n"}],LanguageOption:[function(t,e,o){"use strict";cc._RF.push(e,"30d3fu3vPpBnYuUy8u18eEB","LanguageOption");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.toggle=null,e}return r(e,t),e.prototype.onLoad=function(){this.toggle||(this.toggle=this.getComponent(cc.Toggle))},e.prototype.setLan=function(t){this.label&&(this.label.string=t.name)},e.prototype.setSelected=function(t){this.toggle&&(this.toggle.isChecked=t||t)},i([c(cc.Label)],e.prototype,"label",void 0),i([c(cc.Toggle)],e.prototype,"toggle",void 0),i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],LevelAStarNode:[function(t,e,o){"use strict";cc._RF.push(e,"f979cZ75kRDGK8z4Jgru1xm","LevelAStarNode");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.LevelAStarNode=void 0;var i=t("./AStar"),a=t("./Grid"),s=function(t){function e(e,o,n){var r=t.call(this,n)||this;return r._level=e,r._grid=o,r}return r(e,t),e.prototype.getGrid=function(){return this._grid},e.prototype.getConnectedNodes=function(){var t=a.GRID_DIR.NONE;if(this.getParent()){var o=this.getParent();t=this.getGrid().sub(o.getGrid()).normalize()}this._grid.equals(cc.v2(3,1))&&console.debug("break here");var n=[],r=[];if(t.equals(a.GRID_DIR.NONE))r.push(a.GRID_DIR.UP),r.push(a.GRID_DIR.DOWN),r.push(a.GRID_DIR.LEFT),r.push(a.GRID_DIR.RIGHT);else{var i=this.getGrid().add(t);if(this._level.isGridWalkable(i)){var s=new e(this._level,i,this);n.push(s)}else r.push(t.mul(-1)),t.equals(a.GRID_DIR.UP)||t.equals(a.GRID_DIR.DOWN)?(r.push(a.GRID_DIR.LEFT),r.push(a.GRID_DIR.RIGHT)):(r.push(a.GRID_DIR.UP),r.push(a.GRID_DIR.DOWN))}for(;r.length>0;)t=r.pop(),i=this.getGrid().add(t),this._level.isGridWalkable(i)&&(s=new e(this._level,i,this),n.push(s));return n},e.prototype.distant=function(t){var e=this._grid.sub(t.getGrid());return Math.abs(e.x)+Math.abs(e.y)},e.prototype.equalTo=function(t){var e=t;if(!this.getGrid().equals(e.getGrid()))return!1;if(this.getParent()&&e.getParent()){var o=this.getParent().getGrid(),n=e.getParent().getGrid();if(!o.equals(n))return!1}return!0},e.prototype.isInPath=function(t){if(this.getGrid().equals(t))return!0;for(var e=!1,o=this.getParent();o;){if(o.getGrid().equals(t)){e=!0;break}o=o.getParent()}return e},e.prototype.getPathGrid=function(){for(var t=this.getPath(),e=[],o=0;o<t.length;o++){var n=t[o].getGrid();e.push(n)}return e},e.prototype.toString=function(){for(var t=this.getPathGrid(),e="",o=0;o<t.length;o++){var n=t[o];o>0&&(e+="->"),e+="["+n.x+", "+n.y+"]"}return e},e}(i.AStarNode);o.LevelAStarNode=s;var c={findPath:function(t,e,o){var n=new s(t,e),r=new s(t,o),a=[],c=i.default.search(n,r);return c&&(a=c.getPathGrid()),a},getReachability:function(t,e,o){var n=new s(t,e),r=e.add(o);t.isGridWalkable(r)&&(n=new s(t,r,n));for(var a=[],c=[],l=0;l<t.getHeight();l++)for(var u=0;u<t.getWidth();u++){var p=cc.v2(u,l);if(t.isGridWalkable(p))if(n.isInPath(p))a.push(p);else{var d=new s(t,p),f=i.default.search(n,d);f?(n=f,a.push(p)):(console.info("[LevelAStar] not reachable: ["+e.x+","+e.y+"]=>["+p.x+","+p.y+"] "),c.push(p))}}return{result:n,reachable:a,unreachable:c}}};o.default=c,cc._RF.pop()},{"./AStar":"AStar","./Grid":"Grid"}],LevelData:[function(t,e,o){"use strict";cc._RF.push(e,"a4943e1J0JNVYZmsTOP/6HT","LevelData");var n=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../GameKit/Framework/Utils/Utils"),i=t("./Grid"),a=t("./LevelAStarNode"),s=cc._decorator,c=s.ccclass,l=(s.property,function(){function t(){this._grids=[],this._starts=[],this._width=0,this._height=0}var e;return e=t,t.create=function(t,o,n){var r=new e;return r.new(t,o,n),r},t.prototype.clone=function(){var t=new e,o=cc.js.array.copy(this.getGridData());t.setGridData(o,this._width);var n=this.getStarts();return n=cc.js.array.copy(n),t.setStarts(n),t},t.prototype.new=function(t,e,o){var n;n=t==this._width&&e==this._height?this.getGridData():new Array(t*e);for(var r=0;r<n.length;r++)n[r]=o;this.setGridData(n,t)},t.prototype.setGridData=function(t,e){this._grids=t;var o=t.length/e;this._width=e,this._height=o},t.prototype.flipX=function(){for(var t=0;t<this.getHeight();t++)for(var e=0;e<this.getWidth()/2;e++){var o=this.getGridType(cc.v2(e,t)),n=this.getWidth()-1-e,r=this.getGridType(cc.v2(n,t));this.setGridType(r,cc.v2(e,t)),this.setGridType(o,cc.v2(n,t))}},t.prototype.setStartsData=function(t){var e=this;this._starts=[],t.forEach(function(t){e._starts.push(cc.v2(t.x,t.y))})},t.prototype.addStart=function(t){this._starts.push(t)},t.prototype.setStarts=function(t){this._starts=t},t.prototype.getGridData=function(){return this._grids},t.prototype.getSize=function(){return cc.size(this._width,this._height)},t.prototype.getWidth=function(){return this._width},t.prototype.getHeight=function(){return this._height},t.prototype.getStart=function(){if(r.default.isUndefinedOrNullOrEmpty(this._starts))return cc.v2();var t=r.default.randomInt(0,this._starts.length);return this._starts[t]},t.prototype.getStarts=function(){return r.default.isUndefinedOrNullOrEmpty(this._starts)?[cc.v2()]:this._starts},t.prototype.isValidGrid=function(t){return t.x>=0&&t.x<this._width&&t.y>=0&&t.y<this._height},t.prototype.isInLevel=function(t,e){var o=0;return t instanceof cc.Vec2?(o=t.x,e=t.y):(o=t,r.default.isUndefinedOrNull(e)&&(e=0)),o>=0&&o<this._width&&e>=0&&e<this._height},t.prototype.isInsideEdge=function(t,e){return t>0&&t<this._width-1&&e>0&&e<this._height-1},t.prototype.getGridType=function(t){if(!this.isValidGrid(t))return i.GRID_TYPE.UNKNOWN;var e=this._width*t.y+t.x;return this._grids[e]},t.prototype.setGridType=function(t,e){if(this.isValidGrid(e)){var o=this._width*e.y+e.x;this._grids[o]=t}else console.info("[LevelData] try to set outside level: ",e)},t.prototype.setGridsType=function(t,e,o){console.assert(this.isValidGrid(e)&&this.isValidGrid(o));var n=[];n.push(e),this.setGridType(t,e);var r=o.sub(e).normalize();if(r.equals(i.GRID_DIR.NONE))return n;var a=e.add(r);for(this.setGridType(t,a),n.push(a);!a.equals(o);){if(a=a.add(r),!this.isValidGrid(a)){console.warn("[Board] try to set grid outside, grid: ",a,", from: ",e,", to:",o);break}this.setGridType(t,a),n.push(a)}return n},t.prototype.replaceWith=function(t,e){for(var o=0;o<this._grids.length;o++)this._grids[o]==t?this._grids[o]=e:t==i.GRID_TYPE.UNKNOWN&&r.default.isNotUndefinedOrNull(this._grids[o])&&(this._grids[o]=e)},t.prototype.getAllConners=function(){for(var t=[],e=0;e<this._height;e++)for(var o=0;o<this._width;o++){var n=cc.v2(o,e);if(this.isCorner(n)){var r=this.getGridWayouts(n);t.push({grid:n,dirs:r})}}return t},t.prototype.isCorner=function(t){if(this.getGridType(t)!=i.GRID_TYPE.WALKABLE)return!1;var e=!1,o=this.isDirWalkable(t,i.GRID_DIR.UP),n=this.isDirWalkable(t,i.GRID_DIR.DOWN),r=this.isDirWalkable(t,i.GRID_DIR.LEFT),a=this.isDirWalkable(t,i.GRID_DIR.RIGHT);return o&&!n?e=!0:n&&!o?e=!0:r&&!a?e=!0:a&&!r&&(e=!0),e},t.prototype.isGridWalkable=function(t){return this.getGridType(t)==i.GRID_TYPE.WALKABLE},t.prototype.isDirWalkable=function(t,e){return this.getGridType(t.add(e))==i.GRID_TYPE.WALKABLE},t.prototype.isDirNotWalkable=function(t,e){var o=this.getGridType(t.add(e));return o==i.GRID_TYPE.UNKNOWN||o==i.GRID_TYPE.UNWALKABLE},t.prototype.isDirWayout=function(t,e){return this.getGridType(t)==i.GRID_TYPE.WALKABLE&&this.isDirWalkable(t,e)},t.prototype.getGridWayouts=function(t){var e=this,o=[i.GRID_DIR.UP,i.GRID_DIR.DOWN,i.GRID_DIR.LEFT,i.GRID_DIR.RIGHT],n=[];return o.forEach(function(o){e.isDirWayout(t,o)&&n.push(o)}),n},t.prototype.getNextGridOfType=function(t,e,o){if(o.equals(i.GRID_DIR.NONE))return i.INVALID_GRID;var n=e.add(o);if(!this.isValidGrid(n))return i.INVALID_GRID;for(var r=e;this.getGridType(n)==t;)if(r=n,n=n.add(o),!this.isValidGrid(n)){console.warn("[LevelData] Invalid grid: ",n);break}return r},t.prototype.getNextGridOfTypes=function(t,e,o){if(o.equals(i.GRID_DIR.NONE))return i.INVALID_GRID;var n=e.add(o);if(!this.isValidGrid(n))return i.INVALID_GRID;for(var r=e;;){var a=this.getGridType(n);if(!cc.js.array.contains(t,a))break;if(r=n,n=n.add(o),!this.isValidGrid(n)){console.warn("[LevelData] Invalid grid: ",n);break}}return r},t.prototype.getNextGridNotType=function(t,e,o){if(o.equals(i.GRID_DIR.NONE))return i.INVALID_GRID;for(var n=e,r=e;this.getGridType(n)!=t;)r=n,n=n.add(o);return r},t.prototype.getNextWalkable=function(t,e){return this.getNextGridOfType(i.GRID_TYPE.WALKABLE,t,e)},t.prototype.getRandomGrids=function(t,e){for(var o=this,n=r.default.randomInt(0,this._grids.length),i=[],a=this._grids.length,s=0,c=0;c<a;c++){var l=(n+c)%a;if(this._grids[l]==e&&(s++,r.default.randomFloat(0,1)<.5&&i.push[l]),i.length==t)break}if(s<t)console.info("[LevelData] not enough grids, total: ",s,", type: ",e);else for(var u=0;i.length<t;){for(c=0;c<a&&(l=(n+c)%a,cc.js.array.contains(i,l)||(this._grids[l]==e&&r.default.randomFloat(0,1)<.5&&i.push(l),i.length!=t));c++);if(++u>100){console.warn("[LevelData] something wrong here");break}}var p=[];return i.length>0&&i.forEach(function(t){var e=cc.v2();e.x=t%o._width,e.y=Math.floor(t/o._width),p.push(e)}),p},t.createRandomLevel=function(t,o,n){for(var a=e.create(t,o,i.GRID_TYPE.UNKNOWN),s=0;s<o;s++)for(var c=0;c<t;c++)a.isInsideEdge(c,s)||a.setGridType(i.GRID_TYPE.UNWALKABLE,cc.v2(c,s));var l=cc.v2(1,o-2);a.setGridType(i.GRID_TYPE.WALKABLE,l),a.addStart(l);var u=0,p=i.GRID_DIR.NONE,d=1,f=t-2;f>9&&(f=9),(d=Math.floor(f/2))<=0&&(d=1);for(var h=0;h<n;h++){u++;var y=r.default.randomInt(1,d+1),_=r.default.randomInt(d,f),v=e.markNextPath(a,l,p,y,_);if(!v.validPath)break;l=l.add(v.path.dir.mul(v.path.path)),p=v.path.dir}for(s=0;s<o;s++)for(c=0;c<t;c++)a.getGridType(cc.v2(c,s))==i.GRID_TYPE.UNKNOWN&&a.setGridType(i.GRID_TYPE.UNWALKABLE,cc.v2(c,s));return u<n&&console.warn("[Level] random level generated by moves: ",u),a},t.markNextPath=function(t,o,n,r,a){var s={validPath:!1,path:{dir:i.GRID_DIR.NONE,path:0}},c=e.findNextPath(t,o,n,r,a);if(c.path<=0)return console.warn("[Editor] no path for current grid:",o,", dir: ",n),s;var l=o.add(n);if(n.equals(i.GRID_DIR.NONE)?l=o.add(c.dir.mul(-1)):c.dir.equals(n)?l=i.INVALID_GRID:c.dir.equals(n.mul(-1)),!l.equals(i.INVALID_GRID)){if((d=t.getGridType(l))==i.GRID_TYPE.WALKABLE)return console.warn("[Editor] Invalid moving direction! grid: ",o,", dir: ",n,", not wall: ",l," (type: ",d,")"),s;t.setGridType(i.GRID_TYPE.UNWALKABLE,l)}for(var u=o,p=0;p<c.path;p++){var d;if(u=u.add(c.dir),(d=t.getGridType(u))==i.GRID_TYPE.UNWALKABLE){console.warn("[Editor] Invalid moving direction! grid: ",o,", dir: ",n,", not walkable: ",u);break}t.setGridType(i.GRID_TYPE.WALKABLE,u)}return s.validPath=!0,s.path=c,s},t.prototype._getPathLengthInDir=function(t,e,o){return this._getDistOfNextGridOfTypes(t,u,e,o)},t.prototype._getPathLengthInAllDirs=function(t,e,o){var n=this,r=[];return o.forEach(function(o){var i=n._getPathLengthInDir(t,e,o);r.push({dir:o,path:i})}),r},t.prototype._getGridInDir=function(t,e,o,n,r){for(var i=[],a=1;a<n;a++){var s=e.add(o.mul(a)),c=t.getGridType(s);cc.js.array.contains(r,c)&&i.push(s)}return i},t.findNextPath=function(t,e,o,n,a){var s;s=o.equals(i.GRID_DIR.NONE)?d:[cc.v2(o.y,o.x),cc.v2(o.y,o.x).mul(-1),o,o.mul(-1)];var c={dir:i.GRID_DIR.NONE,path:0},l=[];s.forEach(function(n){var r=e.add(n);if(t.isInsideEdge(r.x,r.y)){var a=e.add(o);if(o.equals(i.GRID_DIR.NONE)&&(a=e.add(n).mul(-1)),t.getGridType(a)!=i.GRID_TYPE.WALKABLE){var s=t.getGridType(e.add(n));s!=i.GRID_TYPE.UNKNOWN&&s!=i.GRID_TYPE.WALKABLE||l.push(n)}}});var u=t._getPathLengthInAllDirs(t,e,l);if(console.assert(u.length>0,"[Editor] no path in all directions! something wrong"),u.length<=0)return c;for(var p=[],f=[],h=[],y=[],_=[],v=[],g=0;g<u.length;g++){var b=u[g],m=t._getGridInDir(t,e,b.dir,b.path,[i.GRID_TYPE.UNKNOWN]);if(m.length<=0)_.push(b);else for(var w=0;w<=m.length;w++)if(w==m.length)t.getGridType(e.add(b.dir.mul(b.path)))==i.GRID_TYPE.UNKNOWN?v.push(b):_.push(b);else{var S=m[w].sub(e).mag()-1;if(S>0){var P={dir:b.dir,path:S};t.getGridType(e.add(P.dir.mul(P.path)))==i.GRID_TYPE.UNKNOWN?v.push(P):_.push(P)}}}for(g=0;g<v.length;g++)(b=v[g]).path>=n&&b.path<=a?b.dir.equals(o)||b.dir.equals(o.mul(-1))?f.push(b):p.push(b):b.dir.equals(o)||b.dir.equals(o.mul(-1))?y.push(b):h.push(b);return p.length>0?c=p[r.default.randomInt(0,p.length)]:h.length>0?c=h[r.default.randomInt(0,h.length)]:y.length>0?c=y[r.default.randomInt(0,y.length)]:f.length>0?c=f[r.default.randomInt(0,f.length)]:_.length>0?c=_[r.default.randomInt(0,_.length)]:console.error("[Editor] invalid "),c},t.prototype._getDistOfNextGridOfTypes=function(t,e,o,n){var r=t.getNextGridOfTypes(e,o,n);return r.equals(i.INVALID_GRID),r.sub(o).mag()},t.prototype._getPathLength=function(t,e,o){return{new:this._getDistOfNextGridOfTypes(t,u,e,o),old:this._getDistOfNextGridOfTypes(t,p,e,o)}},t.checkReachability=function(t,e){if(!t.isGridWalkable(e))return!1;for(var o=!0,n=t.getGridWayouts(e),r=0;r<n.length;r++)if(a.default.getReachability(t,e,n[r]).unreachable.length>0){o=!1;break}return o},e=n([c],t)}());o.default=l;var u=[i.GRID_TYPE.UNKNOWN,i.GRID_TYPE.WALKABLE],p=[i.GRID_TYPE.WALKABLE],d=[i.GRID_DIR.RIGHT,i.GRID_DIR.DOWN,i.GRID_DIR.LEFT,i.GRID_DIR.UP];cc._RF.pop()},{"../../../GameKit/Framework/Utils/Utils":"Utils","./Grid":"Grid","./LevelAStarNode":"LevelAStarNode"}],LevelHelper:[function(t,e,o){"use strict";cc._RF.push(e,"6fd3dYSRExNhINXiMvas1iO","LevelHelper"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.getLevel=function(){return this._level},t.prototype.setLevel=function(t){this._level=t},t.prototype.setPathStartPoition=function(){},t.prototype.isReachable=function(){},t}();o.default=n,cc._RF.pop()},{}],LipstickGrid:[function(t,e,o){"use strict";cc._RF.push(e,"fe6eelzvjhF746qUuJuukQ6","LipstickGrid");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./Lipstick"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lipstick=null,e}return r(e,t),e.prototype.setColor=function(t){this.lipstick.setColor(t)},i([l(a.default)],e.prototype,"lipstick",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Lipstick":"Lipstick"}],Lipstick:[function(t,e,o){"use strict";cc._RF.push(e,"0aa94Ehja5MGpx47KErE12V","Lipstick");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.colorNode=null,e.bodyNode=null,e}return r(e,t),e.prototype.setColor=function(t){this.colorNode.color=t},i([c(cc.Node)],e.prototype,"colorNode",void 0),i([c(cc.Node)],e.prototype,"bodyNode",void 0),i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],LocalCache:[function(t,e,o){"use strict";cc._RF.push(e,"f01falB1ZlLPLLcS2To36Zi","LocalCache");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.CACHE_PROVIDER=void 0;var i,a=t("../Utils/Utils"),s=t("../../Tpcl/Baidu/Baidu"),c=t("../../Tpcl/Facebook/Facebook"),l=cc.sys.localStorage;(function(t){t[t.LOCAL=0]="LOCAL",t[t.BAIDU=1]="BAIDU",t[t.FACEBOOK=2]="FACEBOOK"})(i=o.CACHE_PROVIDER||(o.CACHE_PROVIDER={}));var u={privider:i.LOCAL,init:function(t){switch(console.info("[LocalCache] init ==========> ",t),u.privider=t,t){case i.BAIDU:s.default.isValid()?l=s.default:console.warn("[Baidu] not valid");break;case i.FACEBOOK:c.default.isValid()?l=c.default:console.warn("[Facebook] not valid")}},put:function(t,e){return n(this,void 0,void 0,function(){return r(this,function(o){switch(o.label){case 0:return[4,l.setItem(t,e)];case 1:return o.sent(),[2]}})})},putObj:function(t,e){return n(this,void 0,void 0,function(){var o;return r(this,function(n){switch(n.label){case 0:return o=JSON.stringify(e),[3,2];case 1:return n.sent(),[3,4];case 2:return[4,u.put(t,o)];case 3:n.sent(),n.label=4;case 4:return[2]}})})},get:function(t){return n(this,void 0,Promise,function(){return r(this,function(e){switch(e.label){case 0:return[4,l.getItem(t)];case 1:return[2,e.sent()]}})})},getObj:function(t){return n(this,void 0,void 0,function(){var e,o,n;return r(this,function(r){switch(r.label){case 0:return[4,u.get(t)];case 1:if(e=r.sent(),a.default.isUndefinedOrNullOrEmpty(e))return console.warn("[LocalCache] key not exist: ",t),[2,null];o="",n=null;try{o=e,n=JSON.parse(o)}catch(i){console.error("[LocalCache] parse json str failed, key=",t,", error: ",i,"\n txt:\n",o)}return[2,n]}})})}};o.default=u,cc._RF.pop()},{"../../Tpcl/Baidu/Baidu":"Baidu","../../Tpcl/Facebook/Facebook":"Facebook","../Utils/Utils":"Utils"}],LocalProxy:[function(t,e,o){"use strict";cc._RF.push(e,"85fbcX/Lg5Ad5Vv+VEQDJtE","LocalProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../AccountProxy"),c=t("../../Framework/Model/LocalCache"),l=t("../../Framework/Utils/Utils"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){return i(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return t.prototype.init.call(this),this._accountType=s.ACCOUNT.LOCAL,this._player.id="0",this._player.name="",this._context.id="0",this._context.type=s.CONTEXT.DEFAULT,[4,l.default.waitFor(1e3)];case 1:return e.sent(),[2]}})})},e.prototype.loadPlayerDataAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.loadContextDataAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.startAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.getPlayerPhoto=function(){},e.prototype.onFirstStartAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.saveDataAsync=function(t){return i(this,void 0,void 0,function(){var e,o;return a(this,function(){for(e in t)o=t[e],c.default.putObj(e,o);return[2]})})},e.prototype.loadDataAsync=function(t){return i(this,void 0,void 0,function(){var e,o,n,r,i;return a(this,function(){for(e={},o=0,n=t;o<n.length;o++)r=n[o],i=c.default.getObj(r),e[r]=i;return[2,e]})})},e.prototype.prepareAds=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.isAdsReady=function(){return!0},e.prototype.playAds=function(){return i(this,void 0,Promise,function(){return a(this,function(){return[2,!0]})})},e.prototype.canCreateShortcut=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2,!1]})})},e.prototype.tryCreateShortcut=function(){return i(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,t.prototype.tryCreateShortcut.call(this)];case 1:return e.sent(),[2]}})})},e.prototype.canShare=function(){return!1},e.prototype.shareAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.inviteAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.updateAsync=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e}(s.default);o.default=u,cc._RF.pop()},{"../../Framework/Model/LocalCache":"LocalCache","../../Framework/Utils/Utils":"Utils","../AccountProxy":"AccountProxy"}],LocalizedLabel:[function(t,e,o){"use strict";cc._RF.push(e,"0de76YiZSdFC4gF8CNV/8Sp","LocalizedLabel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./i18n"),s=t("../Utils/Utils"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dataId="",e.defaultValue="",e.concateArray=!0,e.bgNode=null,e.expendBg=!1,e.padding=cc.v2(),e._label=void 0,e}return r(e,t),e.prototype.start=function(){this.fetchRender()},e.prototype.fetchRender=function(){var t=this.getComponent(cc.Label);if(t)return this._label=t,void this.updateLanguage()},e.prototype.onEnable=function(){a.default.register(this)},e.prototype.onDisable=function(){a.default.unregister(this)},e.prototype.updateLanguage=function(){if(this._label){if(!s.default.isUndefinedOrNullOrEmpty(this.dataId)){var t=a.default.value(this.dataId,this.defaultValue),e=t;Array.isArray(t)&&(e=this.concateArray?s.default.concateStrings(t):s.default.randomItemInArray(t).value),this._label.string=e}a.default.useSystemFont()&&(this._label.useSystemFont=!0),this._label.horizontalAlign!=cc.Label.HorizontalAlign.CENTER&&(a.default.rightToLeft()?this._label.horizontalAlign=cc.Label.HorizontalAlign.RIGHT:this._label.horizontalAlign=cc.Label.HorizontalAlign.LEFT),this.expendBg&&this.bgNode&&this._updateBgNode()}},e.prototype._updateBgNode=function(){s.default.expendLabelBackground(this._label,this.bgNode,this.padding.x,this.padding.y)},i([u],e.prototype,"dataId",void 0),i([u],e.prototype,"defaultValue",void 0),i([u],e.prototype,"concateArray",void 0),i([u(cc.Node)],e.prototype,"bgNode",void 0),i([u],e.prototype,"expendBg",void 0),i([u(cc.Vec2)],e.prototype,"padding",void 0),i([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../Utils/Utils":"Utils","./i18n":"i18n"}],LocalizedSpriteConfig:[function(t,e,o){"use strict";cc._RF.push(e,"42ac993G8RKOqW1VK/2uFXr","LocalizedSpriteConfig");var n=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,i=r.ccclass,a=r.property,s=function(){function t(){this.languageCode="",this.spriteFrame=null,this.spriteFrameName=""}return n([a(cc.String)],t.prototype,"languageCode",void 0),n([a(cc.SpriteFrame)],t.prototype,"spriteFrame",void 0),n([a(cc.String)],t.prototype,"spriteFrameName",void 0),n([i("LocalizedSpriteConfig")],t)}();o.default=s,cc._RF.pop()},{}],LocalizedSprite:[function(t,e,o){"use strict";cc._RF.push(e,"4d190JkpR1Aq5U4KshnlxDr","LocalizedSprite");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./LocalizedSpriteConfig"),s=t("./i18n"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imageId="",e.configs=[],e}return r(e,t),e.prototype.onEnable=function(){s.default.register(this)},e.prototype.onDisable=function(){s.default.unregister(this)},e.prototype.start=function(){this.fetchRender()},e.prototype.fetchRender=function(){var t=this.getComponent(cc.Sprite);if(t)return this._sprite=t,void this.updateLanguage()},e.prototype.updateLanguage=function(){if(this._sprite){var t=this._getConfig();t&&t.spriteFrame&&(this._sprite.spriteFrame=t.spriteFrame)}},e.prototype._getConfig=function(){for(var t=s.default.getCurrentLan(),e=s.default.getDefaultLan(),o=void 0,n=void 0,r=0;r<this.configs.length;r++){if("zh"==this.configs[r].languageCode&&(this.configs[r].languageCode="cn"),this.configs[r].languageCode==t){o=this.configs[r];break}this.configs[r].languageCode==e&&(n=this.configs[r])}return o||n&&(o=n),o||console.warn("[LocalizedSprite] missing config for lan: "+t+", or default: "+e),o},i([u],e.prototype,"imageId",void 0),i([u(a.default)],e.prototype,"configs",void 0),i([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./LocalizedSpriteConfig":"LocalizedSpriteConfig","./i18n":"i18n"}],LogSettings:[function(t,e,o){"use strict";cc._RF.push(e,"5580amV2V5OAbeAS6xfIkB/","LogSettings"),Object.defineProperty(o,"__esModule",{value:!0}),o.default={ADS_FOR_REVIVE:"ADS_For_Revive",ADS_FOR_BONUS:"ADS_For_BONUS",ADS_FOR_RANDOM:"ADS_For_Random",SHARE_SCORE:"SHARE_SCORE",SHARE_ON_RESULT:"SHARE_ON_RESULT",SHARE_ON_RANK_LIST:"SHARE_ON_RANK_LIST",SHARE_ON_RANK_ITEM:"SHARE_ON_RANK_ITEM",SHARE_QUOTE:"SHARE_QUOTE",SHARE_COLOR:"SHARE_COLOR",MATCH_PLAYED:"MATCH_PLAYED",DAYS_PLAYED:"DAYS_PLAYED",DAYS_RETURNED:"DAYS_RETURNED",MATCH_SCORE:"MATCH_SCORE"},cc._RF.pop()},{}],Logger:[function(t,e,o){"use strict";cc._RF.push(e,"82df1d8XlJN/5c3Wq+Gkwe1","Logger"),Object.defineProperty(o,"__esModule",{value:!0}),o.LOGGER_PROVIDER=void 0;var n,r,i=t("../Settings/LogSettings"),a=t("../Tpcl/Facebook/Facebook"),s=t("../Logger/TempLogger");(function(t){t[t.NONE=0]="NONE",t[t.FACEBOOK=1]="FACEBOOK"})(r=o.LOGGER_PROVIDER||(o.LOGGER_PROVIDER={}));var c={initLoggerProvider:function(t){switch(t){case r.FACEBOOK:a.default.isValid()?n=a.default:console.warn("[Logger.init] facebook provider not ready")}n||(console.log("[Logger] using temp logger"),n=new s.default)},quickLog:function(t,e,o){n&&n.logEvent({name:t,valueToSum:e,param:o})},logAdsForRevive:function(){c.quickLog(i.default.ADS_FOR_REVIVE)},logAdsForBonus:function(){c.quickLog(i.default.ADS_FOR_BONUS)},logAdsForRandom:function(){c.quickLog(i.default.ADS_FOR_RANDOM)},logShareScore:function(){c.quickLog(i.default.SHARE_SCORE)},logShareQuote:function(t){c._logCombinedEvent(i.default.SHARE_QUOTE,t)},logShareColor:function(){c.quickLog(i.default.SHARE_COLOR)},logShareOnResult:function(){c.quickLog(i.default.SHARE_ON_RESULT)},logShareOnRankList:function(){c.quickLog(i.default.SHARE_ON_RANK_LIST)},logShareOnRankItem:function(){c.quickLog(i.default.SHARE_ON_RANK_ITEM)},_logCombinedEvent:function(t,e){var o=t;e>=0&&(o=o+"_"+e),c.quickLog(o)},logMatchPlayed:function(t){c._logCombinedEvent(i.default.MATCH_PLAYED,t)},logDaysPlayed:function(t){c._logCombinedEvent(i.default.DAYS_PLAYED,t)},logDaysReturn:function(t){c._logCombinedEvent(i.default.DAYS_RETURNED,t)},logMatchScore:function(t){c._logCombinedEvent(i.default.MATCH_SCORE,t)}};o.default=c,cc._RF.pop()},{"../Logger/TempLogger":"TempLogger","../Settings/LogSettings":"LogSettings","../Tpcl/Facebook/Facebook":"Facebook"}],LotterySlot:[function(t,e,o){"use strict";cc._RF.push(e,"0f572CqIYJKFImWMRsEZW5R","LotterySlot");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../KittyResouces"),s=t("../../../GameKit/Framework/Utils/Utils"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardsNode=null,e}return r(e,t),e.prototype.setRewards=function(t){var e=a.default.getInstance().getOtherPrefab(t);if(s.default.isNotUndefinedOrNull(e)){var o=cc.instantiate(e);o.setParent(this.rewardsNode),o.setPosition(cc.v2(0,0))}},i([u(cc.Node)],e.prototype,"rewardsNode",void 0),i([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../GameKit/Framework/Utils/Utils":"Utils","../KittyResouces":"KittyResouces"}],MacroCommand:[function(t,e,o){"use strict";cc._RF.push(e,"5a87332LsJFsY8iuQ5JlMSR","MacroCommand");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){t.prototype.init.call(this),this._subCommands=[],this._tags=[]},e.prototype.execute=function(t){return i(this,void 0,void 0,function(){var e,o,n,r;return a(this,function(i){switch(i.label){case 0:e=0,o=0,n=this._subCommands,i.label=1;case 1:return o<n.length?(r=n[o],t._stop?[2]:(this._tags[e],[4,this.runCommand(r,t)])):[3,4];case 2:i.sent(),e++,i.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},e.prototype.addSubCommand=function(t,e){this._subCommands.push(t),this._tags.push(e)},e}(t("./SimpleCommand").default);o.default=s,cc._RF.pop()},{"./SimpleCommand":"SimpleCommand"}],MainUIMediator:[function(t,e,o){"use strict";cc._RF.push(e,"7effcmQG1BEsJyMcL/dPW0p","MainUIMediator");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./UIMediator"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([c],e)}(a.default));o.default=l,cc._RF.pop()},{"./UIMediator":"UIMediator"}],MatchMediator:[function(t,e,o){"use strict";cc._RF.push(e,"522f284d/pCpa6Gwc0Hx+mD","MatchMediator");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./MatchUI"),l=t("./ResultUI"),u=t("../../../GameKit/GamePlay/BaseMatchMediator"),p=t("../../../GameKit/Settings/EventTypes"),d=t("../../../GameKit/Settings/CommandTypes"),f=t("../../../GameKit/Settings/ProxyTypes"),h=t("../../../GameKit/Framework/Utils/Utils"),y=t("../Game/WalkableGrid"),_=t("../App/ConfigDB"),v=t("../../../GameKit/App/AppFacade"),g=t("../Game/Lipstick"),b=t("../../../GameKit/App/Logger"),m=cc._decorator,w=m.ccclass,S=m.property,P=["Nice","Sweet","Fabulous","Brilliant","Perfect","Beautiful","Amazing","Lucky"],O=[{name:"Stacky",id:"2333613016921232"}],E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.matchUI=null,e.resultUI=null,e.lettlePrefab=null,e.guideAnimation=null,e.screenshotLipsticks=null,e._hasLetter=!1,e._letterEvent=void 0,e._userAction=!1,e}return r(e,t),e.prototype._initProxy=function(){t.prototype._initProxy.call(this),this._player=this.retrieveProxy(f.default.PLAYER);var e=this.retrieveProxy(f.default.ACCOUNT);this._playerName=e.getPlayer().name},e.prototype.newMatch=function(){return a(this,void 0,void 0,function(){var e,o,n,r,i,a;return s(this,function(s){switch(s.label){case 0:return v.default.getInstance()?(this.resultUI.hide(!1),[4,t.prototype.newMatch.call(this)]):[2];case 1:return s.sent(),e=this._proxy,o=e.getLevel(),(n=this._player.getColorIdx())<0?[3,4]:[3,2];case 2:return this.matchUI.setLevel(o),[4,this.matchUI.show(!0)];case 3:s.sent(),n+=2,(r=_.default.getColors()[n])&&(i=(new cc.Color).fromHEX(r.color),this.playground.setLipstickColor(i)),this.playground.loadLevel(e.getLevelData()),this.playground.setSpecial(e.getSpecial()),this.matchUI.showDebugMenu(!1,e),a=this.retrieveProxy(f.default.ACCOUNT),this.matchUI.showSwichGameIcon(a.canSwitchGame()),this.guideAnimation.node.active=!1,this.showGuide(),s.label=4;case 4:return[2]}})})},e.prototype.showGuide=function(){var t=this._proxy,e=-1;switch(t.getLevel()){case 0:case 1:case 2:e=t.getLevel()}e>=0&&(this.guideAnimation.node.active=!0,this.guideAnimation.play(this.guideAnimation.getClips()[e].name))},e.prototype._initViewComponent=function(){t.prototype._initViewComponent.call(this),this.matchUI.initOnce(),this.resultUI.initOnce()},e.prototype.initEvents=function(){var e=this;t.prototype.initEvents.call(this),this.addEvent(p.default.GAMEPLAY.GAME_STOPPED,this.onGameStop,this),this.addEvent(p.default.UI.PLAY_NEXT_LEVEL,function(){return a(e,void 0,void 0,function(){var t,e;return s(this,function(){return t=this._proxy,e=t.getLevel(),t.setEditMode(!1),this.executeCommand(d.default.PLAY_NEW_MATCH,{level:e+1,editMode:t.isEditMode()}),[2]})})}),this.addEvent(p.default.UI.PLAY_CURRENT_LEVEL,function(){return a(e,void 0,void 0,function(){var t,e;return s(this,function(){return t=this._proxy,e=t.getLevel(),this.executeCommand(d.default.PLAY_NEW_MATCH,{level:e,editMode:t.isEditMode()}),[2]})})}),this.addEvent(y.default.EVENTS.MARKED,this.onWalkableMarked.bind(this)),this.addEvent(p.default.UI.EDIT_LEVEL,function(){e._proxy.setEditMode(!0),cc.director.loadScene("GameEditor")}),this.addEvent(p.default.UI.PLAY_LEVEL,function(t){e.executeCommand(d.default.PLAY_NEW_MATCH,t)}),this.addEvent(p.default.UI.SWITCH_GAME,this.onSwithGame,this)},e.prototype.onSwithGame=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return(t=this.retrieveProxy(f.default.ACCOUNT)).canSwitchGame()?(e=h.default.randomItemInArray(O),[4,t.switchGameAsync(e.value.id)]):[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},e.prototype.onGameStop=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.matchUI.hide(!1),this.finishGame(),[4,this.resultUI.show(!0)];case 1:return t.sent(),[4,this.resultUI.afterShow()];case 2:return t.sent(),this._hasLetter?[4,h.default.waitFor(1e3)]:[3,5];case 3:return t.sent(),[4,this._showSpecial()];case 4:return t.sent(),[3,5];case 5:return[4,this._showAds()];case 6:return t.sent(),this.resultUI.setReady(.1),[2]}})})},e.prototype.finishGame=function(){return a(this,void 0,void 0,function(){var t,e,o,n;return s(this,function(r){switch(r.label){case 0:return t=h.default.randomInt(0,P.length),this.resultUI.setTitle(P[t]),e=this._player,o=this._proxy,n=o.getLevel(),e.setLevelPassed(n),e.addGamesPlayed(1),[4,e.save()];case 1:return r.sent(),[2]}})})},e.prototype._showAds=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:return(t=this.retrieveProxy(f.default.ADS)).increaseFreeMatch(),this._userAction&&t.resetDailyData(),(e=this._player.getGamesPlayed())>=10&&e%5==0?cc.sys.isMobile?[3,3]:t.isRandomAdsReady()?[4,t.playRandomAds()]:[3,2]:[3,4];case 1:o.sent(),b.default.logAdsForRandom(),o.label=2;case 2:return[3,4];case 3:o.label=4;case 4:return[2]}})})},e.prototype._showSpecial=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this._letterEvent.id,[2]})})},e.prototype._showLipstick=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.onWalkableMarked=function(t){this._hasLetter=t.hasLetter,this._letterEvent=t},i([S(c.default)],e.prototype,"matchUI",void 0),i([S(l.default)],e.prototype,"resultUI",void 0),i([S(cc.Prefab)],e.prototype,"lettlePrefab",void 0),i([S(cc.Animation)],e.prototype,"guideAnimation",void 0),i([S(g.default)],e.prototype,"screenshotLipsticks",void 0),i([w],e)}(u.default);o.default=E,cc._RF.pop()},{"../../../GameKit/App/AppFacade":"AppFacade","../../../GameKit/App/Logger":"Logger","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/GamePlay/BaseMatchMediator":"BaseMatchMediator","../../../GameKit/Settings/CommandTypes":"CommandTypes","../../../GameKit/Settings/EventTypes":"EventTypes","../../../GameKit/Settings/ProxyTypes":"ProxyTypes","../App/ConfigDB":"ConfigDB","../Game/Lipstick":"Lipstick","../Game/WalkableGrid":"WalkableGrid","./MatchUI":"MatchUI","./ResultUI":"ResultUI"}],MatchProxy:[function(t,e,o){"use strict";cc._RF.push(e,"59ab1zuh01KR7rUQvfFEMEI","MatchProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.SPECIAL_GRID=void 0;var c,l=t("../../../GameKit/GamePlay/BaseMatchProxy"),u=t("../Game/LevelData"),p=t("../../../GameKit/Framework/Utils/Utils"),d=t("../Game/Grid"),f=t("../../../GameKit/Settings/ProxyTypes"),h=cc._decorator,y=h.ccclass;h.property,function(t){t[t.NONE=0]="NONE",t[t.LETTER=1]="LETTER",t[t.SHOP=2]="SHOP",t[t.OTHERS=3]="OTHERS"}(c=o.SPECIAL_GRID||(o.SPECIAL_GRID={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._editMode=!1,e._loadedLevel=-1,e._special=c.NONE,e}var o;return r(e,t),o=e,e.create=function(t){var e=new o;return e.name=t,e},e.prototype._initMatchData=function(e){return a(this,void 0,void 0,function(){var o,n;return s(this,function(r){switch(r.label){case 0:return[4,t.prototype._initMatchData.call(this,e)];case 1:return r.sent(),e||(o=this.retrieveProxy(f.default.PLAYER),(n=o.getLevelPassed())<0&&(n=-1),e={level:n+1,editMode:!1}),[4,this.loadLevelAsync(e.level)];case 2:return r.sent(),this.data.level=e.level,e.editMode?this.setEditMode(e.editMode):this.setEditMode(!1),this._initSpecial(e.level),[2]}})})},e.prototype._initSpecial=function(t){var e=c.NONE;t<5?0==t||2==t?e=c.OTHERS:1==t||3==t?e=c.OTHERS+p.default.randomInt(0,3):4==t&&(e=c.OTHERS+9):(t%5==0?t>=10&&(10==t?e=c.LETTER:p.default.randomInt(0,10)<5&&(e=c.LETTER)):t%5==2&&(7==t?e=c.SHOP:p.default.randomInt(0,10)<5&&(e=c.SHOP)),e==c.NONE&&(p.default.randomInt(0,10)<5||(e=p.default.randomInt(0,10)<7?c.OTHERS+p.default.randomInt(0,3):c.OTHERS+9))),this._special=e},e.prototype.getSpecial=function(){return this._special},e.prototype.setEditMode=function(t){this._editMode=t},e.prototype.isEditMode=function(){return this._editMode},e.prototype.setLevelData=function(t){this._levelData=t},e.prototype.getLevelData=function(){return this._levelData},e.prototype.loadLevelAsync=function(t){return a(this,void 0,void 0,function(){var e,o,n,r,i,a,c,l,f;return s(this,function(s){switch(s.label){case 0:if(t==this._loadedLevel)return[2];e="level/"+t,s.label=1;case 1:if(s.trys.push([1,5,,6]),o=void 0,n=void 0,r=localStorage.getItem("RES"),!cc.sys.isNative||p.default.isUndefinedOrNullOrEmpty(r))return[3,2];i=r+"/level/"+t.toString()+".json";try{if(!jsb.fileUtils.isFileExist(i))return console.warn("[Match] load file fail, url=",i,", error: ","File not exists"),[2,!1];a=jsb.fileUtils.getStringFromFile(i),o=JSON.parse(a)}catch(h){return console.warn("[Match] load file fail, url=",i,", error: ",h),[2,!1]}return[3,4];case 2:return[4,p.default.loadRes(e)];case 3:(c=s.sent()).error?(console.warn("[Match] can't load level: ",e,", create random level"),l=9,t<100?l=9:t<200?l=10:t<300?l=11:t<400?l=12:(Math.floor((t-400)/100),l=13),n=u.default.createRandomLevel(l,l,l)):(o=c.resource.json,(n=u.default.create(1,1,d.GRID_TYPE.UNKNOWN)).setGridData(o._grids,o._width),n.setStartsData(o._starts)),s.label=4;case 4:return this.data.level=t,this._loadedLevel=t,this._levelData=n,[2,!0];case 5:return f=s.sent(),console.warn("[Playground] load level failed, url: ",e,", error: ",f),[3,6];case 6:return[2,!1]}})})},e.prototype.loadNextLevelAsync=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return t=this.getLevel()+1,[4,this.loadLevelAsync(t)];case 1:return[2,e.sent()]}})})},o=i([y],e)}(l.default);o.default=_,cc._RF.pop()},{"../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/GamePlay/BaseMatchProxy":"BaseMatchProxy","../../../GameKit/Settings/ProxyTypes":"ProxyTypes","../Game/Grid":"Grid","../Game/LevelData":"LevelData"}],MatchUI:[function(t,e,o){"use strict";cc._RF.push(e,"e869515DgdMBq3lW8oVEaz/","MatchUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/GamePlay/BaseGameUI"),s=t("../../../GameKit/Framework/Utils/UIHelper"),c=t("../../../GameKit/Settings/EventTypes"),l=t("./DebugMenu"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnEdit=null,e.btnReplay=null,e.txtLevel=null,e.debugMenu=null,e.promotionIcon=null,e}return r(e,t),e.prototype.initOnce=function(){t.prototype.initOnce.call(this),s.default.bindClickEvent(this.btnReplay,c.default.UI.PLAY_CURRENT_LEVEL),s.default.bindClickEvent(this.promotionIcon,c.default.UI.SWITCH_GAME)},e.prototype.setLevel=function(t){this.txtLevel.string=t.toString()},e.prototype.showDebugMenu=function(t,e){this.debugMenu&&(this.debugMenu.node.active=t,this.debugMenu.setMatch(e))},e.prototype.showSwichGameIcon=function(t){this.promotionIcon&&(this.promotionIcon.node.active=t)},i([d(cc.Button)],e.prototype,"btnEdit",void 0),i([d(cc.Button)],e.prototype,"btnReplay",void 0),i([d(cc.Label)],e.prototype,"txtLevel",void 0),i([d(l.default)],e.prototype,"debugMenu",void 0),i([d(cc.Button)],e.prototype,"promotionIcon",void 0),i([p],e)}(a.default);o.default=f,cc._RF.pop()},{"../../../GameKit/Framework/Utils/UIHelper":"UIHelper","../../../GameKit/GamePlay/BaseGameUI":"BaseGameUI","../../../GameKit/Settings/EventTypes":"EventTypes","./DebugMenu":"DebugMenu"}],MediatorComp:[function(t,e,o){"use strict";cc._RF.push(e,"05ce2stKW1Jxqv4PaXYYxDJ","MediatorComp");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Facade"),l=t("../Utils/Utils"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._events=[],e.mediatorName="",e.removeOnDestroy=!0,e.registerOnEnable=!1,e.unregisterOnDisable=!1,e.initOnLoaded=!0,e._inited=!1,e._handlers={},e}return r(e,t),e.prototype.onLoad=function(){l.default.isUndefinedOrNullOrEmpty(this.mediatorName)&&(this.mediatorName=this.node.name),this._onLoaded()},e.prototype._onLoaded=function(){this.initOnLoaded&&this.initOnce2()},e.prototype.initOnce=function(){this._inited||(this._inited=!0,this._initProxy(),this._initViewComponent(),this.initEvents(),this._updateData())},e.prototype.initOnce2=function(){this._inited||(this._inited=!0,this._initViewComponent(),this.initEvents())},e.prototype.onEnable=function(){this.registerOnEnable&&this.getFacade()&&(this.getFacade().hasMediator(this.mediatorName)||this.getFacade().registerMediator(this))},e.prototype.onDisable=function(){this.unregisterOnDisable&&this.getFacade()&&this.getFacade().removeMediator(this.mediatorName)},e.prototype.onDestroy=function(){this.removeOnDestroy&&this.getFacade()&&this.getFacade().removeMediator(this.getName())},e.prototype.addEvent=function(t,e,o){this._events.push(t),e&&this._bindEvent(t,e,o)},e.prototype.initEvents=function(){this._events=[]},e.prototype._initProxy=function(){},e.prototype._initViewComponent=function(){},e.prototype._updateData=function(){},e.prototype.onStart=function(){},e.prototype.getName=function(){return this.mediatorName},e.prototype.listNotificationInterests=function(){return this._events},e.prototype.handleNotification=function(t){var e=t.getUserData(),o=t.type;this._handlers[o]&&(0,this._handlers[o])(e)},e.prototype.onRegister=function(){},e.prototype.onRemove=function(){},e.prototype.getFacade=function(){return this._facade||(this._facade=c.default.getInstance()),this._facade},e.prototype.sendNotification=function(t,e){this.getFacade().sendNotification(t,e)},e.prototype.retrieveProxy=function(t){return this.getFacade().retrieveProxy(t)},e.prototype.retrieveMediator=function(t){return this.getFacade().retrieveMediator(t)},e.prototype.executeCommand=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(){return[2,this.getFacade().executeCommand(t,e)]})})},e.prototype._bindEvent=function(t,e,o){this._handlers[t]=o?e.bind(o):e},i([d],e.prototype,"mediatorName",void 0),i([d],e.prototype,"removeOnDestroy",void 0),i([d],e.prototype,"registerOnEnable",void 0),i([d],e.prototype,"unregisterOnDisable",void 0),i([d],e.prototype,"initOnLoaded",void 0),i([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../Facade":"Facade","../Utils/Utils":"Utils"}],MediatorType:[function(t,e,o){"use strict";cc._RF.push(e,"19262NitS9LE6CmgifazwaJ","MediatorType"),Object.defineProperty(o,"__esModule",{value:!0}),o.default={HOME_UI:"HomeUI",GAME_UI:"GameUI",RESULT_UI:"ResultUI",GAME_CONTROL:"GameControl",REVIVE_UI:"ReviveUI",SHOP_UI:"ShopUI",HUD:"HUD",ADS:"AdsUI",RANK_UI:"RankUI",REPLAY_UI:"ReplayUI",MATCH:"Match"},cc._RF.pop()},{}],Mediator:[function(t,e,o){"use strict";cc._RF.push(e,"5d2c7RaBd9GdqSiakNOOEeE","Mediator");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!1,configurable:!0}),e.prototype.getName=function(){return this._name},Object.defineProperty(e.prototype,"viewComponent",{get:function(){return this._viewComponent},set:function(t){this._viewComponent=t},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.listNotificationInterests=function(){return[]},e.prototype.handleNotification=function(){},e.prototype.onRegister=function(){},e.prototype.onRemove=function(){},e}(t("../Observer/Notifier").default);o.default=i,cc._RF.pop()},{"../Observer/Notifier":"Notifier"}],Model:[function(t,e,o){"use strict";cc._RF.push(e,"89ce416kBFD3pNCVqRykz45","Model");var n=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,i=r.ccclass,a=(r.property,t("../Utils/Utils")),s=function(){function t(){}var e;return e=t,t.getInstance=function(){return a.Utils.isUndefinedOrNull(e._instance)&&(e._instance=new e),e._instance},t.prototype.init=function(t){this._proxies=[],this._facade=t},t.prototype.registerProxy=function(t){if(a.Utils.isUndefinedOrNullOrEmpty(t.name))console.warn("[Model] registerProxy: missing proxy name! ",t.name);else{if(console.info("[Model] registerProxy: ",t.name),this.hasProxy(t.name)){if(this.retrieveProxy(t.name)==t)return void console.warn("[Model] proxy already registered: ",t.name);console.warn("[Model] remove previous proxy: ",t.name),this.removeProxy(t.name)}this._proxies[t.name]=t}},t.prototype.retrieveProxy=function(t){return this._proxies[t]},t.prototype.hasProxy=function(t){return a.Utils.isNotUndefinedOrNull(this.retrieveProxy(t))},t.prototype.removeProxy=function(t){console.info("[Model] removeProxy: ",t),this._proxies[t]=void 0},e=n([i],t)}();o.default=s,cc._RF.pop()},{"../Utils/Utils":"Utils"}],NestedJob:[function(t,e,o){"use strict";cc._RF.push(e,"7dbad8rwYNKeKqThfVKyDKn","NestedJob");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Job"),a=t("../Utils/Utils"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createJob=function(t,o){var n=new e(t);return o&&(n.setJobBeginHandler(o.onBeginHandler),n.setJobUpdateHandler(o.onUpdateHandler),n.setFinishHander(o.onFinishHandler),n.setCancelHandler(o.tryCancelHandler)),n},e.createNestedJob=function(t,o,n,r){var i=e.createJob(n,r);return i.setLazyGenerator(o,function(e){return{job:t(e)}}),i},e.prototype._generateJob=function(e){t.prototype._generateJob.call(this,e),e&&(this._nestedJob=e.job)},e.prototype.setJob=function(t){this._nestedJob=t},e.prototype.hasNestedJob=function(){return a.default.isNotUndefinedOrNull(this._nestedJob)},e.prototype._onBegin=function(){t.prototype._onBegin.call(this),this._nestedJob&&this._nestedJob.begin()},e.prototype._onUpdate=function(e){var o=t.prototype._onUpdate.call(this,e);return this._nestedJob&&(o=this._nestedJob.update(e)),o},e.prototype._tryCancel=function(){var e=t.prototype._tryCancel.call(this);return this._nestedJob&&(e=this._nestedJob.cancel()),e},e.prototype.hasSiblings=function(){return t.prototype.hasSiblings.call(this)||!!this._nestedJob&&this._nestedJob.hasSiblings()},e.prototype.getSiblings=function(){var e=t.prototype.getSiblings.call(this);return this._nestedJob&&this._nestedJob.hasSiblings()&&(e=e?e.concat(this._nestedJob.getSiblings()):this._nestedJob.getSiblings()),e},e.prototype.removeSiblings=function(){var e=t.prototype.removeSiblings.call(this);return this._nestedJob&&this._nestedJob.hasSiblings()&&(e=e?e.concat(this._nestedJob.removeSiblings()):this._nestedJob.removeSiblings()),e},e.prototype.hasNextJob=function(){return t.prototype.hasNextJob.call(this)||!!this._nestedJob&&this._nestedJob.hasNextJob()},e.prototype.getNextJob=function(){var e=t.prototype.getNextJob.call(this);return this._nestedJob&&this._nestedJob.hasNextJob()&&(e?e.spawn(this._nestedJob.getNextJob()):e=this._nestedJob.getNextJob()),e},e.prototype.addNextJob=function(e){return this._nestedJob?this._nestedJob.addNextJob(e):t.prototype.addNextJob.call(this,e)},e}(i.default);o.default=s,cc._RF.pop()},{"../Utils/Utils":"Utils","./Job":"Job"}],Notifier:[function(t,e,o){"use strict";cc._RF.push(e,"b1edbw+CYBOj68QpouSTVWO","Notifier"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Facade"),r=function(){function t(){}return t.prototype.getFacade=function(){return this._facade||(this._facade=n.default.getInstance()),this._facade},t.prototype.sendNotification=function(t,e){this.getFacade().sendNotification(t,e)},t.prototype.retrieveProxy=function(t){return this.getFacade().retrieveProxy(t)},t.prototype.retrieveMediator=function(t){return this.getFacade().retrieveMediator(t)},t}();o.default=r,cc._RF.pop()},{"../Facade":"Facade"}],PlayerProxy:[function(t,e,o){"use strict";cc._RF.push(e,"a1277kdeENC95BTNCqsgH6M","PlayerProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../../GameKit/Account/BasePlayerProxy"),s=t("../../../GameKit/Framework/Utils/Utils"),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return r(e,t),o=e,e.create=function(t){var e=new o;return e.name=t,e.init(),e},e.prototype.updateFromData=function(e){t.prototype.updateFromData.call(this,e),s.default.isUndefinedOrNull(this.data.colorIdx)&&(this.data.colorIdx=-1),this.data.colorIdx<0&&(this.data.colorIdx=0),console.info("[Player] ",this.data)},e.prototype.getColorIdx=function(){return this.data.colorIdx},e.prototype.setColorIdx=function(t){this.data.colorIdx=t},o=i([l],e)}(a.default));o.default=u,cc._RF.pop()},{"../../../GameKit/Account/BasePlayerProxy":"BasePlayerProxy","../../../GameKit/Framework/Utils/Utils":"Utils"}],Playground:[function(t,e,o){"use strict";cc._RF.push(e,"d732bAnBp5CepBbtnoZoygC","Playground");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.HIDE_AND_SEEK=void 0;var c=t("./Board"),l=t("./Role"),u=t("./InputType"),p=t("../../../GameKit/GamePlay/BasePlayground"),d=t("../../../GameKit/App/AppFacade"),f=t("../../../GameKit/Framework/Utils/Utils"),h=t("./Grid"),y=t("./LevelData"),_=t("./WalkableGrid"),v=t("../Match/MatchProxy"),g=t("../../../Kitty/Script/KittyApp"),b=t("../../../Kitty/Script/KittyConsts"),m=cc._decorator,w=m.ccclass,S=m.property;o.HIDE_AND_SEEK={EVENTS:{WIN:"Hide.And.Seek.Win.Event",LOOT:"Hide.And.Seek.Loot.Event"},LOOT_TYPE:{NONE:0,COIN:1,HEART:3,KITTY:2,EXIT:4}};var P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtLevel=null,e.board=null,e.role=null,e.gridPrefabs=[],e.specials=[],e.heart=null,e.kitty=null,e.door=null,e.digger=null,e.treasure=null,e.specialAssemblyPostions=[],e.guideNode=null,e.hand=null,e._levelIdx=0,e._touchPos=cc.v2(),e._roleGrid=cc.v2(),e._isRoleMoving=!1,e._pathLevel=null,e._currentLevel=null,e._treasureCount=0,e._idleTime=0,e._letterEvent={hasLetter:!1},e}return r(e,t),e.prototype.startGame=function(){this.newMatch(1),this.startMatch()},e.prototype.newMatch=function(e){return a(this,void 0,void 0,function(){var o;return s(this,function(){return this._reset(),o=y.default.createRandomLevel(10,10,10),this._currentLevel=o,this.loadLevel(o),t.prototype.newMatch.call(this,e),[2]})})},e.prototype.replayGame=function(){this.loadLevel(this._currentLevel),t.prototype.newMatch.call(this,1),this.startMatch()},e.prototype.setLipstickColor=function(t){this._lipstickColor=t},e.prototype.loadLevel=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return this.board.setPrefabs(this.gridPrefabs[0],this.gridPrefabs),this.board.loadLevelData(t),this._onLevelLoaded(),[2]})})},e.prototype._reset=function(){this._pathLevel=void 0,this._roleGrid=h.INVALID_GRID,this.role.node.active=!1,this._win=!1,this._idleTime=0,this.showGuide(!1)},e.prototype._loadLevel=function(t){return a(this,void 0,void 0,function(){var e,o,n,r,i,a,c,l,u;return s(this,function(s){switch(s.label){case 0:e="level/"+t,s.label=1;case 1:if(s.trys.push([1,5,,6]),o=void 0,n=void 0,r=localStorage.getItem("RES"),!cc.sys.isNative||f.default.isUndefinedOrNullOrEmpty(r))return[3,2];i=r+"/level/"+t.toString()+".json";try{if(!jsb.fileUtils.isFileExist(i))return console.warn("[Playground] load file fail, url=",i,", error: ","File not exists"),[2,!1];a=jsb.fileUtils.getStringFromFile(i),o=JSON.parse(a)}catch(p){return console.warn("[Playground] load file fail, url=",i,", error: ",p),[2,!1]}return[3,4];case 2:return[4,f.default.loadRes(e)];case 3:(c=s.sent()).error?(l=9,t<100?l=9:t<200?l=10:t<300?l=11:t<400?l=12:(Math.floor((t-400)/100),l=13),n=y.default.createRandomLevel(l,l,l)):(o=c.resource.json,(n=y.default.create(1,1,h.GRID_TYPE.UNKNOWN)).setGridData(o._grids,o._width),n.setStartsData(o._starts)),s.label=4;case 4:return this.board.loadLevelData(n),this._levelIdx=t,[2,!0];case 5:return u=s.sent(),console.warn("[Playground] load level failed, url: ",e,", error: ",u),[3,6];case 6:return[2,!1]}})})},e.prototype._onLevelLoaded=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i,a,c;return s(this,function(s){switch(s.label){case 0:if(t=this.board.getLevel(),this._pathLevel=y.default.create(t.getWidth(),t.getHeight(),h.GRID_TYPE.UNKNOWN),this._lipstickColor&&this.role.setColor(this._lipstickColor),this._roleGrid=this.board.getStartGrid(),e=this.board.getGridPosition(this._roleGrid),this.role.node.active=!0,this.role.node.setPosition(e),o=f.default.randomInt(0,15),n=1,o>=5)switch(o-=5){case 0:case 1:case 2:n=1;break;case 3:n=2;break;case 4:n=3;break;default:n=f.default.randomFloat(0,1)>.5?10:1}if(n>0){if(r=[],1==n&&f.default.randomFloat(0,1)<.5)f.default.randomFloat(0,1)<.75?r.push(this.heart):r.push(this.kitty);else for(i=0;i<n;i++)a=f.default.randomInt(0,this.specials.length),r.push(this.specials[a]);this._treasureCount=n,this.board.setSpecial(r)}return[4,this._markWalkableGrid([this._roleGrid],.1)];case 1:return c=s.sent(),this._testSpecialEvents(c.events),[2]}})})},e.prototype.setSpecial=function(t){if(!(t<=0)){var e=[];switch(t){case v.SPECIAL_GRID.LETTER:e.push(this.heart);break;case v.SPECIAL_GRID.SHOP:e.push(this.kitty);break;default:for(var o=0;o<=t-v.SPECIAL_GRID.OTHERS;o++){var n=f.default.randomInt(0,this.specials.length);e.push(this.specials[n])}}this.board.setSpecial(e)}},e.prototype._loadNextLevel=function(){this._loadLevel(this._levelIdx+1)},e.prototype.onTouchBegin=function(t){this._touchPos=t.getLocation()},e.prototype.onTouchMove=function(t){var e=t.getLocation();this._tryMoveRole(e)},e.prototype.onTouchEnd=function(t){var e=t.getLocation();this._tryMoveRole(e)},e.prototype.onTouchCancel=function(t){var e=t.getLocation();this._tryMoveRole(e)},e.prototype._calculateAngle=function(t,e){var o=e.sub(t),n=o.angle(cc.v2(1,0))/Math.PI*180;return o.y>=0||(n=360-n),n},e.prototype._checkInput=function(t){if(t.sub(this._touchPos).mag()<10)return u.default.NONE;u.default.NONE;var e=this._calculateAngle(this._touchPos,t);return e>45&&e<=135?u.default.UP:e>135&&e<=225?u.default.LEFT:e>225&&e<=315?u.default.DOWN:u.default.RIGHT},e.prototype.update=function(t){this._win||1==this.guideNode.active||(this._idleTime+=t,this._idleTime>3&&this.showGuide(!0))},e.prototype._tryMoveRole=function(t){return a(this,void 0,void 0,function(){var e,o,n,r,i,a,c,l,p,d,y,v,g;return s(this,function(s){switch(s.label){case 0:return this._win?[2]:(e=this._checkInput(t))==u.default.NONE?[2]:(this._idleTime=0,this.showGuide(!1),this._touchPos=t,this._isRoleMoving?[3,5]:(o=this.board.getNextGrid(this._roleGrid,e),f.default.isUndefinedOrNull(o)||o.equals(h.INVALID_GRID)?[3,5]:[3,1]));case 1:return n=this._pathLevel.setGridsType(h.GRID_TYPE.WALKABLE,this._roleGrid,o),this._isRoleMoving=!0,r=void 0,a=(i=Promise).all,c=[this._moveRoleToGrid(o)],[4,this._markWalkableGrid(n,this.role.calculateTime(this.board.getGridPosition(o)))];case 2:return[4,a.apply(i,[c.concat([r=s.sent()])])];case 3:return s.sent(),this._isRoleMoving=!1,this._testSpecialEvents(r.events),this._checkWin()?(l=r.last.getComponent(h.default),p=this.door,d=500,this._treasureCount>=5&&(p=this.treasure,d=1e3),y=cc.instantiate(p),v=this.board.getGrid(l.gridPostion),g=f.default.convertNode1PositionToNode2SpaceAR(v.node,this.board.node),y.setParent(this.board.node),y.setPosition(g),y.getComponent(_.default).mark(!0),this.role.node.active=!1,[4,f.default.waitFor(d)]):[3,5];case 4:s.sent(),this._onWin(),s.label=5;case 5:return[2]}})})},e.prototype._testSpecialEvents=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(o){switch(o.label){case 0:return t.length>0?[4,f.default.waitFor(500)]:[3,2];case 1:for(o.sent(),e=0;e<t.length;e++)this._gatherSpecial(t[e]);o.label=2;case 2:return[2]}})})},e.prototype._gatherSpecial=function(t){g.default.playSound(b.default.SOUNDS.LOOT);var e=this.specialAssemblyPostions[t.id-1];if(e||(e=this.specialAssemblyPostions[0]),null!=t.grid.hiddenNode){var n=cc.instantiate(t.grid.hiddenNode);t.grid.gatherSpecial(),n.name="special",n.setParent(e);var r=t.grid.node.getPosition();r=t.grid.node.parent.convertToWorldSpaceAR(r),r=e.convertToNodeSpaceAR(r),n.setPosition(r),d.default.getInstance().sendNotification(o.HIDE_AND_SEEK.EVENTS.LOOT,{type:t.id,amount:1}),n.runAction(cc.sequence(cc.moveTo(.5,cc.v2(0,0)),cc.fadeOut(.1),cc.callFunc(function(){})))}},e.prototype._markWalkableGrid=function(t,e){return a(this,void 0,void 0,function(){var o,n,r,i,a,c,l,u,p,d;return s(this,function(s){switch(s.label){case 0:return o=e/t.length,[4,f.default.waitFor(500*o)];case 1:s.sent(),n=0,r=[],a=0,c=t,s.label=2;case 2:return a<c.length?(l=c[a],n>0?[4,f.default.waitFor(1e3*o)]:[3,4]):[3,6];case 3:s.sent(),s.label=4;case 4:(u=this.board.getGrid(l))&&u.gridType==h.GRID_TYPE.WALKABLE&&(p=u.getComponent(_.default))&&!p.isMarked()&&(i=p,this._lipstickColor&&p.setDisplayColor(this._lipstickColor),p.mark(!0),p.eventId>0&&((d={id:0,grid:void 0}).id=p.eventId,d.grid=p,r.push(d))),n++,s.label=5;case 5:return a++,[3,2];case 6:return[2,{events:r,last:i}]}})})},e.prototype._moveRoleToGrid=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(o){switch(o.label){case 0:return e=this.board.getGridPosition(t),[4,this.role.moveToAsync(e)];case 1:return o.sent(),this._roleGrid=t,[2]}})})},e.prototype._checkWin=function(){if(this._win)return!1;for(var t=!0,e=this._pathLevel.getGridData(),o=this.board.getLevel().getGridData(),n=0;n<o.length;n++){var r=o[n];if(r==h.GRID_TYPE.WALKABLE&&e[n]!=r){t=!1;break}}return this._win=t,t},e.prototype._onWin=function(){d.default.getInstance().sendNotification(_.default.EVENTS.MARKED,this._letterEvent),d.default.getInstance().sendNotification(o.HIDE_AND_SEEK.EVENTS.WIN)},e.prototype._findGuideDir=function(){for(var t=cc.v2(0,0),e=[cc.v2(1,0),cc.v2(0,-1),cc.v2(0,1),cc.v2(-1,0)],o=[],n=0;n<e.length;n++){var r=e[n],i=this.board.getLevel().getNextWalkable(this._roleGrid,r);if(i!=h.INVALID_GRID&&!i.equals(this._roleGrid)&&(o.push(r),this.board.hasUnmarkedGrid(this._roleGrid,i))){t=r;break}}return 0==t.x&&0==t.y&&(o.length<=0?console.warn("[HideAndSeek] no guide dir"):t=f.default.randomItemInArray(o).value),t},e.prototype.showGuide=function(t){var e=this;if(this.guideNode.active!=t&&(this.guideNode.active=t,t)){var o=this._findGuideDir();this.hand.stopAllActions();var n=cc.callFunc(function(){e.hand.setPosition(o.mul(-100))}),r=cc.moveBy(.5,o.mul(100)),i=cc.delayTime(.5),a=cc.sequence(n,r,i);a.repeatForever(),this.hand.runAction(a)}},i([S(cc.Label)],e.prototype,"txtLevel",void 0),i([S(c.default)],e.prototype,"board",void 0),i([S(l.default)],e.prototype,"role",void 0),i([S(cc.Prefab)],e.prototype,"gridPrefabs",void 0),i([S(cc.Prefab)],e.prototype,"specials",void 0),i([S(cc.Prefab)],e.prototype,"heart",void 0),i([S(cc.Prefab)],e.prototype,"kitty",void 0),i([S(cc.Prefab)],e.prototype,"door",void 0),i([S(cc.Prefab)],e.prototype,"digger",void 0),i([S(cc.Prefab)],e.prototype,"treasure",void 0),i([S(cc.Node)],e.prototype,"specialAssemblyPostions",void 0),i([S(cc.Node)],e.prototype,"guideNode",void 0),i([S(cc.Node)],e.prototype,"hand",void 0),i([w],e)}(p.default);o.default=P,cc._RF.pop()},{"../../../GameKit/App/AppFacade":"AppFacade","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/GamePlay/BasePlayground":"BasePlayground","../../../Kitty/Script/KittyApp":"KittyApp","../../../Kitty/Script/KittyConsts":"KittyConsts","../Match/MatchProxy":"MatchProxy","./Board":"Board","./Grid":"Grid","./InputType":"InputType","./LevelData":"LevelData","./Role":"Role","./WalkableGrid":"WalkableGrid"}],PoolConfig:[function(t,e,o){"use strict";cc._RF.push(e,"a4a9dARVB1Mw7vtpAw6m4QI","PoolConfig");var n=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,i=r.ccclass,a=r.property,s=function(){function t(){this.tplPrefab=null,this.tplNode=null,this.poolName="",this.initSize=1,this.maxSize=-1}return n([a(cc.Prefab)],t.prototype,"tplPrefab",void 0),n([a(cc.Node)],t.prototype,"tplNode",void 0),n([a("string")],t.prototype,"poolName",void 0),n([a("number")],t.prototype,"initSize",void 0),n([a("number")],t.prototype,"maxSize",void 0),n([i("PoolConfig")],t)}();o.default=s,cc._RF.pop()},{}],PoolManager:[function(t,e,o){"use strict";cc._RF.push(e,"865e6Z3eGFKPqCQ8dQJCZtg","PoolManager");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Extension/SingleNode"),l=t("./PoolConfig"),u=t("../Utils/Utils"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(){function t(t,e,o,n,r){console.assert(u.default.isNotUndefinedOrNull(t)),console.assert(!u.default.isUndefinedOrNullOrEmpty(e)),this._tpl=t,this._name=e,this._initSize=o,this._maxSize=n;var i=new cc.NodePool(r);this._pool=i}return t.prototype.initPool=function(){for(var t=0;t<this._initSize;t++){var e=cc.instantiate(this._tpl);this._pool.put(e)}console.info("[Pool:"+this._name+"] init, size: "+this._pool.size()+", max: "+this._maxSize)},t.prototype.get=function(){if(this._pool.size()<=0){var t=cc.instantiate(this._tpl);this._pool.put(t)}return this._pool.get()},t.prototype.put=function(t){this._maxSize<0||this._pool.size()<this._maxSize?this._pool.put(t):(t.removeFromParent(),t.active=!1,t.destroy())},t.prototype.clear=function(){this._pool.clear(),this._pool=null},t}(),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.configs=[],e._pools={},e}var o;return r(e,t),o=e,e.getInstance=function(){return o._inst},e.prototype._onloaded=function(){return a(this,void 0,void 0,function(){return s(this,function(){return t.prototype._onloaded.call(this),o._inst=this,[2]})})},e.prototype.init=function(){var t=this;this.configs.forEach(function(e){t.initPool(e)})},e.prototype.initPool=function(t){var e,o;if(u.default.isNotUndefinedOrNull(t.tplPrefab))e=t.tplPrefab;else{if(!u.default.isNotUndefinedOrNull(t.tplNode))return void console.warn("[PoolManager] init, invalid pool config, missing Template: prefab or node");e=t.tplNode}if(o=u.default.isUndefinedOrNullOrEmpty(t.poolName)?e.name:t.poolName,u.default.isUndefinedOrNullOrEmpty(o))console.warn("[PoolManager] init, invalid pool config, missing pool name: ",t);else{if(!u.default.isNotUndefinedOrNull(this._pools[o])){var n=t.initSize;n<0&&(n=0);var r=t.maxSize;r>0&&r<t.initSize&&(r=t.initSize);var i=new h(e,o,n,r,t.handlerComp);return i.initPool(),this._pools[o]=i,i}console.warn("[PoolManager] init, pool already exist! call (removePool) first, name: ",t)}},e.prototype.removePool=function(t){var e;if("string"==typeof t)e=t;else if(t instanceof cc.Prefab)e=t.name;else{if(!(t instanceof cc.Node))return void console.warn("[PoolManager] remove, missing name or unsupported type for pool: ",t);e=t.name}var o=this._pools[e];this._pools[e]=void 0,o.clear()},e.prototype.put=function(t,e){var o;if(u.default.isUndefinedOrNull(e))o=t.name;else if("string"==typeof e)o=e;else if(e instanceof cc.Prefab)o=e.name;else{if(!(e instanceof cc.Node))return console.warn("[PoolManager] put, missing name or unsupported type for pool: ",e),t.removeFromParent(),t.active=!1,void t.destroy();o=e.name}var n=this._pools[o];if(u.default.isUndefinedOrNull(n))return console.warn("[PoolManager] put, missing pool of name: ",o),t.removeFromParent(),t.active=!1,void t.destroy();n.put(t)},e.prototype.get=function(t,e){var o,n;if("string"==typeof t)o=t;else if(t instanceof cc.Prefab)o=t.name,n=t;else{if(!(t instanceof cc.Node))return console.warn("[PoolManager] get, missing name or unsupported type for pool: ",t),null;o=t.name,n=t}if(u.default.isUndefinedOrNullOrEmpty(o))return console.warn("[PoolManager] get, missing name for pool: ",t),null;var r=this._pools[o];return u.default.isUndefinedOrNull(r)&&!e?(console.warn("[PoolManager] get, missing pool of name: ",o),null):(u.default.isUndefinedOrNull(r)&&e&&(r=this.initDefaultPool(n)),r.get())},e.prototype.hasPool=function(t){var e;if("string"==typeof t)e=t;else if(t instanceof cc.Prefab)e=t.name;else{if(!(t instanceof cc.Node))return console.warn("[PoolManager] missing name or unsupported type for pool: ",t),!1;e=t.name}return u.default.isNotUndefinedOrNull(this._pools[e])},e.prototype.initDefaultPool=function(t){var e=t,o=t;return this.initPool({tplPrefab:e,tplNode:o,poolName:void 0,initSize:0,maxSize:-1})},i([f(l.default)],e.prototype,"configs",void 0),o=i([d],e)}(c.default);o.default=y,cc._RF.pop()},{"../Extension/SingleNode":"SingleNode","../Utils/Utils":"Utils","./PoolConfig":"PoolConfig"}],PopUI:[function(t,e,o){"use strict";cc._RF.push(e,"edce1trI+NJdbGv1zW2oUDN","PopUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/View/BaseUI"),l=t("../Framework/Utils/UIHelper"),u=cc._decorator,p=u.ccclass,d=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnYes=null,e.txtYes=null,e.btnNo=null,e.txtNo=null,e.txtMsg=null,e}var o;return r(e,t),o=e,e.Show=function(t,e,n,r){return a(this,void 0,void 0,function(){var i,a,c;return s(this,function(s){switch(s.label){case 0:return t?(i=cc.instantiate(t),(a=i.getComponent(o))?(n&&a.setMsg(n),r&&a.setStyle(r),i.parent=e,[4,a.showUI()]):(console.error("[PopUI.Show] not PopUI comp in prefab"),[2,!1])):[3,2];case 1:return c=s.sent(),i.destroy(),[2,c];case 2:return console.error("[PopUI.Show] invalid prefab"),[2,!1]}})})},e.Show2=function(t,e,n,r){return a(this,void 0,void 0,function(){var i,a,c;return s(this,function(s){switch(s.label){case 0:return t?(i=cc.instantiate(t),(a=i.getComponent(o))?(n&&a.setMsg(n),r&&a.setStyle(r),i.parent=e,[4,a.showUI()]):(console.error("[PopUI.Show] not PopUI comp in prefab"),[2,{result:!1,ui:void 0}])):[3,2];case 1:return c=s.sent(),i.destroy(),[2,{result:c,ui:a}];case 2:return console.error("[PopUI.Show] invalid prefab"),[2,{result:!1,ui:void 0}]}})})},e.prototype.onLoad=function(){this.initOnce()},e.prototype.setMsg=function(t){this.txtMsg&&(this.txtMsg.string=t)},e.prototype.setStyle=function(t){t.hideCancel&&(this.btnNo.node.active=!1),t.cancelText&&(this.txtNo.string=t.cancelText),t.yesText&&(this.txtYes.string=t.yesText),this._opt=t},e.prototype.initOnce=function(){var e=this;t.prototype.initOnce.call(this),l.default.bindClickEvent(this.btnYes,function(){return a(e,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this._onAction(!0)];case 1:return t.sent(),[2]}})})},void 0),l.default.bindClickEvent(this.btnNo,function(){return a(e,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this._onAction(!1)];case 1:return t.sent(),[2]}})})},void 0)},e.prototype._onAction=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.hide(!0)];case 1:return e.sent(),this._onCloseHandler&&this._onCloseHandler(t),[2]}})})},e.prototype.show=function(e){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return[4,t.prototype.show.call(this,e)];case 1:return o.sent(),[2]}})})},e.prototype.hide=function(e){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return[4,t.prototype.hide.call(this,e)];case 1:return o.sent(),[2]}})})},e.prototype.showUI=function(t){return a(this,void 0,Promise,function(){var e=this;return s(this,function(){return[2,new Promise(function(o){e._onCloseHandler=o,t&&e.setMsg(t),e.show(!0)})]})})},i([d(cc.Button)],e.prototype,"btnYes",void 0),i([d(cc.Label)],e.prototype,"txtYes",void 0),i([d(cc.Button)],e.prototype,"btnNo",void 0),i([d(cc.Label)],e.prototype,"txtNo",void 0),i([d(cc.Label)],e.prototype,"txtMsg",void 0),o=i([p],e)}(c.default);o.default=f,cc._RF.pop()},{"../Framework/Utils/UIHelper":"UIHelper","../Framework/View/BaseUI":"BaseUI"}],PrefabPair:[function(t,e,o){"use strict";cc._RF.push(e,"f3109X9q59PNLVQglU9bFeM","PrefabPair");var n=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.ImagePair=void 0;var r=cc._decorator,i=r.ccclass,a=r.property,s=function(){function t(){this.name="",this.prefab=null}return n([a("string")],t.prototype,"name",void 0),n([a(cc.Prefab)],t.prototype,"prefab",void 0),n([i("PrefabPair")],t)}();o.default=s;var c=function(){function t(){this.name="",this.image=null}return n([a("string")],t.prototype,"name",void 0),n([a(cc.SpriteFrame)],t.prototype,"image",void 0),n([i("ImagePair")],t)}();o.ImagePair=c,cc._RF.pop()},{}],PropertyCounter:[function(t,e,o){"use strict";cc._RF.push(e,"84284GWNTpNdaIS9kYpcPsv","PropertyCounter"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],ProxyTypes:[function(t,e,o){"use strict";cc._RF.push(e,"435beH8fxdAwJH9Aqig/XJs","ProxyTypes"),Object.defineProperty(o,"__esModule",{value:!0}),o.default={APP:"App.Proxy",MATCH:"Match.Proxy",SHOP:"Shop.Proxy",INVENTORY:"Inventory.Proxy",PLAYER:"Player.Proxy",ACCOUNT:"Account.Proxy",ADS:"Ads.Proxy",LEADERBOARD:"Leaderboard.Proxy",CONTEXT_RANK:"Context.Board.Proxy",DOWNLOAD_CACHE:"Download.Cache.Proxy",LOGGER:"Event.Logger.Proxy"},cc._RF.pop()},{}],Proxy:[function(t,e,o){"use strict";cc._RF.push(e,"30d8aPqMuxOt72tvP/phZG1","Proxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e._name=null,e._data=null,e}return r(e,t),e.create=function(t,o){var n=new e;return n._name=t,n._data=o,n},Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!1,configurable:!0}),e.prototype.onRegister=function(){},e.prototype.onRemove=function(){},e}(t("../Observer/Notifier").default);o.default=i,cc._RF.pop()},{"../Observer/Notifier":"Notifier"}],QuickCloseButton:[function(t,e,o){"use strict";cc._RF.push(e,"70ea3F72VNPrZph67MjtbKF","QuickCloseButton");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Utils/UIHelper"),s=t("../Utils/Utils"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.objectToClose=null,e.destroyOnClose=!1,e}return r(e,t),e.prototype.start=function(){a.default.bindClickEvent(this,this.onClick.bind(this),!1)},e.prototype.onClick=function(){s.default.isNotUndefinedOrNull(this.objectToClose)&&(this.objectToClose.active=!1,this.destroyOnClose&&this.objectToClose.destroy())},i([u(cc.Node)],e.prototype,"objectToClose",void 0),i([u],e.prototype,"destroyOnClose",void 0),i([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../Utils/UIHelper":"UIHelper","../Utils/Utils":"Utils"}],QuickEventButton:[function(t,e,o){"use strict";cc._RF.push(e,"6ae84O+OzJKNrsG0OLKGyjl","QuickEventButton");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Utils/UIHelper"),s=t("../Utils/Utils"),c=t("../../App/AppFacade"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.objectToShow=null,e.eventName="",e.paramJson="",e}return r(e,t),e.prototype.start=function(){a.default.bindClickEvent(this,this.onClick.bind(this),!1)},e.prototype.onClick=function(){if(s.default.isNotUndefinedOrNull(this.objectToShow)&&(this.objectToShow.active=!0),!s.default.isUndefinedOrNullOrEmpty(this.eventName))if(s.default.isUndefinedOrNullOrEmpty(this.paramJson))c.default.getInstance().sendNotification(this.eventName);else{var t=JSON.parse(this.paramJson);c.default.getInstance().sendNotification(this.eventName,t)}},i([p(cc.Node)],e.prototype,"objectToShow",void 0),i([p],e.prototype,"eventName",void 0),i([p],e.prototype,"paramJson",void 0),i([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../App/AppFacade":"AppFacade","../Utils/UIHelper":"UIHelper","../Utils/Utils":"Utils"}],RankEntryItem:[function(t,e,o){"use strict";cc._RF.push(e,"870a0cCad1JRpWkYNjHZTNK","RankEntryItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Framework/Utils/Utils"),s=t("../App/AppFacade"),c=t("../Settings/ProxyTypes"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtRank=null,e.photo=null,e.txtName=null,e.txtScore=null,e.defaultPhoto=null,e}return r(e,t),e.prototype.upateEntryData=function(t,e){this._entry=t,this.txtRank.string=e?t.worldRank.toString()+".":t.rank.toString()+".",this.txtName.string=t.player.name,this.txtScore.string=t.score.toString();var o=t.player.photo;if(a.default.isUndefinedOrNullOrEmpty(o))this.photo.spriteFrame=this.defaultPhoto;else{var n=s.default.getInstance().retrieveProxy(c.default.DOWNLOAD_CACHE);if(n.contains(o)){var r=n.get(o),i=new cc.SpriteFrame(r.data);this.photo.spriteFrame=i,this.photo.node.width=64,this.photo.node.height=64}else this.photo.spriteFrame=this.defaultPhoto}this.updateSelfInfo(t.isCurrentPlayer)},e.prototype.updateSelfInfo=function(){},i([p(cc.Label)],e.prototype,"txtRank",void 0),i([p(cc.Sprite)],e.prototype,"photo",void 0),i([p(cc.Label)],e.prototype,"txtName",void 0),i([p(cc.Label)],e.prototype,"txtScore",void 0),i([p(cc.SpriteFrame)],e.prototype,"defaultPhoto",void 0),i([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../App/AppFacade":"AppFacade","../Framework/Utils/Utils":"Utils","../Settings/ProxyTypes":"ProxyTypes"}],RankMediator:[function(t,e,o){"use strict";cc._RF.push(e,"f1f1fYQLxJJFIWP292qqwrf","RankMediator");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/View/UIMediator"),l=t("./RankProxy"),u=t("../Settings/ProxyTypes"),p=t("../App/DownloadCache"),d=t("../Settings/EventTypes"),f=cc._decorator,h=f.ccclass,y=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._category=-1,e}return r(e,t),e.prototype._initProxy=function(){this._proxy=this.getFacade().retrieveProxy(u.default.LEADERBOARD)},e.prototype.initEvents=function(){t.prototype.initEvents.call(this),this.addEvent(l.default.EVENTS.RANK_LIST_UPDATE,this.onRankListUpdate,this),this.addEvent(p.default.EVENTS.DOWNLOAD_READY,this.onImageDownloaded,this),this.addEvent(d.default.UI.RANK_TAB_CHANGE,this.onChangeRankCategory,this)},e.prototype.show=function(e){return a(this,void 0,void 0,function(){return s(this,function(){return this._category<0&&this.onChangeRankCategory(0),t.prototype.show.call(this,e),[2]})})},e.prototype.onRankListUpdate=function(t){this._category==t&&this.onChangeRankCategory(t)},e.prototype.onImageDownloaded=function(){this.ui.refresh()},e.prototype.onChangeRankCategory=function(t){var e;switch(t){case 0:this._category=t,e=this._proxy.getList(!0),this.ui.setEntries(e,!1),this.ui.changeTab(t),this.ui._goPage(0);break;case 1:this._category=t,e=this._proxy.getList(!1),this.ui.setEntries(e,!0),this.ui.changeTab(t),this.ui._goPage(0);break;default:console.warn("[RankMediator][onChangeRankCategory] unsupported category: ",t)}},i([h],e)}(c.default));o.default=y,cc._RF.pop()},{"../App/DownloadCache":"DownloadCache","../Framework/View/UIMediator":"UIMediator","../Settings/EventTypes":"EventTypes","../Settings/ProxyTypes":"ProxyTypes","./RankProxy":"RankProxy"}],RankProxy:[function(t,e,o){"use strict";cc._RF.push(e,"42a9cmQ/EZM776++fMrTiuO","RankProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/Model/Proxy"),l=t("../Framework/Utils/Utils"),u=t("../Account/AccountProxy"),p=t("../Settings/ProxyTypes"),d=t("../GamePlay/BaseMatchProxy"),f=cc._decorator,h=f.ccclass,y=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isValid=-1,e}var o;return r(e,t),o=e,e.create=function(t,e){var n=new o;return n.name=t,n.init(e.board,e.friendsOnly),n},e.prototype.init=function(t,e){this._boardName=t,this._entries=[],this._friendsOnly=e},e.prototype.isValid=function(){return this._isValid<0&&(this.getFacade().retrieveProxy(p.default.ACCOUNT).getType()==u.ACCOUNT.FACEBOOK?this._isValid=1:this._isValid=0),this._isValid>0},e.prototype.getBoardName=function(){return this._boardName},e.prototype.setScoreAsync=function(t,e){return a(this,void 0,void 0,function(){var o,n;return s(this,function(r){switch(r.label){case 0:return this.isValid()?[4,this._getBoardAsync()]:[2,!1];case 1:if(!r.sent())return[3,5];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this._board.setScoreAsync(t,e)];case 3:return o=r.sent(),[2,this._updatePlayerEntry(o)];case 4:return n=r.sent(),console.warn("[Leaderboard] can't get leaderboard entries: ",this.getBoardName(),", Error: ",n),[2,!1];case 5:return[2]}})})},e.prototype._getBoardAsync=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(o){switch(o.label){case 0:if(!l.default.isUndefinedOrNull(this._board))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),t=this,[4,FBInstant.getLeaderboardAsync(this.getBoardName())];case 2:return t._board=o.sent(),[2,!0];case 3:return e=o.sent(),console.warn("[Leaderboard] can't get leaderboard: ",this.getBoardName(),", Error: ",e),[2,!1];case 4:return[2,!0]}})})},e.prototype._updatePlayerEntry=function(t){var e={old:-1,new:t.getRank()};l.default.isUndefinedOrNull(this._playerEntry)?(e.old=-1,this._playerEntry=t):(e.old=this._playerEntry.getRank(),this._playerEntry=t);var n=e.old!=e.new;return this.sendNotification(o.EVENTS.PLAYER_RANK_UPDATE,e),n},e.prototype.loadPlayerEntryAsync=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return this.isValid()?[4,this._getBoardAsync()]:(this.sendNotification(o.EVENTS.PLAYER_RANK_UPDATE),[2]);case 1:if(!n.sent())return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this._board.getPlayerEntryAsync()];case 3:return(t=n.sent())&&(this._playerEntry=t,this._downloadPhotosForEntriesAsync([t]),this._updatePlayerEntry(t)),[3,5];case 4:return e=n.sent(),console.warn("[Leaderboard] can't get player entry: ",this.getBoardName(),", Error: ",e),[3,5];case 5:return[2]}})})},e.prototype.getPlayerEntry=function(){return this._convertEntry(this._playerEntry,!1)},e.prototype.getEntrisAsync=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return[4,this.getFriendsRanksAsync(t,e)];case 1:return o.sent(),this._friendsOnly?[3,3]:[4,this.getWorldRanksAsync(t,e)];case 2:o.sent(),o.label=3;case 3:return[2]}})})},e.prototype.getFriendsRanksAsync=function(t,e){return a(this,void 0,void 0,function(){var n,r;return s(this,function(i){switch(i.label){case 0:return this.isValid()?[4,this._getBoardAsync()]:(this.sendNotification(o.EVENTS.RANK_LIST_UPDATE,{board:this.getBoardName(),type:0}),[2]);case 1:if(!i.sent())return[3,5];i.label=2;case 2:return i.trys.push([2,4,,5]),n=void 0,[4,this._board.getConnectedPlayerEntriesAsync(t,e)];case 3:return n=i.sent(),this._entries=n,this._downloadPhotosForEntriesAsync(n),this.sendNotification(o.EVENTS.RANK_LIST_UPDATE,{board:this.getBoardName(),type:0}),[3,5];case 4:return r=i.sent(),console.warn("[Leaderboard] can't get leaderboard entries: ",this.getBoardName(),", Error: ",r),[3,5];case 5:return[2]}})})},e.prototype.getWorldRanksAsync=function(t,e){return a(this,void 0,void 0,function(){var n,r;return s(this,function(i){switch(i.label){case 0:return this.isValid()?[4,this._getBoardAsync()]:(this.sendNotification(o.EVENTS.RANK_LIST_UPDATE,{board:this.getBoardName(),type:1}),[2]);case 1:if(!i.sent())return[3,5];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this._board.getEntriesAsync(t,e)];case 3:return n=i.sent(),this._worldEntries=n,this._downloadPhotosForEntriesAsync(n),this.sendNotification(o.EVENTS.RANK_LIST_UPDATE,{board:this.getBoardName(),type:1}),[3,5];case 4:return r=i.sent(),console.warn("[Leaderboard] can't get leaderboard entries: ",this.getBoardName(),", Error: ",r),[3,5];case 5:return[2]}})})},e.prototype._downloadPhotosForEntriesAsync=function(t){return a(this,void 0,void 0,function(){var e,o,n;return s(this,function(r){switch(r.label){case 0:for(e=this.getFacade().retrieveProxy(p.default.DOWNLOAD_CACHE),o=[],n=0;n<t.length;n++)o.push(t[n].getPlayer().getPhoto());return[4,e.downloadArrayAsync(o,"jpg")];case 1:return r.sent(),[2]}})})},e.prototype._convertEntry=function(t,e){if(t){var o={worldRank:t.getRank(),rank:0,score:t.getScore()/100,isCurrentPlayer:!1,data:t.getExtraData(),player:{id:t.getPlayer().getID(),name:t.getPlayer().getName(),photo:t.getPlayer().getPhoto()}};return l.default.isNotUndefinedOrNull(this._playerEntry)&&t.getPlayer().getID()==this._playerEntry.getPlayer().getID()?(o.isCurrentPlayer=!0,o.isFriend=!1):o.isFriend=e,o}},e.prototype.getList=function(t){if(!this.isValid())return this._getFakeList(t,l.default.randomInt(7,23));for(var e=[],o=t?this._entries:this._worldEntries,n=!1,r=0;r<o.length;r++){var i=this._convertEntry(o[r],t);i.rank=r+1,e.push(i),i.isCurrentPlayer&&(n=!0)}if(!n&&l.default.isNotUndefinedOrNull(this._playerEntry)){var a=this._convertEntry(this._playerEntry,!1);e.push(a),a.rank=e.length,t&&(a.worldRank=a.rank)}return e},e.prototype._getFakeEntry=function(t){var e={worldRank:999,rank:0,score:9999,isCurrentPlayer:!1,data:d.default.fakeResult,player:{id:"123",name:"Devon Zhang",photo:""},isFriend:t};return t||(e.player.name+="*"),e},e.prototype._getFakeList=function(t,e){for(var o=[],n=0;n<e;n++){var r=this._getFakeEntry(t,0);r.rank=n+1,o.push(r)}return o[l.default.randomInt(0,e)].isCurrentPlayer=!0,o},e.EVENTS={RANK_LIST_UPDATE:"Ranks.Ready",PLAYER_RANK_UPDATE:"Player.Rank.Update"},o=i([h],e)}(c.default));o.default=y,cc._RF.pop()},{"../Account/AccountProxy":"AccountProxy","../Framework/Model/Proxy":"Proxy","../Framework/Utils/Utils":"Utils","../GamePlay/BaseMatchProxy":"BaseMatchProxy","../Settings/ProxyTypes":"ProxyTypes"}],RankTypes:[function(t,e,o){"use strict";cc._RF.push(e,"326dcpCvMFCPpE977rFI+Gj","RankTypes"),Object.defineProperty(o,"__esModule",{value:!0}),o.default={HIGHSCORE:"globalHighScore",CONTEXT_HIGHSCORE:"contextHighScore"},cc._RF.pop()},{}],RankUI:[function(t,e,o){"use strict";cc._RF.push(e,"a6916XmOzNPOrLrh4GuSTAA","RankUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/View/BaseUI"),l=t("./RankEntryItem"),u=t("../Framework/Utils/Utils"),p=t("../App/AppFacade"),d=t("../Framework/Utils/UIHelper"),f=t("../Settings/EventTypes"),h=cc._decorator,y=h.ccclass,_=h.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnLeft=null,e.btnRight=null,e.txtPage=null,e.btnOK=null,e.btnShare=null,e.toggleFriends=null,e.toggleWorld=null,e.txtTitle=null,e.items=[],e._page=0,e._entries=[],e._totalPages=0,e._showWorldRank=!1,e}return r(e,t),e.prototype.initOnce=function(){d.default.bindClickEvent(this.btnOK,this.onOK.bind(this)),d.default.bindClickEvent(this.btnShare,this.onShare.bind(this)),d.default.bindClickEvent(this.btnLeft,this.onPrePage.bind(this)),d.default.bindClickEvent(this.btnRight,this.onNextPage.bind(this)),d.default.bindToggleEvent(this.toggleFriends,this._onTabChange.bind(this,0),void 0,!0),d.default.bindToggleEvent(this.toggleWorld,this._onTabChange.bind(this,1),void 0,!0)},e.prototype.setEntries=function(t,e){this._entries=t,this._showWorldRank=e,this._totalPages=Math.ceil(this._entries.length/this.items.length)},e.prototype.beforeShow=function(){},e.prototype.onOK=function(){this.hide(!0)},e.prototype.onShare=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.onPrePage=function(){this._goPage(this._page-1)},e.prototype.onNextPage=function(){this._goPage(this._page+1)},e.prototype._goPage=function(t){this._page=t,this._page<0&&(this._page=this._totalPages-1),this._page>=this._totalPages&&(this._page=0),this.txtPage.string=this._page+1+"/"+this._totalPages;for(var e=this.items.length*this._page,o=0;o<this.items.length;o++){var n=this.items[o];if(e+o>=this._entries.length)n.node.active=!1;else{var r=this._entries[e+o];u.default.isNotUndefinedOrNull(r)?(n.node.active=!0,n.upateEntryData(r,this._showWorldRank)):n.node.active=!1}}},e.prototype._onTabChange=function(t){p.default.getInstance().sendNotification(f.default.UI.RANK_TAB_CHANGE,t)},e.prototype.changeTab=function(t){switch(t){case 0:this.toggleFriends.isChecked||this.toggleFriends.check(),this.txtTitle&&(this.txtTitle.string="FRIENDS HIGH SCORE");break;case 1:this.toggleWorld.isChecked||this.toggleWorld.check(),this.txtTitle&&(this.txtTitle.string="WORLD HIGH SCORE")}},e.prototype.refresh=function(){this._goPage(this._page)},i([_(cc.Button)],e.prototype,"btnLeft",void 0),i([_(cc.Button)],e.prototype,"btnRight",void 0),i([_(cc.Label)],e.prototype,"txtPage",void 0),i([_(cc.Button)],e.prototype,"btnOK",void 0),i([_(cc.Button)],e.prototype,"btnShare",void 0),i([_(cc.Toggle)],e.prototype,"toggleFriends",void 0),i([_(cc.Toggle)],e.prototype,"toggleWorld",void 0),i([_(cc.Label)],e.prototype,"txtTitle",void 0),i([_(l.default)],e.prototype,"items",void 0),i([y],e)}(c.default);o.default=v,cc._RF.pop()},{"../App/AppFacade":"AppFacade","../Framework/Utils/UIHelper":"UIHelper","../Framework/Utils/Utils":"Utils","../Framework/View/BaseUI":"BaseUI","../Settings/EventTypes":"EventTypes","./RankEntryItem":"RankEntryItem"}],RemoteCache:[function(t,e,o){"use strict";cc._RF.push(e,"c6f18zw/hRCQKpx06appB1c","RemoteCache");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./KittyHttp"),a={version:0},s={putObj:function(t,e){a[t]=e},getObj:function(t){return a[t]},load:function(){return n(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return[4,i.default.GetData("cache")];case 1:return(t=e.sent()).success&&((a=t.data).version||(a.version=1)),console.info("[RemoteCache] load: ",a),[2,t.success]}})})},save:function(){return n(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return a.version++,t=a,[4,i.default.SetData("cache",t)];case 1:return[2,e.sent().success]}})})}};o.default=s,cc._RF.pop()},{"./KittyHttp":"KittyHttp"}],ResultUI:[function(t,e,o){"use strict";cc._RF.push(e,"6deb1/xASFDSKNdnc4ykHPr","ResultUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/GamePlay/BaseResultUI"),l=t("../../../GameKit/Settings/EventTypes"),u=t("../../../GameKit/Framework/Utils/Utils"),p=t("../../../GameKit/App/AppFacade"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnReplay=null,e.btnNext=null,e.bgLayer=null,e.title=null,e._timeCounter=0,e._goNextDone=!1,e._ready=!1,e._closeTime=.25,e}return r(e,t),e.prototype.initOnce=function(){t.prototype.initOnce.call(this)},e.prototype.update=function(t){this._ready&&!this._goNextDone&&(this._timeCounter+=t,this._timeCounter>=this._closeTime&&this._goNext())},e.prototype._goNext=function(){this._goNextDone=!0,p.default.getInstance().sendNotification(l.default.UI.PLAY_NEXT_LEVEL)},e.prototype.setReady=function(t){this._closeTime=t,this._ready=!0},e.prototype.afterShow=function(){return a(this,void 0,void 0,function(){var e,o;return s(this,function(n){switch(n.label){case 0:return[4,t.prototype.afterShow.call(this)];case 1:return n.sent(),this.title.scale=.1,e=cc.scaleTo(.3,1.1,1.1),o=cc.scaleTo(.05,1,1),this.title.runAction(cc.sequence(e,o)),[4,u.default.waitFor(.3)];case 2:return n.sent(),[2]}})})},e.prototype.setTitle=function(t){this.title.getComponent(cc.Label).string=t},i([h(cc.Button)],e.prototype,"btnReplay",void 0),i([h(cc.Button)],e.prototype,"btnNext",void 0),i([h(cc.Node)],e.prototype,"bgLayer",void 0),i([h(cc.Node)],e.prototype,"title",void 0),i([f],e)}(c.default);o.default=y,cc._RF.pop()},{"../../../GameKit/App/AppFacade":"AppFacade","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/GamePlay/BaseResultUI":"BaseResultUI","../../../GameKit/Settings/EventTypes":"EventTypes"}],RewardsPopup:[function(t,e,o){"use strict";cc._RF.push(e,"93605vRQaFO1LoPLmbJIS72","RewardsPopup");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GameKit/Share/PopUI"),l=t("../../../GameKit/Framework/Utils/Utils"),u=t("../KittyResouces"),p=t("../../../GameKit/Framework/Utils/ScreenShotNode"),d=t("../../../GameKit/Framework/i18n/i18n"),f=cc._decorator,h=f.ccclass,y=f.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardsAmount=null,e.rewardsUnit=null,e.avatar=null,e.adsIcon=null,e.content=null,e.testSprite=null,e.rewardCallback=null,e._rewardsNode=null,e}return r(e,t),e.prototype.setRewards=function(t,e,o,n){if(this.rewardsAmount.string=t,l.default.isNotUndefinedOrNull(e))this.rewardsUnit.spriteFrame=e;else if(l.default.isNotUndefinedOrNull(o)){var r=u.default.getInstance().getOtherPrefab(o);if(l.default.isNotUndefinedOrNull(r)){var i=cc.instantiate(r);i.parent=this.rewardsUnit.node.parent,i.setPosition(this.rewardsUnit.node.position),n>0&&(i.scale*=n),this.rewardsUnit.node.active=!1,this._rewardsNode=i}}},e.prototype.getRewardsNode=function(){return this._rewardsNode},e.prototype.setAvatar=function(t){this.avatar.spriteFrame=t},e.prototype.setStyle=function(e){t.prototype.setStyle.call(this,e);var o=e;l.default.isUndefinedOrNullOrEmpty(o.rewardsAmount)?console.warn("[RewardsPopup] missing amount in opt: ",e):(o.avatar&&this.setAvatar(o.avatar),o.hideAds?this.showAds(!1):this.showAds(!0),this.setRewards(o.rewardsAmount,o.rewardsImage,o.rewardsPrefabName,o.scale))},e.prototype.showAds=function(t){this.adsIcon.active=t,t||(this.txtYes.node.x=0)},e.prototype._onAction=function(e){var o,n;return a(this,void 0,Promise,function(){var r,i,a,c;return s(this,function(s){switch(s.label){case 0:return this._opt.shouldShare?[4,this.share()]:[3,3];case 1:return r=s.sent(),i=u.default.getInstance().getCoinAssemblyPos(this.getRewardsNode()),a=null===(o=this._opt)||void 0===o?void 0:o.amount,c=null===(n=this._opt)||void 0===n?void 0:n.shareRate,r?(a*=c,u.default.getInstance().playCoinAssemblyFromPos(i),u.default.showToast(d.default.text("msg.thansk.for.share","\u8c22\u8c22\u5206\u4eab\uff0c\u4f60\u5feb\u4e50\u662f\u6211\u4eec\u6700\u5927\u7684\u5feb\u4e50\uff01")),u.default.addCoinToInventory(a)):(u.default.getInstance().playCoinAssemblyFromPos(i),u.default.showToast(d.default.text("msg.for.no.share","\u8c22\u8c22\u652f\u6301\uff0c\u4f60\u5feb\u4e50\u6240\u4ee5\u6211\u5feb\u4e50~")),u.default.addCoinToInventory(a)),[4,this.waitSeconds()];case 2:s.sent(),s.label=3;case 3:return[2,t.prototype._onAction.call(this,e)]}})})},e.prototype.share=function(){return a(this,void 0,Promise,function(){var t,e,o;return s(this,function(n){switch(n.label){case 0:return this.btnYes.node.active=!1,this.btnNo.node.active=!1,t=void 0,e=this.content.getContentSize(),o=this.content.convertToWorldSpaceAR(cc.v2(0,0)),[4,p.default.takeAsync(!1,e,o,.5)];case 1:return n.sent(),[4,p.default.getDataUrl()];case 2:return t=n.sent(),[4,u.default.share(t)];case 3:return n.sent(),console.info("======> rewardsPopup share success"),[2,Promise.resolve(!0)]}})})},e.prototype.waitSeconds=function(){return new Promise(function(t){setTimeout(function(){t()},3e3)})},i([y(cc.Label)],e.prototype,"rewardsAmount",void 0),i([y(cc.Sprite)],e.prototype,"rewardsUnit",void 0),i([y(cc.Sprite)],e.prototype,"avatar",void 0),i([y(cc.Node)],e.prototype,"adsIcon",void 0),i([y(cc.Node)],e.prototype,"content",void 0),i([y(cc.Node)],e.prototype,"testSprite",void 0),i([h],e)}(c.default);o.default=_,cc._RF.pop()},{"../../../GameKit/Framework/Utils/ScreenShotNode":"ScreenShotNode","../../../GameKit/Framework/Utils/Utils":"Utils","../../../GameKit/Framework/i18n/i18n":"i18n","../../../GameKit/Share/PopUI":"PopUI","../KittyResouces":"KittyResouces"}],Role:[function(t,e,o){"use strict";cc._RF.push(e,"db7c92jRX5C05Kq+t43Rl+C","Role");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speed=2560,e.lipstickColor=null,e}return r(e,t),e.prototype.calculateTime=function(t){var e=this.node.getPosition(),o=t.sub(e).mag()/this.speed;return o>.2&&(o=.2),o},e.prototype.moveToAsync=function(t){return a(this,void 0,void 0,function(){var e,o=this;return s(this,function(){return e=this.calculateTime(t),[2,new Promise(function(n){var r=cc.moveTo(e,t),i=cc.callFunc(function(){n()});o.node.runAction(cc.sequence(r,i))})]})})},e.prototype.setColor=function(t){this.lipstickColor.color=t},i([u],e.prototype,"speed",void 0),i([u(cc.Node)],e.prototype,"lipstickColor",void 0),i([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],SceneControl:[function(t,e,o){"use strict";cc._RF.push(e,"1d30dcTqQROOKAfP5B1FVGf","SceneControl");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../View/MediatorComp"),l=t("../../Settings/SceneTypes"),u=t("../../App/AppFacade"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.firstScene=l.default.SPLASH,e.mediators=[],e.adjustForWideScreen=!1,e._started=!1,e}var o;return r(e,t),o=e,e.preloadSceneAsync=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(){return[2,new Promise(function(o){cc.director.preloadScene(t,function(t,o,n){e&&e(t,o,n)},o)})]})})},e.loadSceneAsync=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return e?[4,o.preloadSceneAsync(t)]:[3,3];case 1:return n.sent(),[4,o.loadSceneAsync(t,!1)];case 2:return n.sent(),[3,4];case 3:return[2,new Promise(function(e){cc.director.loadScene(t,function(){u.default.getInstance()&&u.default.getInstance().sendNotification(o.EVENTS.LOADED,t),e()})})];case 4:return[2]}})})},e.prototype._adjustForWideScreen=function(){var t=cc.winSize;t.width/t.height>=.7&&(cc.Canvas.instance.designResolution=cc.size(750,1136),cc.Canvas.instance.fitHeight=!0,cc.Canvas.instance.fitWidth=!1)},e.prototype.onLoad=function(){this.adjustForWideScreen&&this._adjustForWideScreen()},e.prototype.start=function(){u.default.getInstance()?this._onStart():cc.director.getScene().name!=this.firstScene?(console.info("[SceneControl] AppFacade not inited, go back to first scene: ",this.firstScene),cc.director.loadScene(this.firstScene)):console.warn("[SceneControl] First scene doesn't contain AppFacade instance!")},e.prototype._onStart=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this._started=!0,this.registerMediators(),[2]})})},e.prototype.registerMediators=function(){this.mediators.forEach(function(t){t.initOnce()}),this.mediators.forEach(function(t){u.default.getInstance().registerMediator(t)})},e.EVENTS={LOADED:"Scene.Loaded.Event"},i([f],e.prototype,"firstScene",void 0),i([f(c.default)],e.prototype,"mediators",void 0),i([f],e.prototype,"adjustForWideScreen",void 0),o=i([d],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../App/AppFacade":"AppFacade","../../Settings/SceneTypes":"SceneTypes","../View/MediatorComp":"MediatorComp"}],SceneResolution:[function(t,e,o){"use strict";cc._RF.push(e,"f4c463f7+dIuYT0Qmm2BswP","SceneResolution");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.adjustForWideScreen=!1,e}return r(e,t),e.prototype._adjustForWideScreen=function(){var t=cc.winSize,e=t.width/t.height;console.info("[SceneResolution] ratio: ",e,", winSize: ",t),e>=.7&&(cc.Canvas.instance.designResolution=cc.size(750,1136),cc.Canvas.instance.fitHeight=!0,cc.Canvas.instance.fitWidth=!1)},e.prototype.onLoad=function(){this.adjustForWideScreen&&this._adjustForWideScreen()},i([c],e.prototype,"adjustForWideScreen",void 0),i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],SceneTypes:[function(t,e,o){"use strict";cc._RF.push(e,"a5dbf1h9OhBUqW4m4rugkpQ","SceneTypes"),Object.defineProperty(o,"__esModule",{value:!0}),o.default={SPLASH:"Splash",GAME:"Game"},cc._RF.pop()},{}],ScoreLabel:[function(t,e,o){"use strict";cc._RF.push(e,"5b733gpXTtDq437Pyi2rNHo","ScoreLabel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e._playing=!1,e._duration=0,e._interval=0,e._counter=0,e._frameCounter=0,e._frames=0,e}return r(e,t),e.prototype.init=function(){this.label||(this.label=this.getComponent(cc.Label))},e.prototype.update=function(t){if(this._playing&&(this._counter+=t,this._frameCounter+=t,this._interval<=0||this._frameCounter>=this._interval)){if(this._interval<=0)this._frames+=1,this._frameCounter=0;else{var e=Math.floor(this._frameCounter/this._interval);this._frames=this._counter/this._interval,this._frameCounter-=this._frameCounter-this._interval*e}var o=this._updateFunc(this,this._frames);this.setText(o.text),o.stop?this.stop():this._counter>=this._duration&&this.stop()}},e.prototype.play=function(t){this.init(),t&&this.setOpt(t),this._updateFunc?(this.reset(),this._playing=!0):console.warn("[ScoreLabel] missing update function! Cant play")},e.prototype.setOpt=function(t){this.init(),this.label.string=t.startValue,this._duration=t.duration,this._updateFunc=t.updateFunc,this._interval=t.interval,this._onStopFunc=t.onStopFunc},e.prototype.reset=function(){this._counter=0,this._frameCounter=0,this._frames=0},e.prototype.setText=function(t){this.init(),this.label.string=t},e.prototype.stop=function(){this._playing=!1,this._onStopFunc&&this._onStopFunc()},e.prototype.pause=function(){this._playing=!1},e.prototype.resume=function(){this._playing=!0},i([c(cc.Label)],e.prototype,"label",void 0),i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],ScreenShotButton:[function(t,e,o){"use strict";cc._RF.push(e,"b7e1705241J64gGSAjxTXIX","ScreenShotButton");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./ScreenShotNode"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.TakeFullScreen=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,c.default.takeAsync(!1)];case 1:return t.sent(),[4,c.default.downloadAsync()];case 2:return t.sent(),[2]}})})},i([u],e)}(cc.Component));o.default=p,cc._RF.pop()},{"./ScreenShotNode":"ScreenShotNode"}],ScreenShotNode:[function(t,e,o){"use strict";cc._RF.push(e,"35f08x5utNPGJbTUn/T/j/U","ScreenShotNode");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./Utils"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.logoNode=null,e.groups=[],e.testSprite=null,e._size=cc.size(0),e._center=cc.v2(),e._shoted=!1,e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){o._inst=this,this.logoNode.active=!0;var t=this.getComponent(cc.Camera);t||(t=this.addComponent(cc.Camera)),t.enabled=!1,this._camera=t,this._sprite=this.getComponent(cc.Sprite),this.init()},e.prototype.init=function(t,e,o){void 0===t&&(t=cc.size(0)),void 0===e&&(e=cc.v2()),void 0===o&&(o=1),this._camera.zoomRatio=o,(t.width<=0||t.height<=0)&&(t.width=cc.winSize.width,t.height=cc.winSize.height),this._texture&&this._texture.destroy();var n=new cc.RenderTexture;n.initWithSize(t.width*o,t.height*o,cc.game._renderContext.STENCIL_INDEX8),this._texture=n,this._camera.targetTexture=n,this._size=t,this._center.equals(e)||(this.node.setPosition(e),this._center=e)},e.prototype._shotAsync=function(t,e,o,n){return void 0===t&&(t=!0),void 0===e&&(e=cc.size(0)),void 0===o&&(o=cc.v2()),void 0===n&&(n=1),a(this,void 0,void 0,function(){return s(this,function(r){switch(r.label){case 0:return this.init(e,o,n),this.logoNode?t?(this.logoNode.active=!0,[4,c.default.waitFor(1)]):[3,2]:[3,3];case 1:return r.sent(),[3,3];case 2:this.logoNode.active=!1,r.label=3;case 3:return this._camera.render(void 0),this.logoNode&&(this.logoNode.active=!1),this._shotTime=Date.now(),this._shoted=!0,console.info("[Screenshot] taked"),[2]}})})},e.prototype._shotGroupAsync=function(t,e){return void 0===e&&(e=!0),a(this,void 0,void 0,function(){var o;return s(this,function(n){switch(n.label){case 0:return t<0&&t>=this.groups.length?(console.warn("[Screenshot] invalid group idx: ",t),[2]):((o=this.groups[t]).active=!0,[4,c.default.waitFor(.1)]);case 1:return n.sent(),[4,this._shotAsync(e,cc.size(o.width,o.height),o.getPosition())];case 2:return n.sent(),o.active=!1,[2]}})})},e.prototype._toSpriteFrameAsync=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return this._spriteFrame?[2,this._spriteFrame]:[2,new Promise(function(e){var o=new Image;o.src=t._dataUrl;var n=t;o.onload=function(){var t=new cc.Texture2D;t.initWithElement(o),t.handleLoadedTexture();var r=new cc.SpriteFrame(t);n._spriteFrame=r,e(r),console.info("[Screenshot] spriteframe ready")}})]})})},e.prototype._downloadImgAsync=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(){return e=t.replace(/^data:image[^;]*/,"data:image/octet-stream"),document.location.href=e,[2]})})},e.prototype._toDataUrlAsync=function(){return a(this,void 0,void 0,function(){var t,e,o,n,r,i,a,c,l,u,p,d,f;return s(this,function(){for(t=this._texture,e=t.readPixels(),o=t.width,n=t.height,r=document.createElement("canvas"),i=r.getContext("2d"),r.width=o,r.height=n,a=4*o,c=0;c<n;c++){for(l=n-1-c,u=i.createImageData(o,1),p=l*o*4,d=0;d<a;d++)u.data[d]=e[p+d];i.putImageData(u,0,c)}return f=r.toDataURL("image/jpeg"),this._dataUrl=f,[2,f]})})},e.prototype._clear=function(){this._shoted=!1,this._dataUrl=void 0,this._spriteFrame=void 0},e.takeAsync=function(t,e,n,r){return void 0===t&&(t=!0),void 0===e&&(e=cc.size(0)),void 0===n&&(n=cc.v2()),void 0===r&&(r=1),a(this,void 0,void 0,function(){return s(this,function(i){switch(i.label){case 0:return[4,o._inst._shotAsync(t,e,n,r)];case 1:return[2,i.sent()]}})})},e.clear=function(){o._inst._clear()},e.isTaken=function(){return o._inst._shoted},e.getShotTime=function(){return o._inst._shotTime},e.getDataUrl=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,o._inst._toDataUrlAsync()];case 1:return t.sent(),[2,o._inst._dataUrl]}})})},e.getTexture=function(){return o._inst._texture},e.getSpriteFrame=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return o.isTaken()?[4,o._inst._toSpriteFrameAsync()]:[2];case 1:return[2,t.sent()]}})})},e.downloadAsync=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return o.isTaken()?[4,o.getDataUrl()]:[2];case 1:return t=e.sent(),[4,o._inst._downloadImgAsync(t)];case 2:return e.sent(),[2]}})})},e.downloadDataUrlAsync=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,o._inst._downloadImgAsync(t)];case 1:return e.sent(),[2]}})})},e.takeGroup=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,o._inst._shotGroupAsync(t,e)];case 1:return[2,n.sent()]}})})},i([p(cc.Node)],e.prototype,"logoNode",void 0),i([p(cc.Node)],e.prototype,"groups",void 0),i([p(cc.Node)],e.prototype,"testSprite",void 0),o=i([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./Utils":"Utils"}],ScreenShot:[function(t,e,o){"use strict";cc._RF.push(e,"4140ed/lU9NRoFdKb7Y7Ln2","ScreenShot");var n=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,i=r.ccclass,a=(r.property,function(){function t(){}return t.take=function(){var t=new cc.Node;t.parent=cc.director.getScene();var e=t.addComponent(cc.Camera);e.cullingMask=4294967295,e.backgroundColor=cc.Color.BLUE;var o=new cc.RenderTexture;cc.game._renderContext,o.initWithSize(cc.view.getViewportRect().width,cc.view.getViewportRect().height),e.targetTexture=o,e.render(void 0);var n=o.readPixels(),r=cc.director.getWinSize().width,i=cc.director.getWinSize().height,a=document.createElement("canvas"),s=a.getContext("2d");a.width=o.width,a.height=o.height;for(var c=4*r,l=0;l<i;l++){for(var u=i-1-l,p=s.createImageData(r,1),d=u*r*4,f=0;f<c;f++)p.data[f]=n[d+f];s.putImageData(p,0,l)}var h=a.toDataURL("image/jpeg");this.downloadImg(h),t.destroy()},t.base64ToSpriteFrame=function(t,e){var o=new Image;o.src=t,o.onload=function(){var t=new cc.Texture2D;t.initWithElement(o),t.handleLoadedTexture();var n=new cc.SpriteFrame(t);e&&e(n)}},t.downloadImg=function(t){var e=t.replace(/^data:image[^;]*/,"data:image/octet-stream");document.location.href=e},n([i],t)}());o.default=a,cc._RF.pop()},{}],Settings:[function(t,e,o){"use strict";cc._RF.push(e,"22efbu//gNJSJRR4oy3fqY7","Settings"),Object.defineProperty(o,"__esModule",{value:!0}),o.default={RANK_INIT_COUNT:30,INVINCIBLE:0,INPUT_MOVE_MIN:.5,INPUT_MOVE_MAX:10,INPUT_MOVE_SCALE:20,LEVEL_DIFFICULTIY:-1,LEVEL_MIN_SAFES:1,LEVEL_MIN_EXITS:1,LEVEL_MAX_SAFES:0,LEVEL_MAX_EXITS:0,LEVEL_SAFE_RATE:1,LEVEL_EXIT_RATE:1,LEVEL_DANGER_RATE:1,LEVEL_TYPE:0,LEVEL_NORMAL_GROUP_RATE:1,LEVEL_FUN_GROUP_RATE:1,LEVEL_DANGER_GROUP_RATE:1,LEVEL_GROUP_LINES:20,MIN_PRESURE:5},cc._RF.pop()},{}],ShopDB:[function(t,e,o){"use strict";cc._RF.push(e,"9d4077LNhJON7G7lg1XLiYN","ShopDB");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=(i.ccclass,i.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.getInstance=function(){return e._inst},e.prototype.getListByCategory=function(){return[]},e.prototype.getConfigById=function(){},e.idToCategory=function(){return 0},e}(cc.Component));o.default=a,cc._RF.pop()},{}],ShopItemAction:[function(t,e,o){"use strict";cc._RF.push(e,"da0a0DE2I5IVZEdiHnc2iuu","ShopItemAction");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Framework/Utils/Utils"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtAction=null,e.txtPrice=null,e.btnBuy=null,e.btnSelect=null,e._itemId=0,e._buyCallback=void 0,e._selectCallback=void 0,e}return r(e,t),e.prototype.showBuy=function(t,e,o){this.node.active=!0,this._itemId=t,this.btnSelect.node.active=!1,this.btnBuy.node.active=!0,this.txtAction.string=o,this.txtPrice.string=e.toString()},e.prototype.showSelect=function(t,e){this.node.active=!1,this._itemId=t,this.btnSelect.node.active=!0,this.btnBuy.node.active=!1,this.txtAction.string=e},e.prototype.onBuy=function(){a.default.isNotUndefinedOrNull(this._buyCallback)&&this._buyCallback(this._itemId)},e.prototype.onSelect=function(){a.default.isNotUndefinedOrNull(this._selectCallback)&&this._selectCallback(this._itemId)},e.prototype.setBuyCallback=function(t){this._buyCallback=t},e.prototype.setSelectCallback=function(t){this._selectCallback=t},i([l(cc.Label)],e.prototype,"txtAction",void 0),i([l(cc.Label)],e.prototype,"txtPrice",void 0),i([l(cc.Button)],e.prototype,"btnBuy",void 0),i([l(cc.Button)],e.prototype,"btnSelect",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../Framework/Utils/Utils":"Utils"}],ShopMediator:[function(t,e,o){"use strict";cc._RF.push(e,"a7500x/X6VEK7U6v9cmlOoT","ShopMediator");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Framework/View/UIMediator"),l=t("../Account/InventoryProxy"),u=cc._decorator,p=u.ccclass,d=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.initEvents=function(){this.addEvent(l.default.EVENTS.OWN_NEW_PROP)},e.prototype.handleNotification=function(t){var e=t.getUserData();switch(t.type){case l.default.EVENTS.OWN_NEW_PROP:this.onNewPropOwned(e)}},e.prototype.onEndMatch=function(){this.ui.refresh(!1)},e.prototype.onNewPropOwned=function(){this.ui.refresh(!0)},e.prototype.open=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.ui.node.active||this.show(!1),this.ui.close(!1),[2]})})},e.prototype.close=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.ui.node.active||this.show(!1),[4,this.ui.close(!0)];case 1:return t.sent(),[2]}})})},i([p],e)}(c.default));o.default=d,cc._RF.pop()},{"../Account/InventoryProxy":"InventoryProxy","../Framework/View/UIMediator":"UIMediator"}],ShopPage:[function(t,e,o){"use strict";cc._RF.push(e,"da10fo5BddK4Z8jDEN0eavO","ShopPage");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./ShopItemAction"),s=t("../Framework/Utils/Utils"),c=t("../App/AppFacade"),l=t("../Settings/CommandTypes"),u=t("../Settings/ProxyTypes"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.proxyName="",e.txtPage=null,e.itemPrefab=null,e.itemNodes=[],e.shopAction=null,e.progress=null,e._page=0,e._proxy=null,e._items=[],e._selectedItemId=0,e}return r(e,t),e.prototype.initOnce=function(){this._initProxy()?(this._initItems(),this._initAction(),this.progress&&this._updateProress(),this.goToSelectedItem()):console.warn("shop proxy is not ready")},e.prototype.onClose=function(t){this.shopAction.node.active=!t,t?this.applyOrRestore():this.refresh()},e.prototype.nextPage=function(){this.goPage(this._page+1)},e.prototype.prePage=function(){this.goPage(this._page-1)},e.prototype.goToSelectedItem=function(){for(var t=this._proxy.getItems(),e=this.itemNodes.length,o=void 0,n=0,r=0;r<t.length;r++)if(t[r].selected){o=t[r],n=r;break}var i=Math.floor(n/e);this.goPage(i),this._onItemSelected(o.id)},e.prototype.goPage=function(t){var e=this._proxy.getItems(),o=this.itemNodes.length,n=Math.ceil(e.length/o);t<0?t=n-1:t==n&&(t=0),this._page=t,this.updateItemList()},e.prototype._initProxy=function(){return s.default.isUndefinedOrNull(this._proxy)&&(this._proxy=c.default.getInstance().retrieveProxy(this.proxyName)),s.default.isNotUndefinedOrNull(this._proxy)},e.prototype._initItems=function(){for(var t=this.itemNodes.length,e=0;e<t;e++){var o=this.itemNodes[e],n=cc.instantiate(this.itemPrefab);n.active=!0,n.parent=o,n.setPosition(0,0),this._items.push(n),n.on("item.selected",this._onItemSelected,this)}},e.prototype._initAction=function(){this.shopAction.setBuyCallback(this._onBuyAction.bind(this)),this.shopAction.setSelectCallback(this._onSelectAction.bind(this))},e.prototype.updateItemList=function(){for(var t=this._proxy.getItems(),e=this.itemNodes.length,o=this._page,n=Math.ceil(t.length/e),r=e*o,i=0;i<this._items.length;i++){var a=this._items[i];if(i+r<t.length){var s=t[i+r];this._updateItem(a,s)}else this._updateItem(a,void 0)}this.txtPage.string=o+1+"/"+n},e.prototype._updateAction=function(){},e.prototype._onBuyAction=function(t){c.default.getInstance().executeCommand(l.default.BUY_PROP,{item:t})},e.prototype._onSelectAction=function(t){c.default.getInstance().retrieveProxy(u.default.PLAYER).useProp(t)},e.prototype._onItemSelected=function(t){0!=t&&(this._selectedItemId=t,this._updateAction(t))},e.prototype._updateProress=function(){},e.prototype.refresh=function(t){this._updateProress(),this.updateItemList(),this._updateAction(this._selectedItemId),t&&this._selectedItemId>0&&this._onItemSelected(this._selectedItemId)},i([f],e.prototype,"proxyName",void 0),i([f(cc.Label)],e.prototype,"txtPage",void 0),i([f(cc.Prefab)],e.prototype,"itemPrefab",void 0),i([f(cc.Node)],e.prototype,"itemNodes",void 0),i([f(a.default)],e.prototype,"shopAction",void 0),i([f(cc.Label)],e.prototype,"progress",void 0),i([d],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../App/AppFacade":"AppFacade","../Framework/Utils/Utils":"Utils","../Settings/CommandTypes":"CommandTypes","../Settings/ProxyTypes":"ProxyTypes","./ShopItemAction":"ShopItemAction"}],ShopProxy:[function(t,e,o){"use strict";cc._RF.push(e,"5ce473r6SxODIEuRet3rEG+","ShopProxy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,t("../Framework/Model/Proxy")),l=t("../Settings/ProxyTypes"),u=t("../Framework/Utils/Utils"),p=t("./ShopDB"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._items=[],e}var o;return r(e,t),o=e,e.create=function(t,e){var n=new o;return n.name=t,n.initWithCategory(e),n},e.prototype.initWithCategory=function(t){this._items=p.default.getInstance().getListByCategory(t)},e.prototype.getItems=function(){for(var t=this.getFacade().retrieveProxy(l.default.INVENTORY),e=this.getFacade().retrieveProxy(l.default.PLAYER),o=[],n=0;n<this._items.length;n++){var r=this._items[n];r.owned=t.isPropOwned(r.id),r.selected=e.isPropSelected(r.id);var i=p.default.getInstance().getConfigById(r.id);u.default.isNotUndefinedOrNull(i)&&u.default.isNotUndefinedOrNull(i.price)?r.price=i.price:r.price=0,o.push(r)}return o},e.prototype.getItemById=function(t){for(var e=this.getFacade().retrieveProxy(l.default.INVENTORY),o=this.getFacade().retrieveProxy(l.default.PLAYER),n=void 0,r=0;r<this._items.length;r++)if(this._items[r].id==t){(n=this._items[r]).owned=e.isPropOwned(n.id),n.selected=o.isPropSelected(n.id);var i=p.default.getInstance().getConfigById(n.id);n.price=i.price;break}return n},o=i([s],e)}(c.default);o.default=d,cc._RF.pop()},{"../Framework/Model/Proxy":"Proxy","../Framework/Utils/Utils":"Utils","../Settings/ProxyTypes":"ProxyTypes","./ShopDB":"ShopDB"}],ShopUI:[function(t,e,o){"use strict";cc._RF.push(e,"75369jlAuRDfKVYzwggLSNh","ShopUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../App/AppFacade"),l=t("../Framework/View/BaseUI"),u=t("../Settings/ProxyTypes"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnClose=null,e.btnOpen=null,e.weaponToggle=null,e.skinToggle=null,e.emojiToggle=null,e.newWeaponMark=null,e.newSkinMark=null,e.newEmojiMark=null,e.edgeOffset=100,e.onPosition=-320,e.eventBlocker=null,e._isClosed=!1,e}var o;return r(e,t),o=e,e.prototype.initOnce=function(){t.prototype.initOnce.call(this),this.checkNewItemMarkState(),this.onTabToggle(),this.btnClose.isChecked=!1},e.prototype.onClose=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return t.isChecked?this.close(!1):this.close(!0),[2]})})},e.prototype.close=function(t){return a(this,void 0,void 0,function(){var e,n;return s(this,function(r){switch(r.label){case 0:return c.default.getInstance().sendNotification(t?o.EVENTS.CLOSE:o.EVENTS.OPEN),this._isClosed==t?[2]:(this._isClosed=t,t?(this.node.y=-cc.winSize.height/2+this.edgeOffset-this.node.height/2,this.btnOpen.enabled=!0):(this.node.y=this.onPosition,this.btnOpen.enabled=!1),this.eventBlocker.active=!t,t?(e=c.default.getInstance().retrieveProxy(u.default.PLAYER),n=c.default.getInstance().retrieveProxy(u.default.INVENTORY),[4,e.save()]):[3,3]);case 1:return r.sent(),[4,n.save()];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.onBtnOpen=function(){this.close(!1),this.btnClose.isChecked=!0},e.prototype.onTabToggle=function(){},e.prototype._showPage=function(){},e.prototype.refresh=function(){this.checkNewItemMarkState()},e.prototype.checkNewItemMarkState=function(){},e.EVENTS={OPEN:"Shop.Open.Event",CLOSE:"Shop.Close.Event"},i([f(cc.Toggle)],e.prototype,"btnClose",void 0),i([f(cc.Button)],e.prototype,"btnOpen",void 0),i([f(cc.Toggle)],e.prototype,"weaponToggle",void 0),i([f(cc.Toggle)],e.prototype,"skinToggle",void 0),i([f(cc.Toggle)],e.prototype,"emojiToggle",void 0),i([f(cc.Node)],e.prototype,"newWeaponMark",void 0),i([f(cc.Node)],e.prototype,"newSkinMark",void 0),i([f(cc.Node)],e.prototype,"newEmojiMark",void 0),i([f],e.prototype,"edgeOffset",void 0),i([f],e.prototype,"onPosition",void 0),i([f(cc.Node)],e.prototype,"eventBlocker",void 0),o=i([d],e)}(l.default);o.default=h,cc._RF.pop()},{"../App/AppFacade":"AppFacade","../Framework/View/BaseUI":"BaseUI","../Settings/ProxyTypes":"ProxyTypes"}],SimpleCommand:[function(t,e,o){"use strict";cc._RF.push(e,"10e67SiIhxDnbvskQ/9h9T6","SimpleCommand");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){},e.prototype.execute=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.runCommand=function(t,e){return i(this,void 0,void 0,function(){var o;return a(this,function(n){switch(n.label){case 0:return t.isQuickClass?[4,t.execute(e)]:[3,2];case 1:return n.sent(),[3,6];case 2:return"string"!=typeof t?[3,4]:[4,this.getFacade().executeCommand(t,e)];case 3:return n.sent(),[3,6];case 4:return(o=new t).init(),[4,o.execute(e)];case 5:n.sent(),n.label=6;case 6:return[2]}})})},e.prototype.hasProxy=function(t){return this.getFacade().hasProxy(t)},e.prototype.retrieveProxy=function(t){return this.getFacade().retrieveProxy(t)},e.prototype.hasMediator=function(t){return this.getFacade().hasMediator(t)},e.prototype.retrieveMediator=function(t){return this.getFacade().retrieveMediator(t)},e.createQuickCommand=function(t){return c.create(t)},e}(t("../Observer/Notifier").default);o.default=s;var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isQuickClass=!0,e}return r(e,t),e.create=function(t){var o=new e;return o.onNotification=t,o},e.prototype.execute=function(t){return i(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this.onNotification?[4,this.onNotification(t)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e}(s);cc._RF.pop()},{"../Observer/Notifier":"Notifier"}],SingleNode:[function(t,e,o){"use strict";cc._RF.push(e,"eefb96d/YdPJajeJQwY+XQw","SingleNode");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Utils/Utils"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="",e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){c.default.isUndefinedOrNullOrEmpty(this.key)&&(this.key=this.node.name),cc.js.array.contains(o._map,this.key)?(this.node.active=!1,this.node.destroy()):(cc.game.addPersistRootNode(this.node),o._map.push(this.key),this._onloaded())},e.prototype._onloaded=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e._map=[],i([p],e.prototype,"key",void 0),o=i([u],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../Utils/Utils":"Utils"}],Splash:[function(t,e,o){"use strict";cc._RF.push(e,"84ea45h1/tK9IgocyM0W3kx","Splash");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.childNodes=[],e.logo=null,e}return r(e,t),e.prototype.start=function(){this.fadeToClose()},e.prototype.StartGame=function(){this.node.active=!1},e.prototype.fadeToClose=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(){return t=this,[2,new Promise(function(){var e=cc.fadeTo(2,200),o=cc.fadeTo(1,0),n=cc.fadeTo(.5,0),r=cc.callFunc(function(){t.StartGame()});t.node.runAction(cc.sequence(e,o,r)),t.logo&&t.logo.runAction(cc.sequence(e.clone(),n.clone()));for(var i=0;i<t.childNodes.length;i++)t.childNodes[i].runAction(cc.sequence(e.clone(),o.clone()))})]})})},i([u(cc.Node)],e.prototype,"childNodes",void 0),i([u(cc.Node)],e.prototype,"logo",void 0),i([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],StartScene:[function(t,e,o){"use strict";cc._RF.push(e,"9bdd1chBUZIcJ5kRcvMJLAZ","StartScene");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../Kitty/Script/Data/KittyConfig"),l=t("../Framework/Utils/Utils"),u=t("../Tpcl/Baidu/Baidu"),p=cc._decorator,d=p.ccclass,f=p.property;function h(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return[2,new Promise(function(e){(void 0).loadSubpackage({name:t.subPackage,success:function(){e(!0)},fail:function(){e(!1)}}).onProgressUpdate(function(t){console.log("\u4e0b\u8f7d\u8fdb\u5ea6",t.progress),console.log("\u5df2\u7ecf\u4e0b\u8f7d\u7684\u6570\u636e\u957f\u5ea6",t.totalBytesWritten),console.log("\u9884\u671f\u9700\u8981\u4e0b\u8f7d\u7684\u6570\u636e\u603b\u957f\u5ea6",t.totalBytesExpectedToWrite)})})]})})}var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nextScene="",e.enableSubPacakge=!1,e.subPackage="GamePackage",e.infoLabel=null,e.versionLabel=null,e.progressBar=null,e}return r(e,t),e.prototype.onLoad=function(){this.versionLabel&&(this.versionLabel.string=c.default.Version()),this.progressBar.node.active=!1,this.progressBar.progress=0},e.prototype.start=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this._loadSubPackage()];case 1:return t.sent(),[4,this._loadNextScene()];case 2:return t.sent(),[2]}})})},e.prototype._loadSubPackage=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return this.progressBar.node.active=!0,this.progressBar.progress=.1,!this.enableSubPacakge||l.default.isUndefinedOrNullOrEmpty(this.subPackage)?[3,4]:(t="loading ["+this.subPackage+"]",this.infoLabel.string=t,console.info(t),c.default.isBaidu()?[4,u.default.loadPackage(this.subPackage)]:[3,2]);case 1:return e.sent(),[3,4];case 2:return c.default.isWechat()?[4,h(this.subPackage)]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2]}})})},e.prototype._loadNextScene=function(){return a(this,void 0,void 0,function(){var t,e=this;return s(this,function(){return t=this,this.infoLabel.string="preload scene ["+t.nextScene+"]",cc.director.preloadScene(this.nextScene,function(o,n){var r="preload scene ["+t.nextScene+"] "+o+"/"+n,i=n>0?o/n:1;(i=Math.floor(10*i)/10)<.1&&(i=.1),e.progressBar.progress=i,t.infoLabel.string=r},function(o){var n="preload scene ["+t.nextScene+"] done, Success: "+(null==o);null!=o?(e.infoLabel.string="ERROR: "+o.toString(),console.error(n,o)):(console.info(n),cc.director.loadScene(t.nextScene))}),this.infoLabel.string="preload scene ["+t.nextScene+"] ...",[2]})})},i([f],e.prototype,"nextScene",void 0),i([f],e.prototype,"enableSubPacakge",void 0),i([f],e.prototype,"subPackage",void 0),i([f(cc.Label)],e.prototype,"infoLabel",void 0),i([f(cc.Label)],e.prototype,"versionLabel",void 0),i([f(cc.ProgressBar)],e.prototype,"progressBar",void 0),i([d],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../Kitty/Script/Data/KittyConfig":"KittyConfig","../Framework/Utils/Utils":"Utils","../Tpcl/Baidu/Baidu":"Baidu"}],TableViewCell:[function(t,e,o){"use strict";cc._RF.push(e,"ca6e8BZfjpBgopHbJdjHPke","TableViewCell");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=(a.inspector,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e}return r(e,t),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),e.prototype.setIndex=function(t){this._index=t},e.prototype.updateData=function(t,e){this._index=t,this._data=e,this.label&&(this.label.string=t.toString())},i([c(cc.Label)],e.prototype,"label",void 0),i([s],e)}(cc.Component));o.default=l,cc._RF.pop()},{}],TableView:[function(t,e,o){"use strict";cc._RF.push(e,"1023bjuNLRPS6DakK3kWF7j","TableView");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./TableViewCell"),s=cc._decorator,c=s.ccclass,l=s.property,u=(s.inspector,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cellPrefab=null,e.rightLeftOrBottomUp=!1,e.cellPerRow=1,e.testMode=!1,e.testCount=20,e.testMoveToCell=10,e._data=[],e._cellCount=0,e._rows=0,e._shouldUpdate=!0,e._moveDirection=cc.v2(),e._inited=!1,e}var o;return r(e,t),o=e,e.prototype.isInited=function(){return this._inited},e.prototype.onLoad=function(){var t=this,e=this.node.destroy;this.node.destroy=function(){return t.clear(),e.call(t.node)};var o=this.node._onPreDestroy;if(this.node._onPreDestroy=function(){return t.clear(),o.call(t.node)},this.testMode){for(var n=new Array(this.testCount),r=0;r<n.length;r++)n[r]={id:r};this.initTableView(n),this.moveToCell(this.testMoveToCell)}},e.prototype.initTableView=function(t){this._inited=!0,this._poolName=this.cellPrefab.name,this._cellPool=this._getPool(),this._viewSize=this.content.parent.getContentSize(),this.horizontal?(this.content.anchorX=0,this.content.anchorY=.5,this.vertical=!1):(this.content.anchorX=.5,this.content.anchorY=0,this.vertical=!0),this.verticalScrollBar&&this.verticalScrollBar.node.on("size-changed",function(){this._updateScrollBar(this._getHowMuchOutOfBoundary())},this),this.horizontalScrollBar&&this.horizontalScrollBar.node.on("size-changed",function(){this._updateScrollBar(this._getHowMuchOutOfBoundary())},this),this.node.getComponent(cc.Widget)&&this.node.getComponent(cc.Widget).updateAlignment();var e=this._getCell();this._cellSize=e.getContentSize(),this._cellPool.put(e),this._data=t,this._initCells(),this.stopAutoScroll(),this.horizontal?this.rightLeftOrBottomUp?this.scrollToRight():this.scrollToLeft():this.rightLeftOrBottomUp||this.scrollToTop(),this._lastOffset=this.getScrollOffset(),this._updateCells()},e.prototype._getPool=function(){var t=o._pools[this._poolName];return t||(t=new cc.NodePool(this._poolName),o._pools[this._poolName]=t),t},e.prototype._getCell=function(){if(0===this._cellPool.size()){var t=cc.instantiate(this.cellPrefab);this._cellPool.put(t)}return this._cellPool.get()},e.prototype._initCells=function(){var t=(this.horizontal?Math.ceil(this._viewSize.width/this._cellSize.width)+1:Math.ceil(this._viewSize.height/this._cellSize.height)+1)*this.cellPerRow,e=Math.ceil(this._data.length/this.cellPerRow);this.horizontal?(this.content.width=this._cellSize.width*e,this.content.height=this._cellSize.height*this.cellPerRow,this.content.y=0):(this.content.height=this._cellSize.height*e,this.content.width=this._cellSize.width*this.cellPerRow,this.content.x=0),this._rows=e,this._cellCount=t;for(var o=0;o<t;o++){var n=this._getCell();n.parent=this.content;var r=n.getComponent(a.default);this._setCell(r,o)}},e.prototype.clear=function(){for(var t=this.content.childrenCount-1;t>=0;--t)this._cellPool.put(this.content.children[t])},e.prototype.reload=function(t){this.clear(),this._data=t,this._initCells(),this._updateCells()},e.prototype._onTouchBegan=function(e,o){t.prototype._onTouchBegan.call(this,e,o),this._touchstart(e)},e.prototype._onTouchMoved=function(e,o){t.prototype._onTouchMoved.call(this,e,o),this._touchmove(e)},e.prototype._onTouchEnded=function(e,o){t.prototype._onTouchEnded.call(this,e,o),this._touchend(e)},e.prototype._onTouchCancelled=function(e,o){t.prototype._onTouchCancelled.call(this,e,o),this._touchend(e)},e.prototype.stopAutoScroll=function(){t.prototype.stopAutoScroll.call(this)},e.prototype.scrollToBottom=function(e,o){t.prototype.scrollToBottom.call(this,e,o)},e.prototype.scrollToTop=function(e,o){t.prototype.scrollToTop.call(this,e,o)},e.prototype.scrollToLeft=function(e,o){t.prototype.scrollToLeft.call(this,e,o)},e.prototype.scrollToRight=function(e,o){t.prototype.scrollToRight.call(this,e,o)},e.prototype.scrollToOffset=function(e,o,n){this.getScrollOffset(),t.prototype.scrollToOffset.call(this,e,o,n)},e.prototype._touchstart=function(){},e.prototype._touchmove=function(){this._shouldUpdate=!0},e.prototype._touchend=function(){this._shouldUpdate=!0},e.prototype._checkDirection=function(){var t=this.getScrollOffset(),e=t.sub(this._lastOffset);this._lastOffset=t,this._moveDirection=e,this._shouldUpdate||e.mag()>0&&(this._shouldUpdate=!0)},e.prototype.update=function(e){t.prototype.update.call(this,e),this._inited&&(this._checkDirection(),this._shouldUpdate&&(this._updateCells(),this._shouldUpdate=!1))},e.prototype._updateCells=function(){var t=cc.v2(-this._viewSize.width/2,-this._viewSize.height/2),e=cc.v2(this._viewSize.width/2,this._viewSize.height/2);t=this.content.parent.convertToWorldSpaceAR(t),e=this.content.parent.convertToWorldSpaceAR(e);for(var o=this.content.childrenCount-1;o>=0;o--){var n=this.content.children[o];this._updateCell(o,n,this._moveDirection,t,e)}},e.prototype._updateCell=function(t,e,o,n,r){var i=e.getBoundingBoxToWorld(),s=e.getComponent(a.default);if(this.horizontal){if(this.rightLeftOrBottomUp){if(o.x>=0){if(i.xMin>r.x){for(c=s.index+this._cellCount,i.xMin-=this._cellSize.width*this._cellCount;i.xMin>r.x;)c+=this._cellCount,i.xMin-=this._cellSize.width*this._cellCount;this._setCell(s,c)}}else if(o.x<0&&i.xMax<n.x){for(c=s.index-this._cellCount,i.xMax+=this._cellSize.width*this._cellCount;i.xMax<n.x;)c-=this._cellCount,i.xMax+=this._cellSize.width*this._cellCount;this._setCell(s,c)}}else if(o.x>=0){if(i.xMin>r.x){var c=s.index-this._cellCount;for(i.xMin-=this._cellSize.width*this._cellCount;i.xMin>r.x;)c-=this._cellCount,i.xMin-=this._cellSize.width*this._cellCount;this._setCell(s,c)}}else if(o.x<0&&i.xMax<n.x){c=s.index+this._cellCount;for(i.xMax+=this._cellSize.width*this._cellCount;i.xMax<n.x;)c+=this._cellCount,i.xMax+=this._cellSize.width*this._cellCount;this._setCell(s,c)}}else if(this.rightLeftOrBottomUp){if(o.y>=0){if(i.yMin>r.y){for(c=s.index-this._cellCount,i.yMin-=this._cellSize.height*this._cellCount;i.yMin>r.y;)c-=this._cellCount,i.yMin-=this._cellSize.height*this._cellCount;this._setCell(s,c)}}else if(o.y<0&&i.yMax<n.y){for(c=s.index+this._cellCount,i.yMax+=this._cellSize.height*this._cellCount;i.yMax<n.y;)c+=this._cellCount,i.yMax+=this._cellSize.height*this._cellCount;this._setCell(s,c)}}else if(o.y>=0){if(i.yMin>r.y){for(c=s.index+this._cellCount,i.yMin-=this._cellSize.height*this._cellCount;i.yMin>r.y;)c+=this._cellCount,i.yMin-=this._cellSize.height*this._cellCount;this._setCell(s,c)}}else if(o.y<0&&i.yMax<n.y){for(c=s.index-this._cellCount,i.yMax+=this._cellSize.height*this._cellCount;i.yMax<n.y;)c-=this._cellCount,i.yMax+=this._cellSize.height*this._cellCount;this._setCell(s,c)}},e.prototype._setCell=function(t,e){t.node.name=this.cellPrefab.name+"-"+e;var o=this.getCellPosition(e,this.horizontal);t.node.position=o;var n=void 0;e>=0&&e<this._data.length&&(n=this._data[e]),n?(t.updateData(e,n,!0),t.node.active=!0):(t.node.active=!1,t.setIndex(e))},e.prototype.getCellPosition=function(t,e){var o=cc.v2(),n=Math.floor(t/this.cellPerRow),r=t%this.cellPerRow;return e?(o.x=this._cellSize.width*(n+.5),r=this.cellPerRow-r,o.y=this._cellSize.height*(r-this.cellPerRow/2-.5),this.rightLeftOrBottomUp&&(o.x=this.content.width-o.x)):(o.y=this._cellSize.height*(n+.5),o.x=this._cellSize.width*(r-this.cellPerRow/2+.5),this.rightLeftOrBottomUp||(o.y=this.content.height-o.y)),o},e.prototype.moveToCell=function(t){var e=this.getCellPosition(t,this.horizontal);if(this.horizontal){var o=e.x;this.rightLeftOrBottomUp?(o-=this._viewSize.width,o+=this._cellSize.width/2):o-=this._cellSize.width/2,this.scrollToOffset(cc.v2(o,0))}else{var n=this.content.height-e.y;this.rightLeftOrBottomUp?(n-=this._viewSize.height,n+=this._cellSize.height/2):n-=this._cellSize.height/2,this.scrollToOffset(cc.v2(0,n))}this._checkDirection(),this._updateCells(),this._test()},e.prototype._test=function(){for(var t=this.content.childrenCount-1;t>=0;t--)this.content.children[t].getComponent(a.default)},e._pools={},i([l(cc.Prefab)],e.prototype,"cellPrefab",void 0),i([l({displayName:"\u662f\u5426\u53cd\u5411\u6392\u5217",tooltip:"\u4ece\u53f3\u5230\u5de6\uff0c\u4ece\u4e0b\u5230\u4e0a"})],e.prototype,"rightLeftOrBottomUp",void 0),i([l({displayName:"\u6bcf\u884c/\u5217\u7684\u5b50\u9879\u6570",tooltip:"\u7528\u4e8e\u652f\u6301Grid\u6a21\u5f0f\u7684tableview"})],e.prototype,"cellPerRow",void 0),i([l],e.prototype,"testMode",void 0),i([l],e.prototype,"testCount",void 0),i([l],e.prototype,"testMoveToCell",void 0),o=i([c],e)}(cc.ScrollView));o.default=u,cc._RF.pop()},{"./TableViewCell":"TableViewCell"}],TempAds:[function(t,e,o){"use strict";cc._RF.push(e,"eb515qW0VdCbrKfGvC/uXRk","TempAds");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){}return t.prototype.init=function(){},t.prototype.isBannerReady=function(){},t.prototype.showBanner=function(){},t.prototype.hideBanner=function(){},t.prototype.isInterstitialReady=function(){return!1},t.prototype.loadInterstitial=function(){},t.prototype.showInterstitial=function(){},t.prototype.isVideoReady=function(){return!0},t.prototype.loadVideo=function(){},t.prototype.showVideo=function(){return n(this,void 0,void 0,function(){return r(this,function(){return[2,!0]})})},t}();o.default=i,cc._RF.pop()},{}],TempLogger:[function(t,e,o){"use strict";cc._RF.push(e,"ba91fQ9M6tDfIazWIDtNU0u","TempLogger"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.logEvent=function(t){t&&console.log("[Event: "+t.name+"] value: ",t.valueToSum,t.param)},t}();o.default=n,cc._RF.pop()},{}],TimeCounter:[function(t,e,o){"use strict";cc._RF.push(e,"9d072+GkSZO0Y82vMSpm7bK","TimeCounter");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../GameKit/Framework/Utils/Utils"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeText=null,e.background=null,e.progress=null,e.totalTime=null,e.showTotal=!1,e._counter=0,e._started=!1,e._isCountdown=!1,e._targetTime=0,e._value=0,e._digits=0,e._interval=0,e._intervalCounter=0,e._total=0,e._starting=!1,e}return r(e,t),e.prototype.update=function(t){this._starting&&(this._total+=t,this.totalTime.string=this._total.toFixed(1)),this._started&&(this._counter+=t,this._updateValue())},e.prototype._updateValue=function(){var t=!1;if(this._targetTime>0&&this._counter>this._targetTime&&(this._counter=this._targetTime,this._started=!1,t=!0),this._isCountdown?this._value=this._targetTime-this._counter:this._value=this._counter,this._targetTime>0){var e=this._counter/this._targetTime;e=1-e,this.progress.progress=e}if(this.timeText.string=this._value.toFixed(this._digits),this._interval>0){var o=Math.floor(this._counter/this._interval);o!=this._intervalCounter&&(this._intervalCounter=o,this._intervalCallback(this,this._intervalCounter))}t&&a.default.isNotUndefinedOrNull(this._timeoutCallback)&&this._timeoutCallback()},e.prototype.setTimer=function(t,e,o,n){this._targetTime=t,this._isCountdown=e,this._digits=o,this._timeoutCallback=n,this._total=0,this.totalTime.node.active=this.showTotal,this.showInitValue()},e.prototype.setInterval=function(t,e){this._intervalCounter=0,this._interval=t,this._intervalCallback=e},e.prototype.showInitValue=function(){this.progress.progress=1,this._isCountdown?this.timeText.string=this._targetTime.toFixed(this._digits):this.timeText.string=(0).toFixed(this._digits),this.totalTime.string=this._total.toFixed(1)},e.prototype.startTimer=function(){this._started=!0,this._starting=!0,this._counter=0,this._total=0,this.totalTime.node.active=this.showTotal,this._intervalCounter=0,this._updateValue()},e.prototype.pause=function(){this._started=!1},e.prototype.resume=function(){this._started=!0},e.prototype.stop=function(){this._started=!1,this._starting=!1},e.prototype.isStarted=function(){return this._started},e.prototype.getTimePassed=function(){return this._counter},e.prototype.addTimePassed=function(t){this._counter+=t},e.prototype.addTargetTime=function(t){this._targetTime+=t},e.prototype.getTargetTime=function(){return this._targetTime},e.prototype.getTimeLeft=function(){return this._targetTime>0?this._targetTime-this._counter:this._targetTime},e.prototype.setTimeLeft=function(t){this._targetTime>0&&(this._counter=this._targetTime-t)},e.prototype.addTimeLeft=function(t,e){var o=this.getTimeLeft();(o+=t)>e&&(o=e),this.setTimeLeft(o)},i([l(cc.Label)],e.prototype,"timeText",void 0),i([l(cc.Node)],e.prototype,"background",void 0),i([l(cc.ProgressBar)],e.prototype,"progress",void 0),i([l(cc.Label)],e.prototype,"totalTime",void 0),i([l],e.prototype,"showTotal",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../GameKit/Framework/Utils/Utils":"Utils"}],TimeScale:[function(t,e,o){"use strict";cc._RF.push(e,"1aa38vEdCtGMZnbkjHcI1va","TimeScale"),Object.defineProperty(o,"__esModule",{value:!0});var n={timeScale:1,normal:function(){n.timeScale=1},slowdown:function(){n.timeScale=.1}};o.default=n,cc._RF.pop()},{}],TimedCounter:[function(t,e,o){"use strict";cc._RF.push(e,"534e2w+L8RAAoHb7PUEyGH2","TimedCounter"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Utils/Utils"),r=function(){function t(){this.interval=1,this._map={},this._startTime=0}return t.prototype.setInterval=function(t){this.interval=t},t.prototype.setValue=function(t,e){this._map[t]=e},t.prototype.getValue=function(t,e){var o=this._map[t];return n.default.isNotUndefinedOrNull(o)?o:e},t.prototype.startTimer=function(t){this._startTime=t},t.prototype.updateTimer=function(){this._startTime},t}();o.default=r,cc._RF.pop()},{"../Utils/Utils":"Utils"}],TimerJob:[function(t,e,o){"use strict";cc._RF.push(e,"4cea3cgOLNFVpEtMG4w6Ggc","TimerJob");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.createTimerJob=function(t,o){var n=new e(t);return n.setFinishHander(o),n},e.createJob=function(t,o){var n=new e(t);return o&&(n.setJobBeginHandler(o.onBeginHandler),n.setJobUpdateHandler(o.onUpdateHandler),n.setFinishHander(o.onFinishHandler),n.setCancelHandler(o.tryCancelHandler)),n},e.prototype._generateJob=function(t){this._duration=t.duration},e.prototype._onBegin=function(){t.prototype._onBegin.call(this),this._counter=0},e.prototype._onUpdate=function(e){return t.prototype._onUpdate.call(this,e),this._counter+=e,this._counter>=this._duration},e}(t("./Job").default);o.default=i,cc._RF.pop()},{"./Job":"Job"}],ToastUI:[function(t,e,o){"use strict";cc._RF.push(e,"e8067WPWDpNy5/6UFRJYEyS","ToastUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeToClose=3,e.timeToHide=1,e.xPadding=20,e.yPadding=20,e.msgLabel=null,e.bg=null,e.kitty=null,e._timer=0,e._hidding=!1,e}var o;return r(e,t),o=e,e.prototype.update=function(t){this._hidding||(this._timer+=t,this._timer>=this.timeToClose&&this.hide())},e.prototype.setMsg=function(t){this.msgLabel.string=t,this.msgLabel._forceUpdateRenderData(!0),this.bg.width=this.msgLabel.node.width+this.xPadding,this.bg.height=this.msgLabel.node.height+this.yPadding,this.kitty.x=this.bg.x-this.bg.width/2-this.kitty.width/2+10},e.prototype.show=function(t){this.setMsg(t),this._timer=0,this.node.active=!0,this._hidding=!1},e.prototype.hide=function(){var t=this;this._hidding=!0;var e=cc.fadeOut(this.timeToHide),o=cc.callFunc(function(){t.node.active=!1,t.node.destroy()});this.node.runAction(cc.sequence(e,o))},e.showToast=function(t,e,n){var r=cc.instantiate(e);r.setParent(n),r.getComponent(o).show(t)},i([c],e.prototype,"timeToClose",void 0),i([c],e.prototype,"timeToHide",void 0),i([c],e.prototype,"xPadding",void 0),i([c],e.prototype,"yPadding",void 0),i([c(cc.Label)],e.prototype,"msgLabel",void 0),i([c(cc.Node)],e.prototype,"bg",void 0),i([c(cc.Node)],e.prototype,"kitty",void 0),o=i([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],ToggleButton:[function(t,e,o){"use strict";cc._RF.push(e,"ca9b03S5FlDdLFC/KYtLyv7","ToggleButton");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onSprite=null,e.offSprite=null,e.onAnimationSprites=[],e.offAnimationSprites=[],e.iconSprite=null,e._on=!1,e.startWithOn=!1,e}return r(e,t),e.prototype.onLoad=function(){this.iconSprite||(this.iconSprite=this.getComponent(cc.Sprite)),this.offAnimationSprites.length<=0&&(this.offAnimationSprites=this.onAnimationSprites),this.setOn(this.startWithOn)},e.prototype.setOn=function(t){this._on=t,t?(this.onAnimationSprites.length>=2&&(this.normalSprite=this.onAnimationSprites[0],this.pressedSprite=this.onAnimationSprites[1]),this.iconSprite.spriteFrame=this.onSprite):(this.offAnimationSprites.length>=2&&(this.normalSprite=this.offAnimationSprites[0],this.pressedSprite=this.offAnimationSprites[1]),this.iconSprite.spriteFrame=this.offSprite)},i([c(cc.SpriteFrame)],e.prototype,"onSprite",void 0),i([c(cc.SpriteFrame)],e.prototype,"offSprite",void 0),i([c(cc.SpriteFrame)],e.prototype,"onAnimationSprites",void 0),i([c(cc.SpriteFrame)],e.prototype,"offAnimationSprites",void 0),i([c(cc.Sprite)],e.prototype,"iconSprite",void 0),i([c],e.prototype,"startWithOn",void 0),i([s],e)}(cc.Button);o.default=l,cc._RF.pop()},{}],UIHelper:[function(t,e,o){"use strict";cc._RF.push(e,"ef884lE9UZGS62WAoaO1ni3","UIHelper");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Audio/AudioControl"),a=t("../../App/AppFacade"),s=t("./Utils"),c={_bindClickEventOnComp:function(t,e,o,n,r){t?c._bindClickEventOnNode(t.node,e,o,n,r):console.warn("[UIHelper][bindClickEventOnComp] invalid component")},_bindClickEventOnNode:function(t,e,o,c,l){var u=this;t?t.on("click",function(t){return n(u,void 0,void 0,function(){return r(this,function(){return"number"==typeof l?i.default.getInstance().playSoundById(l):"boolean"==typeof l||s.default.isUndefinedOrNull(l)?i.default.getInstance().playClick():"string"==typeof l&&i.default.getInstance().playSoundByName(l),"function"==typeof e?e(t,c):"string"==typeof e?o?a.default.getInstance().executeCommand(e,c):a.default.getInstance().sendNotification(e,c):console.warn("[UIHelper] unknown type of event or callback: ",e),[2]})})},void 0):console.warn("[UIHelper][bindClickEventOnNode] invalid node")},bindClickEvent:function(t,e,o,n,r){t instanceof cc.Node?c._bindClickEventOnNode(t,e,o,n,r):t instanceof cc.Component&&c._bindClickEventOnNode(t.node,e,o,n,r)},bindToggleEvent:function(t,e,o,n){t.node.on("toggle",function(t){"number"==typeof n?i.default.getInstance().playSoundById(n):"boolean"==typeof n?i.default.getInstance().playClick():"string"==typeof n&&i.default.getInstance().playSoundByName(n),t.isChecked?e&&e(!0):o&&o(!1)})},getChildByNameR:function(t,e){var o=t.getChildByName(e);if(s.default.isNotUndefinedOrNull(o))return o;for(var n=0;n<t.childrenCount;n++){var r=t.children[n];if(o=c.getChildByNameR(r,e),s.default.isNotUndefinedOrNull(o))break}return o}};o.default=c,cc._RF.pop()},{"../../App/AppFacade":"AppFacade","../Audio/AudioControl":"AudioControl","./Utils":"Utils"}],UIMediator2:[function(t,e,o){"use strict";cc._RF.push(e,"9db502f5llHWZpaMGhleW35","UIMediator2");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./MediatorComp"),l=t("../Utils/Utils"),u=t("../Utils/UIHelper"),p=t("../Ads/AdsManager"),d=t("../../../Kitty/Script/Data/KittyLogger"),f=cc._decorator,h=f.ccclass,y=f.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.defaultCloseButton="BtnClose",e.pageName="",e._btnClose=null,e}return r(e,t),e.prototype._initViewComponent=function(){if(t.prototype._initViewComponent.call(this),!l.default.isUndefinedOrNullOrEmpty(this.defaultCloseButton)){var e=u.default.getChildByNameR(this.node,this.defaultCloseButton);l.default.isNotUndefinedOrNull(e)&&(this._btnClose=e.getComponent(cc.Button),u.default.bindClickEvent(e,this.onClose.bind(this)))}},e.prototype.onClose=function(){this.hide(!0)},e.prototype.show=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.node.active=!0,p.default.getInstance().showBannerAds(!0),d.default.logPageEnter(this.pageName),[2]})})},e.prototype.hide=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.node.active=!1,p.default.getInstance().showBannerAds(!1),d.default.logPageExit(),[2]})})},i([y],e.prototype,"defaultCloseButton",void 0),i([y],e.prototype,"pageName",void 0),i([h],e)}(c.default);o.default=_,cc._RF.pop()},{"../../../Kitty/Script/Data/KittyLogger":"KittyLogger","../Ads/AdsManager":"AdsManager","../Utils/UIHelper":"UIHelper","../Utils/Utils":"Utils","./MediatorComp":"MediatorComp"}],UIMediator:[function(t,e,o){"use strict";cc._RF.push(e,"ca3a4secopHcKon1pCZ5B9R","UIMediator");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},a=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.UITYPE=void 0;var c=t("./MediatorComp"),l=t("./BaseUI"),u=t("../Utils/Utils"),p=cc._decorator,d=p.ccclass,f=p.property;o.UITYPE={HOME:"HomeUI",GAME:"GameUI",RESULT:"ResultUI"};var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ui=null,e.registerOnStart=!1,e.defaultHide=!0,e}return r(e,t),e.prototype._initViewComponent=function(){u.default.isUndefinedOrNull(this.ui)?(this.ui=this.getComponent(l.default),this.ui&&this.ui.initOnce()):this.ui.initOnce()},e.prototype._updateData=function(){},e.prototype.start=function(){u.default.isUndefinedOrNull(this.ui)?console.warn("[UIMediator] uiComponent not set"):this.registerOnStart&&this.getFacade()&&(this.initOnce(),this.getFacade().registerMediator(this))},e.prototype.show=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return[2,this.ui.show(t)]})})},e.prototype.hide=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return[2,this.ui.hide(t)]})})},e.prototype.getName=function(){return u.default.isUndefinedOrNullOrEmpty(this.mediatorName)&&(this.mediatorName=this.ui.node.name),this.mediatorName},e.prototype.initOnce=function(){t.prototype.initOnce.call(this),this.defaultHide&&this.hide(!1)},i([f({type:l.default,tooltip:"UI\u8282\u70b9"})],e.prototype,"ui",void 0),i([f({tooltip:"\u521d\u59cb\u81ea\u52a8\u6ce8\u518c"})],e.prototype,"registerOnStart",void 0),i([f({tooltip:"\u521d\u59cb\u662f\u5426\u9690\u85cf\u89c6\u56fe\u8282\u70b9"})],e.prototype,"defaultHide",void 0),i([d],e)}(c.default);o.default=h,cc._RF.pop()},{"../Utils/Utils":"Utils","./BaseUI":"BaseUI","./MediatorComp":"MediatorComp"}],Utils:[function(t,e,o){"use strict";cc._RF.push(e,"522b1ZITIJIqLFGHnUVyS6z","Utils");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.Utils=void 0;var i={paddingNumber:function(t,e){var o=Math.abs(t),n=t<0,r=o.toString();for(0==o&&(o=1);o<Math.pow(10,e-1);)r="0"+r,o*=10;return n&&(r="-"+r),r},isUndefined:function(t){return void 0===t},isUndefinedOrNull:function(t){return void 0===t||null==t},isNotUndefinedOrNull:function(t){return!i.isUndefinedOrNull(t)},isUndefinedOrNullOrEmpty:function(t){return i.isUndefinedOrNull(t)||t.length<=0},random:function(){return Math.random()},randomInt:function(t,e){var o=Math.random();return o*=e-t,t+Math.floor(o)},randomFloat:function(t,e){return Math.random()*(e-t)+t},randomItemInArray:function(t){var e=i.randomInt(0,t.length);return{idx:e,value:t[e]}},randomItems:function(t,e){var o=i.randomValuesBetween(0,t.length,e),n=[];return o.forEach(function(e){n.push({idx:e,value:t[e]})}),n},randomValuesBetween:function(t,e,o){var n=[],r=e-t;r<=o&&(o=r);for(var a=0;a<o;a++)n.push(i.randomValueBetweenAndNotInList(t,e,n));return n},randomValueBetweenAndNotInList:function(t,e,o){for(var n=0,r=!1;!r;)n=i.randomInt(t,e),r=!0,cc.js.array.contains(o,n)&&(r=!1);return n},randomArray:function(t){var e=i.randomItems(t,t.length),o=[];return e.forEach(function(t){o.push(t.value)}),o},sortArray:function(t,e){for(var o=0;o<t.length;o++){for(var n=t[o],r=o+1;r<t.length;r++){var i=t[r];e(n,i)||(t[r]=n,n=i)}t[o]=n}return t},sign:function(t){return t>0?1:t<0?-1:0},asyncForEach:function(t,e){return n(this,void 0,void 0,function(){var o;return r(this,function(n){switch(n.label){case 0:o=0,n.label=1;case 1:return o<t.length?[4,e(t[o],o,t)]:[3,4];case 2:n.sent(),n.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},waitFor:function(t){return n(this,void 0,void 0,function(){return r(this,function(){return[2,new Promise(function(e){return setTimeout(e,t)})]})})},waitForNode:function(t,e){return n(this,void 0,void 0,function(){return r(this,function(){return[2,new Promise(function(o){var n=cc.delayTime(e),r=cc.callFunc(o),i=cc.sequence(n,r);t.runAction(i)})]})})},loadRes:function(t,e){return n(this,void 0,Promise,function(){return r(this,function(){return[2,new Promise(function(o){cc.loader.loadRes(t,e,function(t,e){o({error:t,resource:e})})})]})})},getKeys:function(t){var e=[];for(var o in t)e.push(o);return e},isSameDay:function(t,e){return t.getFullYear()==e.getFullYear()&&t.getMonth()==e.getMonth()&&t.getDate()==e.getDate()},isSameDayToday:function(t){return i.isSameDay(t,new Date)},msADay:function(){return 864e5},msHour:function(t){return void 0===t&&(t=1),36e5*t},msMinutes:function(t){return void 0===t&&(t=1),6e4*t},calculateDays2:function(t,e,o){var n=new Date(t.getTime()),r=new Date(e.getTime());return o&&(n.setHours(0,0,0,0),r.setHours(0,0,0,0)),(r.getTime()-n.getTime())/i.msADay()},calculateDays:function(t,e,o){var n=new Date(t.getTime()),r=new Date(e.getTime());o&&(n.setHours(0,0,0,0),r.setHours(0,0,0,0));var a=r.getTime()-n.getTime(),s=i.msADay();return Math.ceil(a/s)},calculateDaysToNow:function(t,e){return i.calculateDays(t,new Date,e)},formatDate:function(t){return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},formatTime:function(t){var e=t%1e3,o=(t-e)/1e3,n=o%60,r=(o-n)/60,a=r%60,s=(r-a)/60;return{h:s,m:a,s:n,ms:e,seconds:t/1e3,minutes:t/6e4,hours:t/i.msHour(1),str:s+"\u5c0f\u65f6"+a+"\u5206\u949f"+n+"\u79d2"}},fillArray:function(t,e){for(var o=0;o<t.length;o++)t[o]=e},createArray:function(t,e){var o=new Array(t);return i.fillArray(o,e),o},concateStrings:function(t,e){if(!Array.isArray(t))return t;var o="";return i.isUndefinedOrNull(e)&&(e="\n"),t.forEach(function(t,n){n>0&&(o+=e),o+=t}),o},replaceAll:function(t,e,o){for(var n=t;n.indexOf(e)>=0;)n=n.replace(e,o);return n},getWorldPositionOfNode:function(t){var e=t.getPosition();return null==t.parent?e:t.parent.convertToWorldSpaceAR(e)},getNodeParentPositionOfWorld:function(t,e){return null==t.parent?e:t.parent.convertToNodeSpaceAR(e)},convertNode1PositionToNode2SpaceAR:function(t,e){var o=i.getWorldPositionOfNode(t);return e.convertToNodeSpaceAR(o)},convertNode1PositionToNode2ParentSpaceAR:function(t,e){if(t.parent==e.parent)return t.getPosition();var o=i.getWorldPositionOfNode(t);return i.getNodeParentPositionOfWorld(e,o)},convertPositionInNode1ToNode2SpaceAR:function(t,e,o){var n=e.convertToWorldSpaceAR(t);return o.convertToNodeSpaceAR(n)},expendLabelBackground:function(t,e,o,n){t._forceUpdateRenderData(!0),o>0&&(e.width=t.node.width+o),n>0&&(e.height=t.node.height+n)}};o.Utils=i,o.default=i,cc._RF.pop()},{}],View:[function(t,e,o){"use strict";cc._RF.push(e,"95180vTC2pLMZP1tI2IRBLS","View");var n=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,i=r.ccclass,a=(r.property,t("../Utils/Utils")),s=function(){function t(){}var e;return e=t,t.getInstance=function(){return a.Utils.isUndefinedOrNull(e._instance)&&(e._instance=new e),e._instance},t.prototype.init=function(t){this._mediators=[],this._facade=t},t.prototype.registerMediator=function(t){if(console.info("[View] registerMediator: ",t.getName()),this.hasMediator(t.getName())){if(this.retrieveMediator(t.getName())==t)return void console.warn("[View] mediator already registered: ",t.getName());console.warn("[View] remove previous mediator: ",t.getName()),this.removeMediator(t.getName)}this._mediators[t.getName()]=t;for(var e=t.listNotificationInterests(),o=0;o<e.length;o++)this._facade.registerObserver(e[o],t.handleNotification,t);t.onRegister()},t.prototype.retrieveMediator=function(t){return this._mediators[t]},t.prototype.removeMediator=function(t){var e=this.retrieveMediator(t);if(a.Utils.isUndefinedOrNull(e))console.warn("[View] mediator already removed: ",e.getName());else{console.info("[View] removeMediator: ",e.getName()),this._mediators[t]=void 0;for(var o=e.listNotificationInterests(),n=0;n<o.length;n++)this._facade.removeObserver(o[n],e.handleNotification,e);e.onRemove()}},t.prototype.hasMediator=function(t){return a.Utils.isNotUndefinedOrNull(this._mediators[t])},e=n([i],t)}();o.default=s,cc._RF.pop()},{"../Utils/Utils":"Utils"}],WalkableGrid:[function(t,e,o){"use strict";cc._RF.push(e,"1762eofZJFLyKOFuV+TNDoQ","WalkableGrid");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./GridNode"),s=t("./Grid"),c=t("../../../GameKit/Framework/Utils/Utils"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.display=null,e.initScale=.1,e.markScale=1,e.hiddenNode=null,e.hiddenNodeScale=1,e.eventId=0,e.hideOnMarked=!0,e._marked=!1,e._isSpecial=!1,e}return r(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this._isSpecial=c.default.isNotUndefinedOrNull(this.hiddenNode),this._grid.gridType==s.GRID_TYPE.WALKABLE&&(this.mark(!1),this._playShow()),this.hiddenNode&&(this.hiddenNode.active=!1)},e.prototype.isMarked=function(){return this._marked},e.prototype.setDisplayColor=function(t){this.display.color=t},e.prototype.mark=function(t){t?this._marked||(this._marked=t,this._playMark()):this._marked=t},e.prototype._playShow=function(){this.display.scale=.001;var t=cc.scaleTo(.1,this.initScale,this.initScale);this.display.runAction(t)},e.prototype._playMark=function(){var t=this;this.hiddenNode&&(this.hiddenNode.active=!1),this.display.stopAllActions();var e=cc.scaleTo(.2,this.markScale,this.markScale),o=e;this._isSpecial&&(o=this.hideOnMarked?cc.sequence(e,cc.callFunc(function(){t.hiddenNode&&(t.hiddenNode.scale=.01,t.hiddenNode.active=!0,t.hiddenNode.runAction(cc.scaleTo(.2,t.hiddenNodeScale,t.hiddenNodeScale)))}),cc.fadeOut(.1)):cc.sequence(e,cc.callFunc(function(){t.hiddenNode&&(t.hiddenNode.scale=.01,t.hiddenNode.active=!0,t.hiddenNode.runAction(cc.scaleTo(.2,t.hiddenNodeScale,t.hiddenNodeScale))),t.display.active=!1}))),this.display.runAction(o)},e.prototype.hideIcon=function(t){this.hiddenNode&&(this.hiddenNode.active=!t)},e.prototype.gatherSpecial=function(){this.hiddenNode&&(this.hiddenNode.active=!1,this.display.runAction(cc.fadeIn(.1)))},e.EVENTS={MARKED:"Walkable.Marked"},i([p(cc.Node)],e.prototype,"display",void 0),i([p],e.prototype,"initScale",void 0),i([p],e.prototype,"markScale",void 0),i([p(cc.Node)],e.prototype,"hiddenNode",void 0),i([p],e.prototype,"hiddenNodeScale",void 0),i([p],e.prototype,"eventId",void 0),i([p],e.prototype,"hideOnMarked",void 0),i([u],e)}(a.default);o.default=d,cc._RF.pop()},{"../../../GameKit/Framework/Utils/Utils":"Utils","./Grid":"Grid","./GridNode":"GridNode"}],WallGrid:[function(t,e,o){"use strict";cc._RF.push(e,"7976df/pCRFA7NVXSauDrbA","WallGrid");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.start=function(){this._playShow()},e.prototype._playShow=function(){this.node.scale=.001;var t=cc.scaleTo(.25,1,1);this.node.runAction(t)},i([s],e)}(cc.Component));o.default=c,cc._RF.pop()},{}],Wallet:[function(t,e,o){"use strict";cc._RF.push(e,"c0375GqWa5Kkq8MxHzjamuT","Wallet");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../KittyUtils"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coinIcon=null,e.coinValue=null,e.goldIcon=null,e.goldValue=null,e}return r(e,t),e.prototype.updateData=function(t){this.coinValue.string=a.default.formatNumber(t.coin),this.goldValue.string=a.default.formatNumber(t.gold)},i([l(cc.Node)],e.prototype,"coinIcon",void 0),i([l(cc.Label)],e.prototype,"coinValue",void 0),i([l(cc.Node)],e.prototype,"goldIcon",void 0),i([l(cc.Label)],e.prototype,"goldValue",void 0),i([c],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../KittyUtils":"KittyUtils"}],i18n:[function(t,e,o){"use strict";cc._RF.push(e,"2c76awylQtFs7B3UU4knNgL","i18n");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(a,s)}c((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Utils/Utils"),a=cc._decorator,s=(a.ccclass,a.property,{default:"en",current:"",_data:{},_ready:!1,_comps:new Array,_supportedLan:[],_localeLan:"",setLocale:function(t){this._localeLan=t},setSupportedLanguages:function(t){this._supportedLan=t},isSupported:function(t){for(var e=!1,o=0;o<this._supportedLan.length;o++)if(this._supportedLan[o].lan==t){e=!0;break}return e},getLanOption:function(t){for(var e,o=0;o<this._supportedLan.length;o++)if(this._supportedLan[o].lan==t){e=this._supportedLan[o];break}return e},getLanOptions:function(){var t=[],e=this.getLanOption(this._localeLan);return e&&t.push(e),this.default!=this._localeLan&&(e=this.getLanOption(this.default))&&t.push(e),t},init:function(t,e,o){return n(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return o&&(this.default=o),[4,this._loadLanguageData(this.default)];case 1:return n.sent(),i.default.isNotUndefinedOrNull(t)&&t!=this.default?[4,this._loadLanguageData(t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return e&&(this.setLanguage(e,o),this.setReady(!0)),[2]}})})},setLanguage:function(t,e){this.current=t,i.default.isNotUndefinedOrNull(e)&&(this.default=e),this.hasLanguage(this.current)||(console.info("[i18n] missing lan: ",this.current,", use default: ",this.default),this.current=this.default),console.info("[i18n] set lan, current: ",this.current,", default: ",this.default)},hasLanguage:function(t){var e=this._data[t];return i.default.isNotUndefinedOrNull(e)},getCurrentLan:function(){return this.current},getDefaultLan:function(){return this.default},_loadLanguageData:function(t){return n(this,void 0,void 0,function(){var e,o,n,a;return r(this,function(r){switch(r.label){case 0:return this.hasLanguage(t)?[2]:(e="i18n/"+t,[4,i.default.loadRes(e)]);case 1:return o=r.sent(),console.info("[i18n] load res: ",t,", result: ",o),o.error||(n=o.resource,a=n.json,this._data[t]=a),[2]}})})},isReady:function(){return this._ready},setReady:function(t){this._ready=t,t&&this.onReady()},register:function(t){cc.js.array.contains(this._comps,t)||this._comps.push(t)},unregister:function(t){cc.js.array.remove(this._comps,t)},onReady:function(){this._comps.forEach(function(t){t&&t.updateLanguage()})},useSystemFont:function(){var t=this._data[this.current];return!i.default.isUndefinedOrNull(t)&&!i.default.isUndefinedOrNull(t.useSystemFont)&&t.useSystemFont},rightToLeft:function(){var t=this._data[this.current];return!i.default.isUndefinedOrNull(t)&&!i.default.isUndefinedOrNull(t.rightToLeft)&&t.rightToLeft},value:function(t,e){var o,n=this._data[this.current];if(i.default.isNotUndefinedOrNull(n)&&(o=n.strings[t],i.default.isNotUndefinedOrNull(o)))return o;if(this.current!=this.default){var r=this._data[this.default];if(i.default.isNotUndefinedOrNull(r)&&(o=r.strings[t],i.default.isNotUndefinedOrNull(o)))return o}return i.default.isUndefinedOrNull(e)&&(e=""),e},text:function(t,e){var o=s.value(t);return i.default.isUndefinedOrNull(o)&&(o=e),Array.isArray(o)&&(o=i.default.concateStrings(o)),o},textWithVar:function(t,e,o,n){var r=s.text(t,e);return i.default.isUndefinedOrNullOrEmpty(n)&&(n="value"),i.default.replaceAll(r,"${"+n+"}",o)},randomText:function(t,e){var o=s.value(t);return i.default.isUndefinedOrNull(o)&&(o=e),Array.isArray(o)?o[i.default.randomInt(0,o.length)]:o},subItem:function(t,e,o){var n=s.value(t);return i.default.isUndefinedOrNull(n)?o:i.default.isUndefinedOrNull(n[e])?o:n[e]}});o.default=s,cc._RF.pop()},{"../Utils/Utils":"Utils"}],"use_v2.1-2.2.1_cc.Toggle_event":[function(t,e){"use strict";cc._RF.push(e,"1c093smw3lB9L0eOnYKrKES","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}]},{},["ConfigDB","GameFacade","PlayerProxy","AStar","Board","CollisionTags","Corner","Grid","GridNode","InputType","LevelAStarNode","LevelData","LevelHelper","Lipstick","LipstickGrid","Playground","Role","TimeScale","WalkableGrid","WallGrid","BoardEditor","GameEditor","DebugMenu","MatchMediator","MatchProxy","MatchUI","ResultUI","EditorScene","GameScene","CardboardBox","KFPlayground","AccountProxy","BasePlayerProxy","FB","FacebookProxy","InventoryProxy","LocalProxy","AdsProxy","AdsUI","AdsUIMediator","AppFacade","AppProxy","DownloadCache","GameApp","Logger","Splash","AppCommands","AdsInterface","AdsManager","TempAds","AudioConfig","AudioControl","Cloud","Jumpy","QuickCloseButton","QuickEventButton","ScoreLabel","Controller","MacroCommand","SimpleCommand","EventCenter","SingleNode","TableView","TableViewCell","ToggleButton","Facade","InputControl","ActionJob","AnimationJob","Job","JobGroup","JobQueue","JobSystem","NestedJob","TimerJob","LocalCache","Model","Proxy","TimedCounter","HttpRequest","Notifier","PoolConfig","PoolManager","SceneControl","SceneResolution","ScreenShot","ScreenShotButton","ScreenShotNode","UIHelper","Utils","BaseUI","MainUIMediator","Mediator","MediatorComp","ToastUI","UIMediator","UIMediator2","View","LanguageButton","LanguageOption","LocalizedLabel","LocalizedSprite","LocalizedSpriteConfig","i18n","BaseGameUI","BaseGameUIMediator","BaseHUD","BaseHomeUI","BaseHudMediator","BaseMatchData","BaseMatchMediator","BaseMatchProxy","BasePlayground","BaseResultMediator","BaseResultUI","BaseReviveMediator","BaseReviveUI","BaseScoreData","TempLogger","ContextRankProxy","RankEntryItem","RankMediator","RankProxy","RankUI","BaseGameScene","BaseSplashScene","StartScene","AdsSettings","AudioTypes","Builds","CommandTypes","EventTypes","LogSettings","MediatorType","ProxyTypes","RankTypes","SceneTypes","Settings","PopUI","ShopDB","ShopItemAction","ShopMediator","ShopPage","ShopProxy","ShopUI","AdmobProvider","AdmobHelper","Baidu","BaiduAds","Facebook","FacebookAds","FeedCommands","KittyCommands","HeartEffect","HiddenKitty","ImageResize","KittyCard","KittyOption","KittyAds","KittyConfig","KittyDB","KittyGuideSettings","KittyInfo","KittyInventoryProxy","KittyLevelSequence","KittyLogger","KittyPlaygroundProxy","KittyShopProxy","KittyTaskInfo","KittyTaskProxy","KittyToyInfo","PrefabPair","PropertyCounter","KittyApp","KittyConsts","KittyFacade","KittyGuide","KittyResouces","KittyUtils","KittyHttp","RemoteCache","Cell","CellContainer","Item","KittyBonus","KittyCheckin","KittyCheckinItem","KittyCollection","KittyCollectionItem","KittyFinding","KittyGameUnlocked","KittyHideAndSeek","KittyHome","KittyHud","KittyItem","KittyLottery","KittyMatch","KittyPetting","KittyPlayground","KittyRank","KittyScene","KittyShop","KittyShopItem","KittyTask","KittyTaskItem","KittyTeamTask","KittyToyItem","KittyToys","KittyTreasures","KittyUnlocked","LotterySlot","RewardsPopup","Wallet","ClickGuide","KMCountdownEffect","KMJob","KMJobs","KMPlayground","KMResult","KMScoreEffect","KMSkillEffect","KMSkillProgress","KittyBall","KittyBallInfo","KittyBallScore","TimeCounter","use_v2.1-2.2.1_cc.Toggle_event"]);